(function(){const R=document.createElement("link").relList;if(R&&R.supports&&R.supports("modulepreload"))return;for(const h of document.querySelectorAll('link[rel="modulepreload"]'))P(h);new MutationObserver(h=>{for(const e of h)if(e.type==="childList")for(const n of e.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&P(n)}).observe(document,{childList:!0,subtree:!0});function T(h){const e={};return h.integrity&&(e.integrity=h.integrity),h.referrerPolicy&&(e.referrerPolicy=h.referrerPolicy),h.crossOrigin==="use-credentials"?e.credentials="include":h.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function P(h){if(h.ep)return;h.ep=!0;const e=T(h);fetch(h.href,e)}})();var on=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Lo(S){return S&&S.__esModule&&Object.prototype.hasOwnProperty.call(S,"default")?S.default:S}var kn={exports:{}};/*!
 * matter-js 0.20.0 by @liabru
 * http://brm.io/matter-js/
 * License MIT
 * 
 * The MIT License (MIT)
 * 
 * Copyright (c) Liam Brummitt and contributors.
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */(function(S,R){(function(P,h){S.exports=h()})(on,function(){return function(T){var P={};function h(e){if(P[e])return P[e].exports;var n=P[e]={i:e,l:!1,exports:{}};return T[e].call(n.exports,n,n.exports,h),n.l=!0,n.exports}return h.m=T,h.c=P,h.d=function(e,n,i){h.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},h.r=function(e){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},h.t=function(e,n){if(n&1&&(e=h(e)),n&8||n&4&&typeof e=="object"&&e&&e.__esModule)return e;var i=Object.create(null);if(h.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),n&2&&typeof e!="string")for(var u in e)h.d(i,u,(function(c){return e[c]}).bind(null,u));return i},h.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return h.d(n,"a",n),n},h.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},h.p="",h(h.s=20)}([function(T,P){var h={};T.exports=h,function(){h._baseDelta=1e3/60,h._nextId=0,h._seed=0,h._nowStartTime=+new Date,h._warnedOnce={},h._decomp=null,h.extend=function(n,i){var u,c;typeof i=="boolean"?(u=2,c=i):(u=1,c=!0);for(var l=u;l<arguments.length;l++){var m=arguments[l];if(m)for(var d in m)c&&m[d]&&m[d].constructor===Object&&(!n[d]||n[d].constructor===Object)?(n[d]=n[d]||{},h.extend(n[d],c,m[d])):n[d]=m[d]}return n},h.clone=function(n,i){return h.extend({},i,n)},h.keys=function(n){if(Object.keys)return Object.keys(n);var i=[];for(var u in n)i.push(u);return i},h.values=function(n){var i=[];if(Object.keys){for(var u=Object.keys(n),c=0;c<u.length;c++)i.push(n[u[c]]);return i}for(var l in n)i.push(n[l]);return i},h.get=function(n,i,u,c){i=i.split(".").slice(u,c);for(var l=0;l<i.length;l+=1)n=n[i[l]];return n},h.set=function(n,i,u,c,l){var m=i.split(".").slice(c,l);return h.get(n,i,0,-1)[m[m.length-1]]=u,u},h.shuffle=function(n){for(var i=n.length-1;i>0;i--){var u=Math.floor(h.random()*(i+1)),c=n[i];n[i]=n[u],n[u]=c}return n},h.choose=function(n){return n[Math.floor(h.random()*n.length)]},h.isElement=function(n){return typeof HTMLElement<"u"?n instanceof HTMLElement:!!(n&&n.nodeType&&n.nodeName)},h.isArray=function(n){return Object.prototype.toString.call(n)==="[object Array]"},h.isFunction=function(n){return typeof n=="function"},h.isPlainObject=function(n){return typeof n=="object"&&n.constructor===Object},h.isString=function(n){return toString.call(n)==="[object String]"},h.clamp=function(n,i,u){return n<i?i:n>u?u:n},h.sign=function(n){return n<0?-1:1},h.now=function(){if(typeof window<"u"&&window.performance){if(window.performance.now)return window.performance.now();if(window.performance.webkitNow)return window.performance.webkitNow()}return Date.now?Date.now():new Date-h._nowStartTime},h.random=function(n,i){return n=typeof n<"u"?n:0,i=typeof i<"u"?i:1,n+e()*(i-n)};var e=function(){return h._seed=(h._seed*9301+49297)%233280,h._seed/233280};h.colorToNumber=function(n){return n=n.replace("#",""),n.length==3&&(n=n.charAt(0)+n.charAt(0)+n.charAt(1)+n.charAt(1)+n.charAt(2)+n.charAt(2)),parseInt(n,16)},h.logLevel=1,h.log=function(){console&&h.logLevel>0&&h.logLevel<=3&&console.log.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},h.info=function(){console&&h.logLevel>0&&h.logLevel<=2&&console.info.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},h.warn=function(){console&&h.logLevel>0&&h.logLevel<=3&&console.warn.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},h.warnOnce=function(){var n=Array.prototype.slice.call(arguments).join(" ");h._warnedOnce[n]||(h.warn(n),h._warnedOnce[n]=!0)},h.deprecated=function(n,i,u){n[i]=h.chain(function(){h.warnOnce("ðŸ”… deprecated ðŸ”…",u)},n[i])},h.nextId=function(){return h._nextId++},h.indexOf=function(n,i){if(n.indexOf)return n.indexOf(i);for(var u=0;u<n.length;u++)if(n[u]===i)return u;return-1},h.map=function(n,i){if(n.map)return n.map(i);for(var u=[],c=0;c<n.length;c+=1)u.push(i(n[c]));return u},h.topologicalSort=function(n){var i=[],u=[],c=[];for(var l in n)!u[l]&&!c[l]&&h._topologicalSort(l,u,c,n,i);return i},h._topologicalSort=function(n,i,u,c,l){var m=c[n]||[];u[n]=!0;for(var d=0;d<m.length;d+=1){var a=m[d];u[a]||i[a]||h._topologicalSort(a,i,u,c,l)}u[n]=!1,i[n]=!0,l.push(n)},h.chain=function(){for(var n=[],i=0;i<arguments.length;i+=1){var u=arguments[i];u._chained?n.push.apply(n,u._chained):n.push(u)}var c=function(){for(var l,m=new Array(arguments.length),d=0,a=arguments.length;d<a;d++)m[d]=arguments[d];for(d=0;d<n.length;d+=1){var y=n[d].apply(l,m);typeof y<"u"&&(l=y)}return l};return c._chained=n,c},h.chainPathBefore=function(n,i,u){return h.set(n,i,h.chain(u,h.get(n,i)))},h.chainPathAfter=function(n,i,u){return h.set(n,i,h.chain(h.get(n,i),u))},h.setDecomp=function(n){h._decomp=n},h.getDecomp=function(){var n=h._decomp;try{!n&&typeof window<"u"&&(n=window.decomp),!n&&typeof on<"u"&&(n=on.decomp)}catch{n=null}return n}}()},function(T,P){var h={};T.exports=h,function(){h.create=function(e){var n={min:{x:0,y:0},max:{x:0,y:0}};return e&&h.update(n,e),n},h.update=function(e,n,i){e.min.x=1/0,e.max.x=-1/0,e.min.y=1/0,e.max.y=-1/0;for(var u=0;u<n.length;u++){var c=n[u];c.x>e.max.x&&(e.max.x=c.x),c.x<e.min.x&&(e.min.x=c.x),c.y>e.max.y&&(e.max.y=c.y),c.y<e.min.y&&(e.min.y=c.y)}i&&(i.x>0?e.max.x+=i.x:e.min.x+=i.x,i.y>0?e.max.y+=i.y:e.min.y+=i.y)},h.contains=function(e,n){return n.x>=e.min.x&&n.x<=e.max.x&&n.y>=e.min.y&&n.y<=e.max.y},h.overlaps=function(e,n){return e.min.x<=n.max.x&&e.max.x>=n.min.x&&e.max.y>=n.min.y&&e.min.y<=n.max.y},h.translate=function(e,n){e.min.x+=n.x,e.max.x+=n.x,e.min.y+=n.y,e.max.y+=n.y},h.shift=function(e,n){var i=e.max.x-e.min.x,u=e.max.y-e.min.y;e.min.x=n.x,e.max.x=n.x+i,e.min.y=n.y,e.max.y=n.y+u}}()},function(T,P){var h={};T.exports=h,function(){h.create=function(e,n){return{x:e||0,y:n||0}},h.clone=function(e){return{x:e.x,y:e.y}},h.magnitude=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},h.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y},h.rotate=function(e,n,i){var u=Math.cos(n),c=Math.sin(n);i||(i={});var l=e.x*u-e.y*c;return i.y=e.x*c+e.y*u,i.x=l,i},h.rotateAbout=function(e,n,i,u){var c=Math.cos(n),l=Math.sin(n);u||(u={});var m=i.x+((e.x-i.x)*c-(e.y-i.y)*l);return u.y=i.y+((e.x-i.x)*l+(e.y-i.y)*c),u.x=m,u},h.normalise=function(e){var n=h.magnitude(e);return n===0?{x:0,y:0}:{x:e.x/n,y:e.y/n}},h.dot=function(e,n){return e.x*n.x+e.y*n.y},h.cross=function(e,n){return e.x*n.y-e.y*n.x},h.cross3=function(e,n,i){return(n.x-e.x)*(i.y-e.y)-(n.y-e.y)*(i.x-e.x)},h.add=function(e,n,i){return i||(i={}),i.x=e.x+n.x,i.y=e.y+n.y,i},h.sub=function(e,n,i){return i||(i={}),i.x=e.x-n.x,i.y=e.y-n.y,i},h.mult=function(e,n){return{x:e.x*n,y:e.y*n}},h.div=function(e,n){return{x:e.x/n,y:e.y/n}},h.perp=function(e,n){return n=n===!0?-1:1,{x:n*-e.y,y:n*e.x}},h.neg=function(e){return{x:-e.x,y:-e.y}},h.angle=function(e,n){return Math.atan2(n.y-e.y,n.x-e.x)},h._temp=[h.create(),h.create(),h.create(),h.create(),h.create(),h.create()]}()},function(T,P,h){var e={};T.exports=e;var n=h(2),i=h(0);(function(){e.create=function(u,c){for(var l=[],m=0;m<u.length;m++){var d=u[m],a={x:d.x,y:d.y,index:m,body:c,isInternal:!1};l.push(a)}return l},e.fromPath=function(u,c){var l=/L?\s*([-\d.e]+)[\s,]*([-\d.e]+)*/ig,m=[];return u.replace(l,function(d,a,y){m.push({x:parseFloat(a),y:parseFloat(y)})}),e.create(m,c)},e.centre=function(u){for(var c=e.area(u,!0),l={x:0,y:0},m,d,a,y=0;y<u.length;y++)a=(y+1)%u.length,m=n.cross(u[y],u[a]),d=n.mult(n.add(u[y],u[a]),m),l=n.add(l,d);return n.div(l,6*c)},e.mean=function(u){for(var c={x:0,y:0},l=0;l<u.length;l++)c.x+=u[l].x,c.y+=u[l].y;return n.div(c,u.length)},e.area=function(u,c){for(var l=0,m=u.length-1,d=0;d<u.length;d++)l+=(u[m].x-u[d].x)*(u[m].y+u[d].y),m=d;return c?l/2:Math.abs(l)/2},e.inertia=function(u,c){for(var l=0,m=0,d=u,a,y,v=0;v<d.length;v++)y=(v+1)%d.length,a=Math.abs(n.cross(d[y],d[v])),l+=a*(n.dot(d[y],d[y])+n.dot(d[y],d[v])+n.dot(d[v],d[v])),m+=a;return c/6*(l/m)},e.translate=function(u,c,l){l=typeof l<"u"?l:1;var m=u.length,d=c.x*l,a=c.y*l,y;for(y=0;y<m;y++)u[y].x+=d,u[y].y+=a;return u},e.rotate=function(u,c,l){if(c!==0){var m=Math.cos(c),d=Math.sin(c),a=l.x,y=l.y,v=u.length,_,w,k,A;for(A=0;A<v;A++)_=u[A],w=_.x-a,k=_.y-y,_.x=a+(w*m-k*d),_.y=y+(w*d+k*m);return u}},e.contains=function(u,c){for(var l=c.x,m=c.y,d=u.length,a=u[d-1],y,v=0;v<d;v++){if(y=u[v],(l-a.x)*(y.y-a.y)+(m-a.y)*(a.x-y.x)>0)return!1;a=y}return!0},e.scale=function(u,c,l,m){if(c===1&&l===1)return u;m=m||e.centre(u);for(var d,a,y=0;y<u.length;y++)d=u[y],a=n.sub(d,m),u[y].x=m.x+a.x*c,u[y].y=m.y+a.y*l;return u},e.chamfer=function(u,c,l,m,d){typeof c=="number"?c=[c]:c=c||[8],l=typeof l<"u"?l:-1,m=m||2,d=d||14;for(var a=[],y=0;y<u.length;y++){var v=u[y-1>=0?y-1:u.length-1],_=u[y],w=u[(y+1)%u.length],k=c[y<c.length?y:c.length-1];if(k===0){a.push(_);continue}var A=n.normalise({x:_.y-v.y,y:v.x-_.x}),D=n.normalise({x:w.y-_.y,y:_.x-w.x}),g=Math.sqrt(2*Math.pow(k,2)),b=n.mult(i.clone(A),k),E=n.normalise(n.mult(n.add(A,D),.5)),C=n.sub(_,n.mult(E,g)),B=l;l===-1&&(B=Math.pow(k,.32)*1.75),B=i.clamp(B,m,d),B%2===1&&(B+=1);for(var O=Math.acos(n.dot(A,D)),I=O/B,F=0;F<B;F++)a.push(n.add(n.rotate(b,I*F),C))}return a},e.clockwiseSort=function(u){var c=e.mean(u);return u.sort(function(l,m){return n.angle(c,l)-n.angle(c,m)}),u},e.isConvex=function(u){var c=0,l=u.length,m,d,a,y;if(l<3)return null;for(m=0;m<l;m++)if(d=(m+1)%l,a=(m+2)%l,y=(u[d].x-u[m].x)*(u[a].y-u[d].y),y-=(u[d].y-u[m].y)*(u[a].x-u[d].x),y<0?c|=1:y>0&&(c|=2),c===3)return!1;return c!==0?!0:null},e.hull=function(u){var c=[],l=[],m,d;for(u=u.slice(0),u.sort(function(a,y){var v=a.x-y.x;return v!==0?v:a.y-y.y}),d=0;d<u.length;d+=1){for(m=u[d];l.length>=2&&n.cross3(l[l.length-2],l[l.length-1],m)<=0;)l.pop();l.push(m)}for(d=u.length-1;d>=0;d-=1){for(m=u[d];c.length>=2&&n.cross3(c[c.length-2],c[c.length-1],m)<=0;)c.pop();c.push(m)}return c.pop(),l.pop(),c.concat(l)}})()},function(T,P,h){var e={};T.exports=e;var n=h(3),i=h(2),u=h(7),c=h(0),l=h(1),m=h(11);(function(){e._timeCorrection=!0,e._inertiaScale=4,e._nextCollidingGroupId=1,e._nextNonCollidingGroupId=-1,e._nextCategory=1,e._baseDelta=1e3/60,e.create=function(a){var y={id:c.nextId(),type:"body",label:"Body",parts:[],plugin:{},angle:0,vertices:n.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"),position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1,render:{visible:!0,opacity:1,strokeStyle:null,fillStyle:null,lineWidth:null,sprite:{xScale:1,yScale:1,xOffset:0,yOffset:0}},events:null,bounds:null,chamfer:null,circleRadius:0,positionPrev:null,anglePrev:0,parent:null,axes:null,area:0,mass:0,inertia:0,deltaTime:16.666666666666668,_original:null},v=c.extend(y,a);return d(v,a),v},e.nextGroup=function(a){return a?e._nextNonCollidingGroupId--:e._nextCollidingGroupId++},e.nextCategory=function(){return e._nextCategory=e._nextCategory<<1,e._nextCategory};var d=function(a,y){y=y||{},e.set(a,{bounds:a.bounds||l.create(a.vertices),positionPrev:a.positionPrev||i.clone(a.position),anglePrev:a.anglePrev||a.angle,vertices:a.vertices,parts:a.parts||[a],isStatic:a.isStatic,isSleeping:a.isSleeping,parent:a.parent||a}),n.rotate(a.vertices,a.angle,a.position),m.rotate(a.axes,a.angle),l.update(a.bounds,a.vertices,a.velocity),e.set(a,{axes:y.axes||a.axes,area:y.area||a.area,mass:y.mass||a.mass,inertia:y.inertia||a.inertia});var v=a.isStatic?"#14151f":c.choose(["#f19648","#f5d259","#f55a3c","#063e7b","#ececd1"]),_=a.isStatic?"#555":"#ccc",w=a.isStatic&&a.render.fillStyle===null?1:0;a.render.fillStyle=a.render.fillStyle||v,a.render.strokeStyle=a.render.strokeStyle||_,a.render.lineWidth=a.render.lineWidth||w,a.render.sprite.xOffset+=-(a.bounds.min.x-a.position.x)/(a.bounds.max.x-a.bounds.min.x),a.render.sprite.yOffset+=-(a.bounds.min.y-a.position.y)/(a.bounds.max.y-a.bounds.min.y)};e.set=function(a,y,v){var _;typeof y=="string"&&(_=y,y={},y[_]=v);for(_ in y)if(Object.prototype.hasOwnProperty.call(y,_))switch(v=y[_],_){case"isStatic":e.setStatic(a,v);break;case"isSleeping":u.set(a,v);break;case"mass":e.setMass(a,v);break;case"density":e.setDensity(a,v);break;case"inertia":e.setInertia(a,v);break;case"vertices":e.setVertices(a,v);break;case"position":e.setPosition(a,v);break;case"angle":e.setAngle(a,v);break;case"velocity":e.setVelocity(a,v);break;case"angularVelocity":e.setAngularVelocity(a,v);break;case"speed":e.setSpeed(a,v);break;case"angularSpeed":e.setAngularSpeed(a,v);break;case"parts":e.setParts(a,v);break;case"centre":e.setCentre(a,v);break;default:a[_]=v}},e.setStatic=function(a,y){for(var v=0;v<a.parts.length;v++){var _=a.parts[v];y?(_.isStatic||(_._original={restitution:_.restitution,friction:_.friction,mass:_.mass,inertia:_.inertia,density:_.density,inverseMass:_.inverseMass,inverseInertia:_.inverseInertia}),_.restitution=0,_.friction=1,_.mass=_.inertia=_.density=1/0,_.inverseMass=_.inverseInertia=0,_.positionPrev.x=_.position.x,_.positionPrev.y=_.position.y,_.anglePrev=_.angle,_.angularVelocity=0,_.speed=0,_.angularSpeed=0,_.motion=0):_._original&&(_.restitution=_._original.restitution,_.friction=_._original.friction,_.mass=_._original.mass,_.inertia=_._original.inertia,_.density=_._original.density,_.inverseMass=_._original.inverseMass,_.inverseInertia=_._original.inverseInertia,_._original=null),_.isStatic=y}},e.setMass=function(a,y){var v=a.inertia/(a.mass/6);a.inertia=v*(y/6),a.inverseInertia=1/a.inertia,a.mass=y,a.inverseMass=1/a.mass,a.density=a.mass/a.area},e.setDensity=function(a,y){e.setMass(a,y*a.area),a.density=y},e.setInertia=function(a,y){a.inertia=y,a.inverseInertia=1/a.inertia},e.setVertices=function(a,y){y[0].body===a?a.vertices=y:a.vertices=n.create(y,a),a.axes=m.fromVertices(a.vertices),a.area=n.area(a.vertices),e.setMass(a,a.density*a.area);var v=n.centre(a.vertices);n.translate(a.vertices,v,-1),e.setInertia(a,e._inertiaScale*n.inertia(a.vertices,a.mass)),n.translate(a.vertices,a.position),l.update(a.bounds,a.vertices,a.velocity)},e.setParts=function(a,y,v){var _;for(y=y.slice(0),a.parts.length=0,a.parts.push(a),a.parent=a,_=0;_<y.length;_++){var w=y[_];w!==a&&(w.parent=a,a.parts.push(w))}if(a.parts.length!==1){if(v=typeof v<"u"?v:!0,v){var k=[];for(_=0;_<y.length;_++)k=k.concat(y[_].vertices);n.clockwiseSort(k);var A=n.hull(k),D=n.centre(A);e.setVertices(a,A),n.translate(a.vertices,D)}var g=e._totalProperties(a);a.area=g.area,a.parent=a,a.position.x=g.centre.x,a.position.y=g.centre.y,a.positionPrev.x=g.centre.x,a.positionPrev.y=g.centre.y,e.setMass(a,g.mass),e.setInertia(a,g.inertia),e.setPosition(a,g.centre)}},e.setCentre=function(a,y,v){v?(a.positionPrev.x+=y.x,a.positionPrev.y+=y.y,a.position.x+=y.x,a.position.y+=y.y):(a.positionPrev.x=y.x-(a.position.x-a.positionPrev.x),a.positionPrev.y=y.y-(a.position.y-a.positionPrev.y),a.position.x=y.x,a.position.y=y.y)},e.setPosition=function(a,y,v){var _=i.sub(y,a.position);v?(a.positionPrev.x=a.position.x,a.positionPrev.y=a.position.y,a.velocity.x=_.x,a.velocity.y=_.y,a.speed=i.magnitude(_)):(a.positionPrev.x+=_.x,a.positionPrev.y+=_.y);for(var w=0;w<a.parts.length;w++){var k=a.parts[w];k.position.x+=_.x,k.position.y+=_.y,n.translate(k.vertices,_),l.update(k.bounds,k.vertices,a.velocity)}},e.setAngle=function(a,y,v){var _=y-a.angle;v?(a.anglePrev=a.angle,a.angularVelocity=_,a.angularSpeed=Math.abs(_)):a.anglePrev+=_;for(var w=0;w<a.parts.length;w++){var k=a.parts[w];k.angle+=_,n.rotate(k.vertices,_,a.position),m.rotate(k.axes,_),l.update(k.bounds,k.vertices,a.velocity),w>0&&i.rotateAbout(k.position,_,a.position,k.position)}},e.setVelocity=function(a,y){var v=a.deltaTime/e._baseDelta;a.positionPrev.x=a.position.x-y.x*v,a.positionPrev.y=a.position.y-y.y*v,a.velocity.x=(a.position.x-a.positionPrev.x)/v,a.velocity.y=(a.position.y-a.positionPrev.y)/v,a.speed=i.magnitude(a.velocity)},e.getVelocity=function(a){var y=e._baseDelta/a.deltaTime;return{x:(a.position.x-a.positionPrev.x)*y,y:(a.position.y-a.positionPrev.y)*y}},e.getSpeed=function(a){return i.magnitude(e.getVelocity(a))},e.setSpeed=function(a,y){e.setVelocity(a,i.mult(i.normalise(e.getVelocity(a)),y))},e.setAngularVelocity=function(a,y){var v=a.deltaTime/e._baseDelta;a.anglePrev=a.angle-y*v,a.angularVelocity=(a.angle-a.anglePrev)/v,a.angularSpeed=Math.abs(a.angularVelocity)},e.getAngularVelocity=function(a){return(a.angle-a.anglePrev)*e._baseDelta/a.deltaTime},e.getAngularSpeed=function(a){return Math.abs(e.getAngularVelocity(a))},e.setAngularSpeed=function(a,y){e.setAngularVelocity(a,c.sign(e.getAngularVelocity(a))*y)},e.translate=function(a,y,v){e.setPosition(a,i.add(a.position,y),v)},e.rotate=function(a,y,v,_){if(!v)e.setAngle(a,a.angle+y,_);else{var w=Math.cos(y),k=Math.sin(y),A=a.position.x-v.x,D=a.position.y-v.y;e.setPosition(a,{x:v.x+(A*w-D*k),y:v.y+(A*k+D*w)},_),e.setAngle(a,a.angle+y,_)}},e.scale=function(a,y,v,_){var w=0,k=0;_=_||a.position;for(var A=0;A<a.parts.length;A++){var D=a.parts[A];n.scale(D.vertices,y,v,_),D.axes=m.fromVertices(D.vertices),D.area=n.area(D.vertices),e.setMass(D,a.density*D.area),n.translate(D.vertices,{x:-D.position.x,y:-D.position.y}),e.setInertia(D,e._inertiaScale*n.inertia(D.vertices,D.mass)),n.translate(D.vertices,{x:D.position.x,y:D.position.y}),A>0&&(w+=D.area,k+=D.inertia),D.position.x=_.x+(D.position.x-_.x)*y,D.position.y=_.y+(D.position.y-_.y)*v,l.update(D.bounds,D.vertices,a.velocity)}a.parts.length>1&&(a.area=w,a.isStatic||(e.setMass(a,a.density*w),e.setInertia(a,k))),a.circleRadius&&(y===v?a.circleRadius*=y:a.circleRadius=null)},e.update=function(a,y){y=(typeof y<"u"?y:1e3/60)*a.timeScale;var v=y*y,_=e._timeCorrection?y/(a.deltaTime||y):1,w=1-a.frictionAir*(y/c._baseDelta),k=(a.position.x-a.positionPrev.x)*_,A=(a.position.y-a.positionPrev.y)*_;a.velocity.x=k*w+a.force.x/a.mass*v,a.velocity.y=A*w+a.force.y/a.mass*v,a.positionPrev.x=a.position.x,a.positionPrev.y=a.position.y,a.position.x+=a.velocity.x,a.position.y+=a.velocity.y,a.deltaTime=y,a.angularVelocity=(a.angle-a.anglePrev)*w*_+a.torque/a.inertia*v,a.anglePrev=a.angle,a.angle+=a.angularVelocity;for(var D=0;D<a.parts.length;D++){var g=a.parts[D];n.translate(g.vertices,a.velocity),D>0&&(g.position.x+=a.velocity.x,g.position.y+=a.velocity.y),a.angularVelocity!==0&&(n.rotate(g.vertices,a.angularVelocity,a.position),m.rotate(g.axes,a.angularVelocity),D>0&&i.rotateAbout(g.position,a.angularVelocity,a.position,g.position)),l.update(g.bounds,g.vertices,a.velocity)}},e.updateVelocities=function(a){var y=e._baseDelta/a.deltaTime,v=a.velocity;v.x=(a.position.x-a.positionPrev.x)*y,v.y=(a.position.y-a.positionPrev.y)*y,a.speed=Math.sqrt(v.x*v.x+v.y*v.y),a.angularVelocity=(a.angle-a.anglePrev)*y,a.angularSpeed=Math.abs(a.angularVelocity)},e.applyForce=function(a,y,v){var _={x:y.x-a.position.x,y:y.y-a.position.y};a.force.x+=v.x,a.force.y+=v.y,a.torque+=_.x*v.y-_.y*v.x},e._totalProperties=function(a){for(var y={mass:0,area:0,inertia:0,centre:{x:0,y:0}},v=a.parts.length===1?0:1;v<a.parts.length;v++){var _=a.parts[v],w=_.mass!==1/0?_.mass:1;y.mass+=w,y.area+=_.area,y.inertia+=_.inertia,y.centre=i.add(y.centre,i.mult(_.position,w))}return y.centre=i.div(y.centre,y.mass),y}})()},function(T,P,h){var e={};T.exports=e;var n=h(0);(function(){e.on=function(i,u,c){for(var l=u.split(" "),m,d=0;d<l.length;d++)m=l[d],i.events=i.events||{},i.events[m]=i.events[m]||[],i.events[m].push(c);return c},e.off=function(i,u,c){if(!u){i.events={};return}typeof u=="function"&&(c=u,u=n.keys(i.events).join(" "));for(var l=u.split(" "),m=0;m<l.length;m++){var d=i.events[l[m]],a=[];if(c&&d)for(var y=0;y<d.length;y++)d[y]!==c&&a.push(d[y]);i.events[l[m]]=a}},e.trigger=function(i,u,c){var l,m,d,a,y=i.events;if(y&&n.keys(y).length>0){c||(c={}),l=u.split(" ");for(var v=0;v<l.length;v++)if(m=l[v],d=y[m],d){a=n.clone(c,!1),a.name=m,a.source=i;for(var _=0;_<d.length;_++)d[_].apply(i,[a])}}}})()},function(T,P,h){var e={};T.exports=e;var n=h(5),i=h(0),u=h(1),c=h(4);(function(){e.create=function(l){return i.extend({id:i.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite",plugin:{},cache:{allBodies:null,allConstraints:null,allComposites:null}},l)},e.setModified=function(l,m,d,a){if(l.isModified=m,m&&l.cache&&(l.cache.allBodies=null,l.cache.allConstraints=null,l.cache.allComposites=null),d&&l.parent&&e.setModified(l.parent,m,d,a),a)for(var y=0;y<l.composites.length;y++){var v=l.composites[y];e.setModified(v,m,d,a)}},e.add=function(l,m){var d=[].concat(m);n.trigger(l,"beforeAdd",{object:m});for(var a=0;a<d.length;a++){var y=d[a];switch(y.type){case"body":if(y.parent!==y){i.warn("Composite.add: skipped adding a compound body part (you must add its parent instead)");break}e.addBody(l,y);break;case"constraint":e.addConstraint(l,y);break;case"composite":e.addComposite(l,y);break;case"mouseConstraint":e.addConstraint(l,y.constraint);break}}return n.trigger(l,"afterAdd",{object:m}),l},e.remove=function(l,m,d){var a=[].concat(m);n.trigger(l,"beforeRemove",{object:m});for(var y=0;y<a.length;y++){var v=a[y];switch(v.type){case"body":e.removeBody(l,v,d);break;case"constraint":e.removeConstraint(l,v,d);break;case"composite":e.removeComposite(l,v,d);break;case"mouseConstraint":e.removeConstraint(l,v.constraint);break}}return n.trigger(l,"afterRemove",{object:m}),l},e.addComposite=function(l,m){return l.composites.push(m),m.parent=l,e.setModified(l,!0,!0,!1),l},e.removeComposite=function(l,m,d){var a=i.indexOf(l.composites,m);if(a!==-1){var y=e.allBodies(m);e.removeCompositeAt(l,a);for(var v=0;v<y.length;v++)y[v].sleepCounter=0}if(d)for(var v=0;v<l.composites.length;v++)e.removeComposite(l.composites[v],m,!0);return l},e.removeCompositeAt=function(l,m){return l.composites.splice(m,1),e.setModified(l,!0,!0,!1),l},e.addBody=function(l,m){return l.bodies.push(m),e.setModified(l,!0,!0,!1),l},e.removeBody=function(l,m,d){var a=i.indexOf(l.bodies,m);if(a!==-1&&(e.removeBodyAt(l,a),m.sleepCounter=0),d)for(var y=0;y<l.composites.length;y++)e.removeBody(l.composites[y],m,!0);return l},e.removeBodyAt=function(l,m){return l.bodies.splice(m,1),e.setModified(l,!0,!0,!1),l},e.addConstraint=function(l,m){return l.constraints.push(m),e.setModified(l,!0,!0,!1),l},e.removeConstraint=function(l,m,d){var a=i.indexOf(l.constraints,m);if(a!==-1&&e.removeConstraintAt(l,a),d)for(var y=0;y<l.composites.length;y++)e.removeConstraint(l.composites[y],m,!0);return l},e.removeConstraintAt=function(l,m){return l.constraints.splice(m,1),e.setModified(l,!0,!0,!1),l},e.clear=function(l,m,d){if(d)for(var a=0;a<l.composites.length;a++)e.clear(l.composites[a],m,!0);return m?l.bodies=l.bodies.filter(function(y){return y.isStatic}):l.bodies.length=0,l.constraints.length=0,l.composites.length=0,e.setModified(l,!0,!0,!1),l},e.allBodies=function(l){if(l.cache&&l.cache.allBodies)return l.cache.allBodies;for(var m=[].concat(l.bodies),d=0;d<l.composites.length;d++)m=m.concat(e.allBodies(l.composites[d]));return l.cache&&(l.cache.allBodies=m),m},e.allConstraints=function(l){if(l.cache&&l.cache.allConstraints)return l.cache.allConstraints;for(var m=[].concat(l.constraints),d=0;d<l.composites.length;d++)m=m.concat(e.allConstraints(l.composites[d]));return l.cache&&(l.cache.allConstraints=m),m},e.allComposites=function(l){if(l.cache&&l.cache.allComposites)return l.cache.allComposites;for(var m=[].concat(l.composites),d=0;d<l.composites.length;d++)m=m.concat(e.allComposites(l.composites[d]));return l.cache&&(l.cache.allComposites=m),m},e.get=function(l,m,d){var a,y;switch(d){case"body":a=e.allBodies(l);break;case"constraint":a=e.allConstraints(l);break;case"composite":a=e.allComposites(l).concat(l);break}return a?(y=a.filter(function(v){return v.id.toString()===m.toString()}),y.length===0?null:y[0]):null},e.move=function(l,m,d){return e.remove(l,m),e.add(d,m),l},e.rebase=function(l){for(var m=e.allBodies(l).concat(e.allConstraints(l)).concat(e.allComposites(l)),d=0;d<m.length;d++)m[d].id=i.nextId();return l},e.translate=function(l,m,d){for(var a=d?e.allBodies(l):l.bodies,y=0;y<a.length;y++)c.translate(a[y],m);return l},e.rotate=function(l,m,d,a){for(var y=Math.cos(m),v=Math.sin(m),_=a?e.allBodies(l):l.bodies,w=0;w<_.length;w++){var k=_[w],A=k.position.x-d.x,D=k.position.y-d.y;c.setPosition(k,{x:d.x+(A*y-D*v),y:d.y+(A*v+D*y)}),c.rotate(k,m)}return l},e.scale=function(l,m,d,a,y){for(var v=y?e.allBodies(l):l.bodies,_=0;_<v.length;_++){var w=v[_],k=w.position.x-a.x,A=w.position.y-a.y;c.setPosition(w,{x:a.x+k*m,y:a.y+A*d}),c.scale(w,m,d)}return l},e.bounds=function(l){for(var m=e.allBodies(l),d=[],a=0;a<m.length;a+=1){var y=m[a];d.push(y.bounds.min,y.bounds.max)}return u.create(d)}})()},function(T,P,h){var e={};T.exports=e;var n=h(4),i=h(5),u=h(0);(function(){e._motionWakeThreshold=.18,e._motionSleepThreshold=.08,e._minBias=.9,e.update=function(c,l){for(var m=l/u._baseDelta,d=e._motionSleepThreshold,a=0;a<c.length;a++){var y=c[a],v=n.getSpeed(y),_=n.getAngularSpeed(y),w=v*v+_*_;if(y.force.x!==0||y.force.y!==0){e.set(y,!1);continue}var k=Math.min(y.motion,w),A=Math.max(y.motion,w);y.motion=e._minBias*k+(1-e._minBias)*A,y.sleepThreshold>0&&y.motion<d?(y.sleepCounter+=1,y.sleepCounter>=y.sleepThreshold/m&&e.set(y,!0)):y.sleepCounter>0&&(y.sleepCounter-=1)}},e.afterCollisions=function(c){for(var l=e._motionSleepThreshold,m=0;m<c.length;m++){var d=c[m];if(d.isActive){var a=d.collision,y=a.bodyA.parent,v=a.bodyB.parent;if(!(y.isSleeping&&v.isSleeping||y.isStatic||v.isStatic)&&(y.isSleeping||v.isSleeping)){var _=y.isSleeping&&!y.isStatic?y:v,w=_===y?v:y;!_.isStatic&&w.motion>l&&e.set(_,!1)}}}},e.set=function(c,l){var m=c.isSleeping;l?(c.isSleeping=!0,c.sleepCounter=c.sleepThreshold,c.positionImpulse.x=0,c.positionImpulse.y=0,c.positionPrev.x=c.position.x,c.positionPrev.y=c.position.y,c.anglePrev=c.angle,c.speed=0,c.angularSpeed=0,c.motion=0,m||i.trigger(c,"sleepStart")):(c.isSleeping=!1,c.sleepCounter=0,m&&i.trigger(c,"sleepEnd"))}})()},function(T,P,h){var e={};T.exports=e;var n=h(3),i=h(9);(function(){var u=[],c={overlap:0,axis:null},l={overlap:0,axis:null};e.create=function(m,d){return{pair:null,collided:!1,bodyA:m,bodyB:d,parentA:m.parent,parentB:d.parent,depth:0,normal:{x:0,y:0},tangent:{x:0,y:0},penetration:{x:0,y:0},supports:[null,null],supportCount:0}},e.collides=function(m,d,a){if(e._overlapAxes(c,m.vertices,d.vertices,m.axes),c.overlap<=0||(e._overlapAxes(l,d.vertices,m.vertices,d.axes),l.overlap<=0))return null;var y=a&&a.table[i.id(m,d)],v;y?v=y.collision:(v=e.create(m,d),v.collided=!0,v.bodyA=m.id<d.id?m:d,v.bodyB=m.id<d.id?d:m,v.parentA=v.bodyA.parent,v.parentB=v.bodyB.parent),m=v.bodyA,d=v.bodyB;var _;c.overlap<l.overlap?_=c:_=l;var w=v.normal,k=v.tangent,A=v.penetration,D=v.supports,g=_.overlap,b=_.axis,E=b.x,C=b.y,B=d.position.x-m.position.x,O=d.position.y-m.position.y;E*B+C*O>=0&&(E=-E,C=-C),w.x=E,w.y=C,k.x=-C,k.y=E,A.x=E*g,A.y=C*g,v.depth=g;var I=e._findSupports(m,d,w,1),F=0;if(n.contains(m.vertices,I[0])&&(D[F++]=I[0]),n.contains(m.vertices,I[1])&&(D[F++]=I[1]),F<2){var V=e._findSupports(d,m,w,-1);n.contains(d.vertices,V[0])&&(D[F++]=V[0]),F<2&&n.contains(d.vertices,V[1])&&(D[F++]=V[1])}return F===0&&(D[F++]=I[0]),v.supportCount=F,v},e._overlapAxes=function(m,d,a,y){var v=d.length,_=a.length,w=d[0].x,k=d[0].y,A=a[0].x,D=a[0].y,g=y.length,b=Number.MAX_VALUE,E=0,C,B,O,I,F,V;for(F=0;F<g;F++){var U=y[F],W=U.x,H=U.y,q=w*W+k*H,K=A*W+D*H,Z=q,Q=K;for(V=1;V<v;V+=1)I=d[V].x*W+d[V].y*H,I>Z?Z=I:I<q&&(q=I);for(V=1;V<_;V+=1)I=a[V].x*W+a[V].y*H,I>Q?Q=I:I<K&&(K=I);if(B=Z-K,O=Q-q,C=B<O?B:O,C<b&&(b=C,E=F,C<=0))break}m.axis=y[E],m.overlap=b},e._findSupports=function(m,d,a,y){var v=d.vertices,_=v.length,w=m.position.x,k=m.position.y,A=a.x*y,D=a.y*y,g=v[0],b=g,E=A*(w-b.x)+D*(k-b.y),C,B,O;for(O=1;O<_;O+=1)b=v[O],B=A*(w-b.x)+D*(k-b.y),B<E&&(E=B,g=b);return C=v[(_+g.index-1)%_],E=A*(w-C.x)+D*(k-C.y),b=v[(g.index+1)%_],A*(w-b.x)+D*(k-b.y)<E?(u[0]=g,u[1]=b,u):(u[0]=g,u[1]=C,u)}})()},function(T,P,h){var e={};T.exports=e;var n=h(16);(function(){e.create=function(i,u){var c=i.bodyA,l=i.bodyB,m={id:e.id(c,l),bodyA:c,bodyB:l,collision:i,contacts:[n.create(),n.create()],contactCount:0,separation:0,isActive:!0,isSensor:c.isSensor||l.isSensor,timeCreated:u,timeUpdated:u,inverseMass:0,friction:0,frictionStatic:0,restitution:0,slop:0};return e.update(m,i,u),m},e.update=function(i,u,c){var l=u.supports,m=u.supportCount,d=i.contacts,a=u.parentA,y=u.parentB;i.isActive=!0,i.timeUpdated=c,i.collision=u,i.separation=u.depth,i.inverseMass=a.inverseMass+y.inverseMass,i.friction=a.friction<y.friction?a.friction:y.friction,i.frictionStatic=a.frictionStatic>y.frictionStatic?a.frictionStatic:y.frictionStatic,i.restitution=a.restitution>y.restitution?a.restitution:y.restitution,i.slop=a.slop>y.slop?a.slop:y.slop,i.contactCount=m,u.pair=i;var v=l[0],_=d[0],w=l[1],k=d[1];(k.vertex===v||_.vertex===w)&&(d[1]=_,d[0]=_=k,k=d[1]),_.vertex=v,k.vertex=w},e.setActive=function(i,u,c){u?(i.isActive=!0,i.timeUpdated=c):(i.isActive=!1,i.contactCount=0)},e.id=function(i,u){return i.id<u.id?i.id.toString(36)+":"+u.id.toString(36):u.id.toString(36)+":"+i.id.toString(36)}})()},function(T,P,h){var e={};T.exports=e;var n=h(3),i=h(2),u=h(7),c=h(1),l=h(11),m=h(0);(function(){e._warming=.4,e._torqueDampen=1,e._minLength=1e-6,e.create=function(d){var a=d;a.bodyA&&!a.pointA&&(a.pointA={x:0,y:0}),a.bodyB&&!a.pointB&&(a.pointB={x:0,y:0});var y=a.bodyA?i.add(a.bodyA.position,a.pointA):a.pointA,v=a.bodyB?i.add(a.bodyB.position,a.pointB):a.pointB,_=i.magnitude(i.sub(y,v));a.length=typeof a.length<"u"?a.length:_,a.id=a.id||m.nextId(),a.label=a.label||"Constraint",a.type="constraint",a.stiffness=a.stiffness||(a.length>0?1:.7),a.damping=a.damping||0,a.angularStiffness=a.angularStiffness||0,a.angleA=a.bodyA?a.bodyA.angle:a.angleA,a.angleB=a.bodyB?a.bodyB.angle:a.angleB,a.plugin={};var w={visible:!0,lineWidth:2,strokeStyle:"#ffffff",type:"line",anchors:!0};return a.length===0&&a.stiffness>.1?(w.type="pin",w.anchors=!1):a.stiffness<.9&&(w.type="spring"),a.render=m.extend(w,a.render),a},e.preSolveAll=function(d){for(var a=0;a<d.length;a+=1){var y=d[a],v=y.constraintImpulse;y.isStatic||v.x===0&&v.y===0&&v.angle===0||(y.position.x+=v.x,y.position.y+=v.y,y.angle+=v.angle)}},e.solveAll=function(d,a){for(var y=m.clamp(a/m._baseDelta,0,1),v=0;v<d.length;v+=1){var _=d[v],w=!_.bodyA||_.bodyA&&_.bodyA.isStatic,k=!_.bodyB||_.bodyB&&_.bodyB.isStatic;(w||k)&&e.solve(d[v],y)}for(v=0;v<d.length;v+=1)_=d[v],w=!_.bodyA||_.bodyA&&_.bodyA.isStatic,k=!_.bodyB||_.bodyB&&_.bodyB.isStatic,!w&&!k&&e.solve(d[v],y)},e.solve=function(d,a){var y=d.bodyA,v=d.bodyB,_=d.pointA,w=d.pointB;if(!(!y&&!v)){y&&!y.isStatic&&(i.rotate(_,y.angle-d.angleA,_),d.angleA=y.angle),v&&!v.isStatic&&(i.rotate(w,v.angle-d.angleB,w),d.angleB=v.angle);var k=_,A=w;if(y&&(k=i.add(y.position,_)),v&&(A=i.add(v.position,w)),!(!k||!A)){var D=i.sub(k,A),g=i.magnitude(D);g<e._minLength&&(g=e._minLength);var b=(g-d.length)/g,E=d.stiffness>=1||d.length===0,C=E?d.stiffness*a:d.stiffness*a*a,B=d.damping*a,O=i.mult(D,b*C),I=(y?y.inverseMass:0)+(v?v.inverseMass:0),F=(y?y.inverseInertia:0)+(v?v.inverseInertia:0),V=I+F,U,W,H,q,K;if(B>0){var Z=i.create();H=i.div(D,g),K=i.sub(v&&i.sub(v.position,v.positionPrev)||Z,y&&i.sub(y.position,y.positionPrev)||Z),q=i.dot(H,K)}y&&!y.isStatic&&(W=y.inverseMass/I,y.constraintImpulse.x-=O.x*W,y.constraintImpulse.y-=O.y*W,y.position.x-=O.x*W,y.position.y-=O.y*W,B>0&&(y.positionPrev.x-=B*H.x*q*W,y.positionPrev.y-=B*H.y*q*W),U=i.cross(_,O)/V*e._torqueDampen*y.inverseInertia*(1-d.angularStiffness),y.constraintImpulse.angle-=U,y.angle-=U),v&&!v.isStatic&&(W=v.inverseMass/I,v.constraintImpulse.x+=O.x*W,v.constraintImpulse.y+=O.y*W,v.position.x+=O.x*W,v.position.y+=O.y*W,B>0&&(v.positionPrev.x+=B*H.x*q*W,v.positionPrev.y+=B*H.y*q*W),U=i.cross(w,O)/V*e._torqueDampen*v.inverseInertia*(1-d.angularStiffness),v.constraintImpulse.angle+=U,v.angle+=U)}}},e.postSolveAll=function(d){for(var a=0;a<d.length;a++){var y=d[a],v=y.constraintImpulse;if(!(y.isStatic||v.x===0&&v.y===0&&v.angle===0)){u.set(y,!1);for(var _=0;_<y.parts.length;_++){var w=y.parts[_];n.translate(w.vertices,v),_>0&&(w.position.x+=v.x,w.position.y+=v.y),v.angle!==0&&(n.rotate(w.vertices,v.angle,y.position),l.rotate(w.axes,v.angle),_>0&&i.rotateAbout(w.position,v.angle,y.position,w.position)),c.update(w.bounds,w.vertices,y.velocity)}v.angle*=e._warming,v.x*=e._warming,v.y*=e._warming}}},e.pointAWorld=function(d){return{x:(d.bodyA?d.bodyA.position.x:0)+(d.pointA?d.pointA.x:0),y:(d.bodyA?d.bodyA.position.y:0)+(d.pointA?d.pointA.y:0)}},e.pointBWorld=function(d){return{x:(d.bodyB?d.bodyB.position.x:0)+(d.pointB?d.pointB.x:0),y:(d.bodyB?d.bodyB.position.y:0)+(d.pointB?d.pointB.y:0)}},e.currentLength=function(d){var a=(d.bodyA?d.bodyA.position.x:0)+(d.pointA?d.pointA.x:0),y=(d.bodyA?d.bodyA.position.y:0)+(d.pointA?d.pointA.y:0),v=(d.bodyB?d.bodyB.position.x:0)+(d.pointB?d.pointB.x:0),_=(d.bodyB?d.bodyB.position.y:0)+(d.pointB?d.pointB.y:0),w=a-v,k=y-_;return Math.sqrt(w*w+k*k)}})()},function(T,P,h){var e={};T.exports=e;var n=h(2),i=h(0);(function(){e.fromVertices=function(u){for(var c={},l=0;l<u.length;l++){var m=(l+1)%u.length,d=n.normalise({x:u[m].y-u[l].y,y:u[l].x-u[m].x}),a=d.y===0?1/0:d.x/d.y;a=a.toFixed(3).toString(),c[a]=d}return i.values(c)},e.rotate=function(u,c){if(c!==0)for(var l=Math.cos(c),m=Math.sin(c),d=0;d<u.length;d++){var a=u[d],y;y=a.x*l-a.y*m,a.y=a.x*m+a.y*l,a.x=y}}})()},function(T,P,h){var e={};T.exports=e;var n=h(3),i=h(0),u=h(4),c=h(1),l=h(2);(function(){e.rectangle=function(m,d,a,y,v){v=v||{};var _={label:"Rectangle Body",position:{x:m,y:d},vertices:n.fromPath("L 0 0 L "+a+" 0 L "+a+" "+y+" L 0 "+y)};if(v.chamfer){var w=v.chamfer;_.vertices=n.chamfer(_.vertices,w.radius,w.quality,w.qualityMin,w.qualityMax),delete v.chamfer}return u.create(i.extend({},_,v))},e.trapezoid=function(m,d,a,y,v,_){_=_||{},v>=1&&i.warn("Bodies.trapezoid: slope parameter must be < 1."),v*=.5;var w=(1-v*2)*a,k=a*v,A=k+w,D=A+k,g;v<.5?g="L 0 0 L "+k+" "+-y+" L "+A+" "+-y+" L "+D+" 0":g="L 0 0 L "+A+" "+-y+" L "+D+" 0";var b={label:"Trapezoid Body",position:{x:m,y:d},vertices:n.fromPath(g)};if(_.chamfer){var E=_.chamfer;b.vertices=n.chamfer(b.vertices,E.radius,E.quality,E.qualityMin,E.qualityMax),delete _.chamfer}return u.create(i.extend({},b,_))},e.circle=function(m,d,a,y,v){y=y||{};var _={label:"Circle Body",circleRadius:a};v=v||25;var w=Math.ceil(Math.max(10,Math.min(v,a)));return w%2===1&&(w+=1),e.polygon(m,d,w,a,i.extend({},_,y))},e.polygon=function(m,d,a,y,v){if(v=v||{},a<3)return e.circle(m,d,y,v);for(var _=2*Math.PI/a,w="",k=_*.5,A=0;A<a;A+=1){var D=k+A*_,g=Math.cos(D)*y,b=Math.sin(D)*y;w+="L "+g.toFixed(3)+" "+b.toFixed(3)+" "}var E={label:"Polygon Body",position:{x:m,y:d},vertices:n.fromPath(w)};if(v.chamfer){var C=v.chamfer;E.vertices=n.chamfer(E.vertices,C.radius,C.quality,C.qualityMin,C.qualityMax),delete v.chamfer}return u.create(i.extend({},E,v))},e.fromVertices=function(m,d,a,y,v,_,w,k){var A=i.getDecomp(),D,g,b,E,C,B,O,I,F,V,U;for(D=!!(A&&A.quickDecomp),y=y||{},b=[],v=typeof v<"u"?v:!1,_=typeof _<"u"?_:.01,w=typeof w<"u"?w:10,k=typeof k<"u"?k:.01,i.isArray(a[0])||(a=[a]),V=0;V<a.length;V+=1)if(B=a[V],E=n.isConvex(B),C=!E,C&&!D&&i.warnOnce("Bodies.fromVertices: Install the 'poly-decomp' library and use Common.setDecomp or provide 'decomp' as a global to decompose concave vertices."),E||!D)E?B=n.clockwiseSort(B):B=n.hull(B),b.push({position:{x:m,y:d},vertices:B});else{var W=B.map(function(Y){return[Y.x,Y.y]});A.makeCCW(W),_!==!1&&A.removeCollinearPoints(W,_),k!==!1&&A.removeDuplicatePoints&&A.removeDuplicatePoints(W,k);var H=A.quickDecomp(W);for(O=0;O<H.length;O++){var q=H[O],K=q.map(function(Y){return{x:Y[0],y:Y[1]}});w>0&&n.area(K)<w||b.push({position:n.centre(K),vertices:K})}}for(O=0;O<b.length;O++)b[O]=u.create(i.extend(b[O],y));if(v){var Z=5;for(O=0;O<b.length;O++){var Q=b[O];for(I=O+1;I<b.length;I++){var J=b[I];if(c.overlaps(Q.bounds,J.bounds)){var $=Q.vertices,te=J.vertices;for(F=0;F<Q.vertices.length;F++)for(U=0;U<J.vertices.length;U++){var pe=l.magnitudeSquared(l.sub($[(F+1)%$.length],te[U])),re=l.magnitudeSquared(l.sub($[F],te[(U+1)%te.length]));pe<Z&&re<Z&&($[F].isInternal=!0,te[U].isInternal=!0)}}}}}return b.length>1?(g=u.create(i.extend({parts:b.slice(0)},y)),u.setPosition(g,{x:m,y:d}),g):b[0]}})()},function(T,P,h){var e={};T.exports=e;var n=h(0),i=h(8);(function(){e.create=function(u){var c={bodies:[],collisions:[],pairs:null};return n.extend(c,u)},e.setBodies=function(u,c){u.bodies=c.slice(0)},e.clear=function(u){u.bodies=[],u.collisions=[]},e.collisions=function(u){var c=u.pairs,l=u.bodies,m=l.length,d=e.canCollide,a=i.collides,y=u.collisions,v=0,_,w;for(l.sort(e._compareBoundsX),_=0;_<m;_++){var k=l[_],A=k.bounds,D=k.bounds.max.x,g=k.bounds.max.y,b=k.bounds.min.y,E=k.isStatic||k.isSleeping,C=k.parts.length,B=C===1;for(w=_+1;w<m;w++){var O=l[w],I=O.bounds;if(I.min.x>D)break;if(!(g<I.min.y||b>I.max.y)&&!(E&&(O.isStatic||O.isSleeping))&&d(k.collisionFilter,O.collisionFilter)){var F=O.parts.length;if(B&&F===1){var V=a(k,O,c);V&&(y[v++]=V)}else for(var U=C>1?1:0,W=F>1?1:0,H=U;H<C;H++)for(var q=k.parts[H],A=q.bounds,K=W;K<F;K++){var Z=O.parts[K],I=Z.bounds;if(!(A.min.x>I.max.x||A.max.x<I.min.x||A.max.y<I.min.y||A.min.y>I.max.y)){var V=a(q,Z,c);V&&(y[v++]=V)}}}}}return y.length!==v&&(y.length=v),y},e.canCollide=function(u,c){return u.group===c.group&&u.group!==0?u.group>0:(u.mask&c.category)!==0&&(c.mask&u.category)!==0},e._compareBoundsX=function(u,c){return u.bounds.min.x-c.bounds.min.x}})()},function(T,P,h){var e={};T.exports=e;var n=h(0);(function(){e.create=function(i){var u={};return i||n.log("Mouse.create: element was undefined, defaulting to document.body","warn"),u.element=i||document.body,u.absolute={x:0,y:0},u.position={x:0,y:0},u.mousedownPosition={x:0,y:0},u.mouseupPosition={x:0,y:0},u.offset={x:0,y:0},u.scale={x:1,y:1},u.wheelDelta=0,u.button=-1,u.pixelRatio=parseInt(u.element.getAttribute("data-pixel-ratio"),10)||1,u.sourceEvents={mousemove:null,mousedown:null,mouseup:null,mousewheel:null},u.mousemove=function(c){var l=e._getRelativeMousePosition(c,u.element,u.pixelRatio),m=c.changedTouches;m&&(u.button=0,c.preventDefault()),u.absolute.x=l.x,u.absolute.y=l.y,u.position.x=u.absolute.x*u.scale.x+u.offset.x,u.position.y=u.absolute.y*u.scale.y+u.offset.y,u.sourceEvents.mousemove=c},u.mousedown=function(c){var l=e._getRelativeMousePosition(c,u.element,u.pixelRatio),m=c.changedTouches;m?(u.button=0,c.preventDefault()):u.button=c.button,u.absolute.x=l.x,u.absolute.y=l.y,u.position.x=u.absolute.x*u.scale.x+u.offset.x,u.position.y=u.absolute.y*u.scale.y+u.offset.y,u.mousedownPosition.x=u.position.x,u.mousedownPosition.y=u.position.y,u.sourceEvents.mousedown=c},u.mouseup=function(c){var l=e._getRelativeMousePosition(c,u.element,u.pixelRatio),m=c.changedTouches;m&&c.preventDefault(),u.button=-1,u.absolute.x=l.x,u.absolute.y=l.y,u.position.x=u.absolute.x*u.scale.x+u.offset.x,u.position.y=u.absolute.y*u.scale.y+u.offset.y,u.mouseupPosition.x=u.position.x,u.mouseupPosition.y=u.position.y,u.sourceEvents.mouseup=c},u.mousewheel=function(c){u.wheelDelta=Math.max(-1,Math.min(1,c.wheelDelta||-c.detail)),c.preventDefault(),u.sourceEvents.mousewheel=c},e.setElement(u,u.element),u},e.setElement=function(i,u){i.element=u,u.addEventListener("mousemove",i.mousemove,{passive:!0}),u.addEventListener("mousedown",i.mousedown,{passive:!0}),u.addEventListener("mouseup",i.mouseup,{passive:!0}),u.addEventListener("wheel",i.mousewheel,{passive:!1}),u.addEventListener("touchmove",i.mousemove,{passive:!1}),u.addEventListener("touchstart",i.mousedown,{passive:!1}),u.addEventListener("touchend",i.mouseup,{passive:!1})},e.clearSourceEvents=function(i){i.sourceEvents.mousemove=null,i.sourceEvents.mousedown=null,i.sourceEvents.mouseup=null,i.sourceEvents.mousewheel=null,i.wheelDelta=0},e.setOffset=function(i,u){i.offset.x=u.x,i.offset.y=u.y,i.position.x=i.absolute.x*i.scale.x+i.offset.x,i.position.y=i.absolute.y*i.scale.y+i.offset.y},e.setScale=function(i,u){i.scale.x=u.x,i.scale.y=u.y,i.position.x=i.absolute.x*i.scale.x+i.offset.x,i.position.y=i.absolute.y*i.scale.y+i.offset.y},e._getRelativeMousePosition=function(i,u,c){var l=u.getBoundingClientRect(),m=document.documentElement||document.body.parentNode||document.body,d=window.pageXOffset!==void 0?window.pageXOffset:m.scrollLeft,a=window.pageYOffset!==void 0?window.pageYOffset:m.scrollTop,y=i.changedTouches,v,_;return y?(v=y[0].pageX-l.left-d,_=y[0].pageY-l.top-a):(v=i.pageX-l.left-d,_=i.pageY-l.top-a),{x:v/(u.clientWidth/(u.width||u.clientWidth)*c),y:_/(u.clientHeight/(u.height||u.clientHeight)*c)}}})()},function(T,P,h){var e={};T.exports=e;var n=h(0);(function(){e._registry={},e.register=function(i){if(e.isPlugin(i)||n.warn("Plugin.register:",e.toString(i),"does not implement all required fields."),i.name in e._registry){var u=e._registry[i.name],c=e.versionParse(i.version).number,l=e.versionParse(u.version).number;c>l?(n.warn("Plugin.register:",e.toString(u),"was upgraded to",e.toString(i)),e._registry[i.name]=i):c<l?n.warn("Plugin.register:",e.toString(u),"can not be downgraded to",e.toString(i)):i!==u&&n.warn("Plugin.register:",e.toString(i),"is already registered to different plugin object")}else e._registry[i.name]=i;return i},e.resolve=function(i){return e._registry[e.dependencyParse(i).name]},e.toString=function(i){return typeof i=="string"?i:(i.name||"anonymous")+"@"+(i.version||i.range||"0.0.0")},e.isPlugin=function(i){return i&&i.name&&i.version&&i.install},e.isUsed=function(i,u){return i.used.indexOf(u)>-1},e.isFor=function(i,u){var c=i.for&&e.dependencyParse(i.for);return!i.for||u.name===c.name&&e.versionSatisfies(u.version,c.range)},e.use=function(i,u){if(i.uses=(i.uses||[]).concat(u||[]),i.uses.length===0){n.warn("Plugin.use:",e.toString(i),"does not specify any dependencies to install.");return}for(var c=e.dependencies(i),l=n.topologicalSort(c),m=[],d=0;d<l.length;d+=1)if(l[d]!==i.name){var a=e.resolve(l[d]);if(!a){m.push("âŒ "+l[d]);continue}e.isUsed(i,a.name)||(e.isFor(a,i)||(n.warn("Plugin.use:",e.toString(a),"is for",a.for,"but installed on",e.toString(i)+"."),a._warned=!0),a.install?a.install(i):(n.warn("Plugin.use:",e.toString(a),"does not specify an install function."),a._warned=!0),a._warned?(m.push("ðŸ”¶ "+e.toString(a)),delete a._warned):m.push("âœ… "+e.toString(a)),i.used.push(a.name))}m.length>0&&n.info(m.join("  "))},e.dependencies=function(i,u){var c=e.dependencyParse(i),l=c.name;if(u=u||{},!(l in u)){i=e.resolve(i)||i,u[l]=n.map(i.uses||[],function(d){e.isPlugin(d)&&e.register(d);var a=e.dependencyParse(d),y=e.resolve(d);return y&&!e.versionSatisfies(y.version,a.range)?(n.warn("Plugin.dependencies:",e.toString(y),"does not satisfy",e.toString(a),"used by",e.toString(c)+"."),y._warned=!0,i._warned=!0):y||(n.warn("Plugin.dependencies:",e.toString(d),"used by",e.toString(c),"could not be resolved."),i._warned=!0),a.name});for(var m=0;m<u[l].length;m+=1)e.dependencies(u[l][m],u);return u}},e.dependencyParse=function(i){if(n.isString(i)){var u=/^[\w-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-+]+)?))?$/;return u.test(i)||n.warn("Plugin.dependencyParse:",i,"is not a valid dependency string."),{name:i.split("@")[0],range:i.split("@")[1]||"*"}}return{name:i.name,range:i.range||i.version}},e.versionParse=function(i){var u=/^(\*)|(\^|~|>=|>)?\s*((\d+)\.(\d+)\.(\d+))(-[0-9A-Za-z-+]+)?$/;u.test(i)||n.warn("Plugin.versionParse:",i,"is not a valid version or range.");var c=u.exec(i),l=Number(c[4]),m=Number(c[5]),d=Number(c[6]);return{isRange:!!(c[1]||c[2]),version:c[3],range:i,operator:c[1]||c[2]||"",major:l,minor:m,patch:d,parts:[l,m,d],prerelease:c[7],number:l*1e8+m*1e4+d}},e.versionSatisfies=function(i,u){u=u||"*";var c=e.versionParse(u),l=e.versionParse(i);if(c.isRange){if(c.operator==="*"||i==="*")return!0;if(c.operator===">")return l.number>c.number;if(c.operator===">=")return l.number>=c.number;if(c.operator==="~")return l.major===c.major&&l.minor===c.minor&&l.patch>=c.patch;if(c.operator==="^")return c.major>0?l.major===c.major&&l.number>=c.number:c.minor>0?l.minor===c.minor&&l.patch>=c.patch:l.patch===c.patch}return i===u||i==="*"}})()},function(T,P){var h={};T.exports=h,function(){h.create=function(e){return{vertex:e,normalImpulse:0,tangentImpulse:0}}}()},function(T,P,h){var e={};T.exports=e;var n=h(7),i=h(18),u=h(13),c=h(19),l=h(5),m=h(6),d=h(10),a=h(0),y=h(4);(function(){e._deltaMax=1e3/60,e.create=function(v){v=v||{};var _={positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],plugin:{},gravity:{x:0,y:1,scale:.001},timing:{timestamp:0,timeScale:1,lastDelta:0,lastElapsed:0,lastUpdatesPerFrame:0}},w=a.extend(_,v);return w.world=v.world||m.create({label:"World"}),w.pairs=v.pairs||c.create(),w.detector=v.detector||u.create(),w.detector.pairs=w.pairs,w.grid={buckets:[]},w.world.gravity=w.gravity,w.broadphase=w.grid,w.metrics={},w},e.update=function(v,_){var w=a.now(),k=v.world,A=v.detector,D=v.pairs,g=v.timing,b=g.timestamp,E;_>e._deltaMax&&a.warnOnce("Matter.Engine.update: delta argument is recommended to be less than or equal to",e._deltaMax.toFixed(3),"ms."),_=typeof _<"u"?_:a._baseDelta,_*=g.timeScale,g.timestamp+=_,g.lastDelta=_;var C={timestamp:g.timestamp,delta:_};l.trigger(v,"beforeUpdate",C);var B=m.allBodies(k),O=m.allConstraints(k);for(k.isModified&&(u.setBodies(A,B),m.setModified(k,!1,!1,!0)),v.enableSleeping&&n.update(B,_),e._bodiesApplyGravity(B,v.gravity),_>0&&e._bodiesUpdate(B,_),l.trigger(v,"beforeSolve",C),d.preSolveAll(B),E=0;E<v.constraintIterations;E++)d.solveAll(O,_);d.postSolveAll(B);var I=u.collisions(A);c.update(D,I,b),v.enableSleeping&&n.afterCollisions(D.list),D.collisionStart.length>0&&l.trigger(v,"collisionStart",{pairs:D.collisionStart,timestamp:g.timestamp,delta:_});var F=a.clamp(20/v.positionIterations,0,1);for(i.preSolvePosition(D.list),E=0;E<v.positionIterations;E++)i.solvePosition(D.list,_,F);for(i.postSolvePosition(B),d.preSolveAll(B),E=0;E<v.constraintIterations;E++)d.solveAll(O,_);for(d.postSolveAll(B),i.preSolveVelocity(D.list),E=0;E<v.velocityIterations;E++)i.solveVelocity(D.list,_);return e._bodiesUpdateVelocities(B),D.collisionActive.length>0&&l.trigger(v,"collisionActive",{pairs:D.collisionActive,timestamp:g.timestamp,delta:_}),D.collisionEnd.length>0&&l.trigger(v,"collisionEnd",{pairs:D.collisionEnd,timestamp:g.timestamp,delta:_}),e._bodiesClearForces(B),l.trigger(v,"afterUpdate",C),v.timing.lastElapsed=a.now()-w,v},e.merge=function(v,_){if(a.extend(v,_),_.world){v.world=_.world,e.clear(v);for(var w=m.allBodies(v.world),k=0;k<w.length;k++){var A=w[k];n.set(A,!1),A.id=a.nextId()}}},e.clear=function(v){c.clear(v.pairs),u.clear(v.detector)},e._bodiesClearForces=function(v){for(var _=v.length,w=0;w<_;w++){var k=v[w];k.force.x=0,k.force.y=0,k.torque=0}},e._bodiesApplyGravity=function(v,_){var w=typeof _.scale<"u"?_.scale:.001,k=v.length;if(!(_.x===0&&_.y===0||w===0))for(var A=0;A<k;A++){var D=v[A];D.isStatic||D.isSleeping||(D.force.y+=D.mass*_.y*w,D.force.x+=D.mass*_.x*w)}},e._bodiesUpdate=function(v,_){for(var w=v.length,k=0;k<w;k++){var A=v[k];A.isStatic||A.isSleeping||y.update(A,_)}},e._bodiesUpdateVelocities=function(v){for(var _=v.length,w=0;w<_;w++)y.updateVelocities(v[w])}})()},function(T,P,h){var e={};T.exports=e;var n=h(3),i=h(0),u=h(1);(function(){e._restingThresh=2,e._restingThreshTangent=Math.sqrt(6),e._positionDampen=.9,e._positionWarming=.8,e._frictionNormalMultiplier=5,e._frictionMaxStatic=Number.MAX_VALUE,e.preSolvePosition=function(c){var l,m,d,a=c.length;for(l=0;l<a;l++)m=c[l],m.isActive&&(d=m.contactCount,m.collision.parentA.totalContacts+=d,m.collision.parentB.totalContacts+=d)},e.solvePosition=function(c,l,m){var d,a,y,v,_,w,k,A,D=e._positionDampen*(m||1),g=i.clamp(l/i._baseDelta,0,1),b=c.length;for(d=0;d<b;d++)a=c[d],!(!a.isActive||a.isSensor)&&(y=a.collision,v=y.parentA,_=y.parentB,w=y.normal,a.separation=y.depth+w.x*(_.positionImpulse.x-v.positionImpulse.x)+w.y*(_.positionImpulse.y-v.positionImpulse.y));for(d=0;d<b;d++)a=c[d],!(!a.isActive||a.isSensor)&&(y=a.collision,v=y.parentA,_=y.parentB,w=y.normal,A=a.separation-a.slop*g,(v.isStatic||_.isStatic)&&(A*=2),v.isStatic||v.isSleeping||(k=D/v.totalContacts,v.positionImpulse.x+=w.x*A*k,v.positionImpulse.y+=w.y*A*k),_.isStatic||_.isSleeping||(k=D/_.totalContacts,_.positionImpulse.x-=w.x*A*k,_.positionImpulse.y-=w.y*A*k))},e.postSolvePosition=function(c){for(var l=e._positionWarming,m=c.length,d=n.translate,a=u.update,y=0;y<m;y++){var v=c[y],_=v.positionImpulse,w=_.x,k=_.y,A=v.velocity;if(v.totalContacts=0,w!==0||k!==0){for(var D=0;D<v.parts.length;D++){var g=v.parts[D];d(g.vertices,_),a(g.bounds,g.vertices,A),g.position.x+=w,g.position.y+=k}v.positionPrev.x+=w,v.positionPrev.y+=k,w*A.x+k*A.y<0?(_.x=0,_.y=0):(_.x*=l,_.y*=l)}}},e.preSolveVelocity=function(c){var l=c.length,m,d;for(m=0;m<l;m++){var a=c[m];if(!(!a.isActive||a.isSensor)){var y=a.contacts,v=a.contactCount,_=a.collision,w=_.parentA,k=_.parentB,A=_.normal,D=_.tangent;for(d=0;d<v;d++){var g=y[d],b=g.vertex,E=g.normalImpulse,C=g.tangentImpulse;if(E!==0||C!==0){var B=A.x*E+D.x*C,O=A.y*E+D.y*C;w.isStatic||w.isSleeping||(w.positionPrev.x+=B*w.inverseMass,w.positionPrev.y+=O*w.inverseMass,w.anglePrev+=w.inverseInertia*((b.x-w.position.x)*O-(b.y-w.position.y)*B)),k.isStatic||k.isSleeping||(k.positionPrev.x-=B*k.inverseMass,k.positionPrev.y-=O*k.inverseMass,k.anglePrev-=k.inverseInertia*((b.x-k.position.x)*O-(b.y-k.position.y)*B))}}}}},e.solveVelocity=function(c,l){var m=l/i._baseDelta,d=m*m,a=d*m,y=-e._restingThresh*m,v=e._restingThreshTangent,_=e._frictionNormalMultiplier*m,w=e._frictionMaxStatic,k=c.length,A,D,g,b;for(g=0;g<k;g++){var E=c[g];if(!(!E.isActive||E.isSensor)){var C=E.collision,B=C.parentA,O=C.parentB,I=C.normal.x,F=C.normal.y,V=C.tangent.x,U=C.tangent.y,W=E.inverseMass,H=E.friction*E.frictionStatic*_,q=E.contacts,K=E.contactCount,Z=1/K,Q=B.position.x-B.positionPrev.x,J=B.position.y-B.positionPrev.y,$=B.angle-B.anglePrev,te=O.position.x-O.positionPrev.x,pe=O.position.y-O.positionPrev.y,re=O.angle-O.anglePrev;for(b=0;b<K;b++){var Y=q[b],se=Y.vertex,ee=se.x-B.position.x,ge=se.y-B.position.y,ae=se.x-O.position.x,ue=se.y-O.position.y,ie=Q-ge*$,Bt=J+ee*$,Dt=te-ue*re,Ft=pe+ae*re,je=ie-Dt,ke=Bt-Ft,Ee=I*je+F*ke,ce=V*je+U*ke,ze=E.separation+Ee,Oe=Math.min(ze,1);Oe=ze<0?0:Oe;var He=Oe*H;ce<-He||ce>He?(D=ce>0?ce:-ce,A=E.friction*(ce>0?1:-1)*a,A<-D?A=-D:A>D&&(A=D)):(A=ce,D=w);var Ye=ee*F-ge*I,Ke=ae*F-ue*I,Ze=Z/(W+B.inverseInertia*Ye*Ye+O.inverseInertia*Ke*Ke),be=(1+E.restitution)*Ee*Ze;if(A*=Ze,Ee<y)Y.normalImpulse=0;else{var It=Y.normalImpulse;Y.normalImpulse+=be,Y.normalImpulse>0&&(Y.normalImpulse=0),be=Y.normalImpulse-It}if(ce<-v||ce>v)Y.tangentImpulse=0;else{var Pe=Y.tangentImpulse;Y.tangentImpulse+=A,Y.tangentImpulse<-D&&(Y.tangentImpulse=-D),Y.tangentImpulse>D&&(Y.tangentImpulse=D),A=Y.tangentImpulse-Pe}var Ae=I*be+V*A,fe=F*be+U*A;B.isStatic||B.isSleeping||(B.positionPrev.x+=Ae*B.inverseMass,B.positionPrev.y+=fe*B.inverseMass,B.anglePrev+=(ee*fe-ge*Ae)*B.inverseInertia),O.isStatic||O.isSleeping||(O.positionPrev.x-=Ae*O.inverseMass,O.positionPrev.y-=fe*O.inverseMass,O.anglePrev-=(ae*fe-ue*Ae)*O.inverseInertia)}}}}})()},function(T,P,h){var e={};T.exports=e;var n=h(9),i=h(0);(function(){e.create=function(u){return i.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},u)},e.update=function(u,c,l){var m=n.update,d=n.create,a=n.setActive,y=u.table,v=u.list,_=v.length,w=_,k=u.collisionStart,A=u.collisionEnd,D=u.collisionActive,g=c.length,b=0,E=0,C=0,B,O,I;for(I=0;I<g;I++)B=c[I],O=B.pair,O?(O.isActive&&(D[C++]=O),m(O,B,l)):(O=d(B,l),y[O.id]=O,k[b++]=O,v[w++]=O);for(w=0,_=v.length,I=0;I<_;I++)O=v[I],O.timeUpdated>=l?v[w++]=O:(a(O,!1,l),O.collision.bodyA.sleepCounter>0&&O.collision.bodyB.sleepCounter>0?v[w++]=O:(A[E++]=O,delete y[O.id]));v.length!==w&&(v.length=w),k.length!==b&&(k.length=b),A.length!==E&&(A.length=E),D.length!==C&&(D.length=C)},e.clear=function(u){return u.table={},u.list.length=0,u.collisionStart.length=0,u.collisionActive.length=0,u.collisionEnd.length=0,u}})()},function(T,P,h){var e=T.exports=h(21);e.Axes=h(11),e.Bodies=h(12),e.Body=h(4),e.Bounds=h(1),e.Collision=h(8),e.Common=h(0),e.Composite=h(6),e.Composites=h(22),e.Constraint=h(10),e.Contact=h(16),e.Detector=h(13),e.Engine=h(17),e.Events=h(5),e.Grid=h(23),e.Mouse=h(14),e.MouseConstraint=h(24),e.Pair=h(9),e.Pairs=h(19),e.Plugin=h(15),e.Query=h(25),e.Render=h(26),e.Resolver=h(18),e.Runner=h(27),e.SAT=h(28),e.Sleeping=h(7),e.Svg=h(29),e.Vector=h(2),e.Vertices=h(3),e.World=h(30),e.Engine.run=e.Runner.run,e.Common.deprecated(e.Engine,"run","Engine.run âž¤ use Matter.Runner.run(engine) instead")},function(T,P,h){var e={};T.exports=e;var n=h(15),i=h(0);(function(){e.name="matter-js",e.version="0.20.0",e.uses=[],e.used=[],e.use=function(){n.use(e,Array.prototype.slice.call(arguments))},e.before=function(u,c){return u=u.replace(/^Matter./,""),i.chainPathBefore(e,u,c)},e.after=function(u,c){return u=u.replace(/^Matter./,""),i.chainPathAfter(e,u,c)}})()},function(T,P,h){var e={};T.exports=e;var n=h(6),i=h(10),u=h(0),c=h(4),l=h(12),m=u.deprecated;(function(){e.stack=function(d,a,y,v,_,w,k){for(var A=n.create({label:"Stack"}),D=d,g=a,b,E=0,C=0;C<v;C++){for(var B=0,O=0;O<y;O++){var I=k(D,g,O,C,b,E);if(I){var F=I.bounds.max.y-I.bounds.min.y,V=I.bounds.max.x-I.bounds.min.x;F>B&&(B=F),c.translate(I,{x:V*.5,y:F*.5}),D=I.bounds.max.x+_,n.addBody(A,I),b=I,E+=1}else D+=_}g+=B+w,D=d}return A},e.chain=function(d,a,y,v,_,w){for(var k=d.bodies,A=1;A<k.length;A++){var D=k[A-1],g=k[A],b=D.bounds.max.y-D.bounds.min.y,E=D.bounds.max.x-D.bounds.min.x,C=g.bounds.max.y-g.bounds.min.y,B=g.bounds.max.x-g.bounds.min.x,O={bodyA:D,pointA:{x:E*a,y:b*y},bodyB:g,pointB:{x:B*v,y:C*_}},I=u.extend(O,w);n.addConstraint(d,i.create(I))}return d.label+=" Chain",d},e.mesh=function(d,a,y,v,_){var w=d.bodies,k,A,D,g,b;for(k=0;k<y;k++){for(A=1;A<a;A++)D=w[A-1+k*a],g=w[A+k*a],n.addConstraint(d,i.create(u.extend({bodyA:D,bodyB:g},_)));if(k>0)for(A=0;A<a;A++)D=w[A+(k-1)*a],g=w[A+k*a],n.addConstraint(d,i.create(u.extend({bodyA:D,bodyB:g},_))),v&&A>0&&(b=w[A-1+(k-1)*a],n.addConstraint(d,i.create(u.extend({bodyA:b,bodyB:g},_)))),v&&A<a-1&&(b=w[A+1+(k-1)*a],n.addConstraint(d,i.create(u.extend({bodyA:b,bodyB:g},_))))}return d.label+=" Mesh",d},e.pyramid=function(d,a,y,v,_,w,k){return e.stack(d,a,y,v,_,w,function(A,D,g,b,E,C){var B=Math.min(v,Math.ceil(y/2)),O=E?E.bounds.max.x-E.bounds.min.x:0;if(!(b>B)){b=B-b;var I=b,F=y-1-b;if(!(g<I||g>F)){C===1&&c.translate(E,{x:(g+(y%2===1?1:-1))*O,y:0});var V=E?g*O:0;return k(d+V+g*_,D,g,b,E,C)}}})},e.newtonsCradle=function(d,a,y,v,_){for(var w=n.create({label:"Newtons Cradle"}),k=0;k<y;k++){var A=1.9,D=l.circle(d+k*(v*A),a+_,v,{inertia:1/0,restitution:1,friction:0,frictionAir:1e-4,slop:1}),g=i.create({pointA:{x:d+k*(v*A),y:a},bodyB:D});n.addBody(w,D),n.addConstraint(w,g)}return w},m(e,"newtonsCradle","Composites.newtonsCradle âž¤ moved to newtonsCradle example"),e.car=function(d,a,y,v,_){var w=c.nextGroup(!0),k=20,A=-y*.5+k,D=y*.5-k,g=0,b=n.create({label:"Car"}),E=l.rectangle(d,a,y,v,{collisionFilter:{group:w},chamfer:{radius:v*.5},density:2e-4}),C=l.circle(d+A,a+g,_,{collisionFilter:{group:w},friction:.8}),B=l.circle(d+D,a+g,_,{collisionFilter:{group:w},friction:.8}),O=i.create({bodyB:E,pointB:{x:A,y:g},bodyA:C,stiffness:1,length:0}),I=i.create({bodyB:E,pointB:{x:D,y:g},bodyA:B,stiffness:1,length:0});return n.addBody(b,E),n.addBody(b,C),n.addBody(b,B),n.addConstraint(b,O),n.addConstraint(b,I),b},m(e,"car","Composites.car âž¤ moved to car example"),e.softBody=function(d,a,y,v,_,w,k,A,D,g){D=u.extend({inertia:1/0},D),g=u.extend({stiffness:.2,render:{type:"line",anchors:!1}},g);var b=e.stack(d,a,y,v,_,w,function(E,C){return l.circle(E,C,A,D)});return e.mesh(b,y,v,k,g),b.label="Soft Body",b},m(e,"softBody","Composites.softBody âž¤ moved to softBody and cloth examples")})()},function(T,P,h){var e={};T.exports=e;var n=h(9),i=h(0),u=i.deprecated;(function(){e.create=function(c){var l={buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48};return i.extend(l,c)},e.update=function(c,l,m,d){var a,y,v,_=m.world,w=c.buckets,k,A,D=!1;for(a=0;a<l.length;a++){var g=l[a];if(!(g.isSleeping&&!d)&&!(_.bounds&&(g.bounds.max.x<_.bounds.min.x||g.bounds.min.x>_.bounds.max.x||g.bounds.max.y<_.bounds.min.y||g.bounds.min.y>_.bounds.max.y))){var b=e._getRegion(c,g);if(!g.region||b.id!==g.region.id||d){(!g.region||d)&&(g.region=b);var E=e._regionUnion(b,g.region);for(y=E.startCol;y<=E.endCol;y++)for(v=E.startRow;v<=E.endRow;v++){A=e._getBucketId(y,v),k=w[A];var C=y>=b.startCol&&y<=b.endCol&&v>=b.startRow&&v<=b.endRow,B=y>=g.region.startCol&&y<=g.region.endCol&&v>=g.region.startRow&&v<=g.region.endRow;!C&&B&&B&&k&&e._bucketRemoveBody(c,k,g),(g.region===b||C&&!B||d)&&(k||(k=e._createBucket(w,A)),e._bucketAddBody(c,k,g))}g.region=b,D=!0}}}D&&(c.pairsList=e._createActivePairsList(c))},u(e,"update","Grid.update âž¤ replaced by Matter.Detector"),e.clear=function(c){c.buckets={},c.pairs={},c.pairsList=[]},u(e,"clear","Grid.clear âž¤ replaced by Matter.Detector"),e._regionUnion=function(c,l){var m=Math.min(c.startCol,l.startCol),d=Math.max(c.endCol,l.endCol),a=Math.min(c.startRow,l.startRow),y=Math.max(c.endRow,l.endRow);return e._createRegion(m,d,a,y)},e._getRegion=function(c,l){var m=l.bounds,d=Math.floor(m.min.x/c.bucketWidth),a=Math.floor(m.max.x/c.bucketWidth),y=Math.floor(m.min.y/c.bucketHeight),v=Math.floor(m.max.y/c.bucketHeight);return e._createRegion(d,a,y,v)},e._createRegion=function(c,l,m,d){return{id:c+","+l+","+m+","+d,startCol:c,endCol:l,startRow:m,endRow:d}},e._getBucketId=function(c,l){return"C"+c+"R"+l},e._createBucket=function(c,l){var m=c[l]=[];return m},e._bucketAddBody=function(c,l,m){var d=c.pairs,a=n.id,y=l.length,v;for(v=0;v<y;v++){var _=l[v];if(!(m.id===_.id||m.isStatic&&_.isStatic)){var w=a(m,_),k=d[w];k?k[2]+=1:d[w]=[m,_,1]}}l.push(m)},e._bucketRemoveBody=function(c,l,m){var d=c.pairs,a=n.id,y;l.splice(i.indexOf(l,m),1);var v=l.length;for(y=0;y<v;y++){var _=d[a(m,l[y])];_&&(_[2]-=1)}},e._createActivePairsList=function(c){var l,m=c.pairs,d=i.keys(m),a=d.length,y=[],v;for(v=0;v<a;v++)l=m[d[v]],l[2]>0?y.push(l):delete m[d[v]];return y}})()},function(T,P,h){var e={};T.exports=e;var n=h(3),i=h(7),u=h(14),c=h(5),l=h(13),m=h(10),d=h(6),a=h(0),y=h(1);(function(){e.create=function(v,_){var w=(v?v.mouse:null)||(_?_.mouse:null);w||(v&&v.render&&v.render.canvas?w=u.create(v.render.canvas):_&&_.element?w=u.create(_.element):(w=u.create(),a.warn("MouseConstraint.create: options.mouse was undefined, options.element was undefined, may not function as expected")));var k=m.create({label:"Mouse Constraint",pointA:w.position,pointB:{x:0,y:0},length:.01,stiffness:.1,angularStiffness:1,render:{strokeStyle:"#90EE90",lineWidth:3}}),A={type:"mouseConstraint",mouse:w,element:null,body:null,constraint:k,collisionFilter:{category:1,mask:4294967295,group:0}},D=a.extend(A,_);return c.on(v,"beforeUpdate",function(){var g=d.allBodies(v.world);e.update(D,g),e._triggerEvents(D)}),D},e.update=function(v,_){var w=v.mouse,k=v.constraint,A=v.body;if(w.button===0){if(k.bodyB)i.set(k.bodyB,!1),k.pointA=w.position;else for(var D=0;D<_.length;D++)if(A=_[D],y.contains(A.bounds,w.position)&&l.canCollide(A.collisionFilter,v.collisionFilter))for(var g=A.parts.length>1?1:0;g<A.parts.length;g++){var b=A.parts[g];if(n.contains(b.vertices,w.position)){k.pointA=w.position,k.bodyB=v.body=A,k.pointB={x:w.position.x-A.position.x,y:w.position.y-A.position.y},k.angleB=A.angle,i.set(A,!1),c.trigger(v,"startdrag",{mouse:w,body:A});break}}}else k.bodyB=v.body=null,k.pointB=null,A&&c.trigger(v,"enddrag",{mouse:w,body:A})},e._triggerEvents=function(v){var _=v.mouse,w=_.sourceEvents;w.mousemove&&c.trigger(v,"mousemove",{mouse:_}),w.mousedown&&c.trigger(v,"mousedown",{mouse:_}),w.mouseup&&c.trigger(v,"mouseup",{mouse:_}),u.clearSourceEvents(_)}})()},function(T,P,h){var e={};T.exports=e;var n=h(2),i=h(8),u=h(1),c=h(12),l=h(3);(function(){e.collides=function(m,d){for(var a=[],y=d.length,v=m.bounds,_=i.collides,w=u.overlaps,k=0;k<y;k++){var A=d[k],D=A.parts.length,g=D===1?0:1;if(w(A.bounds,v))for(var b=g;b<D;b++){var E=A.parts[b];if(w(E.bounds,v)){var C=_(E,m);if(C){a.push(C);break}}}}return a},e.ray=function(m,d,a,y){y=y||1e-100;for(var v=n.angle(d,a),_=n.magnitude(n.sub(d,a)),w=(a.x+d.x)*.5,k=(a.y+d.y)*.5,A=c.rectangle(w,k,_,y,{angle:v}),D=e.collides(A,m),g=0;g<D.length;g+=1){var b=D[g];b.body=b.bodyB=b.bodyA}return D},e.region=function(m,d,a){for(var y=[],v=0;v<m.length;v++){var _=m[v],w=u.overlaps(_.bounds,d);(w&&!a||!w&&a)&&y.push(_)}return y},e.point=function(m,d){for(var a=[],y=0;y<m.length;y++){var v=m[y];if(u.contains(v.bounds,d))for(var _=v.parts.length===1?0:1;_<v.parts.length;_++){var w=v.parts[_];if(u.contains(w.bounds,d)&&l.contains(w.vertices,d)){a.push(v);break}}}return a}})()},function(T,P,h){var e={};T.exports=e;var n=h(4),i=h(0),u=h(6),c=h(1),l=h(5),m=h(2),d=h(14);(function(){var a,y;typeof window<"u"&&(a=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(g){window.setTimeout(function(){g(i.now())},1e3/60)},y=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),e._goodFps=30,e._goodDelta=1e3/60,e.create=function(g){var b={engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,timing:{historySize:60,delta:0,deltaHistory:[],lastTime:0,lastTimestamp:0,lastElapsed:0,timestampElapsed:0,timestampElapsedHistory:[],engineDeltaHistory:[],engineElapsedHistory:[],engineUpdatesHistory:[],elapsedHistory:[]},options:{width:800,height:600,pixelRatio:1,background:"#14151f",wireframeBackground:"#14151f",wireframeStrokeStyle:"#bbb",hasBounds:!!g.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showStats:!1,showPerformance:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},E=i.extend(b,g);return E.canvas&&(E.canvas.width=E.options.width||E.canvas.width,E.canvas.height=E.options.height||E.canvas.height),E.mouse=g.mouse,E.engine=g.engine,E.canvas=E.canvas||w(E.options.width,E.options.height),E.context=E.canvas.getContext("2d"),E.textures={},E.bounds=E.bounds||{min:{x:0,y:0},max:{x:E.canvas.width,y:E.canvas.height}},E.controller=e,E.options.showBroadphase=!1,E.options.pixelRatio!==1&&e.setPixelRatio(E,E.options.pixelRatio),i.isElement(E.element)&&E.element.appendChild(E.canvas),E},e.run=function(g){(function b(E){g.frameRequestId=a(b),v(g,E),e.world(g,E),g.context.setTransform(g.options.pixelRatio,0,0,g.options.pixelRatio,0,0),(g.options.showStats||g.options.showDebug)&&e.stats(g,g.context,E),(g.options.showPerformance||g.options.showDebug)&&e.performance(g,g.context,E),g.context.setTransform(1,0,0,1,0,0)})()},e.stop=function(g){y(g.frameRequestId)},e.setPixelRatio=function(g,b){var E=g.options,C=g.canvas;b==="auto"&&(b=k(C)),E.pixelRatio=b,C.setAttribute("data-pixel-ratio",b),C.width=E.width*b,C.height=E.height*b,C.style.width=E.width+"px",C.style.height=E.height+"px"},e.setSize=function(g,b,E){g.options.width=b,g.options.height=E,g.bounds.max.x=g.bounds.min.x+b,g.bounds.max.y=g.bounds.min.y+E,g.options.pixelRatio!==1?e.setPixelRatio(g,g.options.pixelRatio):(g.canvas.width=b,g.canvas.height=E)},e.lookAt=function(g,b,E,C){C=typeof C<"u"?C:!0,b=i.isArray(b)?b:[b],E=E||{x:0,y:0};for(var B={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},O=0;O<b.length;O+=1){var I=b[O],F=I.bounds?I.bounds.min:I.min||I.position||I,V=I.bounds?I.bounds.max:I.max||I.position||I;F&&V&&(F.x<B.min.x&&(B.min.x=F.x),V.x>B.max.x&&(B.max.x=V.x),F.y<B.min.y&&(B.min.y=F.y),V.y>B.max.y&&(B.max.y=V.y))}var U=B.max.x-B.min.x+2*E.x,W=B.max.y-B.min.y+2*E.y,H=g.canvas.height,q=g.canvas.width,K=q/H,Z=U/W,Q=1,J=1;Z>K?J=Z/K:Q=K/Z,g.options.hasBounds=!0,g.bounds.min.x=B.min.x,g.bounds.max.x=B.min.x+U*Q,g.bounds.min.y=B.min.y,g.bounds.max.y=B.min.y+W*J,C&&(g.bounds.min.x+=U*.5-U*Q*.5,g.bounds.max.x+=U*.5-U*Q*.5,g.bounds.min.y+=W*.5-W*J*.5,g.bounds.max.y+=W*.5-W*J*.5),g.bounds.min.x-=E.x,g.bounds.max.x-=E.x,g.bounds.min.y-=E.y,g.bounds.max.y-=E.y,g.mouse&&(d.setScale(g.mouse,{x:(g.bounds.max.x-g.bounds.min.x)/g.canvas.width,y:(g.bounds.max.y-g.bounds.min.y)/g.canvas.height}),d.setOffset(g.mouse,g.bounds.min))},e.startViewTransform=function(g){var b=g.bounds.max.x-g.bounds.min.x,E=g.bounds.max.y-g.bounds.min.y,C=b/g.options.width,B=E/g.options.height;g.context.setTransform(g.options.pixelRatio/C,0,0,g.options.pixelRatio/B,0,0),g.context.translate(-g.bounds.min.x,-g.bounds.min.y)},e.endViewTransform=function(g){g.context.setTransform(g.options.pixelRatio,0,0,g.options.pixelRatio,0,0)},e.world=function(g,b){var E=i.now(),C=g.engine,B=C.world,O=g.canvas,I=g.context,F=g.options,V=g.timing,U=u.allBodies(B),W=u.allConstraints(B),H=F.wireframes?F.wireframeBackground:F.background,q=[],K=[],Z,Q={timestamp:C.timing.timestamp};if(l.trigger(g,"beforeRender",Q),g.currentBackground!==H&&D(g,H),I.globalCompositeOperation="source-in",I.fillStyle="transparent",I.fillRect(0,0,O.width,O.height),I.globalCompositeOperation="source-over",F.hasBounds){for(Z=0;Z<U.length;Z++){var J=U[Z];c.overlaps(J.bounds,g.bounds)&&q.push(J)}for(Z=0;Z<W.length;Z++){var $=W[Z],te=$.bodyA,pe=$.bodyB,re=$.pointA,Y=$.pointB;te&&(re=m.add(te.position,$.pointA)),pe&&(Y=m.add(pe.position,$.pointB)),!(!re||!Y)&&(c.contains(g.bounds,re)||c.contains(g.bounds,Y))&&K.push($)}e.startViewTransform(g),g.mouse&&(d.setScale(g.mouse,{x:(g.bounds.max.x-g.bounds.min.x)/g.options.width,y:(g.bounds.max.y-g.bounds.min.y)/g.options.height}),d.setOffset(g.mouse,g.bounds.min))}else K=W,q=U,g.options.pixelRatio!==1&&g.context.setTransform(g.options.pixelRatio,0,0,g.options.pixelRatio,0,0);!F.wireframes||C.enableSleeping&&F.showSleeping?e.bodies(g,q,I):(F.showConvexHulls&&e.bodyConvexHulls(g,q,I),e.bodyWireframes(g,q,I)),F.showBounds&&e.bodyBounds(g,q,I),(F.showAxes||F.showAngleIndicator)&&e.bodyAxes(g,q,I),F.showPositions&&e.bodyPositions(g,q,I),F.showVelocity&&e.bodyVelocity(g,q,I),F.showIds&&e.bodyIds(g,q,I),F.showSeparations&&e.separations(g,C.pairs.list,I),F.showCollisions&&e.collisions(g,C.pairs.list,I),F.showVertexNumbers&&e.vertexNumbers(g,q,I),F.showMousePosition&&e.mousePosition(g,g.mouse,I),e.constraints(K,I),F.hasBounds&&e.endViewTransform(g),l.trigger(g,"afterRender",Q),V.lastElapsed=i.now()-E},e.stats=function(g,b,E){for(var C=g.engine,B=C.world,O=u.allBodies(B),I=0,F=55,V=44,U=0,W=0,H=0;H<O.length;H+=1)I+=O[H].parts.length;var q={Part:I,Body:O.length,Cons:u.allConstraints(B).length,Comp:u.allComposites(B).length,Pair:C.pairs.list.length};b.fillStyle="#0e0f19",b.fillRect(U,W,F*5.5,V),b.font="12px Arial",b.textBaseline="top",b.textAlign="right";for(var K in q){var Z=q[K];b.fillStyle="#aaa",b.fillText(K,U+F,W+8),b.fillStyle="#eee",b.fillText(Z,U+F,W+26),U+=F}},e.performance=function(g,b){var E=g.engine,C=g.timing,B=C.deltaHistory,O=C.elapsedHistory,I=C.timestampElapsedHistory,F=C.engineDeltaHistory,V=C.engineUpdatesHistory,U=C.engineElapsedHistory,W=E.timing.lastUpdatesPerFrame,H=E.timing.lastDelta,q=_(B),K=_(O),Z=_(F),Q=_(V),J=_(U),$=_(I),te=$/q||0,pe=Math.round(q/H),re=1e3/q||0,Y=4,se=12,ee=60,ge=34,ae=10,ue=69;b.fillStyle="#0e0f19",b.fillRect(0,50,se*5+ee*6+22,ge),e.status(b,ae,ue,ee,Y,B.length,Math.round(re)+" fps",re/e._goodFps,function(ie){return B[ie]/q-1}),e.status(b,ae+se+ee,ue,ee,Y,F.length,H.toFixed(2)+" dt",e._goodDelta/H,function(ie){return F[ie]/Z-1}),e.status(b,ae+(se+ee)*2,ue,ee,Y,V.length,W+" upf",Math.pow(i.clamp(Q/pe||1,0,1),4),function(ie){return V[ie]/Q-1}),e.status(b,ae+(se+ee)*3,ue,ee,Y,U.length,J.toFixed(2)+" ut",1-W*J/e._goodFps,function(ie){return U[ie]/J-1}),e.status(b,ae+(se+ee)*4,ue,ee,Y,O.length,K.toFixed(2)+" rt",1-K/e._goodFps,function(ie){return O[ie]/K-1}),e.status(b,ae+(se+ee)*5,ue,ee,Y,I.length,te.toFixed(2)+" x",te*te*te,function(ie){return(I[ie]/B[ie]/te||0)-1})},e.status=function(g,b,E,C,B,O,I,F,V){g.strokeStyle="#888",g.fillStyle="#444",g.lineWidth=1,g.fillRect(b,E+7,C,1),g.beginPath(),g.moveTo(b,E+7-B*i.clamp(.4*V(0),-2,2));for(var U=0;U<C;U+=1)g.lineTo(b+U,E+7-(U<O?B*i.clamp(.4*V(U),-2,2):0));g.stroke(),g.fillStyle="hsl("+i.clamp(25+95*F,0,120)+",100%,60%)",g.fillRect(b,E-7,4,4),g.font="12px Arial",g.textBaseline="middle",g.textAlign="right",g.fillStyle="#eee",g.fillText(I,b+C,E-5)},e.constraints=function(g,b){for(var E=b,C=0;C<g.length;C++){var B=g[C];if(!(!B.render.visible||!B.pointA||!B.pointB)){var O=B.bodyA,I=B.bodyB,F,V;if(O?F=m.add(O.position,B.pointA):F=B.pointA,B.render.type==="pin")E.beginPath(),E.arc(F.x,F.y,3,0,2*Math.PI),E.closePath();else{if(I?V=m.add(I.position,B.pointB):V=B.pointB,E.beginPath(),E.moveTo(F.x,F.y),B.render.type==="spring")for(var U=m.sub(V,F),W=m.perp(m.normalise(U)),H=Math.ceil(i.clamp(B.length/5,12,20)),q,K=1;K<H;K+=1)q=K%2===0?1:-1,E.lineTo(F.x+U.x*(K/H)+W.x*q*4,F.y+U.y*(K/H)+W.y*q*4);E.lineTo(V.x,V.y)}B.render.lineWidth&&(E.lineWidth=B.render.lineWidth,E.strokeStyle=B.render.strokeStyle,E.stroke()),B.render.anchors&&(E.fillStyle=B.render.strokeStyle,E.beginPath(),E.arc(F.x,F.y,3,0,2*Math.PI),E.arc(V.x,V.y,3,0,2*Math.PI),E.closePath(),E.fill())}}},e.bodies=function(g,b,E){var C=E;g.engine;var B=g.options,O=B.showInternalEdges||!B.wireframes,I,F,V,U;for(V=0;V<b.length;V++)if(I=b[V],!!I.render.visible){for(U=I.parts.length>1?1:0;U<I.parts.length;U++)if(F=I.parts[U],!!F.render.visible){if(B.showSleeping&&I.isSleeping?C.globalAlpha=.5*F.render.opacity:F.render.opacity!==1&&(C.globalAlpha=F.render.opacity),F.render.sprite&&F.render.sprite.texture&&!B.wireframes){var W=F.render.sprite,H=A(g,W.texture);C.translate(F.position.x,F.position.y),C.rotate(F.angle),C.drawImage(H,H.width*-W.xOffset*W.xScale,H.height*-W.yOffset*W.yScale,H.width*W.xScale,H.height*W.yScale),C.rotate(-F.angle),C.translate(-F.position.x,-F.position.y)}else{if(F.circleRadius)C.beginPath(),C.arc(F.position.x,F.position.y,F.circleRadius,0,2*Math.PI);else{C.beginPath(),C.moveTo(F.vertices[0].x,F.vertices[0].y);for(var q=1;q<F.vertices.length;q++)!F.vertices[q-1].isInternal||O?C.lineTo(F.vertices[q].x,F.vertices[q].y):C.moveTo(F.vertices[q].x,F.vertices[q].y),F.vertices[q].isInternal&&!O&&C.moveTo(F.vertices[(q+1)%F.vertices.length].x,F.vertices[(q+1)%F.vertices.length].y);C.lineTo(F.vertices[0].x,F.vertices[0].y),C.closePath()}B.wireframes?(C.lineWidth=1,C.strokeStyle=g.options.wireframeStrokeStyle,C.stroke()):(C.fillStyle=F.render.fillStyle,F.render.lineWidth&&(C.lineWidth=F.render.lineWidth,C.strokeStyle=F.render.strokeStyle,C.stroke()),C.fill())}C.globalAlpha=1}}},e.bodyWireframes=function(g,b,E){var C=E,B=g.options.showInternalEdges,O,I,F,V,U;for(C.beginPath(),F=0;F<b.length;F++)if(O=b[F],!!O.render.visible)for(U=O.parts.length>1?1:0;U<O.parts.length;U++){for(I=O.parts[U],C.moveTo(I.vertices[0].x,I.vertices[0].y),V=1;V<I.vertices.length;V++)!I.vertices[V-1].isInternal||B?C.lineTo(I.vertices[V].x,I.vertices[V].y):C.moveTo(I.vertices[V].x,I.vertices[V].y),I.vertices[V].isInternal&&!B&&C.moveTo(I.vertices[(V+1)%I.vertices.length].x,I.vertices[(V+1)%I.vertices.length].y);C.lineTo(I.vertices[0].x,I.vertices[0].y)}C.lineWidth=1,C.strokeStyle=g.options.wireframeStrokeStyle,C.stroke()},e.bodyConvexHulls=function(g,b,E){var C=E,B,O,I;for(C.beginPath(),O=0;O<b.length;O++)if(B=b[O],!(!B.render.visible||B.parts.length===1)){for(C.moveTo(B.vertices[0].x,B.vertices[0].y),I=1;I<B.vertices.length;I++)C.lineTo(B.vertices[I].x,B.vertices[I].y);C.lineTo(B.vertices[0].x,B.vertices[0].y)}C.lineWidth=1,C.strokeStyle="rgba(255,255,255,0.2)",C.stroke()},e.vertexNumbers=function(g,b,E){var C=E,B,O,I;for(B=0;B<b.length;B++){var F=b[B].parts;for(I=F.length>1?1:0;I<F.length;I++){var V=F[I];for(O=0;O<V.vertices.length;O++)C.fillStyle="rgba(255,255,255,0.2)",C.fillText(B+"_"+O,V.position.x+(V.vertices[O].x-V.position.x)*.8,V.position.y+(V.vertices[O].y-V.position.y)*.8)}}},e.mousePosition=function(g,b,E){var C=E;C.fillStyle="rgba(255,255,255,0.8)",C.fillText(b.position.x+"  "+b.position.y,b.position.x+5,b.position.y-5)},e.bodyBounds=function(g,b,E){var C=E;g.engine;var B=g.options;C.beginPath();for(var O=0;O<b.length;O++){var I=b[O];if(I.render.visible)for(var F=b[O].parts,V=F.length>1?1:0;V<F.length;V++){var U=F[V];C.rect(U.bounds.min.x,U.bounds.min.y,U.bounds.max.x-U.bounds.min.x,U.bounds.max.y-U.bounds.min.y)}}B.wireframes?C.strokeStyle="rgba(255,255,255,0.08)":C.strokeStyle="rgba(0,0,0,0.1)",C.lineWidth=1,C.stroke()},e.bodyAxes=function(g,b,E){var C=E;g.engine;var B=g.options,O,I,F,V;for(C.beginPath(),I=0;I<b.length;I++){var U=b[I],W=U.parts;if(U.render.visible)if(B.showAxes)for(F=W.length>1?1:0;F<W.length;F++)for(O=W[F],V=0;V<O.axes.length;V++){var H=O.axes[V];C.moveTo(O.position.x,O.position.y),C.lineTo(O.position.x+H.x*20,O.position.y+H.y*20)}else for(F=W.length>1?1:0;F<W.length;F++)for(O=W[F],V=0;V<O.axes.length;V++)C.moveTo(O.position.x,O.position.y),C.lineTo((O.vertices[0].x+O.vertices[O.vertices.length-1].x)/2,(O.vertices[0].y+O.vertices[O.vertices.length-1].y)/2)}B.wireframes?(C.strokeStyle="indianred",C.lineWidth=1):(C.strokeStyle="rgba(255, 255, 255, 0.4)",C.globalCompositeOperation="overlay",C.lineWidth=2),C.stroke(),C.globalCompositeOperation="source-over"},e.bodyPositions=function(g,b,E){var C=E;g.engine;var B=g.options,O,I,F,V;for(C.beginPath(),F=0;F<b.length;F++)if(O=b[F],!!O.render.visible)for(V=0;V<O.parts.length;V++)I=O.parts[V],C.arc(I.position.x,I.position.y,3,0,2*Math.PI,!1),C.closePath();for(B.wireframes?C.fillStyle="indianred":C.fillStyle="rgba(0,0,0,0.5)",C.fill(),C.beginPath(),F=0;F<b.length;F++)O=b[F],O.render.visible&&(C.arc(O.positionPrev.x,O.positionPrev.y,2,0,2*Math.PI,!1),C.closePath());C.fillStyle="rgba(255,165,0,0.8)",C.fill()},e.bodyVelocity=function(g,b,E){var C=E;C.beginPath();for(var B=0;B<b.length;B++){var O=b[B];if(O.render.visible){var I=n.getVelocity(O);C.moveTo(O.position.x,O.position.y),C.lineTo(O.position.x+I.x,O.position.y+I.y)}}C.lineWidth=3,C.strokeStyle="cornflowerblue",C.stroke()},e.bodyIds=function(g,b,E){var C=E,B,O;for(B=0;B<b.length;B++)if(b[B].render.visible){var I=b[B].parts;for(O=I.length>1?1:0;O<I.length;O++){var F=I[O];C.font="12px Arial",C.fillStyle="rgba(255,255,255,0.5)",C.fillText(F.id,F.position.x+10,F.position.y-10)}}},e.collisions=function(g,b,E){var C=E,B=g.options,O,I,F,V;for(C.beginPath(),F=0;F<b.length;F++)if(O=b[F],!!O.isActive)for(I=O.collision,V=0;V<O.contactCount;V++){var U=O.contacts[V],W=U.vertex;C.rect(W.x-1.5,W.y-1.5,3.5,3.5)}for(B.wireframes?C.fillStyle="rgba(255,255,255,0.7)":C.fillStyle="orange",C.fill(),C.beginPath(),F=0;F<b.length;F++)if(O=b[F],!!O.isActive&&(I=O.collision,O.contactCount>0)){var H=O.contacts[0].vertex.x,q=O.contacts[0].vertex.y;O.contactCount===2&&(H=(O.contacts[0].vertex.x+O.contacts[1].vertex.x)/2,q=(O.contacts[0].vertex.y+O.contacts[1].vertex.y)/2),I.bodyB===I.supports[0].body||I.bodyA.isStatic===!0?C.moveTo(H-I.normal.x*8,q-I.normal.y*8):C.moveTo(H+I.normal.x*8,q+I.normal.y*8),C.lineTo(H,q)}B.wireframes?C.strokeStyle="rgba(255,165,0,0.7)":C.strokeStyle="orange",C.lineWidth=1,C.stroke()},e.separations=function(g,b,E){var C=E,B=g.options,O,I,F,V,U;for(C.beginPath(),U=0;U<b.length;U++)if(O=b[U],!!O.isActive){I=O.collision,F=I.bodyA,V=I.bodyB;var W=1;!V.isStatic&&!F.isStatic&&(W=.5),V.isStatic&&(W=0),C.moveTo(V.position.x,V.position.y),C.lineTo(V.position.x-I.penetration.x*W,V.position.y-I.penetration.y*W),W=1,!V.isStatic&&!F.isStatic&&(W=.5),F.isStatic&&(W=0),C.moveTo(F.position.x,F.position.y),C.lineTo(F.position.x+I.penetration.x*W,F.position.y+I.penetration.y*W)}B.wireframes?C.strokeStyle="rgba(255,165,0,0.5)":C.strokeStyle="orange",C.stroke()},e.inspector=function(g,b){g.engine;var E=g.selected,C=g.render,B=C.options,O;if(B.hasBounds){var I=C.bounds.max.x-C.bounds.min.x,F=C.bounds.max.y-C.bounds.min.y,V=I/C.options.width,U=F/C.options.height;b.scale(1/V,1/U),b.translate(-C.bounds.min.x,-C.bounds.min.y)}for(var W=0;W<E.length;W++){var H=E[W].data;switch(b.translate(.5,.5),b.lineWidth=1,b.strokeStyle="rgba(255,165,0,0.9)",b.setLineDash([1,2]),H.type){case"body":O=H.bounds,b.beginPath(),b.rect(Math.floor(O.min.x-3),Math.floor(O.min.y-3),Math.floor(O.max.x-O.min.x+6),Math.floor(O.max.y-O.min.y+6)),b.closePath(),b.stroke();break;case"constraint":var q=H.pointA;H.bodyA&&(q=H.pointB),b.beginPath(),b.arc(q.x,q.y,10,0,2*Math.PI),b.closePath(),b.stroke();break}b.setLineDash([]),b.translate(-.5,-.5)}g.selectStart!==null&&(b.translate(.5,.5),b.lineWidth=1,b.strokeStyle="rgba(255,165,0,0.6)",b.fillStyle="rgba(255,165,0,0.1)",O=g.selectBounds,b.beginPath(),b.rect(Math.floor(O.min.x),Math.floor(O.min.y),Math.floor(O.max.x-O.min.x),Math.floor(O.max.y-O.min.y)),b.closePath(),b.stroke(),b.fill(),b.translate(-.5,-.5)),B.hasBounds&&b.setTransform(1,0,0,1,0,0)};var v=function(g,b){var E=g.engine,C=g.timing,B=C.historySize,O=E.timing.timestamp;C.delta=b-C.lastTime||e._goodDelta,C.lastTime=b,C.timestampElapsed=O-C.lastTimestamp||0,C.lastTimestamp=O,C.deltaHistory.unshift(C.delta),C.deltaHistory.length=Math.min(C.deltaHistory.length,B),C.engineDeltaHistory.unshift(E.timing.lastDelta),C.engineDeltaHistory.length=Math.min(C.engineDeltaHistory.length,B),C.timestampElapsedHistory.unshift(C.timestampElapsed),C.timestampElapsedHistory.length=Math.min(C.timestampElapsedHistory.length,B),C.engineUpdatesHistory.unshift(E.timing.lastUpdatesPerFrame),C.engineUpdatesHistory.length=Math.min(C.engineUpdatesHistory.length,B),C.engineElapsedHistory.unshift(E.timing.lastElapsed),C.engineElapsedHistory.length=Math.min(C.engineElapsedHistory.length,B),C.elapsedHistory.unshift(C.lastElapsed),C.elapsedHistory.length=Math.min(C.elapsedHistory.length,B)},_=function(g){for(var b=0,E=0;E<g.length;E+=1)b+=g[E];return b/g.length||0},w=function(g,b){var E=document.createElement("canvas");return E.width=g,E.height=b,E.oncontextmenu=function(){return!1},E.onselectstart=function(){return!1},E},k=function(g){var b=g.getContext("2d"),E=window.devicePixelRatio||1,C=b.webkitBackingStorePixelRatio||b.mozBackingStorePixelRatio||b.msBackingStorePixelRatio||b.oBackingStorePixelRatio||b.backingStorePixelRatio||1;return E/C},A=function(g,b){var E=g.textures[b];return E||(E=g.textures[b]=new Image,E.src=b,E)},D=function(g,b){var E=b;/(jpg|gif|png)$/.test(b)&&(E="url("+b+")"),g.canvas.style.background=E,g.canvas.style.backgroundSize="contain",g.currentBackground=b}})()},function(T,P,h){var e={};T.exports=e;var n=h(5),i=h(17),u=h(0);(function(){e._maxFrameDelta=1e3/15,e._frameDeltaFallback=1e3/60,e._timeBufferMargin=1.5,e._elapsedNextEstimate=1,e._smoothingLowerBound=.1,e._smoothingUpperBound=.9,e.create=function(l){var m={delta:16.666666666666668,frameDelta:null,frameDeltaSmoothing:!0,frameDeltaSnapping:!0,frameDeltaHistory:[],frameDeltaHistorySize:100,frameRequestId:null,timeBuffer:0,timeLastTick:null,maxUpdates:null,maxFrameTime:33.333333333333336,lastUpdatesDeferred:0,enabled:!0},d=u.extend(m,l);return d.fps=0,d},e.run=function(l,m){return l.timeBuffer=e._frameDeltaFallback,function d(a){l.frameRequestId=e._onNextFrame(l,d),a&&l.enabled&&e.tick(l,m,a)}(),l},e.tick=function(l,m,d){var a=u.now(),y=l.delta,v=0,_=d-l.timeLastTick;if((!_||!l.timeLastTick||_>Math.max(e._maxFrameDelta,l.maxFrameTime))&&(_=l.frameDelta||e._frameDeltaFallback),l.frameDeltaSmoothing){l.frameDeltaHistory.push(_),l.frameDeltaHistory=l.frameDeltaHistory.slice(-l.frameDeltaHistorySize);var w=l.frameDeltaHistory.slice(0).sort(),k=l.frameDeltaHistory.slice(w.length*e._smoothingLowerBound,w.length*e._smoothingUpperBound),A=c(k);_=A||_}l.frameDeltaSnapping&&(_=1e3/Math.round(1e3/_)),l.frameDelta=_,l.timeLastTick=d,l.timeBuffer+=l.frameDelta,l.timeBuffer=u.clamp(l.timeBuffer,0,l.frameDelta+y*e._timeBufferMargin),l.lastUpdatesDeferred=0;var D=l.maxUpdates||Math.ceil(l.maxFrameTime/y),g={timestamp:m.timing.timestamp};n.trigger(l,"beforeTick",g),n.trigger(l,"tick",g);for(var b=u.now();y>0&&l.timeBuffer>=y*e._timeBufferMargin;){n.trigger(l,"beforeUpdate",g),i.update(m,y),n.trigger(l,"afterUpdate",g),l.timeBuffer-=y,v+=1;var E=u.now()-a,C=u.now()-b,B=E+e._elapsedNextEstimate*C/v;if(v>=D||B>l.maxFrameTime){l.lastUpdatesDeferred=Math.round(Math.max(0,l.timeBuffer/y-e._timeBufferMargin));break}}m.timing.lastUpdatesPerFrame=v,n.trigger(l,"afterTick",g),l.frameDeltaHistory.length>=100&&(l.lastUpdatesDeferred&&Math.round(l.frameDelta/y)>D?u.warnOnce("Matter.Runner: runner reached runner.maxUpdates, see docs."):l.lastUpdatesDeferred&&u.warnOnce("Matter.Runner: runner reached runner.maxFrameTime, see docs."),typeof l.isFixed<"u"&&u.warnOnce("Matter.Runner: runner.isFixed is now redundant, see docs."),(l.deltaMin||l.deltaMax)&&u.warnOnce("Matter.Runner: runner.deltaMin and runner.deltaMax were removed, see docs."),l.fps!==0&&u.warnOnce("Matter.Runner: runner.fps was replaced by runner.delta, see docs."))},e.stop=function(l){e._cancelNextFrame(l)},e._onNextFrame=function(l,m){if(typeof window<"u"&&window.requestAnimationFrame)l.frameRequestId=window.requestAnimationFrame(m);else throw new Error("Matter.Runner: missing required global window.requestAnimationFrame.");return l.frameRequestId},e._cancelNextFrame=function(l){if(typeof window<"u"&&window.cancelAnimationFrame)window.cancelAnimationFrame(l.frameRequestId);else throw new Error("Matter.Runner: missing required global window.cancelAnimationFrame.")};var c=function(l){for(var m=0,d=l.length,a=0;a<d;a+=1)m+=l[a];return m/d||0}})()},function(T,P,h){var e={};T.exports=e;var n=h(8),i=h(0),u=i.deprecated;(function(){e.collides=function(c,l){return n.collides(c,l)},u(e,"collides","SAT.collides âž¤ replaced by Collision.collides")})()},function(T,P,h){var e={};T.exports=e,h(1);var n=h(0);(function(){e.pathToVertices=function(i,u){typeof window<"u"&&!("SVGPathSeg"in window)&&n.warn("Svg.pathToVertices: SVGPathSeg not defined, a polyfill is required.");var c,l,m,d,a,y,v,_,w,k,A=[],D,g,b=0,E=0,C=0;u=u||15;var B=function(I,F,V){var U=V%2===1&&V>1;if(!w||I!=w.x||F!=w.y){w&&U?(D=w.x,g=w.y):(D=0,g=0);var W={x:D+I,y:g+F};(U||!w)&&(w=W),A.push(W),E=D+I,C=g+F}},O=function(I){var F=I.pathSegTypeAsLetter.toUpperCase();if(F!=="Z"){switch(F){case"M":case"L":case"T":case"C":case"S":case"Q":E=I.x,C=I.y;break;case"H":E=I.x;break;case"V":C=I.y;break}B(E,C,I.pathSegType)}};for(e._svgPathToAbsolute(i),m=i.getTotalLength(),y=[],c=0;c<i.pathSegList.numberOfItems;c+=1)y.push(i.pathSegList.getItem(c));for(v=y.concat();b<m;){if(k=i.getPathSegAtLength(b),a=y[k],a!=_){for(;v.length&&v[0]!=a;)O(v.shift());_=a}switch(a.pathSegTypeAsLetter.toUpperCase()){case"C":case"T":case"S":case"Q":case"A":d=i.getPointAtLength(b),B(d.x,d.y,0);break}b+=u}for(c=0,l=v.length;c<l;++c)O(v[c]);return A},e._svgPathToAbsolute=function(i){for(var u,c,l,m,d,a,y=i.pathSegList,v=0,_=0,w=y.numberOfItems,k=0;k<w;++k){var A=y.getItem(k),D=A.pathSegTypeAsLetter;if(/[MLHVCSQTA]/.test(D))"x"in A&&(v=A.x),"y"in A&&(_=A.y);else switch("x1"in A&&(l=v+A.x1),"x2"in A&&(d=v+A.x2),"y1"in A&&(m=_+A.y1),"y2"in A&&(a=_+A.y2),"x"in A&&(v+=A.x),"y"in A&&(_+=A.y),D){case"m":y.replaceItem(i.createSVGPathSegMovetoAbs(v,_),k);break;case"l":y.replaceItem(i.createSVGPathSegLinetoAbs(v,_),k);break;case"h":y.replaceItem(i.createSVGPathSegLinetoHorizontalAbs(v),k);break;case"v":y.replaceItem(i.createSVGPathSegLinetoVerticalAbs(_),k);break;case"c":y.replaceItem(i.createSVGPathSegCurvetoCubicAbs(v,_,l,m,d,a),k);break;case"s":y.replaceItem(i.createSVGPathSegCurvetoCubicSmoothAbs(v,_,d,a),k);break;case"q":y.replaceItem(i.createSVGPathSegCurvetoQuadraticAbs(v,_,l,m),k);break;case"t":y.replaceItem(i.createSVGPathSegCurvetoQuadraticSmoothAbs(v,_),k);break;case"a":y.replaceItem(i.createSVGPathSegArcAbs(v,_,A.r1,A.r2,A.angle,A.largeArcFlag,A.sweepFlag),k);break;case"z":case"Z":v=u,_=c;break}(D=="M"||D=="m")&&(u=v,c=_)}}})()},function(T,P,h){var e={};T.exports=e;var n=h(6);h(0),function(){e.create=n.create,e.add=n.add,e.remove=n.remove,e.clear=n.clear,e.addComposite=n.addComposite,e.addBody=n.addBody,e.addConstraint=n.addConstraint}()}])})})(kn);var _e=kn.exports;const Te=Lo(_e),Vo=[0,0],Uo=[0,0],Wo=[[0,0],[0,0]],qo=[[0,0],[0,0]];function Go(S,R,T){T===void 0&&(T=0),T=T||0;const P=[0,0],h=S[1][1]-S[0][1],e=S[0][0]-S[1][0],n=h*S[0][0]+e*S[0][1],i=R[1][1]-R[0][1],u=R[0][0]-R[1][0],c=i*R[0][0]+u*R[0][1],l=h*u-i*e;return Et(l,0,T)||(P[0]=(u*n-e*c)/l,P[1]=(h*c-i*n)/l),P}function an(S,R,T,P){const h=R[0]-S[0],e=R[1]-S[1],n=P[0]-T[0],i=P[1]-T[1];if(n*e-i*h===0)return!1;const u=(h*(T[1]-S[1])+e*(S[0]-T[0]))/(n*e-i*h),c=(n*(S[1]-T[1])+i*(T[0]-S[0]))/(i*h-n*e);return u>=0&&u<=1&&c>=0&&c<=1}function Ge(S,R,T){return(R[0]-S[0])*(T[1]-S[1])-(T[0]-S[0])*(R[1]-S[1])}function Pt(S,R,T){return Ge(S,R,T)>0}function un(S,R,T){return Ge(S,R,T)>=0}function En(S,R,T){return Ge(S,R,T)<0}function We(S,R,T){return Ge(S,R,T)<=0}function jo(S,R,T,P){if(P===void 0&&(P=0),P){const h=Vo,e=Uo;h[0]=R[0]-S[0],h[1]=R[1]-S[1],e[0]=T[0]-R[0],e[1]=T[1]-R[1];const n=h[0]*e[0]+h[1]*e[1],i=Math.sqrt(h[0]*h[0]+h[1]*h[1]),u=Math.sqrt(e[0]*e[0]+e[1]*e[1]);return Math.acos(n/(i*u))<P}else return Ge(S,R,T)===0}function qe(S,R){const T=R[0]-S[0],P=R[1]-S[1];return T*T+P*P}function G(S,R){const T=S.length;return S[R<0?R%T+T:R%T]}function zo(S){S.length=0}function le(S,R,T,P){for(let h=T;h<P;h++)S.push(R[h])}function Ho(S){let R=0;const T=S;for(let P=1;P<S.length;++P)(T[P][1]<T[R][1]||T[P][1]===T[R][1]&&T[P][0]>T[R][0])&&(R=P);return Pt(G(S,R-1),G(S,R),G(S,R+1))?!1:(Yo(S),!0)}function Yo(S){const R=[],T=S.length;for(let P=0;P!==T;P++)R.push(S.pop());for(let P=0;P!==T;P++)S[P]=R[P]}function On(S,R){return En(G(S,R-1),G(S,R),G(S,R+1))}function Ko(S,R,T){const P=Wo,h=qo;if(un(G(S,R+1),G(S,R),G(S,T))&&We(G(S,R-1),G(S,R),G(S,T)))return!1;const e=qe(G(S,R),G(S,T));for(let n=0;n!==S.length;++n)if(!((n+1)%S.length===R||n===R)&&un(G(S,R),G(S,T),G(S,n+1))&&We(G(S,R),G(S,T),G(S,n))){P[0]=G(S,R),P[1]=G(S,T),h[0]=G(S,n),h[1]=G(S,n+1);const i=Go(P,h);if(qe(G(S,R),i)<e)return!1}return!0}function Zo(S,R,T){for(let P=0;P!==S.length;++P)if(!(P===R||P===T||(P+1)%S.length===R||(P+1)%S.length===T)&&an(G(S,R),G(S,T),G(S,P),G(S,P+1)))return!1;return!0}function kt(S,R,T,P){if(P===void 0&&(P=[]),zo(P),R<T)for(let h=R;h<=T;h++)P.push(S[h]);else{for(let h=0;h<=T;h++)P.push(S[h]);for(let h=R;h<S.length;h++)P.push(S[h])}return P}function ln(S){let R=[],T,P;const h=[];let e=Number.MAX_VALUE;for(let n=0;n<S.length;++n)if(On(S,n)){for(let i=0;i<S.length;++i)if(Ko(S,n,i)){T=ln(kt(S,n,i,h)),P=ln(kt(S,i,n,h));for(let u=0;u<P.length;u++)T.push(P[u]);T.length<e&&(R=T,e=T.length,R.push([G(S,n),G(S,i)]))}}return R}function Xo(S){const R=ln(S);return R.length>0?Rn(S,R):[S]}function Rn(S,R){if(R.length===0)return[S];if(R instanceof Array&&R.length&&R[0]instanceof Array&&R[0].length===2&&R[0][0]instanceof Array){const T=[S];for(let P=0;P<R.length;P++){const h=R[P];for(let e=0;e<T.length;e++){const n=T[e],i=Rn(n,h);if(i){T.splice(e,1),T.push(i[0],i[1]);break}}}return T}else{const T=R,P=S.indexOf(T[0]),h=S.indexOf(T[1]);return P!==-1&&h!==-1?[kt(S,P,h),kt(S,h,P)]:!1}}function Qo(S){const R=S;let T;for(T=0;T<R.length-1;T++)for(let P=0;P<T-1;P++)if(an(R[T],R[T+1],R[P],R[P+1]))return!1;for(T=1;T<R.length-2;T++)if(an(R[0],R[R.length-1],R[T],R[T+1]))return!1;return!0}function Cn(S,R,T,P,h){h===void 0&&(h=0);const e=R[1]-S[1],n=S[0]-R[0],i=e*S[0]+n*S[1],u=P[1]-T[1],c=T[0]-P[0],l=u*T[0]+c*T[1],m=e*c-u*n;return Et(m,0,h)?[0,0]:[(c*i-n*l)/m,(e*l-u*i)/m]}function Ue(S,R,T,P,h,e,n){R===void 0&&(R=[]),T===void 0&&(T=[]),P===void 0&&(P=[]),h===void 0&&(h=25),e===void 0&&(e=100),n===void 0&&(n=0);let i=[0,0],u=[0,0],c=[0,0],l=0,m=0,d=0,a=0,y=0,v=0,_=0;const w=[],k=[],A=S,D=S;if(D.length<3)return R;if(n++,n>e)return console.warn("quickDecomp: max level ("+e+") reached."),R;for(let g=0;g<S.length;++g)if(On(A,g)){T.push(A[g]),l=m=Number.MAX_VALUE;for(let b=0;b<S.length;++b)Pt(G(A,g-1),G(A,g),G(A,b))&&We(G(A,g-1),G(A,g),G(A,b-1))&&(c=Cn(G(A,g-1),G(A,g),G(A,b),G(A,b-1)),En(G(A,g+1),G(A,g),c)&&(d=qe(A[g],c),d<m&&(m=d,u=c,v=b))),Pt(G(A,g+1),G(A,g),G(A,b+1))&&We(G(A,g+1),G(A,g),G(A,b))&&(c=Cn(G(A,g+1),G(A,g),G(A,b),G(A,b+1)),Pt(G(A,g-1),G(A,g),c)&&(d=qe(A[g],c),d<l&&(l=d,i=c,y=b)));if(v===(y+1)%S.length)c[0]=(u[0]+i[0])/2,c[1]=(u[1]+i[1])/2,P.push(c),g<y?(le(w,A,g,y+1),w.push(c),k.push(c),v!==0&&le(k,A,v,A.length),le(k,A,0,g+1)):(g!==0&&le(w,A,g,A.length),le(w,A,0,y+1),w.push(c),k.push(c),le(k,A,v,g+1));else{if(v>y&&(y+=S.length),a=Number.MAX_VALUE,y<v)return R;for(let b=v;b<=y;++b)un(G(A,g-1),G(A,g),G(A,b))&&We(G(A,g+1),G(A,g),G(A,b))&&(d=qe(G(A,g),G(A,b)),d<a&&Zo(A,g,b)&&(a=d,_=b%S.length));g<_?(le(w,A,g,_+1),_!==0&&le(k,A,_,D.length),le(k,A,0,g+1)):(g!==0&&le(w,A,g,D.length),le(w,A,0,_+1),le(k,A,_,g+1))}return w.length<k.length?(Ue(w,R,T,P,h,e,n),Ue(k,R,T,P,h,e,n)):(Ue(k,R,T,P,h,e,n),Ue(w,R,T,P,h,e,n)),R}return R.push(S),R}function $o(S,R){R===void 0&&(R=0);let T=0;for(let P=S.length-1;S.length>3&&P>=0;--P)jo(G(S,P-1),G(S,P),G(S,P+1),R)&&(S.splice(P%S.length,1),T++);return T}function Et(S,R,T){return T===void 0&&(T=0),T=T||0,Math.abs(S-R)<=T}function Jo(S,R,T){return T===void 0&&(T=0),Et(S[0],R[0],T)&&Et(S[1],R[1],T)}function es(S,R){R===void 0&&(R=0);for(let T=S.length-1;T>=1;--T){const P=S[T];for(let h=T-1;h>=0;--h)if(Jo(P,S[h],R)){S.splice(T,1);continue}}}const ts=Object.freeze(Object.defineProperty({__proto__:null,decomp:Xo,isSimple:Qo,makeCCW:Ho,quickDecomp:Ue,removeCollinearPoints:$o,removeDuplicatePoints:es},Symbol.toStringTag,{value:"Module"})),Mn=1920,ye=1080,ns=30,is=`å¾Œã¯é‡Žã¨ãªã‚Œå±±ã¨ãªã‚Œã¨ã€
ä½•ã‚‚æˆã—é‚ã’ã‚‰ã‚Œãšå±…ã‚‹ã€
å¶åƒå´‡æ‹å¦„ä¿¡è€…ãŒã€
æºœé£²ã‚’ä¸‹ã’ã‚‹ã€‚
å››è¾ºå½¢ã«åŽå®¹ã•ã‚ŒãŸã€
è·¯å‚ã®äººã®æ…°ã¿ãŒã€
æ¤ãˆã¤ã‘ã‚‹æ§˜ã«ã“ã¡ã‚‰ã‚’å‘ã„ã¦ã€
å’Žã‚ã‚‹ã®ã§ã—ã‚‡ã†ã€‚

ç ‚ã‚’å™›ã¿ã€
é¤éª¨ã‚’é½§ã‚Šã€
ãƒŠãƒ¡ã‚¯ã‚¸ãŒæº¶ã‘ã¦ã¾ã—ãŸã€‚

ãã‚Œã¯ä¸‡æœ‰å¼•åŠ›ã®ã€
æ§˜ãªãƒ¢ãƒŽã§ã‚ã‚Šã€
æŠ—ãˆã°æŠ—ã†ç¨‹ã€
é’ãç‡ƒãˆä¸ŠãŒã‚‹ã®ã§ã™ã€‚
ãã‚Œã¯ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªä¿¡å·ãŒã€
æŒ‡ã—ç¤ºã™é€šã‚Šã€
ã‚‚ãŒãè…•ã‚„è¶³ã¯ã‚‚ã†ã€
æ„å‘³ã‚’ãªã•ãªã„ã®ã§ã™ã€‚

é€™ã„ãšã‚Šæ–¹ãŒã€
æ€ã„å‡ºã›ãªããªã‚Šã¾ã—ãŸã€`,Bn="å…¨ã¦matter.jsã®æ‰€ç‚ºã§ã™ã€‚",Ot=80,At=188,rs=214,Dn=8,os=2;let Ct;const ss=()=>{Ct=p.loadFont("GenZenGothic.ttf")};(function(){(function(S){var R={};function T(P){if(R[P])return R[P].exports;var h=R[P]={i:P,l:!1,exports:{}};return S[P].call(h.exports,h,h.exports,T),h.l=!0,h.exports}return T.m=S,T.c=R,T.d=function(P,h,e){T.o(P,h)||Object.defineProperty(P,h,{enumerable:!0,get:e})},T.r=function(P){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(P,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(P,"__esModule",{value:!0})},T.t=function(P,h){if(h&1&&(P=T(P)),h&8||h&4&&typeof P=="object"&&P&&P.__esModule)return P;var e=Object.create(null);if(T.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:P}),h&2&&typeof P!="string")for(var n in P)T.d(e,n,(function(i){return P[i]}).bind(null,n));return e},T.n=function(P){var h=P&&P.__esModule?function(){return P.default}:function(){return P};return T.d(h,"a",h),h},T.o=function(P,h){return Object.prototype.hasOwnProperty.call(P,h)},T.p="",T(T.s=40)})([function(S,R,T){var P;P=(function(){function h(n,i){this.isUndef(n)||n===1?this.input=this.context.createGain():1<n&&(this.input=new Array(n)),this.isUndef(i)||i===1?this.output=this.context.createGain():1<i&&(this.output=new Array(n))}var e;return h.prototype.set=function(n,i,u){if(this.isObject(n))u=i;else if(this.isString(n)){var c={};c[n]=i,n=c}e:for(var l in n){i=n[l];var m=this;if(l.indexOf(".")!==-1){for(var d=l.split("."),a=0;a<d.length-1;a++)if((m=m[d[a]])instanceof h){d.splice(0,a+1);var y=d.join(".");m.set(y,i);continue e}l=d[d.length-1]}var v=m[l];this.isUndef(v)||(h.Signal&&v instanceof h.Signal||h.Param&&v instanceof h.Param?v.value!==i&&(this.isUndef(u)?v.value=i:v.rampTo(i,u)):v instanceof AudioParam?v.value!==i&&(v.value=i):v instanceof h?v.set(i):v!==i&&(m[l]=i))}return this},h.prototype.get=function(n){this.isUndef(n)?n=this._collectDefaults(this.constructor):this.isString(n)&&(n=[n]);for(var i={},u=0;u<n.length;u++){var c=n[u],l=this,m=i;if(c.indexOf(".")!==-1){for(var d=c.split("."),a=0;a<d.length-1;a++){var y=d[a];m[y]=m[y]||{},m=m[y],l=l[y]}c=d[d.length-1]}var v=l[c];this.isObject(n[c])?m[c]=v.get():h.Signal&&v instanceof h.Signal||h.Param&&v instanceof h.Param||v instanceof AudioParam?m[c]=v.value:v instanceof h?m[c]=v.get():this.isFunction(v)||this.isUndef(v)||(m[c]=v)}return i},h.prototype._collectDefaults=function(n){var i=[];if(this.isUndef(n.defaults)||(i=Object.keys(n.defaults)),!this.isUndef(n._super))for(var u=this._collectDefaults(n._super),c=0;c<u.length;c++)i.indexOf(u[c])===-1&&i.push(u[c]);return i},h.prototype.toString=function(){for(var n in h){var i=n[0].match(/^[A-Z]$/),u=h[n]===this.constructor;if(this.isFunction(h[n])&&i&&u)return n}return"Tone"},Object.defineProperty(h.prototype,"numberOfInputs",{get:function(){return this.input?this.isArray(this.input)?this.input.length:1:0}}),Object.defineProperty(h.prototype,"numberOfOutputs",{get:function(){return this.output?this.isArray(this.output)?this.output.length:1:0}}),h.prototype.dispose=function(){return this.isUndef(this.input)||(this.input instanceof AudioNode&&this.input.disconnect(),this.input=null),this.isUndef(this.output)||(this.output instanceof AudioNode&&this.output.disconnect(),this.output=null),this},h.prototype.connect=function(n,i,u){return Array.isArray(this.output)?(i=this.defaultArg(i,0),this.output[i].connect(n,0,u)):this.output.connect(n,i,u),this},h.prototype.disconnect=function(n,i,u){this.isArray(this.output)?this.isNumber(n)?this.output[n].disconnect():(i=this.defaultArg(i,0),this.output[i].disconnect(n,0,u)):this.output.disconnect.apply(this.output,arguments)},h.prototype.connectSeries=function(){if(1<arguments.length)for(var n=arguments[0],i=1;i<arguments.length;i++){var u=arguments[i];n.connect(u),n=u}return this},h.prototype.chain=function(){if(0<arguments.length)for(var n=this,i=0;i<arguments.length;i++){var u=arguments[i];n.connect(u),n=u}return this},h.prototype.fan=function(){if(0<arguments.length)for(var n=0;n<arguments.length;n++)this.connect(arguments[n]);return this},AudioNode.prototype.chain=h.prototype.chain,AudioNode.prototype.fan=h.prototype.fan,h.prototype.defaultArg=function(n,i){if(this.isObject(n)&&this.isObject(i)){var u={};for(var c in n)u[c]=this.defaultArg(i[c],n[c]);for(var l in i)u[l]=this.defaultArg(n[l],i[l]);return u}return this.isUndef(n)?i:n},h.prototype.optionsObject=function(n,i,u){var c={};if(n.length===1&&this.isObject(n[0]))c=n[0];else for(var l=0;l<i.length;l++)c[i[l]]=n[l];return this.isUndef(u)?c:this.defaultArg(c,u)},h.prototype.isUndef=function(n){return n===void 0},h.prototype.isFunction=function(n){return typeof n=="function"},h.prototype.isNumber=function(n){return typeof n=="number"},h.prototype.isObject=function(n){return Object.prototype.toString.call(n)==="[object Object]"&&n.constructor===Object},h.prototype.isBoolean=function(n){return typeof n=="boolean"},h.prototype.isArray=function(n){return Array.isArray(n)},h.prototype.isString=function(n){return typeof n=="string"},h.noOp=function(){},h.prototype._readOnly=function(n){if(Array.isArray(n))for(var i=0;i<n.length;i++)this._readOnly(n[i]);else Object.defineProperty(this,n,{writable:!1,enumerable:!0})},h.prototype._writable=function(n){if(Array.isArray(n))for(var i=0;i<n.length;i++)this._writable(n[i]);else Object.defineProperty(this,n,{writable:!0})},h.State={Started:"started",Stopped:"stopped",Paused:"paused"},h.prototype.equalPowerScale=function(n){var i=.5*Math.PI;return Math.sin(n*i)},h.prototype.dbToGain=function(n){return Math.pow(2,n/6)},h.prototype.gainToDb=function(n){return Math.log(n)/Math.LN10*20},h.prototype.intervalToFrequencyRatio=function(n){return Math.pow(2,n/12)},h.prototype.now=function(){return h.context.now()},h.now=function(){return h.context.now()},h.extend=function(n,i){function u(){}h.prototype.isUndef(i)&&(i=h),u.prototype=i.prototype,n.prototype=new u,(n.prototype.constructor=n)._super=i},Object.defineProperty(h,"context",{get:function(){return e},set:function(n){e=h.Context&&n instanceof h.Context?n:new h.Context(n),h.Context&&h.Context.emit("init",e)}}),Object.defineProperty(h.prototype,"context",{get:function(){return h.context}}),h.setContext=function(n){h.context=n},Object.defineProperty(h.prototype,"blockTime",{get:function(){return 128/this.context.sampleRate}}),Object.defineProperty(h.prototype,"sampleTime",{get:function(){return 1/this.context.sampleRate}}),Object.defineProperty(h,"supported",{get:function(){var n=window.hasOwnProperty("AudioContext")||window.hasOwnProperty("webkitAudioContext"),i=window.hasOwnProperty("Promise"),u=window.hasOwnProperty("Worker");return n&&i&&u}}),h.version="r10",window.TONE_SILENCE_VERSION_LOGGING||console.log("%c * Tone.js "+h.version+" * ","background: #000; color: #fff"),h}).call(R,T,R,S),P!==void 0&&(S.exports=P)},function(S,R,T){var P,h;P=[T(0),T(2),T(10)],h=(function(e){return e.Multiply=function(n){this.createInsOuts(2,0),this._mult=this.input[0]=this.output=new e.Gain,this._param=this.input[1]=this.output.gain,this._param.value=this.defaultArg(n,0)},e.extend(e.Multiply,e.Signal),e.Multiply.prototype.dispose=function(){return e.prototype.dispose.call(this),this._mult.dispose(),this._mult=null,this._param=null,this},e.Multiply}).apply(R,P),h!==void 0&&(S.exports=h)},function(S,R,T){var P,h;P=[T(0),T(6),T(9),T(18),T(10)],h=(function(e){return e.Signal=function(){var n=this.optionsObject(arguments,["value","units"],e.Signal.defaults);this.output=this._gain=this.context.createGain(),n.param=this._gain.gain,e.Param.call(this,n),this.input=this._param=this._gain.gain,this.context.getConstant(1).chain(this._gain)},e.extend(e.Signal,e.Param),e.Signal.defaults={value:0,units:e.Type.Default,convert:!0},e.Signal.prototype.connect=e.SignalBase.prototype.connect,e.Signal.prototype.dispose=function(){return e.Param.prototype.dispose.call(this),this._param=null,this._gain.disconnect(),this._gain=null,this},e.Signal}).apply(R,P),h!==void 0&&(S.exports=h)},function(S,R,T){(function(P){T.d(R,"b",function(){return l}),T.d(R,"c",function(){return m});var h=T(22),e=T.n(h),n=T(0),i=T.n(n),u=T(12);T.n(u),P.TONE_SILENCE_VERSION_LOGGING=!0;var c=new window.AudioContext;i.a.setContext(c);function l(){return c}function m(d,a){var y=d;return d instanceof p5.Element?y=d.elt:d instanceof Array&&d[0]instanceof p5.Element&&(y=d.map(function(v){return v.elt})),e()(c,y,a)}R.a=c}).call(this,T(26))},function(S,R,T){var P,h;P=[T(0),T(2),T(10)],h=(function(e){return e.Add=function(n){this.createInsOuts(2,0),this._sum=this.input[0]=this.input[1]=this.output=new e.Gain,this._param=this.input[1]=new e.Signal(n),this._param.connect(this._sum)},e.extend(e.Add,e.Signal),e.Add.prototype.dispose=function(){return e.prototype.dispose.call(this),this._sum.dispose(),this._sum=null,this._param.dispose(),this._param=null,this},e.Add}).apply(R,P),h!==void 0&&(S.exports=h)},function(S,R){S.exports={recorderProcessor:"recorder-processor",soundFileProcessor:"sound-file-processor",amplitudeProcessor:"amplitude-processor"}},function(S,R,T){var P,h;P=[T(0),T(15)],h=(function(e){return e.WaveShaper=function(n,i){this._shaper=this.input=this.output=this.context.createWaveShaper(),this._curve=null,Array.isArray(n)?this.curve=n:isFinite(n)||this.isUndef(n)?this._curve=new Float32Array(this.defaultArg(n,1024)):this.isFunction(n)&&(this._curve=new Float32Array(this.defaultArg(i,1024)),this.setMap(n))},e.extend(e.WaveShaper,e.SignalBase),e.WaveShaper.prototype.setMap=function(n){for(var i=0,u=this._curve.length;i<u;i++){var c=i/(u-1)*2-1;this._curve[i]=n(c,i)}return this._shaper.curve=this._curve,this},Object.defineProperty(e.WaveShaper.prototype,"curve",{get:function(){return this._shaper.curve},set:function(n){this._curve=new Float32Array(n),this._shaper.curve=this._curve}}),Object.defineProperty(e.WaveShaper.prototype,"oversample",{get:function(){return this._shaper.oversample},set:function(n){if(["none","2x","4x"].indexOf(n)===-1)throw new RangeError("Tone.WaveShaper: oversampling must be either 'none', '2x', or '4x'");this._shaper.oversample=n}}),e.WaveShaper.prototype.dispose=function(){return e.prototype.dispose.call(this),this._shaper.disconnect(),this._shaper=null,this._curve=null,this},e.WaveShaper}).apply(R,P),h!==void 0&&(S.exports=h)},function(S,R,T){var P,h;P=[T(0),T(2),T(19)],h=(function(e){return e.TimelineSignal=function(){var n=this.optionsObject(arguments,["value","units"],e.Signal.defaults);this._events=new e.Timeline(10),e.Signal.apply(this,n),n.param=this._param,e.Param.call(this,n),this._initial=this._fromUnits(this._param.value)},e.extend(e.TimelineSignal,e.Param),e.TimelineSignal.Type={Linear:"linear",Exponential:"exponential",Target:"target",Curve:"curve",Set:"set"},Object.defineProperty(e.TimelineSignal.prototype,"value",{get:function(){var n=this.now(),i=this.getValueAtTime(n);return this._toUnits(i)},set:function(n){var i=this._fromUnits(n);this._initial=i,this.cancelScheduledValues(),this._param.value=i}}),e.TimelineSignal.prototype.setValueAtTime=function(n,i){return n=this._fromUnits(n),i=this.toSeconds(i),this._events.add({type:e.TimelineSignal.Type.Set,value:n,time:i}),this._param.setValueAtTime(n,i),this},e.TimelineSignal.prototype.linearRampToValueAtTime=function(n,i){return n=this._fromUnits(n),i=this.toSeconds(i),this._events.add({type:e.TimelineSignal.Type.Linear,value:n,time:i}),this._param.linearRampToValueAtTime(n,i),this},e.TimelineSignal.prototype.exponentialRampToValueAtTime=function(n,i){i=this.toSeconds(i);var u=this._searchBefore(i);u&&u.value===0&&this.setValueAtTime(this._minOutput,u.time),n=this._fromUnits(n);var c=Math.max(n,this._minOutput);return this._events.add({type:e.TimelineSignal.Type.Exponential,value:c,time:i}),n<this._minOutput?(this._param.exponentialRampToValueAtTime(this._minOutput,i-this.sampleTime),this.setValueAtTime(0,i)):this._param.exponentialRampToValueAtTime(n,i),this},e.TimelineSignal.prototype.setTargetAtTime=function(n,i,u){return n=this._fromUnits(n),n=Math.max(this._minOutput,n),u=Math.max(this._minOutput,u),i=this.toSeconds(i),this._events.add({type:e.TimelineSignal.Type.Target,value:n,time:i,constant:u}),this._param.setTargetAtTime(n,i,u),this},e.TimelineSignal.prototype.setValueCurveAtTime=function(n,i,u,c){c=this.defaultArg(c,1);for(var l=new Array(n.length),m=0;m<l.length;m++)l[m]=this._fromUnits(n[m])*c;i=this.toSeconds(i),u=this.toSeconds(u),this._events.add({type:e.TimelineSignal.Type.Curve,value:l,time:i,duration:u}),this._param.setValueAtTime(l[0],i);for(var d=1;d<l.length;d++){var a=i+d/(l.length-1)*u;this._param.linearRampToValueAtTime(l[d],a)}return this},e.TimelineSignal.prototype.cancelScheduledValues=function(n){return n=this.toSeconds(n),this._events.cancel(n),this._param.cancelScheduledValues(n),this},e.TimelineSignal.prototype.setRampPoint=function(n){n=this.toSeconds(n);var i=this._toUnits(this.getValueAtTime(n)),u=this._searchBefore(n);if(u&&u.time===n)this.cancelScheduledValues(n+this.sampleTime);else if(u&&u.type===e.TimelineSignal.Type.Curve&&u.time+u.duration>n)this.cancelScheduledValues(n),this.linearRampToValueAtTime(i,n);else{var c=this._searchAfter(n);c&&(this.cancelScheduledValues(n),c.type===e.TimelineSignal.Type.Linear?this.linearRampToValueAtTime(i,n):c.type===e.TimelineSignal.Type.Exponential&&this.exponentialRampToValueAtTime(i,n)),this.setValueAtTime(i,n)}return this},e.TimelineSignal.prototype.linearRampToValueBetween=function(n,i,u){return this.setRampPoint(i),this.linearRampToValueAtTime(n,u),this},e.TimelineSignal.prototype.exponentialRampToValueBetween=function(n,i,u){return this.setRampPoint(i),this.exponentialRampToValueAtTime(n,u),this},e.TimelineSignal.prototype._searchBefore=function(n){return this._events.get(n)},e.TimelineSignal.prototype._searchAfter=function(n){return this._events.getAfter(n)},e.TimelineSignal.prototype.getValueAtTime=function(n){n=this.toSeconds(n);var i=this._searchAfter(n),u=this._searchBefore(n),c=this._initial;if(u===null)c=this._initial;else if(u.type===e.TimelineSignal.Type.Target){var l,m=this._events.getBefore(u.time);l=m===null?this._initial:m.value,c=this._exponentialApproach(u.time,l,u.value,u.constant,n)}else c=u.type===e.TimelineSignal.Type.Curve?this._curveInterpolate(u.time,u.value,u.duration,n):i===null?u.value:i.type===e.TimelineSignal.Type.Linear?this._linearInterpolate(u.time,u.value,i.time,i.value,n):i.type===e.TimelineSignal.Type.Exponential?this._exponentialInterpolate(u.time,u.value,i.time,i.value,n):u.value;return c},e.TimelineSignal.prototype.connect=e.SignalBase.prototype.connect,e.TimelineSignal.prototype._exponentialApproach=function(n,i,u,c,l){return u+(i-u)*Math.exp(-(l-n)/c)},e.TimelineSignal.prototype._linearInterpolate=function(n,i,u,c,l){return i+(l-n)/(u-n)*(c-i)},e.TimelineSignal.prototype._exponentialInterpolate=function(n,i,u,c,l){return(i=Math.max(this._minOutput,i))*Math.pow(c/i,(l-n)/(u-n))},e.TimelineSignal.prototype._curveInterpolate=function(n,i,u,c){var l=i.length;if(n+u<=c)return i[l-1];if(c<=n)return i[0];var m=(c-n)/u,d=Math.floor((l-1)*m),a=Math.ceil((l-1)*m),y=i[d],v=i[a];return a===d?y:this._linearInterpolate(d,y,a,v,m*(l-1))},e.TimelineSignal.prototype.dispose=function(){e.Signal.prototype.dispose.call(this),e.Param.prototype.dispose.call(this),this._events.dispose(),this._events=null},e.TimelineSignal}).apply(R,P),h!==void 0&&(S.exports=h)},function(S,R,T){var P,h;P=[T(0),T(4),T(1),T(2)],h=(function(e){return e.Scale=function(n,i){this._outputMin=this.defaultArg(n,0),this._outputMax=this.defaultArg(i,1),this._scale=this.input=new e.Multiply(1),this._add=this.output=new e.Add(0),this._scale.connect(this._add),this._setRange()},e.extend(e.Scale,e.SignalBase),Object.defineProperty(e.Scale.prototype,"min",{get:function(){return this._outputMin},set:function(n){this._outputMin=n,this._setRange()}}),Object.defineProperty(e.Scale.prototype,"max",{get:function(){return this._outputMax},set:function(n){this._outputMax=n,this._setRange()}}),e.Scale.prototype._setRange=function(){this._add.value=this._outputMin,this._scale.value=this._outputMax-this._outputMin},e.Scale.prototype.dispose=function(){return e.prototype.dispose.call(this),this._add.dispose(),this._add=null,this._scale.dispose(),this._scale=null,this},e.Scale}).apply(R,P),h!==void 0&&(S.exports=h)},function(S,R,T){var P,h;P=[T(0),T(16),T(30),T(31),T(12)],h=(function(e){return e.Type={Default:"number",Time:"time",Frequency:"frequency",TransportTime:"transportTime",Ticks:"ticks",NormalRange:"normalRange",AudioRange:"audioRange",Decibels:"db",Interval:"interval",BPM:"bpm",Positive:"positive",Cents:"cents",Degrees:"degrees",MIDI:"midi",BarsBeatsSixteenths:"barsBeatsSixteenths",Samples:"samples",Hertz:"hertz",Note:"note",Milliseconds:"milliseconds",Seconds:"seconds",Notation:"notation"},e.prototype.toSeconds=function(n){return this.isNumber(n)?n:this.isUndef(n)?this.now():this.isString(n)?new e.Time(n).toSeconds():n instanceof e.TimeBase?n.toSeconds():void 0},e.prototype.toFrequency=function(n){return this.isNumber(n)?n:this.isString(n)||this.isUndef(n)?new e.Frequency(n).valueOf():n instanceof e.TimeBase?n.toFrequency():void 0},e.prototype.toTicks=function(n){return this.isNumber(n)||this.isString(n)?new e.TransportTime(n).toTicks():this.isUndef(n)?e.Transport.ticks:n instanceof e.TimeBase?n.toTicks():void 0},e}).apply(R,P),h!==void 0&&(S.exports=h)},function(S,R,T){var P,h;P=[T(0),T(18),T(9)],h=(function(e){return window.GainNode&&!AudioContext.prototype.createGain&&(AudioContext.prototype.createGain=AudioContext.prototype.createGainNode),e.Gain=function(){var n=this.optionsObject(arguments,["gain","units"],e.Gain.defaults);this.input=this.output=this._gainNode=this.context.createGain(),this.gain=new e.Param({param:this._gainNode.gain,units:n.units,value:n.gain,convert:n.convert}),this._readOnly("gain")},e.extend(e.Gain),e.Gain.defaults={gain:1,convert:!0},e.Gain.prototype.dispose=function(){e.Param.prototype.dispose.call(this),this._gainNode.disconnect(),this._gainNode=null,this._writable("gain"),this.gain.dispose(),this.gain=null},e.prototype.createInsOuts=function(n,i){n===1?this.input=new e.Gain:1<n&&(this.input=new Array(n)),i===1?this.output=new e.Gain:1<i&&(this.output=new Array(n))},e.Gain}).apply(R,P),h!==void 0&&(S.exports=h)},function(S,R,T){var P,h;P=[T(0),T(7),T(39),T(14),T(12)],h=(function(e){return e.Clock=function(){e.Emitter.call(this);var n=this.optionsObject(arguments,["callback","frequency"],e.Clock.defaults);this.callback=n.callback,this._nextTick=0,this._lastState=e.State.Stopped,this.frequency=new e.TimelineSignal(n.frequency,e.Type.Frequency),this._readOnly("frequency"),this.ticks=0,this._state=new e.TimelineState(e.State.Stopped),this._boundLoop=this._loop.bind(this),this.context.on("tick",this._boundLoop)},e.extend(e.Clock,e.Emitter),e.Clock.defaults={callback:e.noOp,frequency:1,lookAhead:"auto"},Object.defineProperty(e.Clock.prototype,"state",{get:function(){return this._state.getValueAtTime(this.now())}}),e.Clock.prototype.start=function(n,i){return n=this.toSeconds(n),this._state.getValueAtTime(n)!==e.State.Started&&this._state.add({state:e.State.Started,time:n,offset:i}),this},e.Clock.prototype.stop=function(n){return n=this.toSeconds(n),this._state.cancel(n),this._state.setStateAtTime(e.State.Stopped,n),this},e.Clock.prototype.pause=function(n){return n=this.toSeconds(n),this._state.getValueAtTime(n)===e.State.Started&&this._state.setStateAtTime(e.State.Paused,n),this},e.Clock.prototype._loop=function(){for(var n=this.now()+this.context.lookAhead+this.context.updateInterval+2*this.context.lag;n>this._nextTick&&this._state;){var i=this._state.getValueAtTime(this._nextTick);if(i!==this._lastState){this._lastState=i;var u=this._state.get(this._nextTick);i===e.State.Started?(this._nextTick=u.time,this.isUndef(u.offset)||(this.ticks=u.offset),this.emit("start",u.time,this.ticks)):i===e.State.Stopped?(this.ticks=0,this.emit("stop",u.time)):i===e.State.Paused&&this.emit("pause",u.time)}var c=this._nextTick;this.frequency&&(this._nextTick+=1/this.frequency.getValueAtTime(this._nextTick),i===e.State.Started&&(this.callback(c),this.ticks++))}},e.Clock.prototype.getStateAtTime=function(n){return n=this.toSeconds(n),this._state.getValueAtTime(n)},e.Clock.prototype.dispose=function(){e.Emitter.prototype.dispose.call(this),this.context.off("tick",this._boundLoop),this._writable("frequency"),this.frequency.dispose(),this.frequency=null,this._boundLoop=null,this._nextTick=1/0,this.callback=null,this._state.dispose(),this._state=null},e.Clock}).apply(R,P),h!==void 0&&(S.exports=h)},function(S,R,T){var P,h;P=[T(0),T(14)],h=(function(e){function n(c,l,m){if(c.input)Array.isArray(c.input)?(e.prototype.isUndef(m)&&(m=0),this.connect(c.input[m])):this.connect(c.input,l,m);else try{c instanceof AudioNode?i.call(this,c,l,m):i.call(this,c,l)}catch(d){throw new Error("error connecting to node: "+c+`
`+d)}}var i,u;return!window.hasOwnProperty("AudioContext")&&window.hasOwnProperty("webkitAudioContext")&&(window.AudioContext=window.webkitAudioContext),e.Context=function(c){for(var l in e.Emitter.call(this),c=c||new window.AudioContext,this._context=c,this._context)this._defineProperty(this._context,l);this._latencyHint="interactive",this._lookAhead=.1,this._updateInterval=this._lookAhead/3,this._computedUpdateInterval=0,this._worker=this._createWorker(),this._constants={}},e.extend(e.Context,e.Emitter),e.Emitter.mixin(e.Context),e.Context.prototype._defineProperty=function(c,l){this.isUndef(this[l])&&Object.defineProperty(this,l,{get:function(){return typeof c[l]=="function"?c[l].bind(c):c[l]},set:function(m){c[l]=m}})},e.Context.prototype.now=function(){return this._context.currentTime},e.Context.prototype._createWorker=function(){window.URL=window.URL||window.webkitURL;var c=new Blob(["var timeoutTime = "+(1e3*this._updateInterval).toFixed(1)+";self.onmessage = function(msg){	timeoutTime = parseInt(msg.data);};function tick(){	setTimeout(tick, timeoutTime);	self.postMessage('tick');}tick();"]),l=URL.createObjectURL(c),m=new Worker(l);return m.addEventListener("message",(function(){this.emit("tick")}).bind(this)),m.addEventListener("message",(function(){var d=this.now();if(this.isNumber(this._lastUpdate)){var a=d-this._lastUpdate;this._computedUpdateInterval=Math.max(a,.97*this._computedUpdateInterval)}this._lastUpdate=d}).bind(this)),m},e.Context.prototype.getConstant=function(c){if(this._constants[c])return this._constants[c];for(var l=this._context.createBuffer(1,128,this._context.sampleRate),m=l.getChannelData(0),d=0;d<m.length;d++)m[d]=c;var a=this._context.createBufferSource();return a.channelCount=1,a.channelCountMode="explicit",a.buffer=l,a.loop=!0,a.start(0),this._constants[c]=a},Object.defineProperty(e.Context.prototype,"lag",{get:function(){var c=this._computedUpdateInterval-this._updateInterval;return c=Math.max(c,0)}}),Object.defineProperty(e.Context.prototype,"lookAhead",{get:function(){return this._lookAhead},set:function(c){this._lookAhead=c}}),Object.defineProperty(e.Context.prototype,"updateInterval",{get:function(){return this._updateInterval},set:function(c){this._updateInterval=Math.max(c,e.prototype.blockTime),this._worker.postMessage(Math.max(1e3*c,1))}}),Object.defineProperty(e.Context.prototype,"latencyHint",{get:function(){return this._latencyHint},set:function(c){var l=c;if(this._latencyHint=c,this.isString(c))switch(c){case"interactive":l=.1,this._context.latencyHint=c;break;case"playback":l=.8,this._context.latencyHint=c;break;case"balanced":l=.25,this._context.latencyHint=c;break;case"fastest":l=.01}this.lookAhead=l,this.updateInterval=l/3}}),e.supported?(i=AudioNode.prototype.connect,u=AudioNode.prototype.disconnect,AudioNode.prototype.connect!==n&&(AudioNode.prototype.connect=n,AudioNode.prototype.disconnect=function(c,l,m){if(c&&c.input&&Array.isArray(c.input))e.prototype.isUndef(m)&&(m=0),this.disconnect(c.input[m],l,m);else if(c&&c.input)this.disconnect(c.input,l,m);else try{u.apply(this,arguments)}catch(d){throw new Error("error disconnecting node: "+c+`
`+d)}}),e.context=new e.Context):console.warn("This browser does not support Tone.js"),e.Context}).apply(R,P),h!==void 0&&(S.exports=h)},function(S,R,T){var P,h;P=[T(0),T(4),T(20),T(2),T(10)],h=(function(e){return e.Subtract=function(n){this.createInsOuts(2,0),this._sum=this.input[0]=this.output=new e.Gain,this._neg=new e.Negate,this._param=this.input[1]=new e.Signal(n),this._param.chain(this._neg,this._sum)},e.extend(e.Subtract,e.Signal),e.Subtract.prototype.dispose=function(){return e.prototype.dispose.call(this),this._neg.dispose(),this._neg=null,this._sum.disconnect(),this._sum=null,this._param.dispose(),this._param=null,this},e.Subtract}).apply(R,P),h!==void 0&&(S.exports=h)},function(S,R,T){var P,h;P=[T(0)],h=(function(e){return e.Emitter=function(){this._events={}},e.extend(e.Emitter),e.Emitter.prototype.on=function(n,i){for(var u=n.split(/\W+/),c=0;c<u.length;c++){var l=u[c];this._events.hasOwnProperty(l)||(this._events[l]=[]),this._events[l].push(i)}return this},e.Emitter.prototype.off=function(n,i){for(var u=n.split(/\W+/),c=0;c<u.length;c++)if(n=u[c],this._events.hasOwnProperty(n))if(e.prototype.isUndef(i))this._events[n]=[];else for(var l=this._events[n],m=0;m<l.length;m++)l[m]===i&&l.splice(m,1);return this},e.Emitter.prototype.emit=function(n){if(this._events){var i=Array.apply(null,arguments).slice(1);if(this._events.hasOwnProperty(n))for(var u=this._events[n],c=0,l=u.length;c<l;c++)u[c].apply(this,i)}return this},e.Emitter.mixin=function(n){var i=["on","off","emit"];n._events={};for(var u=0;u<i.length;u++){var c=i[u],l=e.Emitter.prototype[c];n[c]=l}},e.Emitter.prototype.dispose=function(){return e.prototype.dispose.call(this),this._events=null,this},e.Emitter}).apply(R,P),h!==void 0&&(S.exports=h)},function(S,R,T){var P,h;P=[T(0)],h=(function(e){return e.SignalBase=function(){},e.extend(e.SignalBase),e.SignalBase.prototype.connect=function(n,i,u){return e.Signal&&e.Signal===n.constructor||e.Param&&e.Param===n.constructor||e.TimelineSignal&&e.TimelineSignal===n.constructor?(n._param.cancelScheduledValues(0),n._param.value=0,n.overridden=!0):n instanceof AudioParam&&(n.cancelScheduledValues(0),n.value=0),e.prototype.connect.call(this,n,i,u),this},e.SignalBase}).apply(R,P),h!==void 0&&(S.exports=h)},function(S,R,T){var P,h;P=[T(0),T(17)],h=(function(e){return e.Time=function(n,i){if(!(this instanceof e.Time))return new e.Time(n,i);this._plusNow=!1,e.TimeBase.call(this,n,i)},e.extend(e.Time,e.TimeBase),e.Time.prototype._unaryExpressions=Object.create(e.TimeBase.prototype._unaryExpressions),e.Time.prototype._unaryExpressions.quantize={regexp:/^@/,method:function(n){return e.Transport.nextSubdivision(n())}},e.Time.prototype._unaryExpressions.now={regexp:/^\+/,method:function(n){return this._plusNow=!0,n()}},e.Time.prototype.quantize=function(n,i){return i=this.defaultArg(i,1),this._expr=(function(u,c,l){return u=u(),c=c.toSeconds(),u+(Math.round(u/c)*c-u)*l}).bind(this,this._expr,new this.constructor(n),i),this},e.Time.prototype.addNow=function(){return this._plusNow=!0,this},e.Time.prototype._defaultExpr=function(){return this._plusNow=!0,this._noOp},e.Time.prototype.copy=function(n){return e.TimeBase.prototype.copy.call(this,n),this._plusNow=n._plusNow,this},e.Time.prototype.toNotation=function(){var n=this.toSeconds(),i=this._toNotationHelper(n,["1m","2n","4n","8n","16n","32n","64n","128n"]),u=this._toNotationHelper(n,["1m","2n","2t","4n","4t","8n","8t","16n","16t","32n","32t","64n","64t","128n"]);return u.split("+").length<i.split("+").length?u:i},e.Time.prototype._toNotationHelper=function(n,i){for(var u=this._notationToUnits(i[i.length-1]),c="",l=0;l<i.length;l++){var m=this._notationToUnits(i[l]),d=n/m;if(1-d%1<1e-6&&(d+=1e-6),0<(d=Math.floor(d))){if(c+=d===1?i[l]:d.toString()+"*"+i[l],(n-=d*m)<u)break;c+=" + "}}return c===""&&(c="0"),c},e.Time.prototype._notationToUnits=function(n){for(var i=this._primaryExpressions,u=[i.n,i.t,i.m],c=0;c<u.length;c++){var l=u[c],m=n.match(l.regexp);if(m)return l.method.call(this,m[1])}},e.Time.prototype.toBarsBeatsSixteenths=function(){var n=this._beatsToUnits(1),i=this.toSeconds()/n,u=Math.floor(i/this._timeSignature()),c=i%1*4;return i=Math.floor(i)%this._timeSignature(),3<(c=c.toString()).length&&(c=parseFloat(c).toFixed(3)),[u,i,c].join(":")},e.Time.prototype.toTicks=function(){var n=this._beatsToUnits(1),i=this.valueOf()/n;return Math.floor(i*e.Transport.PPQ)},e.Time.prototype.toSamples=function(){return this.toSeconds()*this.context.sampleRate},e.Time.prototype.toFrequency=function(){return 1/this.toSeconds()},e.Time.prototype.toSeconds=function(){return this.valueOf()},e.Time.prototype.toMilliseconds=function(){return 1e3*this.toSeconds()},e.Time.prototype.valueOf=function(){return this._expr()+(this._plusNow?this.now():0)},e.Time}).apply(R,P),h!==void 0&&(S.exports=h)},function(S,R,T){var P,h;P=[T(0)],h=(function(e){return e.TimeBase=function(n,i){if(!(this instanceof e.TimeBase))return new e.TimeBase(n,i);if(this._expr=this._noOp,n instanceof e.TimeBase)this.copy(n);else if(!this.isUndef(i)||this.isNumber(n)){i=this.defaultArg(i,this._defaultUnits);var u=this._primaryExpressions[i].method;this._expr=u.bind(this,n)}else this.isString(n)?this.set(n):this.isUndef(n)&&(this._expr=this._defaultExpr())},e.extend(e.TimeBase),e.TimeBase.prototype.set=function(n){return this._expr=this._parseExprString(n),this},e.TimeBase.prototype.clone=function(){var n=new this.constructor;return n.copy(this),n},e.TimeBase.prototype.copy=function(n){var i=n._expr();return this.set(i)},e.TimeBase.prototype._primaryExpressions={n:{regexp:/^(\d+)n/i,method:function(n){return(n=parseInt(n))===1?this._beatsToUnits(this._timeSignature()):this._beatsToUnits(4/n)}},t:{regexp:/^(\d+)t/i,method:function(n){return n=parseInt(n),this._beatsToUnits(8/(3*parseInt(n)))}},m:{regexp:/^(\d+)m/i,method:function(n){return this._beatsToUnits(parseInt(n)*this._timeSignature())}},i:{regexp:/^(\d+)i/i,method:function(n){return this._ticksToUnits(parseInt(n))}},hz:{regexp:/^(\d+(?:\.\d+)?)hz/i,method:function(n){return this._frequencyToUnits(parseFloat(n))}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method:function(n,i,u){var c=0;return n&&n!=="0"&&(c+=this._beatsToUnits(this._timeSignature()*parseFloat(n))),i&&i!=="0"&&(c+=this._beatsToUnits(parseFloat(i))),u&&u!=="0"&&(c+=this._beatsToUnits(parseFloat(u)/4)),c}},s:{regexp:/^(\d+(?:\.\d+)?s)/,method:function(n){return this._secondsToUnits(parseFloat(n))}},samples:{regexp:/^(\d+)samples/,method:function(n){return parseInt(n)/this.context.sampleRate}},default:{regexp:/^(\d+(?:\.\d+)?)/,method:function(n){return this._primaryExpressions[this._defaultUnits].method.call(this,n)}}},e.TimeBase.prototype._binaryExpressions={"+":{regexp:/^\+/,precedence:2,method:function(n,i){return n()+i()}},"-":{regexp:/^\-/,precedence:2,method:function(n,i){return n()-i()}},"*":{regexp:/^\*/,precedence:1,method:function(n,i){return n()*i()}},"/":{regexp:/^\//,precedence:1,method:function(n,i){return n()/i()}}},e.TimeBase.prototype._unaryExpressions={neg:{regexp:/^\-/,method:function(n){return-n()}}},e.TimeBase.prototype._syntaxGlue={"(":{regexp:/^\(/},")":{regexp:/^\)/}},e.TimeBase.prototype._tokenize=function(n){for(var i=-1,u=[];0<n.length;){var c=l(n=n.trim(),this);u.push(c),n=n.substr(c.value.length)}function l(m,d){for(var a=["_binaryExpressions","_unaryExpressions","_primaryExpressions","_syntaxGlue"],y=0;y<a.length;y++){var v=d[a[y]];for(var _ in v){var w=v[_],k=w.regexp,A=m.match(k);if(A!==null)return{method:w.method,precedence:w.precedence,regexp:w.regexp,value:A[0]}}}throw new SyntaxError("Tone.TimeBase: Unexpected token "+m)}return{next:function(){return u[++i]},peek:function(){return u[i+1]}}},e.TimeBase.prototype._matchGroup=function(n,i,u){if(!this.isUndef(n))for(var c in i){var l=i[c];if(l.regexp.test(n.value)&&(this.isUndef(u)||l.precedence===u))return l}return!1},e.TimeBase.prototype._parseBinary=function(n,i){var u;this.isUndef(i)&&(i=2),u=i<0?this._parseUnary(n):this._parseBinary(n,i-1);for(var c=n.peek();c&&this._matchGroup(c,this._binaryExpressions,i);)u=(c=n.next()).method.bind(this,u,this._parseBinary(n,i-1)),c=n.peek();return u},e.TimeBase.prototype._parseUnary=function(n){var i,u;i=n.peek();var c=this._matchGroup(i,this._unaryExpressions);return c?(i=n.next(),u=this._parseUnary(n),c.method.bind(this,u)):this._parsePrimary(n)},e.TimeBase.prototype._parsePrimary=function(n){var i,u;if(i=n.peek(),this.isUndef(i))throw new SyntaxError("Tone.TimeBase: Unexpected end of expression");if(this._matchGroup(i,this._primaryExpressions)){var c=(i=n.next()).value.match(i.regexp);return i.method.bind(this,c[1],c[2],c[3])}if(i&&i.value==="("){if(n.next(),u=this._parseBinary(n),!(i=n.next())||i.value!==")")throw new SyntaxError("Expected )");return u}throw new SyntaxError("Tone.TimeBase: Cannot process token "+i.value)},e.TimeBase.prototype._parseExprString=function(n){this.isString(n)||(n=n.toString());var i=this._tokenize(n);return this._parseBinary(i)},e.TimeBase.prototype._noOp=function(){return 0},e.TimeBase.prototype._defaultExpr=function(){return this._noOp},e.TimeBase.prototype._defaultUnits="s",e.TimeBase.prototype._frequencyToUnits=function(n){return 1/n},e.TimeBase.prototype._beatsToUnits=function(n){return 60/e.Transport.bpm.value*n},e.TimeBase.prototype._secondsToUnits=function(n){return n},e.TimeBase.prototype._ticksToUnits=function(n){return n*(this._beatsToUnits(1)/e.Transport.PPQ)},e.TimeBase.prototype._timeSignature=function(){return e.Transport.timeSignature},e.TimeBase.prototype._pushExpr=function(n,i,u){return n instanceof e.TimeBase||(n=new this.constructor(n,u)),this._expr=this._binaryExpressions[i].method.bind(this,this._expr,n._expr),this},e.TimeBase.prototype.add=function(n,i){return this._pushExpr(n,"+",i)},e.TimeBase.prototype.sub=function(n,i){return this._pushExpr(n,"-",i)},e.TimeBase.prototype.mult=function(n,i){return this._pushExpr(n,"*",i)},e.TimeBase.prototype.div=function(n,i){return this._pushExpr(n,"/",i)},e.TimeBase.prototype.valueOf=function(){return this._expr()},e.TimeBase.prototype.dispose=function(){this._expr=null},e.TimeBase}).apply(R,P),h!==void 0&&(S.exports=h)},function(S,R,T){var P,h;P=[T(0),T(9)],h=(function(e){return e.Param=function(){var n=this.optionsObject(arguments,["param","units","convert"],e.Param.defaults);this._param=this.input=n.param,this.units=n.units,this.convert=n.convert,this.overridden=!1,this._lfo=null,this.isObject(n.lfo)?this.value=n.lfo:this.isUndef(n.value)||(this.value=n.value)},e.extend(e.Param),e.Param.defaults={units:e.Type.Default,convert:!0,param:void 0},Object.defineProperty(e.Param.prototype,"value",{get:function(){return this._toUnits(this._param.value)},set:function(n){if(this.isObject(n)){if(this.isUndef(e.LFO))throw new Error("Include 'Tone.LFO' to use an LFO as a Param value.");this._lfo&&this._lfo.dispose(),this._lfo=new e.LFO(n).start(),this._lfo.connect(this.input)}else{var i=this._fromUnits(n);this._param.cancelScheduledValues(0),this._param.value=i}}}),e.Param.prototype._fromUnits=function(n){if(!this.convert&&!this.isUndef(this.convert))return n;switch(this.units){case e.Type.Time:return this.toSeconds(n);case e.Type.Frequency:return this.toFrequency(n);case e.Type.Decibels:return this.dbToGain(n);case e.Type.NormalRange:return Math.min(Math.max(n,0),1);case e.Type.AudioRange:return Math.min(Math.max(n,-1),1);case e.Type.Positive:return Math.max(n,0);default:return n}},e.Param.prototype._toUnits=function(n){if(!this.convert&&!this.isUndef(this.convert))return n;switch(this.units){case e.Type.Decibels:return this.gainToDb(n);default:return n}},e.Param.prototype._minOutput=1e-5,e.Param.prototype.setValueAtTime=function(n,i){return n=this._fromUnits(n),(i=this.toSeconds(i))<=this.now()+this.blockTime?this._param.value=n:this._param.setValueAtTime(n,i),this},e.Param.prototype.setRampPoint=function(n){n=this.defaultArg(n,this.now());var i=this._param.value;return i===0&&(i=this._minOutput),this._param.setValueAtTime(i,n),this},e.Param.prototype.linearRampToValueAtTime=function(n,i){return n=this._fromUnits(n),this._param.linearRampToValueAtTime(n,this.toSeconds(i)),this},e.Param.prototype.exponentialRampToValueAtTime=function(n,i){return n=this._fromUnits(n),n=Math.max(this._minOutput,n),this._param.exponentialRampToValueAtTime(n,this.toSeconds(i)),this},e.Param.prototype.exponentialRampToValue=function(n,i,u){return u=this.toSeconds(u),this.setRampPoint(u),this.exponentialRampToValueAtTime(n,u+this.toSeconds(i)),this},e.Param.prototype.linearRampToValue=function(n,i,u){return u=this.toSeconds(u),this.setRampPoint(u),this.linearRampToValueAtTime(n,u+this.toSeconds(i)),this},e.Param.prototype.setTargetAtTime=function(n,i,u){return n=this._fromUnits(n),n=Math.max(this._minOutput,n),u=Math.max(this._minOutput,u),this._param.setTargetAtTime(n,this.toSeconds(i),u),this},e.Param.prototype.setValueCurveAtTime=function(n,i,u){for(var c=0;c<n.length;c++)n[c]=this._fromUnits(n[c]);return this._param.setValueCurveAtTime(n,this.toSeconds(i),this.toSeconds(u)),this},e.Param.prototype.cancelScheduledValues=function(n){return this._param.cancelScheduledValues(this.toSeconds(n)),this},e.Param.prototype.rampTo=function(n,i,u){return i=this.defaultArg(i,0),this.units===e.Type.Frequency||this.units===e.Type.BPM||this.units===e.Type.Decibels?this.exponentialRampToValue(n,i,u):this.linearRampToValue(n,i,u),this},Object.defineProperty(e.Param.prototype,"lfo",{get:function(){return this._lfo}}),e.Param.prototype.dispose=function(){return e.prototype.dispose.call(this),this._param=null,this._lfo&&(this._lfo.dispose(),this._lfo=null),this},e.Param}).apply(R,P),h!==void 0&&(S.exports=h)},function(S,R,T){var P,h;P=[T(0),T(9)],h=(function(e){return e.Timeline=function(){var n=this.optionsObject(arguments,["memory"],e.Timeline.defaults);this._timeline=[],this._toRemove=[],this._iterating=!1,this.memory=n.memory},e.extend(e.Timeline),e.Timeline.defaults={memory:1/0},Object.defineProperty(e.Timeline.prototype,"length",{get:function(){return this._timeline.length}}),e.Timeline.prototype.add=function(n){if(this.isUndef(n.time))throw new Error("Tone.Timeline: events must have a time attribute");if(this._timeline.length){var i=this._search(n.time);this._timeline.splice(i+1,0,n)}else this._timeline.push(n);if(this.length>this.memory){var u=this.length-this.memory;this._timeline.splice(0,u)}return this},e.Timeline.prototype.remove=function(n){if(this._iterating)this._toRemove.push(n);else{var i=this._timeline.indexOf(n);i!==-1&&this._timeline.splice(i,1)}return this},e.Timeline.prototype.get=function(n){var i=this._search(n);return i!==-1?this._timeline[i]:null},e.Timeline.prototype.peek=function(){return this._timeline[0]},e.Timeline.prototype.shift=function(){return this._timeline.shift()},e.Timeline.prototype.getAfter=function(n){var i=this._search(n);return i+1<this._timeline.length?this._timeline[i+1]:null},e.Timeline.prototype.getBefore=function(n){var i=this._timeline.length;if(0<i&&this._timeline[i-1].time<n)return this._timeline[i-1];var u=this._search(n);return 0<=u-1?this._timeline[u-1]:null},e.Timeline.prototype.cancel=function(n){if(1<this._timeline.length){var i=this._search(n);if(0<=i)if(this._timeline[i].time===n){for(var u=i;0<=u&&this._timeline[u].time===n;u--)i=u;this._timeline=this._timeline.slice(0,i)}else this._timeline=this._timeline.slice(0,i+1);else this._timeline=[]}else this._timeline.length===1&&this._timeline[0].time>=n&&(this._timeline=[]);return this},e.Timeline.prototype.cancelBefore=function(n){if(this._timeline.length){var i=this._search(n);0<=i&&(this._timeline=this._timeline.slice(i+1))}return this},e.Timeline.prototype._search=function(n){var i=0,u=this._timeline.length,c=u;if(0<u&&this._timeline[u-1].time<=n)return u-1;for(;i<c;){var l=Math.floor(i+(c-i)/2),m=this._timeline[l],d=this._timeline[l+1];if(m.time===n){for(var a=l;a<this._timeline.length;a++)this._timeline[a].time===n&&(l=a);return l}if(m.time<n&&d.time>n)return l;m.time>n?c=l:m.time<n&&(i=l+1)}return-1},e.Timeline.prototype._iterate=function(n,i,u){this._iterating=!0,i=this.defaultArg(i,0),u=this.defaultArg(u,this._timeline.length-1);for(var c=i;c<=u;c++)n(this._timeline[c]);if(this._iterating=!1,0<this._toRemove.length){for(var l=0;l<this._toRemove.length;l++){var m=this._timeline.indexOf(this._toRemove[l]);m!==-1&&this._timeline.splice(m,1)}this._toRemove=[]}},e.Timeline.prototype.forEach=function(n){return this._iterate(n),this},e.Timeline.prototype.forEachBefore=function(n,i){var u=this._search(n);return u!==-1&&this._iterate(i,0,u),this},e.Timeline.prototype.forEachAfter=function(n,i){var u=this._search(n);return this._iterate(i,u+1),this},e.Timeline.prototype.forEachFrom=function(n,i){for(var u=this._search(n);0<=u&&this._timeline[u].time>=n;)u--;return this._iterate(i,u+1),this},e.Timeline.prototype.forEachAtTime=function(n,i){var u=this._search(n);return u!==-1&&this._iterate(function(c){c.time===n&&i(c)},0,u),this},e.Timeline.prototype.dispose=function(){e.prototype.dispose.call(this),this._timeline=null,this._toRemove=null},e.Timeline}).apply(R,P),h!==void 0&&(S.exports=h)},function(S,R,T){var P,h;P=[T(0),T(1),T(2)],h=(function(e){return e.Negate=function(){this._multiply=this.input=this.output=new e.Multiply(-1)},e.extend(e.Negate,e.SignalBase),e.Negate.prototype.dispose=function(){return e.prototype.dispose.call(this),this._multiply.dispose(),this._multiply=null,this},e.Negate}).apply(R,P),h!==void 0&&(S.exports=h)},function(S,R,T){var P,h;P=[T(0),T(2),T(1),T(6)],h=(function(e){return e.GreaterThanZero=function(){this._thresh=this.output=new e.WaveShaper(function(n){return n<=0?0:1},127),this._scale=this.input=new e.Multiply(1e4),this._scale.connect(this._thresh)},e.extend(e.GreaterThanZero,e.SignalBase),e.GreaterThanZero.prototype.dispose=function(){return e.prototype.dispose.call(this),this._scale.dispose(),this._scale=null,this._thresh.dispose(),this._thresh=null,this},e.GreaterThanZero}).apply(R,P),h!==void 0&&(S.exports=h)},function(S,R,T){var P,h,e;(function(n,i){h=[],P=i,e=typeof P=="function"?P.apply(R,h):P,e!==void 0&&(S.exports=e)})(this,function(){var n=function(u,c){this._dragged=!1,this._element=u,this._bindedMove=this._moved.bind(this),this._bindedEnd=this._ended.bind(this,c),u.addEventListener("touchstart",this._bindedEnd),u.addEventListener("touchmove",this._bindedMove),u.addEventListener("touchend",this._bindedEnd),u.addEventListener("mouseup",this._bindedEnd)};function i(u){return u.state==="running"}return n.prototype._moved=function(u){this._dragged=!0},n.prototype._ended=function(u){this._dragged||function(c){var l=c.createBuffer(1,1,c.sampleRate),m=c.createBufferSource();m.buffer=l,m.connect(c.destination),m.start(0),c.resume&&c.resume()}(u),this._dragged=!1},n.prototype.dispose=function(){this._element.removeEventListener("touchstart",this._bindedEnd),this._element.removeEventListener("touchmove",this._bindedMove),this._element.removeEventListener("touchend",this._bindedEnd),this._element.removeEventListener("mouseup",this._bindedEnd),this._bindedMove=null,this._bindedEnd=null,this._element=null},function(u,c,l){var m=new Promise(function(a){(function(y,v){i(y)?v():function _(){i(y)?v():(requestAnimationFrame(_),y.resume&&y.resume())}()})(u,a)}),d=[];return function a(y,v,_){if(Array.isArray(y)||NodeList&&y instanceof NodeList)for(var w=0;w<y.length;w++)a(y[w],v,_);else if(typeof y=="string")a(document.querySelectorAll(y),v,_);else if(y.jquery&&typeof y.toArray=="function")a(y.toArray(),v,_);else if(Element&&y instanceof Element){var k=new n(y,_);v.push(k)}}(c=c||document.body,d,u),m.then(function(){for(var a=0;a<d.length;a++)d[a].dispose();d=null,l&&l()}),m}})},function(S,R,T){var P,h;P=[T(0),T(2),T(32),T(38),T(10)],h=(function(e){return e.CrossFade=function(n){this.createInsOuts(2,1),this.a=this.input[0]=new e.Gain,this.b=this.input[1]=new e.Gain,this.fade=new e.Signal(this.defaultArg(n,.5),e.Type.NormalRange),this._equalPowerA=new e.EqualPowerGain,this._equalPowerB=new e.EqualPowerGain,this._invert=new e.Expr("1 - $0"),this.a.connect(this.output),this.b.connect(this.output),this.fade.chain(this._equalPowerB,this.b.gain),this.fade.chain(this._invert,this._equalPowerA,this.a.gain),this._readOnly("fade")},e.extend(e.CrossFade),e.CrossFade.prototype.dispose=function(){return e.prototype.dispose.call(this),this._writable("fade"),this._equalPowerA.dispose(),this._equalPowerA=null,this._equalPowerB.dispose(),this._equalPowerB=null,this.fade.dispose(),this.fade=null,this._invert.dispose(),this._invert=null,this.a.dispose(),this.a=null,this.b.dispose(),this.b=null,this},e.CrossFade}).apply(R,P),h!==void 0&&(S.exports=h)},function(S,R){(function(){var T,P=[];function h(u){var c=this,l={},m=-1;this.parameters.forEach(function(y,v){var _=P[++m]||(P[m]=new Float32Array(c.bufferSize));_.fill(y.value),l[v]=_}),this.processor.realm.exec("self.sampleRate=sampleRate="+this.context.sampleRate+";self.currentTime=currentTime="+this.context.currentTime);var d=e(u.inputBuffer),a=e(u.outputBuffer);this.instance.process([d],[a],l)}function e(u){for(var c=[],l=0;l<u.numberOfChannels;l++)c[l]=u.getChannelData(l);return c}function n(u){return u.$$processors||(u.$$processors={})}function i(u){this.$$context=u}typeof AudioWorkletNode!="function"&&(self.AudioWorkletNode=function(u,c,l){var m=n(u)[c],d=u.createScriptProcessor(void 0,2,l&&l.outputChannelCount?l.outputChannelCount[0]:2);if(d.parameters=new Map,m.properties)for(var a=0;a<m.properties.length;a++){var y=m.properties[a],v=u.createGain().gain;v.value=y.defaultValue,d.parameters.set(y.name,v)}var _=new MessageChannel;T=_.port2;var w=new m.Processor(l||{});return T=null,d.port=_.port1,d.processor=m,d.instance=w,d.onaudioprocess=h,d},Object.defineProperty((self.AudioContext||self.webkitAudioContext).prototype,"audioWorklet",{get:function(){return this.$$audioWorklet||(this.$$audioWorklet=new self.AudioWorklet(this))}}),self.AudioWorklet=(i.prototype.addModule=function(u,c){var l=this;return fetch(u).then(function(m){if(!m.ok)throw Error(m.status);return m.text()}).then(function(m){var d={sampleRate:0,currentTime:0,AudioWorkletProcessor:function(){this.port=T},registerProcessor:function(y,v){n(l.$$context)[y]={realm:a,context:d,Processor:v,properties:v.parameterDescriptors||[]}}},a=new function(y,v){var _=document.createElement("iframe");_.style.cssText="position:absolute;left:0;top:-999px;width:1px;height:1px;",v.appendChild(_);var w=_.contentWindow,k=w.document,A="var window,$hook";for(var D in w)D in y||D==="eval"||(A+=",",A+=D);for(var g in y)A+=",",A+=g,A+="=self.",A+=g;var b=k.createElement("script");b.appendChild(k.createTextNode(`function $hook(self,console) {"use strict";
        `+A+";return function() {return eval(arguments[0])}}")),k.body.appendChild(b),this.exec=w.$hook(y,console)}(d.self=d,document.documentElement);return a.exec((c&&c.transpile||String)(m)),null})},i))})()},function(S,R){(function(){function u(c){c&&(c.setTargetAtTime||(c.setTargetAtTime=c.setTargetValueAtTime))}window.hasOwnProperty("webkitAudioContext")&&!window.hasOwnProperty("AudioContext")&&(window.AudioContext=window.webkitAudioContext,typeof AudioContext.prototype.createGain!="function"&&(AudioContext.prototype.createGain=AudioContext.prototype.createGainNode),typeof AudioContext.prototype.createDelay!="function"&&(AudioContext.prototype.createDelay=AudioContext.prototype.createDelayNode),typeof AudioContext.prototype.createScriptProcessor!="function"&&(AudioContext.prototype.createScriptProcessor=AudioContext.prototype.createJavaScriptNode),typeof AudioContext.prototype.createPeriodicWave!="function"&&(AudioContext.prototype.createPeriodicWave=AudioContext.prototype.createWaveTable),AudioContext.prototype.internal_createGain=AudioContext.prototype.createGain,AudioContext.prototype.createGain=function(){var c=this.internal_createGain();return u(c.gain),c},AudioContext.prototype.internal_createDelay=AudioContext.prototype.createDelay,AudioContext.prototype.createDelay=function(c){var l=c?this.internal_createDelay(c):this.internal_createDelay();return u(l.delayTime),l},AudioContext.prototype.internal_createBufferSource=AudioContext.prototype.createBufferSource,AudioContext.prototype.createBufferSource=function(){var c=this.internal_createBufferSource();return c.start?(c.internal_start=c.start,c.start=function(l,m,d){typeof d<"u"?c.internal_start(l||0,m,d):c.internal_start(l||0,m||0)}):c.start=function(l,m,d){m||d?this.noteGrainOn(l||0,m,d):this.noteOn(l||0)},c.stop?(c.internal_stop=c.stop,c.stop=function(l){c.internal_stop(l||0)}):c.stop=function(l){this.noteOff(l||0)},u(c.playbackRate),c},AudioContext.prototype.internal_createDynamicsCompressor=AudioContext.prototype.createDynamicsCompressor,AudioContext.prototype.createDynamicsCompressor=function(){var c=this.internal_createDynamicsCompressor();return u(c.threshold),u(c.knee),u(c.ratio),u(c.reduction),u(c.attack),u(c.release),c},AudioContext.prototype.internal_createBiquadFilter=AudioContext.prototype.createBiquadFilter,AudioContext.prototype.createBiquadFilter=function(){var c=this.internal_createBiquadFilter();return u(c.frequency),u(c.detune),u(c.Q),u(c.gain),c},typeof AudioContext.prototype.createOscillator!="function"&&(AudioContext.prototype.internal_createOscillator=AudioContext.prototype.createOscillator,AudioContext.prototype.createOscillator=function(){var c=this.internal_createOscillator();return c.start?(c.internal_start=c.start,c.start=function(l){c.internal_start(l||0)}):c.start=function(l){this.noteOn(l||0)},c.stop?(c.internal_stop=c.stop,c.stop=function(l){c.internal_stop(l||0)}):c.stop=function(l){this.noteOff(l||0)},c.setPeriodicWave||(c.setPeriodicWave=c.setWaveTable),u(c.frequency),u(c.detune),c})),window.hasOwnProperty("webkitOfflineAudioContext")&&!window.hasOwnProperty("OfflineAudioContext")&&(window.OfflineAudioContext=window.webkitOfflineAudioContext)})(),navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;var T=document.createElement("audio");p5.prototype.isSupported=function(){return!!T.canPlayType};var P=function(){return!!T.canPlayType&&T.canPlayType('audio/ogg; codecs="vorbis"')},h=function(){return!!T.canPlayType&&T.canPlayType("audio/mpeg;")},e=function(){return!!T.canPlayType&&T.canPlayType('audio/wav; codecs="1"')},n=function(){return!!T.canPlayType&&(T.canPlayType("audio/x-m4a;")||T.canPlayType("audio/aac;"))},i=function(){return!!T.canPlayType&&T.canPlayType("audio/x-aiff;")};p5.prototype.isFileSupported=function(u){switch(u.toLowerCase()){case"mp3":return h();case"wav":return e();case"ogg":return P();case"aac":case"m4a":case"mp4":return n();case"aif":case"aiff":return i();default:return!1}}},function(S,R){var T;T=function(){return this}();try{T=T||new Function("return this")()}catch{typeof window=="object"&&(T=window)}S.exports=T},function(S,R,T){T.r(R),R.default=`function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _wrapNativeSuper(Class) { var _cache = typeof Map === "function" ? new Map() : undefined; _wrapNativeSuper = function _wrapNativeSuper(Class) { if (Class === null || !_isNativeFunction(Class)) return Class; if (typeof Class !== "function") { throw new TypeError("Super expression must either be null or a function"); } if (typeof _cache !== "undefined") { if (_cache.has(Class)) return _cache.get(Class); _cache.set(Class, Wrapper); } function Wrapper() { return _construct(Class, arguments, _getPrototypeOf(this).constructor); } Wrapper.prototype = Object.create(Class.prototype, { constructor: { value: Wrapper, enumerable: false, writable: true, configurable: true } }); return _setPrototypeOf(Wrapper, Class); }; return _wrapNativeSuper(Class); }

function isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function _construct(Parent, args, Class) { if (isNativeReflectConstruct()) { _construct = Reflect.construct; } else { _construct = function _construct(Parent, args, Class) { var a = [null]; a.push.apply(a, args); var Constructor = Function.bind.apply(Parent, a); var instance = new Constructor(); if (Class) _setPrototypeOf(instance, Class.prototype); return instance; }; } return _construct.apply(null, arguments); }

function _isNativeFunction(fn) { return Function.toString.call(fn).indexOf("[native code]") !== -1; }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

// import dependencies via preval.require so that they're available as values at compile time
var processorNames = {
  "recorderProcessor": "recorder-processor",
  "soundFileProcessor": "sound-file-processor",
  "amplitudeProcessor": "amplitude-processor"
};
var RingBuffer = {
  "default":
  /*#__PURE__*/
  function () {
    /**
     * @constructor
     * @param  {number} length Buffer length in frames.
     * @param  {number} channelCount Buffer channel count.
     */
    function RingBuffer(length, channelCount) {
      _classCallCheck(this, RingBuffer);

      this._readIndex = 0;
      this._writeIndex = 0;
      this._framesAvailable = 0;
      this._channelCount = channelCount;
      this._length = length;
      this._channelData = [];

      for (var i = 0; i < this._channelCount; ++i) {
        this._channelData[i] = new Float32Array(length);
      }
    }
    /**
     * Getter for Available frames in buffer.
     *
     * @return {number} Available frames in buffer.
     */


    _createClass(RingBuffer, [{
      key: "push",

      /**
       * Push a sequence of Float32Arrays to buffer.
       *
       * @param  {array} arraySequence A sequence of Float32Arrays.
       */
      value: function push(arraySequence) {
        // The channel count of arraySequence and the length of each channel must
        // match with this buffer obejct.
        // Transfer data from the |arraySequence| storage to the internal buffer.
        var sourceLength = arraySequence[0] ? arraySequence[0].length : 0;

        for (var i = 0; i < sourceLength; ++i) {
          var writeIndex = (this._writeIndex + i) % this._length;

          for (var channel = 0; channel < this._channelCount; ++channel) {
            this._channelData[channel][writeIndex] = arraySequence[channel][i];
          }
        }

        this._writeIndex += sourceLength;

        if (this._writeIndex >= this._length) {
          this._writeIndex = 0;
        } // For excessive frames, the buffer will be overwritten.


        this._framesAvailable += sourceLength;

        if (this._framesAvailable > this._length) {
          this._framesAvailable = this._length;
        }
      }
      /**
       * Pull data out of buffer and fill a given sequence of Float32Arrays.
       *
       * @param  {array} arraySequence An array of Float32Arrays.
       */

    }, {
      key: "pull",
      value: function pull(arraySequence) {
        // The channel count of arraySequence and the length of each channel must
        // match with this buffer obejct.
        // If the FIFO is completely empty, do nothing.
        if (this._framesAvailable === 0) {
          return;
        }

        var destinationLength = arraySequence[0].length; // Transfer data from the internal buffer to the |arraySequence| storage.

        for (var i = 0; i < destinationLength; ++i) {
          var readIndex = (this._readIndex + i) % this._length;

          for (var channel = 0; channel < this._channelCount; ++channel) {
            arraySequence[channel][i] = this._channelData[channel][readIndex];
          }
        }

        this._readIndex += destinationLength;

        if (this._readIndex >= this._length) {
          this._readIndex = 0;
        }

        this._framesAvailable -= destinationLength;

        if (this._framesAvailable < 0) {
          this._framesAvailable = 0;
        }
      }
    }, {
      key: "framesAvailable",
      get: function get() {
        return this._framesAvailable;
      }
    }]);

    return RingBuffer;
  }()
}["default"];

var RecorderProcessor =
/*#__PURE__*/
function (_AudioWorkletProcesso) {
  _inherits(RecorderProcessor, _AudioWorkletProcesso);

  function RecorderProcessor(options) {
    var _this;

    _classCallCheck(this, RecorderProcessor);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(RecorderProcessor).call(this));
    var processorOptions = options.processorOptions || {};
    _this.numOutputChannels = options.outputChannelCount || 2;
    _this.numInputChannels = processorOptions.numInputChannels || 2;
    _this.bufferSize = processorOptions.bufferSize || 1024;
    _this.recording = false;

    _this.clear();

    _this.port.onmessage = function (event) {
      var data = event.data;

      if (data.name === 'start') {
        _this.record(data.duration);
      } else if (data.name === 'stop') {
        _this.stop();
      }
    };

    return _this;
  }

  _createClass(RecorderProcessor, [{
    key: "process",
    value: function process(inputs) {
      if (!this.recording) {
        return true;
      } else if (this.sampleLimit && this.recordedSamples >= this.sampleLimit) {
        this.stop();
        return true;
      }

      var input = inputs[0];
      this.inputRingBuffer.push(input);

      if (this.inputRingBuffer.framesAvailable >= this.bufferSize) {
        this.inputRingBuffer.pull(this.inputRingBufferArraySequence);

        for (var channel = 0; channel < this.numOutputChannels; ++channel) {
          var inputChannelCopy = this.inputRingBufferArraySequence[channel].slice();

          if (channel === 0) {
            this.leftBuffers.push(inputChannelCopy);

            if (this.numInputChannels === 1) {
              this.rightBuffers.push(inputChannelCopy);
            }
          } else if (channel === 1 && this.numInputChannels > 1) {
            this.rightBuffers.push(inputChannelCopy);
          }
        }

        this.recordedSamples += this.bufferSize;
      }

      return true;
    }
  }, {
    key: "record",
    value: function record(duration) {
      if (duration) {
        this.sampleLimit = Math.round(duration * sampleRate);
      }

      this.recording = true;
    }
  }, {
    key: "stop",
    value: function stop() {
      this.recording = false;
      var buffers = this.getBuffers();
      var leftBuffer = buffers[0].buffer;
      var rightBuffer = buffers[1].buffer;
      this.port.postMessage({
        name: 'buffers',
        leftBuffer: leftBuffer,
        rightBuffer: rightBuffer
      }, [leftBuffer, rightBuffer]);
      this.clear();
    }
  }, {
    key: "getBuffers",
    value: function getBuffers() {
      var buffers = [];
      buffers.push(this.mergeBuffers(this.leftBuffers));
      buffers.push(this.mergeBuffers(this.rightBuffers));
      return buffers;
    }
  }, {
    key: "mergeBuffers",
    value: function mergeBuffers(channelBuffer) {
      var result = new Float32Array(this.recordedSamples);
      var offset = 0;
      var lng = channelBuffer.length;

      for (var i = 0; i < lng; i++) {
        var buffer = channelBuffer[i];
        result.set(buffer, offset);
        offset += buffer.length;
      }

      return result;
    }
  }, {
    key: "clear",
    value: function clear() {
      var _this2 = this;

      this.leftBuffers = [];
      this.rightBuffers = [];
      this.inputRingBuffer = new RingBuffer(this.bufferSize, this.numInputChannels);
      this.inputRingBufferArraySequence = new Array(this.numInputChannels).fill(null).map(function () {
        return new Float32Array(_this2.bufferSize);
      });
      this.recordedSamples = 0;
      this.sampleLimit = null;
    }
  }]);

  return RecorderProcessor;
}(_wrapNativeSuper(AudioWorkletProcessor));

registerProcessor(processorNames.recorderProcessor, RecorderProcessor);`},function(S,R,T){T.r(R),R.default=`function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _wrapNativeSuper(Class) { var _cache = typeof Map === "function" ? new Map() : undefined; _wrapNativeSuper = function _wrapNativeSuper(Class) { if (Class === null || !_isNativeFunction(Class)) return Class; if (typeof Class !== "function") { throw new TypeError("Super expression must either be null or a function"); } if (typeof _cache !== "undefined") { if (_cache.has(Class)) return _cache.get(Class); _cache.set(Class, Wrapper); } function Wrapper() { return _construct(Class, arguments, _getPrototypeOf(this).constructor); } Wrapper.prototype = Object.create(Class.prototype, { constructor: { value: Wrapper, enumerable: false, writable: true, configurable: true } }); return _setPrototypeOf(Wrapper, Class); }; return _wrapNativeSuper(Class); }

function isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function _construct(Parent, args, Class) { if (isNativeReflectConstruct()) { _construct = Reflect.construct; } else { _construct = function _construct(Parent, args, Class) { var a = [null]; a.push.apply(a, args); var Constructor = Function.bind.apply(Parent, a); var instance = new Constructor(); if (Class) _setPrototypeOf(instance, Class.prototype); return instance; }; } return _construct.apply(null, arguments); }

function _isNativeFunction(fn) { return Function.toString.call(fn).indexOf("[native code]") !== -1; }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

// import dependencies via preval.require so that they're available as values at compile time
var processorNames = {
  "recorderProcessor": "recorder-processor",
  "soundFileProcessor": "sound-file-processor",
  "amplitudeProcessor": "amplitude-processor"
};
var RingBuffer = {
  "default":
  /*#__PURE__*/
  function () {
    /**
     * @constructor
     * @param  {number} length Buffer length in frames.
     * @param  {number} channelCount Buffer channel count.
     */
    function RingBuffer(length, channelCount) {
      _classCallCheck(this, RingBuffer);

      this._readIndex = 0;
      this._writeIndex = 0;
      this._framesAvailable = 0;
      this._channelCount = channelCount;
      this._length = length;
      this._channelData = [];

      for (var i = 0; i < this._channelCount; ++i) {
        this._channelData[i] = new Float32Array(length);
      }
    }
    /**
     * Getter for Available frames in buffer.
     *
     * @return {number} Available frames in buffer.
     */


    _createClass(RingBuffer, [{
      key: "push",

      /**
       * Push a sequence of Float32Arrays to buffer.
       *
       * @param  {array} arraySequence A sequence of Float32Arrays.
       */
      value: function push(arraySequence) {
        // The channel count of arraySequence and the length of each channel must
        // match with this buffer obejct.
        // Transfer data from the |arraySequence| storage to the internal buffer.
        var sourceLength = arraySequence[0] ? arraySequence[0].length : 0;

        for (var i = 0; i < sourceLength; ++i) {
          var writeIndex = (this._writeIndex + i) % this._length;

          for (var channel = 0; channel < this._channelCount; ++channel) {
            this._channelData[channel][writeIndex] = arraySequence[channel][i];
          }
        }

        this._writeIndex += sourceLength;

        if (this._writeIndex >= this._length) {
          this._writeIndex = 0;
        } // For excessive frames, the buffer will be overwritten.


        this._framesAvailable += sourceLength;

        if (this._framesAvailable > this._length) {
          this._framesAvailable = this._length;
        }
      }
      /**
       * Pull data out of buffer and fill a given sequence of Float32Arrays.
       *
       * @param  {array} arraySequence An array of Float32Arrays.
       */

    }, {
      key: "pull",
      value: function pull(arraySequence) {
        // The channel count of arraySequence and the length of each channel must
        // match with this buffer obejct.
        // If the FIFO is completely empty, do nothing.
        if (this._framesAvailable === 0) {
          return;
        }

        var destinationLength = arraySequence[0].length; // Transfer data from the internal buffer to the |arraySequence| storage.

        for (var i = 0; i < destinationLength; ++i) {
          var readIndex = (this._readIndex + i) % this._length;

          for (var channel = 0; channel < this._channelCount; ++channel) {
            arraySequence[channel][i] = this._channelData[channel][readIndex];
          }
        }

        this._readIndex += destinationLength;

        if (this._readIndex >= this._length) {
          this._readIndex = 0;
        }

        this._framesAvailable -= destinationLength;

        if (this._framesAvailable < 0) {
          this._framesAvailable = 0;
        }
      }
    }, {
      key: "framesAvailable",
      get: function get() {
        return this._framesAvailable;
      }
    }]);

    return RingBuffer;
  }()
}["default"];

var SoundFileProcessor =
/*#__PURE__*/
function (_AudioWorkletProcesso) {
  _inherits(SoundFileProcessor, _AudioWorkletProcesso);

  function SoundFileProcessor(options) {
    var _this;

    _classCallCheck(this, SoundFileProcessor);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(SoundFileProcessor).call(this));
    var processorOptions = options.processorOptions || {};
    _this.bufferSize = processorOptions.bufferSize || 256;
    _this.inputRingBuffer = new RingBuffer(_this.bufferSize, 1);
    _this.inputRingBufferArraySequence = [new Float32Array(_this.bufferSize)];
    return _this;
  }

  _createClass(SoundFileProcessor, [{
    key: "process",
    value: function process(inputs) {
      var input = inputs[0]; // we only care about the first input channel, because that contains the position data

      this.inputRingBuffer.push([input[0]]);

      if (this.inputRingBuffer.framesAvailable >= this.bufferSize) {
        this.inputRingBuffer.pull(this.inputRingBufferArraySequence);
        var inputChannel = this.inputRingBufferArraySequence[0];
        var position = inputChannel[inputChannel.length - 1] || 0;
        this.port.postMessage({
          name: 'position',
          position: position
        });
      }

      return true;
    }
  }]);

  return SoundFileProcessor;
}(_wrapNativeSuper(AudioWorkletProcessor));

registerProcessor(processorNames.soundFileProcessor, SoundFileProcessor);`},function(S,R,T){T.r(R),R.default=`function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _wrapNativeSuper(Class) { var _cache = typeof Map === "function" ? new Map() : undefined; _wrapNativeSuper = function _wrapNativeSuper(Class) { if (Class === null || !_isNativeFunction(Class)) return Class; if (typeof Class !== "function") { throw new TypeError("Super expression must either be null or a function"); } if (typeof _cache !== "undefined") { if (_cache.has(Class)) return _cache.get(Class); _cache.set(Class, Wrapper); } function Wrapper() { return _construct(Class, arguments, _getPrototypeOf(this).constructor); } Wrapper.prototype = Object.create(Class.prototype, { constructor: { value: Wrapper, enumerable: false, writable: true, configurable: true } }); return _setPrototypeOf(Wrapper, Class); }; return _wrapNativeSuper(Class); }

function isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function _construct(Parent, args, Class) { if (isNativeReflectConstruct()) { _construct = Reflect.construct; } else { _construct = function _construct(Parent, args, Class) { var a = [null]; a.push.apply(a, args); var Constructor = Function.bind.apply(Parent, a); var instance = new Constructor(); if (Class) _setPrototypeOf(instance, Class.prototype); return instance; }; } return _construct.apply(null, arguments); }

function _isNativeFunction(fn) { return Function.toString.call(fn).indexOf("[native code]") !== -1; }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

// import dependencies via preval.require so that they're available as values at compile time
var processorNames = {
  "recorderProcessor": "recorder-processor",
  "soundFileProcessor": "sound-file-processor",
  "amplitudeProcessor": "amplitude-processor"
};
var RingBuffer = {
  "default":
  /*#__PURE__*/
  function () {
    /**
     * @constructor
     * @param  {number} length Buffer length in frames.
     * @param  {number} channelCount Buffer channel count.
     */
    function RingBuffer(length, channelCount) {
      _classCallCheck(this, RingBuffer);

      this._readIndex = 0;
      this._writeIndex = 0;
      this._framesAvailable = 0;
      this._channelCount = channelCount;
      this._length = length;
      this._channelData = [];

      for (var i = 0; i < this._channelCount; ++i) {
        this._channelData[i] = new Float32Array(length);
      }
    }
    /**
     * Getter for Available frames in buffer.
     *
     * @return {number} Available frames in buffer.
     */


    _createClass(RingBuffer, [{
      key: "push",

      /**
       * Push a sequence of Float32Arrays to buffer.
       *
       * @param  {array} arraySequence A sequence of Float32Arrays.
       */
      value: function push(arraySequence) {
        // The channel count of arraySequence and the length of each channel must
        // match with this buffer obejct.
        // Transfer data from the |arraySequence| storage to the internal buffer.
        var sourceLength = arraySequence[0] ? arraySequence[0].length : 0;

        for (var i = 0; i < sourceLength; ++i) {
          var writeIndex = (this._writeIndex + i) % this._length;

          for (var channel = 0; channel < this._channelCount; ++channel) {
            this._channelData[channel][writeIndex] = arraySequence[channel][i];
          }
        }

        this._writeIndex += sourceLength;

        if (this._writeIndex >= this._length) {
          this._writeIndex = 0;
        } // For excessive frames, the buffer will be overwritten.


        this._framesAvailable += sourceLength;

        if (this._framesAvailable > this._length) {
          this._framesAvailable = this._length;
        }
      }
      /**
       * Pull data out of buffer and fill a given sequence of Float32Arrays.
       *
       * @param  {array} arraySequence An array of Float32Arrays.
       */

    }, {
      key: "pull",
      value: function pull(arraySequence) {
        // The channel count of arraySequence and the length of each channel must
        // match with this buffer obejct.
        // If the FIFO is completely empty, do nothing.
        if (this._framesAvailable === 0) {
          return;
        }

        var destinationLength = arraySequence[0].length; // Transfer data from the internal buffer to the |arraySequence| storage.

        for (var i = 0; i < destinationLength; ++i) {
          var readIndex = (this._readIndex + i) % this._length;

          for (var channel = 0; channel < this._channelCount; ++channel) {
            arraySequence[channel][i] = this._channelData[channel][readIndex];
          }
        }

        this._readIndex += destinationLength;

        if (this._readIndex >= this._length) {
          this._readIndex = 0;
        }

        this._framesAvailable -= destinationLength;

        if (this._framesAvailable < 0) {
          this._framesAvailable = 0;
        }
      }
    }, {
      key: "framesAvailable",
      get: function get() {
        return this._framesAvailable;
      }
    }]);

    return RingBuffer;
  }()
}["default"];

var AmplitudeProcessor =
/*#__PURE__*/
function (_AudioWorkletProcesso) {
  _inherits(AmplitudeProcessor, _AudioWorkletProcesso);

  function AmplitudeProcessor(options) {
    var _this;

    _classCallCheck(this, AmplitudeProcessor);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(AmplitudeProcessor).call(this));
    var processorOptions = options.processorOptions || {};
    _this.numOutputChannels = options.outputChannelCount || 1;
    _this.numInputChannels = processorOptions.numInputChannels || 2;
    _this.normalize = processorOptions.normalize || false;
    _this.smoothing = processorOptions.smoothing || 0;
    _this.bufferSize = processorOptions.bufferSize || 2048;
    _this.inputRingBuffer = new RingBuffer(_this.bufferSize, _this.numInputChannels);
    _this.outputRingBuffer = new RingBuffer(_this.bufferSize, _this.numOutputChannels);
    _this.inputRingBufferArraySequence = new Array(_this.numInputChannels).fill(null).map(function () {
      return new Float32Array(_this.bufferSize);
    });
    _this.stereoVol = [0, 0];
    _this.stereoVolNorm = [0, 0];
    _this.volMax = 0.001;

    _this.port.onmessage = function (event) {
      var data = event.data;

      if (data.name === 'toggleNormalize') {
        _this.normalize = data.normalize;
      } else if (data.name === 'smoothing') {
        _this.smoothing = Math.max(0, Math.min(1, data.smoothing));
      }
    };

    return _this;
  } // TO DO make this stereo / dependent on # of audio channels


  _createClass(AmplitudeProcessor, [{
    key: "process",
    value: function process(inputs, outputs) {
      var input = inputs[0];
      var output = outputs[0];
      var smoothing = this.smoothing;
      this.inputRingBuffer.push(input);

      if (this.inputRingBuffer.framesAvailable >= this.bufferSize) {
        this.inputRingBuffer.pull(this.inputRingBufferArraySequence);

        for (var channel = 0; channel < this.numInputChannels; ++channel) {
          var inputBuffer = this.inputRingBufferArraySequence[channel];
          var bufLength = inputBuffer.length;
          var sum = 0;

          for (var i = 0; i < bufLength; i++) {
            var x = inputBuffer[i];

            if (this.normalize) {
              sum += Math.max(Math.min(x / this.volMax, 1), -1) * Math.max(Math.min(x / this.volMax, 1), -1);
            } else {
              sum += x * x;
            }
          } // ... then take the square root of the sum.


          var rms = Math.sqrt(sum / bufLength);
          this.stereoVol[channel] = Math.max(rms, this.stereoVol[channel] * smoothing);
          this.volMax = Math.max(this.stereoVol[channel], this.volMax);
        } // calculate stero normalized volume and add volume from all channels together


        var volSum = 0;

        for (var index = 0; index < this.stereoVol.length; index++) {
          this.stereoVolNorm[index] = Math.max(Math.min(this.stereoVol[index] / this.volMax, 1), 0);
          volSum += this.stereoVol[index];
        } // volume is average of channels


        var volume = volSum / this.stereoVol.length; // normalized value

        var volNorm = Math.max(Math.min(volume / this.volMax, 1), 0);
        this.port.postMessage({
          name: 'amplitude',
          volume: volume,
          volNorm: volNorm,
          stereoVol: this.stereoVol,
          stereoVolNorm: this.stereoVolNorm
        }); // pass input through to output

        this.outputRingBuffer.push(this.inputRingBufferArraySequence);
      } // pull 128 frames out of the ring buffer
      // if the ring buffer does not have enough frames, the output will be silent


      this.outputRingBuffer.pull(output);
      return true;
    }
  }]);

  return AmplitudeProcessor;
}(_wrapNativeSuper(AudioWorkletProcessor));

registerProcessor(processorNames.amplitudeProcessor, AmplitudeProcessor);`},function(S,R,T){var P,h;P=[T(0),T(17)],h=(function(e){e.Frequency=function(u,c){if(!(this instanceof e.Frequency))return new e.Frequency(u,c);e.TimeBase.call(this,u,c)},e.extend(e.Frequency,e.TimeBase),e.Frequency.prototype._primaryExpressions=Object.create(e.TimeBase.prototype._primaryExpressions),e.Frequency.prototype._primaryExpressions.midi={regexp:/^(\d+(?:\.\d+)?midi)/,method:function(u){return this.midiToFrequency(u)}},e.Frequency.prototype._primaryExpressions.note={regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method:function(u,c){var l=n[u.toLowerCase()]+12*(parseInt(c)+1);return this.midiToFrequency(l)}},e.Frequency.prototype._primaryExpressions.tr={regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method:function(u,c,l){var m=1;return u&&u!=="0"&&(m*=this._beatsToUnits(this._timeSignature()*parseFloat(u))),c&&c!=="0"&&(m*=this._beatsToUnits(parseFloat(c))),l&&l!=="0"&&(m*=this._beatsToUnits(parseFloat(l)/4)),m}},e.Frequency.prototype.transpose=function(u){return this._expr=(function(c,l){return c()*this.intervalToFrequencyRatio(l)}).bind(this,this._expr,u),this},e.Frequency.prototype.harmonize=function(u){return this._expr=(function(c,l){for(var m=c(),d=[],a=0;a<l.length;a++)d[a]=m*this.intervalToFrequencyRatio(l[a]);return d}).bind(this,this._expr,u),this},e.Frequency.prototype.toMidi=function(){return this.frequencyToMidi(this.valueOf())},e.Frequency.prototype.toNote=function(){var u=this.valueOf(),c=Math.log(u/e.Frequency.A4)/Math.LN2,l=Math.round(12*c)+57,m=Math.floor(l/12);return m<0&&(l+=-12*m),i[l%12]+m.toString()},e.Frequency.prototype.toSeconds=function(){return 1/this.valueOf()},e.Frequency.prototype.toFrequency=function(){return this.valueOf()},e.Frequency.prototype.toTicks=function(){var u=this._beatsToUnits(1),c=this.valueOf()/u;return Math.floor(c*e.Transport.PPQ)},e.Frequency.prototype._frequencyToUnits=function(u){return u},e.Frequency.prototype._ticksToUnits=function(u){return 1/(60*u/(e.Transport.bpm.value*e.Transport.PPQ))},e.Frequency.prototype._beatsToUnits=function(u){return 1/e.TimeBase.prototype._beatsToUnits.call(this,u)},e.Frequency.prototype._secondsToUnits=function(u){return 1/u},e.Frequency.prototype._defaultUnits="hz";var n={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},i=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];return e.Frequency.A4=440,e.Frequency.prototype.midiToFrequency=function(u){return e.Frequency.A4*Math.pow(2,(u-69)/12)},e.Frequency.prototype.frequencyToMidi=function(u){return 69+12*Math.log(u/e.Frequency.A4)/Math.LN2},e.Frequency}).apply(R,P),h!==void 0&&(S.exports=h)},function(S,R,T){var P,h;P=[T(0),T(16)],h=(function(e){return e.TransportTime=function(n,i){if(!(this instanceof e.TransportTime))return new e.TransportTime(n,i);e.Time.call(this,n,i)},e.extend(e.TransportTime,e.Time),e.TransportTime.prototype._unaryExpressions=Object.create(e.Time.prototype._unaryExpressions),e.TransportTime.prototype._unaryExpressions.quantize={regexp:/^@/,method:function(n){var i=this._secondsToTicks(n()),u=Math.ceil(e.Transport.ticks/i);return this._ticksToUnits(u*i)}},e.TransportTime.prototype._secondsToTicks=function(n){var i=n/this._beatsToUnits(1);return Math.round(i*e.Transport.PPQ)},e.TransportTime.prototype.valueOf=function(){return this._secondsToTicks(this._expr())+(this._plusNow?e.Transport.ticks:0)},e.TransportTime.prototype.toTicks=function(){return this.valueOf()},e.TransportTime.prototype.toSeconds=function(){return this._expr()+(this._plusNow?e.Transport.seconds:0)},e.TransportTime.prototype.toFrequency=function(){return 1/this.toSeconds()},e.TransportTime}).apply(R,P),h!==void 0&&(S.exports=h)},function(S,R,T){var P,h;P=[T(0),T(4),T(13),T(1),T(33),T(21),T(34),T(20),T(35),T(36),T(37)],h=(function(e){function n(l,m,d){var a=new l;return d._eval(m[0]).connect(a,0,0),d._eval(m[1]).connect(a,0,1),a}function i(l,m,d){var a=new l;return d._eval(m[0]).connect(a,0,0),a}function u(l){return l?parseFloat(l):void 0}function c(l){return l&&l.args?parseFloat(l.args):void 0}return e.Expr=function(){var l=this._replacements(Array.prototype.slice.call(arguments)),m=this._parseInputs(l);this._nodes=[],this.input=new Array(m);for(var d=0;d<m;d++)this.input[d]=this.context.createGain();var a,y=this._parseTree(l);try{a=this._eval(y)}catch{throw this._disposeNodes(),new Error("Tone.Expr: Could evaluate expression: "+l)}this.output=a},e.extend(e.Expr,e.SignalBase),e.Expr._Expressions={value:{signal:{regexp:/^\d+\.\d+|^\d+/,method:function(l){return new e.Signal(u(l))}},input:{regexp:/^\$\d/,method:function(l,m){return m.input[u(l.substr(1))]}}},glue:{"(":{regexp:/^\(/},")":{regexp:/^\)/},",":{regexp:/^,/}},func:{abs:{regexp:/^abs/,method:i.bind(this,e.Abs)},mod:{regexp:/^mod/,method:function(l,m){var d=c(l[1]),a=new e.Modulo(d);return m._eval(l[0]).connect(a),a}},pow:{regexp:/^pow/,method:function(l,m){var d=c(l[1]),a=new e.Pow(d);return m._eval(l[0]).connect(a),a}},a2g:{regexp:/^a2g/,method:function(l,m){var d=new e.AudioToGain;return m._eval(l[0]).connect(d),d}}},binary:{"+":{regexp:/^\+/,precedence:1,method:n.bind(this,e.Add)},"-":{regexp:/^\-/,precedence:1,method:function(l,m){return l.length===1?i(e.Negate,l,m):n(e.Subtract,l,m)}},"*":{regexp:/^\*/,precedence:0,method:n.bind(this,e.Multiply)}},unary:{"-":{regexp:/^\-/,method:i.bind(this,e.Negate)},"!":{regexp:/^\!/,method:i.bind(this,e.NOT)}}},e.Expr.prototype._parseInputs=function(l){var m=l.match(/\$\d/g),d=0;if(m!==null)for(var a=0;a<m.length;a++){var y=parseInt(m[a].substr(1))+1;d=Math.max(d,y)}return d},e.Expr.prototype._replacements=function(l){for(var m=l.shift(),d=0;d<l.length;d++)m=m.replace(/\%/i,l[d]);return m},e.Expr.prototype._tokenize=function(l){for(var m=-1,d=[];0<l.length;){var a=y(l=l.trim());d.push(a),l=l.substr(a.value.length)}function y(v){for(var _ in e.Expr._Expressions){var w=e.Expr._Expressions[_];for(var k in w){var A=w[k],D=A.regexp,g=v.match(D);if(g!==null)return{type:_,value:g[0],method:A.method}}}throw new SyntaxError("Tone.Expr: Unexpected token "+v)}return{next:function(){return d[++m]},peek:function(){return d[m+1]}}},e.Expr.prototype._parseTree=function(l){var m=this._tokenize(l),d=this.isUndef.bind(this);function a(w,k){return!d(w)&&w.type==="glue"&&w.value===k}function y(w,k,A){var D=e.Expr._Expressions[k];if(!d(w))for(var g in D){var b=D[g];if(b.regexp.test(w.value)&&(d(A)||b.precedence===A))return!0}return!1}function v(w){var k;d(w)&&(w=5),k=w<0?function D(){var g,b;return g=m.peek(),y(g,"unary")?(g=m.next(),b=D(),{operator:g.value,method:g.method,args:[b]}):_()}():v(w-1);for(var A=m.peek();y(A,"binary",w);)k={operator:(A=m.next()).value,method:A.method,args:[k,v(w-1)]},A=m.peek();return k}function _(){var w,k;if(w=m.peek(),d(w))throw new SyntaxError("Tone.Expr: Unexpected termination of expression");if(w.type==="func")return function(A){var D=[];if(!a(m.next(),"("))throw new SyntaxError('Tone.Expr: Expected ( in a function call "'+A.value+'"');if(a(m.peek(),")")||(D=function(){for(var g,b=[];g=v(),!d(g)&&(b.push(g),a(m.peek(),","));)m.next();return b}()),a(m.next(),")"))return{method:A.method,args:D,name};throw new SyntaxError('Tone.Expr: Expected ) in a function call "'+A.value+'"')}(w=m.next());if(w.type==="value")return{method:(w=m.next()).method,args:w.value};if(a(w,"(")){if(m.next(),k=v(),!a(w=m.next(),")"))throw new SyntaxError("Expected )");return k}throw new SyntaxError("Tone.Expr: Parse error, cannot process token "+w.value)}return v()},e.Expr.prototype._eval=function(l){if(!this.isUndef(l)){var m=l.method(l.args,this);return this._nodes.push(m),m}},e.Expr.prototype._disposeNodes=function(){for(var l=0;l<this._nodes.length;l++){var m=this._nodes[l];this.isFunction(m.dispose)?m.dispose():this.isFunction(m.disconnect)&&m.disconnect(),m=null,this._nodes[l]=null}this._nodes=null},e.Expr.prototype.dispose=function(){e.prototype.dispose.call(this),this._disposeNodes()},e.Expr}).apply(R,P),h!==void 0&&(S.exports=h)},function(S,R,T){var P,h;P=[T(0),T(21),T(13),T(2)],h=(function(e){return e.GreaterThan=function(n){this.createInsOuts(2,0),this._param=this.input[0]=new e.Subtract(n),this.input[1]=this._param.input[1],this._gtz=this.output=new e.GreaterThanZero,this._param.connect(this._gtz)},e.extend(e.GreaterThan,e.Signal),e.GreaterThan.prototype.dispose=function(){return e.prototype.dispose.call(this),this._param.dispose(),this._param=null,this._gtz.dispose(),this._gtz=null,this},e.GreaterThan}).apply(R,P),h!==void 0&&(S.exports=h)},function(S,R,T){var P,h;P=[T(0),T(6),T(15)],h=(function(e){return e.Abs=function(){this._abs=this.input=this.output=new e.WaveShaper(function(n){return n===0?0:Math.abs(n)},127)},e.extend(e.Abs,e.SignalBase),e.Abs.prototype.dispose=function(){return e.prototype.dispose.call(this),this._abs.dispose(),this._abs=null,this},e.Abs}).apply(R,P),h!==void 0&&(S.exports=h)},function(S,R,T){var P,h;P=[T(0),T(6),T(1),T(13)],h=(function(e){return e.Modulo=function(n){this.createInsOuts(1,0),this._shaper=new e.WaveShaper(Math.pow(2,16)),this._multiply=new e.Multiply,this._subtract=this.output=new e.Subtract,this._modSignal=new e.Signal(n),this.input.fan(this._shaper,this._subtract),this._modSignal.connect(this._multiply,0,0),this._shaper.connect(this._multiply,0,1),this._multiply.connect(this._subtract,0,1),this._setWaveShaper(n)},e.extend(e.Modulo,e.SignalBase),e.Modulo.prototype._setWaveShaper=function(n){this._shaper.setMap(function(i){return Math.floor((i+1e-4)/n)})},Object.defineProperty(e.Modulo.prototype,"value",{get:function(){return this._modSignal.value},set:function(n){this._modSignal.value=n,this._setWaveShaper(n)}}),e.Modulo.prototype.dispose=function(){return e.prototype.dispose.call(this),this._shaper.dispose(),this._shaper=null,this._multiply.dispose(),this._multiply=null,this._subtract.dispose(),this._subtract=null,this._modSignal.dispose(),this._modSignal=null,this},e.Modulo}).apply(R,P),h!==void 0&&(S.exports=h)},function(S,R,T){var P,h;P=[T(0),T(6)],h=(function(e){return e.Pow=function(n){this._exp=this.defaultArg(n,1),this._expScaler=this.input=this.output=new e.WaveShaper(this._expFunc(this._exp),8192)},e.extend(e.Pow,e.SignalBase),Object.defineProperty(e.Pow.prototype,"value",{get:function(){return this._exp},set:function(n){this._exp=n,this._expScaler.setMap(this._expFunc(this._exp))}}),e.Pow.prototype._expFunc=function(n){return function(i){return Math.pow(Math.abs(i),n)}},e.Pow.prototype.dispose=function(){return e.prototype.dispose.call(this),this._expScaler.dispose(),this._expScaler=null,this},e.Pow}).apply(R,P),h!==void 0&&(S.exports=h)},function(S,R,T){var P,h;P=[T(0),T(6),T(2)],h=(function(e){return e.AudioToGain=function(){this._norm=this.input=this.output=new e.WaveShaper(function(n){return(n+1)/2})},e.extend(e.AudioToGain,e.SignalBase),e.AudioToGain.prototype.dispose=function(){return e.prototype.dispose.call(this),this._norm.dispose(),this._norm=null,this},e.AudioToGain}).apply(R,P),h!==void 0&&(S.exports=h)},function(S,R,T){var P,h;P=[T(0),T(6)],h=(function(e){return e.EqualPowerGain=function(){this._eqPower=this.input=this.output=new e.WaveShaper((function(n){return Math.abs(n)<.001?0:this.equalPowerScale(n)}).bind(this),4096)},e.extend(e.EqualPowerGain,e.SignalBase),e.EqualPowerGain.prototype.dispose=function(){return e.prototype.dispose.call(this),this._eqPower.dispose(),this._eqPower=null,this},e.EqualPowerGain}).apply(R,P),h!==void 0&&(S.exports=h)},function(S,R,T){var P,h;P=[T(0),T(19),T(9)],h=(function(e){return e.TimelineState=function(n){e.Timeline.call(this),this._initial=n},e.extend(e.TimelineState,e.Timeline),e.TimelineState.prototype.getValueAtTime=function(n){var i=this.get(n);return i!==null?i.state:this._initial},e.TimelineState.prototype.setStateAtTime=function(n,i){this.add({state:n,time:i})},e.TimelineState}).apply(R,P),h!==void 0&&(S.exports=h)},function(S,R,T){T.r(R),T(24),T(25);var P=T(3);function h(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}var e=function s(){h(this,s),this.input=P.a.createGain(),this.output=P.a.createGain(),this.limiter=P.a.createDynamicsCompressor(),this.limiter.threshold.value=-3,this.limiter.ratio.value=20,this.limiter.knee.value=1,this.audiocontext=P.a,this.output.disconnect(),this.input.connect(this.limiter),this.limiter.connect(this.output),this.meter=P.a.createGain(),this.fftMeter=P.a.createGain(),this.output.connect(this.meter),this.output.connect(this.fftMeter),this.output.connect(this.audiocontext.destination),this.soundArray=[],this.parts=[],this.extensions=[]},n=new e;p5.prototype.getOutputVolume=function(){return n.output.gain.value},p5.prototype.outputVolume=function(s){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;if(typeof s=="number"){var o=n.audiocontext.currentTime,f=n.output.gain.value;n.output.gain.cancelScheduledValues(o+t),n.output.gain.linearRampToValueAtTime(f,o+t),n.output.gain.linearRampToValueAtTime(s,o+t+r)}else if(s)s.connect(n.output.gain);else return n.output.gain},p5.prototype.soundOut=p5.soundOut=n,p5.soundOut._silentNode=n.audiocontext.createGain(),p5.soundOut._silentNode.gain.value=0,p5.soundOut._silentNode.connect(n.audiocontext.destination);var i=n,u=T(5),c=T.n(u);function l(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?l=function(t){return typeof t}:l=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(s)}function m(){return i.audiocontext.sampleRate}function d(s){var r=Math.log(s/440)/Math.log(2),t=Math.round(12*r)+69;return t}function a(s){return 440*Math.pow(2,(s-69)/12)}function y(s){if(typeof s!="string")return s;var r={A:21,B:23,C:24,D:26,E:28,F:29,G:31},t=r[s[0].toUpperCase()],o=~~s.slice(-1);switch(t+=12*(o-1),s[1]){case"#":t+=1;break;case"b":t-=1;break}return a(t)}function v(){i.extensions=[];for(var s=0;s<arguments.length;s++)if(arguments[s]=arguments[s].toLowerCase(),["mp3","wav","ogg","m4a","aac"].indexOf(arguments[s])>-1)i.extensions.push(arguments[s]);else throw arguments[s]+" is not a valid sound format!"}function _(){for(var s=0;s<i.soundArray.length;s++)i.soundArray[s].dispose()}function w(s){var r;if(typeof s=="string"){r=s;var t=r.split(".").pop();if(["mp3","wav","ogg","m4a","aac"].indexOf(t)>-1){if(!p5.prototype.isFileSupported(t))for(var o=r.split("."),f=o[o.length-1],x=0;x<i.extensions.length;x++){var M=i.extensions[x],N=p5.prototype.isFileSupported(M);if(N){f="",o.length===2&&(f+=o[0]);for(var L=1;L<=o.length-2;L++){var j=o[L];f+="."+j}r=f+=".",r=r+=M;break}}}else for(var z=0;z<i.extensions.length;z++){var X=i.extensions[z],he=p5.prototype.isFileSupported(X);if(he){r=r+"."+X;break}}}else if(l(s)==="object")for(var ne=0;ne<s.length;ne++){var oe=s[ne].split(".").pop(),de=p5.prototype.isFileSupported(oe);if(de){r=s[ne];break}}return r}function k(s,r,t,o,f){for(var x in s.mathOps)s.mathOps[x]instanceof f&&(s.mathOps[x].dispose(),t=x,t<s.mathOps.length-1&&(o=s.mathOps[x+1]));return s.mathOps[t-1].disconnect(),s.mathOps[t-1].connect(r),r.connect(o),s.mathOps[t]=r,s}function A(s){var r,t;r=s.getChannelData(0),s.numberOfChannels>1?t=s.getChannelData(1):t=r;var o=D(r,t),f=new window.ArrayBuffer(44+o.length*2),x=new window.DataView(f);g(x,0,"RIFF"),x.setUint32(4,36+o.length*2,!0),g(x,8,"WAVE"),g(x,12,"fmt "),x.setUint32(16,16,!0),x.setUint16(20,1,!0),x.setUint16(22,2,!0),x.setUint32(24,i.audiocontext.sampleRate,!0),x.setUint32(28,i.audiocontext.sampleRate*4,!0),x.setUint16(32,4,!0),x.setUint16(34,16,!0),g(x,36,"data"),x.setUint32(40,o.length*2,!0);for(var M=o.length,N=44,L=1,j=0;j<M;j++)x.setInt16(N,o[j]*(32767*L),!0),N+=2;return x}function D(s,r){for(var t=s.length+r.length,o=new Float32Array(t),f=0,x=0;x<t;)o[x++]=s[f],o[x++]=r[f],f++;return o}function g(s,r,t){for(var o=t.length,f=0;f<o;f++)s.setUint8(r+f,t.charCodeAt(f))}function b(s){var r=s,t=new AudioWorkletNode(i.audiocontext,c.a.soundFileProcessor);return t instanceof ScriptProcessorNode&&(r=t.bufferSize),t.disconnect(),t=null,r}function E(s,r){var t=A(s.buffer);p5.prototype.writeFile([t],r,"wav")}var C=function(r,t,o){var f=new Error,x,M;return f.name=r,f.originalStack=f.stack+t,x=f.stack+t,f.failedPath=o,M=x.split(`
`).filter(function(N){return!N.match(/(p5.|native code|globalInit)/g)}),f.stack=M.join(`
`),f},B=C,O=[T(27).default,T(28).default,T(29).default],I=i.audiocontext,F=!1;function V(){return Promise.all(O.map(function(s){var r=new Blob([s],{type:"application/javascript"}),t=URL.createObjectURL(r);return I.audioWorklet.addModule(t)}))}p5.prototype.registerMethod("init",function(){if(!F){!this.preload&&!window.preload&&(this.preload=function(){}),this._incrementPreload();var s=(function(){F=!0,this._decrementPreload()}).bind(this);V().then(s)}});function U(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function W(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function H(s,r,t){return r&&W(s.prototype,r),s}var q=i.audiocontext,K;if(typeof q.createStereoPanner<"u"){var Z=function(){function s(r,t){U(this,s),this.stereoPanner=this.input=q.createStereoPanner(),r.connect(this.stereoPanner),this.stereoPanner.connect(t)}return H(s,[{key:"pan",value:function(t,o){var f=o||0,x=q.currentTime+f;this.stereoPanner.pan.linearRampToValueAtTime(t,x)}},{key:"inputChannels",value:function(){}},{key:"connect",value:function(t){this.stereoPanner.connect(t)}},{key:"disconnect",value:function(){this.stereoPanner&&this.stereoPanner.disconnect()}}]),s}();K=Z}else{var Q=function(){function s(r,t,o){U(this,s),this.input=q.createGain(),r.connect(this.input),this.left=q.createGain(),this.right=q.createGain(),this.left.channelInterpretation="discrete",this.right.channelInterpretation="discrete",o>1?(this.splitter=q.createChannelSplitter(2),this.input.connect(this.splitter),this.splitter.connect(this.left,1),this.splitter.connect(this.right,0)):(this.input.connect(this.left),this.input.connect(this.right)),this.output=q.createChannelMerger(2),this.left.connect(this.output,0,1),this.right.connect(this.output,0,0),this.output.connect(t)}return H(s,[{key:"pan",value:function(t,o){var f=o||0,x=q.currentTime+f,M=(t+1)/2,N=Math.cos(M*Math.PI/2),L=Math.sin(M*Math.PI/2);this.left.gain.linearRampToValueAtTime(L,x),this.right.gain.linearRampToValueAtTime(N,x)}},{key:"inputChannels",value:function(t){t===1?(this.input.disconnect(),this.input.connect(this.left),this.input.connect(this.right)):t===2&&(typeof this.splitter>"u"&&(this.splitter=q.createChannelSplitter(2)),this.input.disconnect(),this.input.connect(this.splitter),this.splitter.connect(this.left,1),this.splitter.connect(this.right,0))}},{key:"connect",value:function(t){this.output.connect(t)}},{key:"disconnect",value:function(){this.output&&this.output.disconnect()}}]),s}();K=Q}var J=K;function $(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?$=function(t){return typeof t}:$=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$(s)}function te(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function pe(s,r,t){return r&&te(s.prototype,r),s}function re(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}var Y=i.audiocontext,se=function(r){for(var t=r.length,o=Y.createBuffer(1,r.length,Y.sampleRate),f=o.getChannelData(0),x=0;x<t;x++)f[x]=x;return o},ee=function s(r,t,o,f){re(this,s),this.callback=r,this.time=t,this.id=o,this.val=f};function ge(s){var r=s.target,t=this;r._playing=!1,r.removeEventListener("ended",t._clearOnEnd),t._onended(t),t.bufferSourceNodes.map(function(o,f){return f}).reverse().forEach(function(o){var f=t.bufferSourceNodes[o];f._playing===!1&&t.bufferSourceNodes.splice(o,1)}),t.bufferSourceNodes.length===0&&(t._playing=!1)}var ae=function(){function s(r,t,o,f){if(re(this,s),typeof r<"u"){if(typeof r=="string"||typeof r[0]=="string"){var x=p5.prototype._checkFileFormats(r);this.url=x}else if($(r)==="object"&&!(window.File&&window.FileReader&&window.FileList&&window.Blob))throw"Unable to load file because the File API is not supported";r.file&&(r=r.file),this.file=r}this._onended=function(){},this._looping=!1,this._playing=!1,this._paused=!1,this._pauseTime=0,this._cues=[],this._cueIDCounter=0,this._lastPos=0,this._counterNode=null,this._workletNode=null,this.bufferSourceNodes=[],this.bufferSourceNode=null,this.buffer=null,this.playbackRate=1,this.input=i.audiocontext.createGain(),this.output=i.audiocontext.createGain(),this.reversed=!1,this.startTime=0,this.endTime=null,this.pauseTime=0,this.mode="sustain",this.startMillis=null,this.panPosition=0,this.panner=new J(this.output,i.input,2),(this.url||this.file)&&this.load(t,o),i.soundArray.push(this),typeof f=="function"?this._whileLoading=f:this._whileLoading=function(){},this._clearOnEnd=ge.bind(this),this.amp=this.setVolume,this.fade=this.setVolume}return pe(s,[{key:"load",value:function(t,o){var f=this,x=new Error().stack;if(this.url!==void 0&&this.url!==""){var M=new XMLHttpRequest;M.addEventListener("progress",function(L){f._updateProgress(L)},!1),M.open("GET",this.url,!0),M.responseType="arraybuffer",M.onload=function(){if(M.status===200){if(!f.panner)return;Y.decodeAudioData(M.response,function(z){f.panner&&(f.buffer=z,f.panner.inputChannels(z.numberOfChannels),t&&t(f))},function(){if(f.panner){var z=new B("decodeAudioData",x,f.url),X="AudioContext error at decodeAudioData for "+f.url;o?(z.msg=X,o(z)):console.error(X+`
 The error stack trace includes: 
`+z.stack)}})}else{if(!f.panner)return;var L=new B("loadSound",x,f.url),j="Unable to load "+f.url+". The request status was: "+M.status+" ("+M.statusText+")";o?(L.message=j,o(L)):console.error(j+`
 The error stack trace includes: 
`+L.stack)}},M.onerror=function(){var L=new B("loadSound",x,f.url),j="There was no response from the server at "+f.url+". Check the url and internet connectivity.";o?(L.message=j,o(L)):console.error(j+`
 The error stack trace includes: 
`+L.stack)},M.send()}else if(this.file!==void 0){var N=new FileReader;N.onload=function(){f.panner&&Y.decodeAudioData(N.result,function(L){f.panner&&(f.buffer=L,f.panner.inputChannels(L.numberOfChannels),t&&t(f))})},N.onerror=function(L){f.panner&&onerror&&onerror(L)},N.readAsArrayBuffer(this.file)}}},{key:"_updateProgress",value:function(t){if(t.lengthComputable){var o=t.loaded/t.total*.99;this._whileLoading(o,t)}else this._whileLoading("size unknown")}},{key:"isLoaded",value:function(){return!!this.buffer}},{key:"play",value:function(t,o,f,x,M){if(!this.output){console.warn("SoundFile.play() called after dispose");return}var N=i.audiocontext.currentTime,L,j,z=t||0;if(z<0&&(z=0),z=z+N,typeof o<"u"&&this.rate(o),typeof f<"u"&&this.setVolume(f),this.buffer){if(this._pauseTime=0,this.mode==="restart"&&this.buffer&&this.bufferSourceNode&&(this.bufferSourceNode.stop(z),this._counterNode.stop(z)),this.mode==="untildone"&&this.isPlaying())return;if(this.bufferSourceNode=this._initSourceNode(),delete this._counterNode,this._counterNode=this._initCounterNode(),x)if(x>=0&&x<this.buffer.duration)L=x;else throw"start time out of range";else L=0;M&&(M=M<=this.buffer.duration-L?M:this.buffer.duration),this._paused?(this.bufferSourceNode.start(z,this.pauseTime,M),this._counterNode.start(z,this.pauseTime,M)):(this.bufferSourceNode.start(z,L,M),this._counterNode.start(z,L,M)),this._playing=!0,this._paused=!1,this.bufferSourceNodes.push(this.bufferSourceNode),this.bufferSourceNode._arrayIndex=this.bufferSourceNodes.length-1,this.bufferSourceNode.addEventListener("ended",this._clearOnEnd)}else throw"not ready to play file, buffer has yet to load. Try preload()";this.bufferSourceNode.loop=this._looping,this._counterNode.loop=this._looping,this._looping===!0&&(j=M||L-1e-15,this.bufferSourceNode.loopStart=L,this.bufferSourceNode.loopEnd=j,this._counterNode.loopStart=L,this._counterNode.loopEnd=j)}},{key:"playMode",value:function(t){var o=t.toLowerCase();if(o==="restart"&&this.buffer&&this.bufferSourceNode)for(var f=0;f<this.bufferSourceNodes.length-1;f++){var x=i.audiocontext.currentTime;this.bufferSourceNodes[f].stop(x)}if(o==="restart"||o==="sustain"||o==="untildone")this.mode=o;else throw'Invalid play mode. Must be either "restart" or "sustain"'}},{key:"pause",value:function(t){var o=i.audiocontext.currentTime,f=t||0,x=f+o;this.isPlaying()&&this.buffer&&this.bufferSourceNode?(this._paused=!0,this._playing=!1,this.pauseTime=this.currentTime(),this.bufferSourceNode.stop(x),this._counterNode.stop(x),this._pauseTime=this.currentTime()):this._pauseTime=0}},{key:"loop",value:function(t,o,f,x,M){this._looping=!0,this.play(t,o,f,x,M)}},{key:"setLoop",value:function(t){if(t===!0)this._looping=!0;else if(t===!1)this._looping=!1;else throw"Error: setLoop accepts either true or false";this.bufferSourceNode&&(this.bufferSourceNode.loop=this._looping,this._counterNode.loop=this._looping)}},{key:"isLooping",value:function(){return this.bufferSourceNode?this._looping===!0&&this.isPlaying()===!0:!1}},{key:"isPlaying",value:function(){return this._playing}},{key:"isPaused",value:function(){return this._paused}},{key:"stop",value:function(t){var o=t||0;if(this.mode==="sustain"||this.mode==="untildone")this.stopAll(o),this._playing=!1,this.pauseTime=0,this._paused=!1;else if(this.buffer&&this.bufferSourceNode){var f=i.audiocontext.currentTime,x=o||0;this.pauseTime=0,this.bufferSourceNode.stop(f+x),this._counterNode.stop(f+x),this._playing=!1,this._paused=!1}}},{key:"stopAll",value:function(t){var o=i.audiocontext.currentTime,f=t||0;if(this.buffer&&this.bufferSourceNode){for(var x in this.bufferSourceNodes){var M=this.bufferSourceNodes[x];if(M)try{M.stop(o+f)}catch{}}this._counterNode.stop(o+f)}}},{key:"getVolume",value:function(){return this.output.gain.value}},{key:"pan",value:function(t,o){this.panPosition=t,this.panner.pan(t,o)}},{key:"getPan",value:function(){return this.panPosition}},{key:"rate",value:function(t){var o=!1;if(typeof t>"u")return this.playbackRate;if(this.playbackRate=t,t===0?t=1e-13:t<0&&!this.reversed?(t=Math.abs(t),o=!0):t>0&&this.reversed&&(o=!0),this.bufferSourceNode){var f=i.audiocontext.currentTime;this.bufferSourceNode.playbackRate.cancelScheduledValues(f),this.bufferSourceNode.playbackRate.linearRampToValueAtTime(Math.abs(t),f),this._counterNode.playbackRate.cancelScheduledValues(f),this._counterNode.playbackRate.linearRampToValueAtTime(Math.abs(t),f)}return o&&this.reverseBuffer(),this.playbackRate}},{key:"setPitch",value:function(t){var o=a(t)/a(60);this.rate(o)}},{key:"getPlaybackRate",value:function(){return this.playbackRate}},{key:"setVolume",value:function(t,o,f){if(typeof t=="number"){var x=o||0,M=f||0,N=i.audiocontext.currentTime,L=this.output.gain.value;this.output.gain.cancelScheduledValues(N+M),this.output.gain.linearRampToValueAtTime(L,N+M),this.output.gain.linearRampToValueAtTime(t,N+M+x)}else if(t)t.connect(this.output.gain);else return this.output.gain}},{key:"duration",value:function(){return this.buffer?this.buffer.duration:0}},{key:"currentTime",value:function(){return this.reversed?Math.abs(this._lastPos-this.buffer.length)/Y.sampleRate:this._lastPos/Y.sampleRate}},{key:"jump",value:function(t,o){if(t<0||t>this.buffer.duration)throw"jump time out of range";if(o>this.buffer.duration-t)throw"end time out of range";var f=t||0,x=o||void 0;this.isPlaying()&&(this.stop(0),this.play(0,this.playbackRate,this.output.gain.value,f,x))}},{key:"channels",value:function(){return this.buffer.numberOfChannels}},{key:"sampleRate",value:function(){return this.buffer.sampleRate}},{key:"frames",value:function(){return this.buffer.length}},{key:"getPeaks",value:function(t){if(this.buffer){if(t||(t=window.width*5),this.buffer){for(var o=this.buffer,f=o.length/t,x=~~(f/10)||1,M=o.numberOfChannels,N=new Float32Array(Math.round(t)),L=0;L<M;L++)for(var j=o.getChannelData(L),z=0;z<t;z++){for(var X=~~(z*f),he=~~(X+f),ne=0,oe=X;oe<he;oe+=x){var de=j[oe];(de>ne||-de>ne)&&(ne=de)}(L===0||Math.abs(ne)>N[z])&&(N[z]=ne)}return N}}else throw"Cannot load peaks yet, buffer is not loaded"}},{key:"reverseBuffer",value:function(){if(this.buffer){var t=this._lastPos/Y.sampleRate,o=this.getVolume();this.setVolume(0,.001);for(var f=this.buffer.numberOfChannels,x=0;x<f;x++)this.buffer.getChannelData(x).reverse();this.reversed=!this.reversed,this.isPlaying()&&t&&this.jump(this.duration()-t),this.setVolume(o,.001)}else throw"SoundFile is not done loading"}},{key:"onended",value:function(t){return this._onended=t,this}},{key:"add",value:function(){}},{key:"dispose",value:function(){var t=i.audiocontext.currentTime,o=i.soundArray.indexOf(this);if(i.soundArray.splice(o,1),this.stop(t),this.buffer&&this.bufferSourceNode){for(var f=0;f<this.bufferSourceNodes.length-1;f++)if(this.bufferSourceNodes[f]!==null){this.bufferSourceNodes[f].disconnect();try{this.bufferSourceNodes[f].stop(t)}catch{console.warn("no buffer source node to dispose")}this.bufferSourceNodes[f]=null}if(this.isPlaying()){try{this._counterNode.stop(t)}catch(x){console.log(x)}this._counterNode=null}}this.output&&(this.output.disconnect(),this.output=null),this.panner&&(this.panner.disconnect(),this.panner=null)}},{key:"connect",value:function(t){t?t.hasOwnProperty("input")?this.panner.connect(t.input):this.panner.connect(t):this.panner.connect(i.input)}},{key:"disconnect",value:function(){this.panner&&this.panner.disconnect()}},{key:"getLevel",value:function(){console.warn("p5.SoundFile.getLevel has been removed from the library. Use p5.Amplitude instead")}},{key:"setPath",value:function(t,o){var f=p5.prototype._checkFileFormats(t);this.url=f,this.load(o)}},{key:"setBuffer",value:function(t){var o=t.length,f=t[0].length,x=Y.createBuffer(o,f,Y.sampleRate);t[0]instanceof Float32Array||(t[0]=new Float32Array(t[0]));for(var M=0;M<o;M++){var N=x.getChannelData(M);N.set(t[M])}this.buffer=x,this.panner.inputChannels(o)}},{key:"_initCounterNode",value:function(){var t=this,o=this,f=Y.currentTime,x=Y.createBufferSource(),M=b(256);return o._workletNode&&(o._workletNode.disconnect(),delete o._workletNode),o._workletNode=new AudioWorkletNode(Y,c.a.soundFileProcessor,{processorOptions:{bufferSize:M}}),o._workletNode.port.onmessage=function(N){if(N.data.name==="position"){if(N.data.position===0)return;t._lastPos=N.data.position,t._onTimeUpdate(o._lastPos)}},x.buffer=se(o.buffer),x.playbackRate.setValueAtTime(o.playbackRate,f),x.connect(o._workletNode),o._workletNode.connect(p5.soundOut._silentNode),x}},{key:"_initSourceNode",value:function(){var t=Y.createBufferSource();return t.buffer=this.buffer,t.playbackRate.value=this.playbackRate,t.connect(this.output),t}},{key:"processPeaks",value:function(t,o,f,x){console.warn("processPeaks is deprecated")}},{key:"addCue",value:function(t,o,f){var x=this._cueIDCounter++,M=new ee(o,t,x,f);return this._cues.push(M),x}},{key:"removeCue",value:function(t){for(var o=this._cues.length,f=0;f<o;f++){var x=this._cues[f];if(x.id===t){this._cues.splice(f,1);break}}this._cues.length}},{key:"clearCues",value:function(){this._cues=[]}},{key:"_onTimeUpdate",value:function(t){for(var o=t/this.buffer.sampleRate,f=this._cues.length,x=0;x<f;x++){var M=this._cues[x],N=M.time,L=M.val,j=this._prevUpdateTime||0,z=o;j<=N&&N<=z&&M.callback(L)}this._prevUpdateTime=o}},{key:"save",value:function(t){p5.prototype.saveSound(this,t,"wav")}},{key:"getBlob",value:function(){var t=A(this.buffer);return new Blob([t],{type:"audio/wav"})}}]),s}();function ue(s,r,t,o){window.location.origin.indexOf("file://")>-1&&window.cordova==="undefined"&&window.alert("This sketch may require a server to load external files. Please see http://bit.ly/1qcInwS");var f=this,x=new ae(s,function(){typeof r=="function"&&r.apply(f,arguments),typeof f._decrementPreload=="function"&&f._decrementPreload()},t,o);return x}var ie=ae;function Bt(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function Dt(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function Ft(s,r,t){return r&&Dt(s.prototype,r),s}var je=function(){function s(r){Bt(this,s),this.bufferSize=b(2048),this.audiocontext=i.audiocontext,this._workletNode=new AudioWorkletNode(this.audiocontext,c.a.amplitudeProcessor,{outputChannelCount:[1],parameterData:{smoothing:r||0},processorOptions:{normalize:!1,smoothing:r||0,numInputChannels:2,bufferSize:this.bufferSize}}),this._workletNode.port.onmessage=(function(t){t.data.name==="amplitude"&&(this.volume=t.data.volume,this.volNorm=t.data.volNorm,this.stereoVol=t.data.stereoVol,this.stereoVolNorm=t.data.stereoVolNorm)}).bind(this),this.input=this._workletNode,this.output=this.audiocontext.createGain(),this.volume=0,this.volNorm=0,this.stereoVol=[0,0],this.stereoVolNorm=[0,0],this.normalize=!1,this._workletNode.connect(this.output),this.output.gain.value=0,this.output.connect(this.audiocontext.destination),i.meter.connect(this._workletNode),i.soundArray.push(this)}return Ft(s,[{key:"setInput",value:function(t,o){i.meter.disconnect(),o&&(this._workletNode.parameters.get("smoothing").value=o),t==null?(console.log("Amplitude input source is not ready! Connecting to main output instead"),i.meter.connect(this._workletNode)):t?(t.connect(this._workletNode),this._workletNode.disconnect(),this._workletNode.connect(this.output)):i.meter.connect(this._workletNode)}},{key:"connect",value:function(t){t?t.hasOwnProperty("input")?this.output.connect(t.input):this.output.connect(t):this.output.connect(this.panner.connect(i.input))}},{key:"disconnect",value:function(){this.output&&this.output.disconnect()}},{key:"getLevel",value:function(t){return typeof t<"u"?this.normalize?this.stereoVolNorm[t]:this.stereoVol[t]:this.normalize?this.volNorm:this.volume}},{key:"toggleNormalize",value:function(t){typeof t=="boolean"?this.normalize=t:this.normalize=!this.normalize,this._workletNode.port.postMessage({name:"toggleNormalize",normalize:this.normalize})}},{key:"smooth",value:function(t){t>=0&&t<1?this._workletNode.port.postMessage({name:"smoothing",smoothing:t}):console.log("Error: smoothing must be between 0 and 1")}},{key:"dispose",value:function(){var t=i.soundArray.indexOf(this);i.soundArray.splice(t,1),this.input&&(this.input.disconnect(),delete this.input),this.output&&(this.output.disconnect(),delete this.output),this._workletNode.disconnect(),delete this._workletNode}}]),s}(),ke=je;function Ee(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function ce(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function ze(s,r,t){return r&&ce(s.prototype,r),s}var Oe=function(){function s(r,t){Ee(this,s),this.input=this.analyser=i.audiocontext.createAnalyser(),Object.defineProperties(this,{bins:{get:function(){return this.analyser.fftSize/2},set:function(f){this.analyser.fftSize=f*2},configurable:!0,enumerable:!0},smoothing:{get:function(){return this.analyser.smoothingTimeConstant},set:function(f){this.analyser.smoothingTimeConstant=f},configurable:!0,enumerable:!0}}),this.smooth(r),this.bins=t||1024,i.fftMeter.connect(this.analyser),this.freqDomain=new Uint8Array(this.analyser.frequencyBinCount),this.timeDomain=new Uint8Array(this.analyser.frequencyBinCount),this.bass=[20,140],this.lowMid=[140,400],this.mid=[400,2600],this.highMid=[2600,5200],this.treble=[5200,14e3],i.soundArray.push(this)}return ze(s,[{key:"setInput",value:function(t){t?(t.output?t.output.connect(this.analyser):t.connect&&t.connect(this.analyser),i.fftMeter.disconnect()):i.fftMeter.connect(this.analyser)}},{key:"waveform",value:function(){for(var t,o,f=new Array,x=0;x<arguments.length;x++)typeof arguments[x]=="number"&&(t=arguments[x],this.analyser.fftSize=t*2),typeof arguments[x]=="string"&&(o=arguments[x]);if(o&&!p5.prototype._isSafari())return Ke(this,this.timeDomain),this.analyser.getFloatTimeDomainData(this.timeDomain),this.timeDomain;Ze(this,this.timeDomain),this.analyser.getByteTimeDomainData(this.timeDomain);for(var M=0;M<this.timeDomain.length;M++){var N=p5.prototype.map(this.timeDomain[M],0,255,-1,1);f.push(N)}return f}},{key:"analyze",value:function(){for(var t,o=0;o<arguments.length;o++)typeof arguments[o]=="number"&&(this.bins=arguments[o],this.analyser.fftSize=this.bins*2),typeof arguments[o]=="string"&&(t=arguments[o]);if(t&&t.toLowerCase()==="db")return He(this),this.analyser.getFloatFrequencyData(this.freqDomain),this.freqDomain;Ye(this,this.freqDomain),this.analyser.getByteFrequencyData(this.freqDomain);var f=Array.apply([],this.freqDomain);return f}},{key:"getEnergy",value:function(t,o){var f=i.audiocontext.sampleRate/2;if(t==="bass"?(t=this.bass[0],o=this.bass[1]):t==="lowMid"?(t=this.lowMid[0],o=this.lowMid[1]):t==="mid"?(t=this.mid[0],o=this.mid[1]):t==="highMid"?(t=this.highMid[0],o=this.highMid[1]):t==="treble"&&(t=this.treble[0],o=this.treble[1]),typeof t!="number")throw"invalid input for getEnergy()";if(o)if(t&&o){if(t>o){var M=o;o=t,t=M}for(var N=Math.round(t/f*this.freqDomain.length),L=Math.round(o/f*this.freqDomain.length),j=0,z=0,X=N;X<=L;X++)j+=this.freqDomain[X],z+=1;var he=j/z;return he}else throw"invalid input for getEnergy()";else{var x=Math.round(t/f*this.freqDomain.length);return this.freqDomain[x]}}},{key:"getFreq",value:function(t,o){console.log("getFreq() is deprecated. Please use getEnergy() instead.");var f=this.getEnergy(t,o);return f}},{key:"getCentroid",value:function(){for(var t=i.audiocontext.sampleRate/2,o=0,f=0,x=0;x<this.freqDomain.length;x++)o+=x*this.freqDomain[x],f+=this.freqDomain[x];var M=0;f!==0&&(M=o/f);var N=M*(t/this.freqDomain.length);return N}},{key:"smooth",value:function(t){return typeof t<"u"&&(this.smoothing=t),this.smoothing}},{key:"dispose",value:function(){var t=i.soundArray.indexOf(this);i.soundArray.splice(t,1),this.analyser&&(this.analyser.disconnect(),delete this.analyser)}},{key:"linAverages",value:function(t){for(var o=t||16,f=this.freqDomain,x=f.length,M=Math.floor(x/o),N=new Array(o),L=0,j=0;j<x;j++)N[L]=N[L]!==void 0?(N[L]+f[j])/2:f[j],j%M===M-1&&L++;return N}},{key:"logAverages",value:function(t){for(var o=i.audiocontext.sampleRate/2,f=this.freqDomain,x=f.length,M=new Array(t.length),N=0,L=0;L<x;L++){var j=Math.round(L*o/this.freqDomain.length);j>t[N].hi&&N++,M[N]=M[N]!==void 0?(M[N]+f[L])/2:f[L]}return M}},{key:"getOctaveBands",value:function(t,o){var f=t||3,x=o||15.625,M=[],N={lo:x/Math.pow(2,1/(2*f)),ctr:x,hi:x*Math.pow(2,1/(2*f))};M.push(N);for(var L=i.audiocontext.sampleRate/2;N.hi<L;){var j={};j.lo=N.hi,j.ctr=N.ctr*Math.pow(2,1/f),j.hi=j.ctr*Math.pow(2,1/(2*f)),M.push(j),N=j}return M}}]),s}();function He(s){s.freqDomain instanceof Float32Array||(s.freqDomain=new Float32Array(s.analyser.frequencyBinCount))}function Ye(s){s.freqDomain instanceof Uint8Array||(s.freqDomain=new Uint8Array(s.analyser.frequencyBinCount))}function Ke(s){s.timeDomain instanceof Float32Array||(s.timeDomain=new Float32Array(s.analyser.frequencyBinCount))}function Ze(s){s.timeDomain instanceof Uint8Array||(s.timeDomain=new Uint8Array(s.analyser.frequencyBinCount))}var be=Oe,It=T(4),Pe=T.n(It),Ae=T(1),fe=T.n(Ae),Nn=T(8),Xe=T.n(Nn);function Qe(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Qe=function(t){return typeof t}:Qe=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qe(s)}function $e(s,r){return r&&(Qe(r)==="object"||typeof r=="function")?r:Ln(s)}function Ln(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function Ce(s){return Ce=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ce(s)}function Je(s,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),r&&Nt(s,r)}function Nt(s,r){return Nt=Object.setPrototypeOf||function(o,f){return o.__proto__=f,o},Nt(s,r)}function Re(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function Vn(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function Un(s,r,t){return r&&Vn(s.prototype,r),s}function Lt(s,r,t,o,f){var x=s.oscillator;for(var M in s.mathOps)s.mathOps[M]instanceof f&&(x.disconnect(),s.mathOps[M].dispose(),t=M,t<s.mathOps.length-2&&(o=s.mathOps[M+1]));return t===s.mathOps.length-1&&s.mathOps.push(o),M>0&&(x=s.mathOps[M-1]),x.disconnect(),x.connect(r),r.connect(o),s.mathOps[t]=r,s}var Me=function(){function s(r,t){if(Re(this,s),typeof r=="string"){var o=t;t=r,r=o}if(typeof t=="number"){var f=t;t=r,r=f}this.started=!1,this.phaseAmount=void 0,this.oscillator=i.audiocontext.createOscillator(),this.f=r||440,this.oscillator.type=t||"sine",this.oscillator.frequency.setValueAtTime(this.f,i.audiocontext.currentTime),this.output=i.audiocontext.createGain(),this._freqMods=[],this.output.gain.value=.5,this.output.gain.setValueAtTime(.5,i.audiocontext.currentTime),this.oscillator.connect(this.output),this.panPosition=0,this.connection=i.input,this.panner=new J(this.output,this.connection,1),this.mathOps=[this.output],i.soundArray.push(this),this.fade=this.amp}return Un(s,[{key:"start",value:function(t,o){if(this.started){var f=i.audiocontext.currentTime;this.stop(f)}if(!this.started){var x=o||this.f,M=this.oscillator.type;this.oscillator&&(this.oscillator.disconnect(),delete this.oscillator),this.oscillator=i.audiocontext.createOscillator(),this.oscillator.frequency.value=Math.abs(x),this.oscillator.type=M,this.oscillator.connect(this.output),t=t||0,this.oscillator.start(t+i.audiocontext.currentTime),this.freqNode=this.oscillator.frequency;for(var N in this._freqMods)typeof this._freqMods[N].connect<"u"&&this._freqMods[N].connect(this.oscillator.frequency);this.started=!0}}},{key:"stop",value:function(t){if(this.started){var o=t||0,f=i.audiocontext.currentTime;this.oscillator.stop(o+f),this.started=!1}}},{key:"amp",value:function(t){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;if(typeof t=="number"){var x=i.audiocontext.currentTime;this.output.gain.linearRampToValueAtTime(t,x+f+o)}else if(t)t.connect(this.output.gain);else return this.output.gain}},{key:"getAmp",value:function(){return this.output.gain.value}},{key:"freq",value:function(t){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;if(typeof t=="number"&&!isNaN(t)){this.f=t;var x=i.audiocontext.currentTime;o===0?this.oscillator.frequency.setValueAtTime(t,f+x):t>0?this.oscillator.frequency.exponentialRampToValueAtTime(t,f+o+x):this.oscillator.frequency.linearRampToValueAtTime(t,f+o+x),this.phaseAmount&&this.phase(this.phaseAmount)}else if(t)t.output&&(t=t.output),t.connect(this.oscillator.frequency),this._freqMods.push(t);else return this.oscillator.frequency}},{key:"getFreq",value:function(){return this.oscillator.frequency.value}},{key:"setType",value:function(t){this.oscillator.type=t}},{key:"getType",value:function(){return this.oscillator.type}},{key:"connect",value:function(t){t?t.hasOwnProperty("input")?(this.panner.connect(t.input),this.connection=t.input):(this.panner.connect(t),this.connection=t):this.panner.connect(i.input)}},{key:"disconnect",value:function(){this.output&&this.output.disconnect(),this.panner&&(this.panner.disconnect(),this.output&&this.output.connect(this.panner)),this.oscMods=[]}},{key:"pan",value:function(t,o){this.panPosition=t,this.panner.pan(t,o)}},{key:"getPan",value:function(){return this.panPosition}},{key:"dispose",value:function(){var t=i.soundArray.indexOf(this);if(i.soundArray.splice(t,1),this.oscillator){var o=i.audiocontext.currentTime;this.stop(o),this.disconnect(),this.panner=null,this.oscillator=null}this.osc2&&this.osc2.dispose()}},{key:"phase",value:function(t){var o=p5.prototype.map(t,0,1,0,1/this.f),f=i.audiocontext.currentTime;this.phaseAmount=t,this.dNode||(this.dNode=i.audiocontext.createDelay(),this.oscillator.disconnect(),this.oscillator.connect(this.dNode),this.dNode.connect(this.output)),this.dNode.delayTime.setValueAtTime(o,f)}},{key:"add",value:function(t){var o=new Pe.a(t),f=this.mathOps.length-1,x=this.output;return Lt(this,o,f,x,Pe.a)}},{key:"mult",value:function(t){var o=new fe.a(t),f=this.mathOps.length-1,x=this.output;return Lt(this,o,f,x,fe.a)}},{key:"scale",value:function(t,o,f,x){var M,N;arguments.length===4?(M=p5.prototype.map(f,t,o,0,1)-.5,N=p5.prototype.map(x,t,o,0,1)-.5):(M=arguments[0],N=arguments[1]);var L=new Xe.a(M,N),j=this.mathOps.length-1,z=this.output;return Lt(this,L,j,z,Xe.a)}}]),s}(),Wn=function(s){Je(r,s);function r(t){return Re(this,r),$e(this,Ce(r).call(this,t,"sine"))}return r}(Me),qn=function(s){Je(r,s);function r(t){return Re(this,r),$e(this,Ce(r).call(this,t,"triangle"))}return r}(Me),cn=function(s){Je(r,s);function r(t){return Re(this,r),$e(this,Ce(r).call(this,t,"sawtooth"))}return r}(Me),Gn=function(s){Je(r,s);function r(t){return Re(this,r),$e(this,Ce(r).call(this,t,"square"))}return r}(Me),et=Me,jn=T(7),Vt=T.n(jn);p5.Envelope=function(s,r,t,o,f,x){this.aTime=s||.1,this.aLevel=r||1,this.dTime=t||.5,this.dLevel=o||0,this.rTime=f||0,this.rLevel=x||0,this._rampHighPercentage=.98,this._rampLowPercentage=.02,this.output=i.audiocontext.createGain(),this.control=new Vt.a,this._init(),this.control.connect(this.output),this.connection=null,this.mathOps=[this.control],this.isExponential=!1,this.sourceToClear=null,this.wasTriggered=!1,i.soundArray.push(this)},p5.Envelope.prototype._init=function(){var s=i.audiocontext.currentTime,r=s;this.control.setTargetAtTime(1e-5,r,.001),this._setRampAD(this.aTime,this.dTime)},p5.Envelope.prototype.set=function(s,r,t,o,f,x){this.aTime=s,this.aLevel=r,this.dTime=t||0,this.dLevel=o||0,this.rTime=f||0,this.rLevel=x||0,this._setRampAD(s,t)},p5.Envelope.prototype.setADSR=function(s,r,t,o){this.aTime=s,this.dTime=r||0,this.sPercent=t||0,this.dLevel=typeof t<"u"?t*(this.aLevel-this.rLevel)+this.rLevel:0,this.rTime=o||0,this._setRampAD(s,r)},p5.Envelope.prototype.setRange=function(s,r){this.aLevel=s||1,this.rLevel=r||0},p5.Envelope.prototype._setRampAD=function(s,r){this._rampAttackTime=this.checkExpInput(s),this._rampDecayTime=this.checkExpInput(r);var t=1;t=Math.log(1/this.checkExpInput(1-this._rampHighPercentage)),this._rampAttackTC=s/this.checkExpInput(t),t=Math.log(1/this._rampLowPercentage),this._rampDecayTC=r/this.checkExpInput(t)},p5.Envelope.prototype.setRampPercentages=function(s,r){this._rampHighPercentage=this.checkExpInput(s),this._rampLowPercentage=this.checkExpInput(r);var t=1;t=Math.log(1/this.checkExpInput(1-this._rampHighPercentage)),this._rampAttackTC=this._rampAttackTime/this.checkExpInput(t),t=Math.log(1/this._rampLowPercentage),this._rampDecayTC=this._rampDecayTime/this.checkExpInput(t)},p5.Envelope.prototype.setInput=function(){for(var s=0;s<arguments.length;s++)this.connect(arguments[s])},p5.Envelope.prototype.setExp=function(s){this.isExponential=s},p5.Envelope.prototype.checkExpInput=function(s){return s<=0&&(s=1e-8),s},p5.Envelope.prototype.play=function(s,r,t){var o=r||0;s&&this.connection!==s&&this.connect(s),this.triggerAttack(s,o),this.triggerRelease(s,o+this.aTime+this.dTime+~~t)},p5.Envelope.prototype.triggerAttack=function(s,r){var t=i.audiocontext.currentTime,o=r||0,f=t+o;this.lastAttack=f,this.wasTriggered=!0,s&&this.connection!==s&&this.connect(s);var x=this.control.getValueAtTime(f);this.isExponential===!0?this.control.exponentialRampToValueAtTime(this.checkExpInput(x),f):this.control.linearRampToValueAtTime(x,f),f+=this.aTime,this.isExponential===!0?(this.control.exponentialRampToValueAtTime(this.checkExpInput(this.aLevel),f),x=this.checkExpInput(this.control.getValueAtTime(f)),this.control.cancelScheduledValues(f),this.control.exponentialRampToValueAtTime(x,f)):(this.control.linearRampToValueAtTime(this.aLevel,f),x=this.control.getValueAtTime(f),this.control.cancelScheduledValues(f),this.control.linearRampToValueAtTime(x,f)),f+=this.dTime,this.isExponential===!0?(this.control.exponentialRampToValueAtTime(this.checkExpInput(this.dLevel),f),x=this.checkExpInput(this.control.getValueAtTime(f)),this.control.cancelScheduledValues(f),this.control.exponentialRampToValueAtTime(x,f)):(this.control.linearRampToValueAtTime(this.dLevel,f),x=this.control.getValueAtTime(f),this.control.cancelScheduledValues(f),this.control.linearRampToValueAtTime(x,f))},p5.Envelope.prototype.triggerRelease=function(s,r){if(this.wasTriggered){var t=i.audiocontext.currentTime,o=r||0,f=t+o;s&&this.connection!==s&&this.connect(s);var x=this.control.getValueAtTime(f);this.isExponential===!0?this.control.exponentialRampToValueAtTime(this.checkExpInput(x),f):this.control.linearRampToValueAtTime(x,f),f+=this.rTime,this.isExponential===!0?(this.control.exponentialRampToValueAtTime(this.checkExpInput(this.rLevel),f),x=this.checkExpInput(this.control.getValueAtTime(f)),this.control.cancelScheduledValues(f),this.control.exponentialRampToValueAtTime(x,f)):(this.control.linearRampToValueAtTime(this.rLevel,f),x=this.control.getValueAtTime(f),this.control.cancelScheduledValues(f),this.control.linearRampToValueAtTime(x,f)),this.wasTriggered=!1}},p5.Envelope.prototype.ramp=function(s,r,t,o){var f=i.audiocontext.currentTime,x=r||0,M=f+x,N=this.checkExpInput(t),L=typeof o<"u"?this.checkExpInput(o):void 0;s&&this.connection!==s&&this.connect(s);var j=this.checkExpInput(this.control.getValueAtTime(M));N>j?(this.control.setTargetAtTime(N,M,this._rampAttackTC),M+=this._rampAttackTime):N<j&&(this.control.setTargetAtTime(N,M,this._rampDecayTC),M+=this._rampDecayTime),L!==void 0&&(L>N?this.control.setTargetAtTime(L,M,this._rampAttackTC):L<N&&this.control.setTargetAtTime(L,M,this._rampDecayTC))},p5.Envelope.prototype.connect=function(s){this.connection=s,(s instanceof p5.Oscillator||s instanceof p5.SoundFile||s instanceof p5.AudioIn||s instanceof p5.Reverb||s instanceof p5.Noise||s instanceof p5.Filter||s instanceof p5.Delay)&&(s=s.output.gain),s instanceof AudioParam&&s.setValueAtTime(0,i.audiocontext.currentTime),this.output.connect(s)},p5.Envelope.prototype.disconnect=function(){this.output&&this.output.disconnect()},p5.Envelope.prototype.add=function(s){var r=new Pe.a(s),t=this.mathOps.length,o=this.output;return p5.prototype._mathChain(this,r,t,o,Pe.a)},p5.Envelope.prototype.mult=function(s){var r=new fe.a(s),t=this.mathOps.length,o=this.output;return p5.prototype._mathChain(this,r,t,o,fe.a)},p5.Envelope.prototype.scale=function(s,r,t,o){var f=new Xe.a(s,r,t,o),x=this.mathOps.length,M=this.output;return p5.prototype._mathChain(this,f,x,M,Xe.a)},p5.Envelope.prototype.dispose=function(){var s=i.soundArray.indexOf(this);i.soundArray.splice(s,1),this.disconnect(),this.control&&(this.control.dispose(),this.control=null);for(var r=1;r<this.mathOps.length;r++)this.mathOps[r].dispose()},p5.Env=function(s,r,t,o,f,x){console.warn("WARNING: p5.Env is now deprecated and may be removed in future versions. Please use the new p5.Envelope instead."),p5.Envelope.call(this,s,r,t,o,f,x)},p5.Env.prototype=Object.create(p5.Envelope.prototype);var zn=p5.Envelope,Hn=zn;function tt(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?tt=function(t){return typeof t}:tt=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tt(s)}function Yn(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function Kn(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function Zn(s,r,t){return r&&Kn(s.prototype,r),s}function Xn(s,r){return r&&(tt(r)==="object"||typeof r=="function")?r:Qn(s)}function Qn(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function Ut(s){return Ut=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ut(s)}function $n(s,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),r&&Wt(s,r)}function Wt(s,r){return Wt=Object.setPrototypeOf||function(o,f){return o.__proto__=f,o},Wt(s,r)}var qt=function(){for(var s=2*i.audiocontext.sampleRate,r=i.audiocontext.createBuffer(1,s,i.audiocontext.sampleRate),t=r.getChannelData(0),o=0;o<s;o++)t[o]=Math.random()*2-1;return r.type="white",r}(),fn=function(){var s=2*i.audiocontext.sampleRate,r=i.audiocontext.createBuffer(1,s,i.audiocontext.sampleRate),t=r.getChannelData(0),o,f,x,M,N,L,j;o=f=x=M=N=L=j=0;for(var z=0;z<s;z++){var X=Math.random()*2-1;o=.99886*o+X*.0555179,f=.99332*f+X*.0750759,x=.969*x+X*.153852,M=.8665*M+X*.3104856,N=.55*N+X*.5329522,L=-.7616*L-X*.016898,t[z]=o+f+x+M+N+L+j+X*.5362,t[z]*=.11,j=X*.115926}return r.type="pink",r}(),hn=function(){for(var s=2*i.audiocontext.sampleRate,r=i.audiocontext.createBuffer(1,s,i.audiocontext.sampleRate),t=r.getChannelData(0),o=0,f=0;f<s;f++){var x=Math.random()*2-1;t[f]=(o+.02*x)/1.02,o=t[f],t[f]*=3.5}return r.type="brown",r}(),Jn=function(s){$n(r,s);function r(t){var o;Yn(this,r),o=Xn(this,Ut(r).call(this));var f;return delete o.f,delete o.freq,delete o.oscillator,t==="brown"?f=hn:t==="pink"?f=fn:f=qt,o.buffer=f,o}return Zn(r,[{key:"setType",value:function(o){switch(o){case"white":this.buffer=qt;break;case"pink":this.buffer=fn;break;case"brown":this.buffer=hn;break;default:this.buffer=qt}if(this.started){var f=i.audiocontext.currentTime;this.stop(f),this.start(f+.01)}}},{key:"getType",value:function(){return this.buffer.type}},{key:"start",value:function(){this.started&&this.stop(),this.noise=i.audiocontext.createBufferSource(),this.noise.buffer=this.buffer,this.noise.loop=!0,this.noise.connect(this.output);var o=i.audiocontext.currentTime;this.noise.start(o),this.started=!0}},{key:"stop",value:function(){var o=i.audiocontext.currentTime;this.noise&&(this.noise.stop(o),this.started=!1)}},{key:"dispose",value:function(){var o=i.audiocontext.currentTime,f=i.soundArray.indexOf(this);i.soundArray.splice(f,1),this.noise&&(this.noise.disconnect(),this.stop(o)),this.output&&this.output.disconnect(),this.panner&&this.panner.disconnect(),this.output=null,this.panner=null,this.buffer=null,this.noise=null}}]),r}(et),ei=Jn,ti=T(2),ni=T.n(ti);function nt(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?nt=function(t){return typeof t}:nt=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nt(s)}function ii(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function ri(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function oi(s,r,t){return r&&ri(s.prototype,r),s}function si(s,r){return r&&(nt(r)==="object"||typeof r=="function")?r:ai(s)}function ai(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function Gt(s){return Gt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Gt(s)}function ui(s,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),r&&jt(s,r)}function jt(s,r){return jt=Object.setPrototypeOf||function(o,f){return o.__proto__=f,o},jt(s,r)}var li=function(s){ui(r,s);function r(t,o){var f;ii(this,r),f=si(this,Gt(r).call(this,t,"sawtooth")),f.w=o||0,f.osc2=new cn(t),f.dNode=i.audiocontext.createDelay(),f.dcOffset=pn(),f.dcGain=i.audiocontext.createGain(),f.dcOffset.connect(f.dcGain),f.dcGain.connect(f.output),f.f=t||440;var x=f.w/f.oscillator.frequency.value;return f.dNode.delayTime.value=x,f.dcGain.gain.value=1.7*(.5-f.w),f.osc2.disconnect(),f.osc2.panner.disconnect(),f.osc2.amp(-1),f.osc2.output.connect(f.dNode),f.dNode.connect(f.output),f.output.gain.value=1,f.output.connect(f.panner),f}return oi(r,[{key:"width",value:function(o){if(typeof o=="number"){if(o<=1&&o>=0){this.w=o;var f=this.w/this.oscillator.frequency.value;this.dNode.delayTime.value=f}this.dcGain.gain.value=1.7*(.5-this.w)}else{o.connect(this.dNode.delayTime);var x=new ni.a(-.5);o.connect(x);var M=new fe.a(-1),N=new fe.a(1.7);x=x.connect(M).connect(N),x.connect(this.dcGain.gain)}}},{key:"start",value:function(o,f){var x=i.audiocontext.currentTime,M=f||0;if(!this.started){var N=o||this.f,L=this.oscillator.type;this.oscillator=i.audiocontext.createOscillator(),this.oscillator.frequency.setValueAtTime(N,x),this.oscillator.type=L,this.oscillator.connect(this.output),this.oscillator.start(M+x),this.osc2.oscillator=i.audiocontext.createOscillator(),this.osc2.oscillator.frequency.setValueAtTime(N,M+x),this.osc2.oscillator.type=L,this.osc2.oscillator.connect(this.osc2.output),this.osc2.start(M+x),this.freqNode=[this.oscillator.frequency,this.osc2.oscillator.frequency],this.dcOffset=pn(),this.dcOffset.connect(this.dcGain),this.dcOffset.start(M+x),this.mods!==void 0&&this.mods.frequency!==void 0&&(this.mods.frequency.connect(this.freqNode[0]),this.mods.frequency.connect(this.freqNode[1])),this.started=!0,this.osc2.started=!0}}},{key:"stop",value:function(o){if(this.started){var f=o||0,x=i.audiocontext.currentTime;this.oscillator.stop(f+x),this.osc2.oscillator&&this.osc2.oscillator.stop(f+x),this.dcOffset.stop(f+x),this.started=!1,this.osc2.started=!1}}},{key:"freq",value:function(o){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,x=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;if(typeof o=="number"){this.f=o;var M=i.audiocontext.currentTime,N=this.oscillator.frequency.value;this.oscillator.frequency.cancelScheduledValues(M),this.oscillator.frequency.setValueAtTime(N,M+x),this.oscillator.frequency.exponentialRampToValueAtTime(o,x+f+M),this.osc2.oscillator.frequency.cancelScheduledValues(M),this.osc2.oscillator.frequency.setValueAtTime(N,M+x),this.osc2.oscillator.frequency.exponentialRampToValueAtTime(o,x+f+M),this.freqMod&&(this.freqMod.output.disconnect(),this.freqMod=null)}else o.output&&(o.output.disconnect(),o.output.connect(this.oscillator.frequency),o.output.connect(this.osc2.oscillator.frequency),this.freqMod=o)}}]),r}(et);function pn(){for(var s=i.audiocontext,r=s.createBuffer(1,2048,s.sampleRate),t=r.getChannelData(0),o=0;o<2048;o++)t[o]=1;var f=s.createBufferSource();return f.buffer=r,f.loop=!0,f}var ci=li;function fi(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function hi(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function pi(s,r,t){return r&&hi(s.prototype,r),s}i.inputSources=[];var di=function(){function s(r){fi(this,s),this.input=i.audiocontext.createGain(),this.output=i.audiocontext.createGain(),this.stream=null,this.mediaStream=null,this.currentSource=null,this.enabled=!1,this.amplitude=new ke,this.output.connect(this.amplitude.input),(!window.MediaStreamTrack||!window.navigator.mediaDevices||!window.navigator.mediaDevices.getUserMedia)&&(r?r():window.alert("This browser does not support MediaStreamTrack and mediaDevices")),i.soundArray.push(this)}return pi(s,[{key:"start",value:function(t,o){var f=this;this.stream&&this.stop();var x=i.inputSources[f.currentSource],M={audio:{sampleRate:i.audiocontext.sampleRate,echoCancellation:!1}};i.inputSources[this.currentSource]&&(M.audio.deviceId=x.deviceId),window.navigator.mediaDevices.getUserMedia(M).then(function(N){f.stream=N,f.enabled=!0,f.mediaStream=i.audiocontext.createMediaStreamSource(N),f.mediaStream.connect(f.output),f.amplitude.setInput(f.output),t&&t()}).catch(function(N){o?o(N):console.error(N)})}},{key:"stop",value:function(){this.stream&&(this.stream.getTracks().forEach(function(t){t.stop()}),this.mediaStream.disconnect(),delete this.mediaStream,delete this.stream)}},{key:"connect",value:function(t){t?t.hasOwnProperty("input")?this.output.connect(t.input):t.hasOwnProperty("analyser")?this.output.connect(t.analyser):this.output.connect(t):this.output.connect(i.input)}},{key:"disconnect",value:function(){this.output&&(this.output.disconnect(),this.output.connect(this.amplitude.input))}},{key:"getLevel",value:function(t){return t&&(this.amplitude.smoothing=t),this.amplitude.getLevel()}},{key:"amp",value:function(t,o){if(o){var f=o||0,x=this.output.gain.value;this.output.gain.cancelScheduledValues(i.audiocontext.currentTime),this.output.gain.setValueAtTime(x,i.audiocontext.currentTime),this.output.gain.linearRampToValueAtTime(t,f+i.audiocontext.currentTime)}else this.output.gain.cancelScheduledValues(i.audiocontext.currentTime),this.output.gain.setValueAtTime(t,i.audiocontext.currentTime)}},{key:"getSources",value:function(t,o){return new Promise(function(f,x){window.navigator.mediaDevices.enumerateDevices().then(function(M){i.inputSources=M.filter(function(N){return N.kind==="audioinput"}),f(i.inputSources),t&&t(i.inputSources)}).catch(function(M){x(M),o?o(M):console.error("This browser does not support MediaStreamTrack.getSources()")})})}},{key:"setSource",value:function(t){i.inputSources.length>0&&t<i.inputSources.length?(this.currentSource=t,console.log("set source to ",i.inputSources[this.currentSource])):console.log("unable to set input source"),this.stream&&this.stream.active&&this.start()}},{key:"dispose",value:function(){var t=i.soundArray.indexOf(this);i.soundArray.splice(t,1),this.stop(),this.output&&this.output.disconnect(),this.amplitude&&this.amplitude.disconnect(),delete this.amplitude,delete this.output}}]),s}(),mi=di,vi=T(23),yi=T.n(vi);function gi(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function xi(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function _i(s,r,t){return r&&xi(s.prototype,r),s}var Ti=function(){function s(){gi(this,s),this.ac=i.audiocontext,this.input=this.ac.createGain(),this.output=this.ac.createGain(),this._drywet=new yi.a(1),this.wet=this.ac.createGain(),this.input.connect(this._drywet.a),this.wet.connect(this._drywet.b),this._drywet.connect(this.output),this.connect(),i.soundArray.push(this)}return _i(s,[{key:"amp",value:function(t){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,x=i.audiocontext.currentTime,M=x+f,N=M+o+.001,L=this.output.gain.value;this.output.gain.cancelScheduledValues(x),this.output.gain.linearRampToValueAtTime(L,M+.001),this.output.gain.linearRampToValueAtTime(t,N)}},{key:"chain",value:function(){if(arguments.length>0){this.connect(arguments[0]);for(var t=1;t<arguments.length;t+=1)arguments[t-1].connect(arguments[t])}return this}},{key:"drywet",value:function(t){return typeof t<"u"&&(this._drywet.fade.value=t),this._drywet.fade.value}},{key:"connect",value:function(t){var o=t||p5.soundOut.input;this.output.connect(o.input?o.input:o)}},{key:"disconnect",value:function(){this.output&&this.output.disconnect()}},{key:"dispose",value:function(){var t=i.soundArray.indexOf(this);i.soundArray.splice(t,1),this.input&&(this.input.disconnect(),delete this.input),this.output&&(this.output.disconnect(),delete this.output),this._drywet&&(this._drywet.disconnect(),delete this._drywet),this.wet&&(this.wet.disconnect(),delete this.wet),this.ac=void 0}}]),s}(),me=Ti;function it(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?it=function(t){return typeof t}:it=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},it(s)}function rt(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function Si(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function wi(s,r,t){return r&&Si(s.prototype,r),s}function ot(s,r){return r&&(it(r)==="object"||typeof r=="function")?r:bi(s)}function bi(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function st(s,r,t){return typeof Reflect<"u"&&Reflect.get?st=Reflect.get:st=function(f,x,M){var N=Pi(f,x);if(N){var L=Object.getOwnPropertyDescriptor(N,x);return L.get?L.get.call(M):L.value}},st(s,r,t||s)}function Pi(s,r){for(;!Object.prototype.hasOwnProperty.call(s,r)&&(s=ve(s),s!==null););return s}function ve(s){return ve=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ve(s)}function at(s,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),r&&zt(s,r)}function zt(s,r){return zt=Object.setPrototypeOf||function(o,f){return o.__proto__=f,o},zt(s,r)}var ut=function(s){at(r,s);function r(t){var o;return rt(this,r),o=ot(this,ve(r).call(this)),o.biquad=o.ac.createBiquadFilter(),o.input.connect(o.biquad),o.biquad.connect(o.wet),t&&o.setType(t),o._on=!0,o._untoggledType=o.biquad.type,o}return wi(r,[{key:"process",value:function(o,f,x,M){o.connect(this.input),this.set(f,x,M)}},{key:"set",value:function(o,f,x){o&&this.freq(o,x),f&&this.res(f,x)}},{key:"freq",value:function(o,f){var x=f||0;return o<=0&&(o=1),typeof o=="number"?(this.biquad.frequency.cancelScheduledValues(this.ac.currentTime+.01+x),this.biquad.frequency.exponentialRampToValueAtTime(o,this.ac.currentTime+.02+x)):o&&o.connect(this.biquad.frequency),this.biquad.frequency.value}},{key:"res",value:function(o,f){var x=f||0;return typeof o=="number"?(this.biquad.Q.value=o,this.biquad.Q.cancelScheduledValues(this.ac.currentTime+.01+x),this.biquad.Q.linearRampToValueAtTime(o,this.ac.currentTime+.02+x)):o&&o.connect(this.biquad.Q),this.biquad.Q.value}},{key:"gain",value:function(o,f){var x=f||0;return typeof o=="number"?(this.biquad.gain.value=o,this.biquad.gain.cancelScheduledValues(this.ac.currentTime+.01+x),this.biquad.gain.linearRampToValueAtTime(o,this.ac.currentTime+.02+x)):o&&o.connect(this.biquad.gain),this.biquad.gain.value}},{key:"toggle",value:function(){return this._on=!this._on,this._on===!0?this.biquad.type=this._untoggledType:this._on===!1&&(this.biquad.type="allpass"),this._on}},{key:"setType",value:function(o){this.biquad.type=o,this._untoggledType=this.biquad.type}},{key:"dispose",value:function(){st(ve(r.prototype),"dispose",this).call(this),this.biquad&&(this.biquad.disconnect(),delete this.biquad)}}]),r}(me),Ai=function(s){at(r,s);function r(){return rt(this,r),ot(this,ve(r).call(this,"lowpass"))}return r}(ut),Ci=function(s){at(r,s);function r(){return rt(this,r),ot(this,ve(r).call(this,"highpass"))}return r}(ut),ki=function(s){at(r,s);function r(){return rt(this,r),ot(this,ve(r).call(this,"bandpass"))}return r}(ut),lt=ut;function ct(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ct=function(t){return typeof t}:ct=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ct(s)}function Ei(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function Oi(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function Ri(s,r,t){return r&&Oi(s.prototype,r),s}function Mi(s,r){return r&&(ct(r)==="object"||typeof r=="function")?r:Bi(s)}function Bi(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function Ht(s){return Ht=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ht(s)}function Di(s,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),r&&Yt(s,r)}function Yt(s,r){return Yt=Object.setPrototypeOf||function(o,f){return o.__proto__=f,o},Yt(s,r)}var Fi=function(s){Di(r,s);function r(t,o){var f;return Ei(this,r),f=Mi(this,Ht(r).call(this,"peaking")),f.disconnect(),f.set(t,o),f.biquad.gain.value=0,delete f.input,delete f.output,delete f._drywet,delete f.wet,f}return Ri(r,[{key:"amp",value:function(){console.warn("`amp()` is not available for p5.EQ bands. Use `.gain()`")}},{key:"drywet",value:function(){console.warn("`drywet()` is not available for p5.EQ bands.")}},{key:"connect",value:function(o){var f=o||p5.soundOut.input;this.biquad?this.biquad.connect(f.input?f.input:f):this.output.connect(f.input?f.input:f)}},{key:"disconnect",value:function(){this.biquad&&this.biquad.disconnect()}},{key:"dispose",value:function(){var o=i.soundArray.indexOf(this);i.soundArray.splice(o,1),this.disconnect(),delete this.biquad}}]),r}(lt),Ii=Fi;function ft(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ft=function(t){return typeof t}:ft=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ft(s)}function Ni(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function Li(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function Vi(s,r,t){return r&&Li(s.prototype,r),s}function Ui(s,r){return r&&(ft(r)==="object"||typeof r=="function")?r:Wi(s)}function Wi(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function ht(s,r,t){return typeof Reflect<"u"&&Reflect.get?ht=Reflect.get:ht=function(f,x,M){var N=qi(f,x);if(N){var L=Object.getOwnPropertyDescriptor(N,x);return L.get?L.get.call(M):L.value}},ht(s,r,t||s)}function qi(s,r){for(;!Object.prototype.hasOwnProperty.call(s,r)&&(s=Be(s),s!==null););return s}function Be(s){return Be=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Be(s)}function Gi(s,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),r&&Kt(s,r)}function Kt(s,r){return Kt=Object.setPrototypeOf||function(o,f){return o.__proto__=f,o},Kt(s,r)}var ji=function(s){Gi(r,s);function r(t){var o;Ni(this,r),o=Ui(this,Be(r).call(this)),t=t===3||t===8?t:3;var f;t===3?f=Math.pow(2,3):f=2,o.bands=[];for(var x,M,N=0;N<t;N++)N===t-1?(x=21e3,M=.01):N===0?(x=100,M=.1):N===1?(x=t===3?360*f:360,M=1):(x=o.bands[N-1].freq()*f,M=1),o.bands[N]=o._newBand(x,M),N>0?o.bands[N-1].connect(o.bands[N].biquad):o.input.connect(o.bands[N].biquad);return o.bands[t-1].connect(o.output),o}return Vi(r,[{key:"process",value:function(o){o.connect(this.input)}},{key:"set",value:function(){if(arguments.length===this.bands.length*2)for(var o=0;o<arguments.length;o+=2)this.bands[o/2].freq(arguments[o]),this.bands[o/2].gain(arguments[o+1]);else console.error("Argument mismatch. .set() should be called with "+this.bands.length*2+" arguments. (one frequency and gain value pair for each band of the eq)")}},{key:"_newBand",value:function(o,f){return new Ii(o,f)}},{key:"dispose",value:function(){if(ht(Be(r.prototype),"dispose",this).call(this),this.bands){for(;this.bands.length>0;)delete this.bands.pop().dispose();delete this.bands}}}]),r}(me),zi=ji;function Hi(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function Yi(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function Ki(s,r,t){return r&&Yi(s.prototype,r),s}var Zi=function(){function s(r){Hi(this,s),this.ac=i.audiocontext,this.listener=this.ac.listener}return Ki(s,[{key:"process",value:function(t){t.connect(this.input)}},{key:"position",value:function(t,o,f,x){return this.positionX(t,x),this.positionY(o,x),this.positionZ(f,x),[this.listener.positionX.value,this.listener.positionY.value,this.listener.positionZ.value]}},{key:"positionX",value:function(t,o){var f=o||0;return typeof t=="number"?(this.listener.positionX.value=t,this.listener.positionX.cancelScheduledValues(this.ac.currentTime+.01+f),this.listener.positionX.linearRampToValueAtTime(t,this.ac.currentTime+.02+f)):t&&t.connect(this.listener.positionX),this.listener.positionX.value}},{key:"positionY",value:function(t,o){var f=o||0;return typeof t=="number"?(this.listener.positionY.value=t,this.listener.positionY.cancelScheduledValues(this.ac.currentTime+.01+f),this.listener.positionY.linearRampToValueAtTime(t,this.ac.currentTime+.02+f)):t&&t.connect(this.listener.positionY),this.listener.positionY.value}},{key:"positionZ",value:function(t,o){var f=o||0;return typeof t=="number"?(this.listener.positionZ.value=t,this.listener.positionZ.cancelScheduledValues(this.ac.currentTime+.01+f),this.listener.positionZ.linearRampToValueAtTime(t,this.ac.currentTime+.02+f)):t&&t.connect(this.listener.positionZ),this.listener.positionZ.value}},{key:"orient",value:function(t,o,f,x,M,N,L){return arguments.length===3||arguments.length===4?(L=arguments[3],this.orientForward(t,o,f,L)):(arguments.length===6||arguments===7)&&(this.orientForward(t,o,f),this.orientUp(x,M,N,L)),[this.listener.forwardX.value,this.listener.forwardY.value,this.listener.forwardZ.value,this.listener.upX.value,this.listener.upY.value,this.listener.upZ.value]}},{key:"orientForward",value:function(t,o,f,x){return this.forwardX(t,x),this.forwardY(o,x),this.forwardZ(f,x),[this.listener.forwardX,this.listener.forwardY,this.listener.forwardZ]}},{key:"orientUp",value:function(t,o,f,x){return this.upX(t,x),this.upY(o,x),this.upZ(f,x),[this.listener.upX,this.listener.upY,this.listener.upZ]}},{key:"forwardX",value:function(t,o){var f=o||0;return typeof t=="number"?(this.listener.forwardX.value=t,this.listener.forwardX.cancelScheduledValues(this.ac.currentTime+.01+f),this.listener.forwardX.linearRampToValueAtTime(t,this.ac.currentTime+.02+f)):t&&t.connect(this.listener.forwardX),this.listener.forwardX.value}},{key:"forwardY",value:function(t,o){var f=o||0;return typeof t=="number"?(this.listener.forwardY.value=t,this.listener.forwardY.cancelScheduledValues(this.ac.currentTime+.01+f),this.listener.forwardY.linearRampToValueAtTime(t,this.ac.currentTime+.02+f)):t&&t.connect(this.listener.forwardY),this.listener.forwardY.value}},{key:"forwardZ",value:function(t,o){var f=o||0;return typeof t=="number"?(this.listener.forwardZ.value=t,this.listener.forwardZ.cancelScheduledValues(this.ac.currentTime+.01+f),this.listener.forwardZ.linearRampToValueAtTime(t,this.ac.currentTime+.02+f)):t&&t.connect(this.listener.forwardZ),this.listener.forwardZ.value}},{key:"upX",value:function(t,o){var f=o||0;return typeof t=="number"?(this.listener.upX.value=t,this.listener.upX.cancelScheduledValues(this.ac.currentTime+.01+f),this.listener.upX.linearRampToValueAtTime(t,this.ac.currentTime+.02+f)):t&&t.connect(this.listener.upX),this.listener.upX.value}},{key:"upY",value:function(t,o){var f=o||0;return typeof t=="number"?(this.listener.upY.value=t,this.listener.upY.cancelScheduledValues(this.ac.currentTime+.01+f),this.listener.upY.linearRampToValueAtTime(t,this.ac.currentTime+.02+f)):t&&t.connect(this.listener.upY),this.listener.upY.value}},{key:"upZ",value:function(t,o){var f=o||0;return typeof t=="number"?(this.listener.upZ.value=t,this.listener.upZ.cancelScheduledValues(this.ac.currentTime+.01+f),this.listener.upZ.linearRampToValueAtTime(t,this.ac.currentTime+.02+f)):t&&t.connect(this.listener.upZ),this.listener.upZ.value}}]),s}(),Xi=Zi;function pt(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?pt=function(t){return typeof t}:pt=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pt(s)}function Qi(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function $i(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function Ji(s,r,t){return r&&$i(s.prototype,r),s}function er(s,r){return r&&(pt(r)==="object"||typeof r=="function")?r:tr(s)}function tr(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function dt(s,r,t){return typeof Reflect<"u"&&Reflect.get?dt=Reflect.get:dt=function(f,x,M){var N=nr(f,x);if(N){var L=Object.getOwnPropertyDescriptor(N,x);return L.get?L.get.call(M):L.value}},dt(s,r,t||s)}function nr(s,r){for(;!Object.prototype.hasOwnProperty.call(s,r)&&(s=De(s),s!==null););return s}function De(s){return De=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},De(s)}function ir(s,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),r&&Zt(s,r)}function Zt(s,r){return Zt=Object.setPrototypeOf||function(o,f){return o.__proto__=f,o},Zt(s,r)}var rr=function(s){ir(r,s);function r(){var t;return Qi(this,r),t=er(this,De(r).call(this)),t.panner=t.ac.createPanner(),t.panner.panningModel="HRTF",t.panner.distanceModel="linear",t.panner.connect(t.output),t.input.connect(t.panner),t}return Ji(r,[{key:"process",value:function(o){o.connect(this.input)}},{key:"set",value:function(o,f,x,M){return this.positionX(o,M),this.positionY(f,M),this.positionZ(x,M),[this.panner.positionX.value,this.panner.positionY.value,this.panner.positionZ.value]}},{key:"positionX",value:function(o,f){var x=f||0;return typeof o=="number"?(this.panner.positionX.value=o,this.panner.positionX.cancelScheduledValues(this.ac.currentTime+.01+x),this.panner.positionX.linearRampToValueAtTime(o,this.ac.currentTime+.02+x)):o&&o.connect(this.panner.positionX),this.panner.positionX.value}},{key:"positionY",value:function(o,f){var x=f||0;return typeof o=="number"?(this.panner.positionY.value=o,this.panner.positionY.cancelScheduledValues(this.ac.currentTime+.01+x),this.panner.positionY.linearRampToValueAtTime(o,this.ac.currentTime+.02+x)):o&&o.connect(this.panner.positionY),this.panner.positionY.value}},{key:"positionZ",value:function(o,f){var x=f||0;return typeof o=="number"?(this.panner.positionZ.value=o,this.panner.positionZ.cancelScheduledValues(this.ac.currentTime+.01+x),this.panner.positionZ.linearRampToValueAtTime(o,this.ac.currentTime+.02+x)):o&&o.connect(this.panner.positionZ),this.panner.positionZ.value}},{key:"orient",value:function(o,f,x,M){return this.orientX(o,M),this.orientY(f,M),this.orientZ(x,M),[this.panner.orientationX.value,this.panner.orientationY.value,this.panner.orientationZ.value]}},{key:"orientX",value:function(o,f){var x=f||0;return typeof o=="number"?(this.panner.orientationX.value=o,this.panner.orientationX.cancelScheduledValues(this.ac.currentTime+.01+x),this.panner.orientationX.linearRampToValueAtTime(o,this.ac.currentTime+.02+x)):o&&o.connect(this.panner.orientationX),this.panner.orientationX.value}},{key:"orientY",value:function(o,f){var x=f||0;return typeof o=="number"?(this.panner.orientationY.value=o,this.panner.orientationY.cancelScheduledValues(this.ac.currentTime+.01+x),this.panner.orientationY.linearRampToValueAtTime(o,this.ac.currentTime+.02+x)):o&&o.connect(this.panner.orientationY),this.panner.orientationY.value}},{key:"orientZ",value:function(o,f){var x=f||0;return typeof o=="number"?(this.panner.orientationZ.value=o,this.panner.orientationZ.cancelScheduledValues(this.ac.currentTime+.01+x),this.panner.orientationZ.linearRampToValueAtTime(o,this.ac.currentTime+.02+x)):o&&o.connect(this.panner.orientationZ),this.panner.orientationZ.value}},{key:"setFalloff",value:function(o,f){this.maxDist(o),this.rolloff(f)}},{key:"maxDist",value:function(o){return typeof o=="number"&&(this.panner.maxDistance=o),this.panner.maxDistance}},{key:"rolloff",value:function(o){return typeof o=="number"&&(this.panner.rolloffFactor=o),this.panner.rolloffFactor}},{key:"dispose",value:function(){dt(De(r.prototype),"dispose",this).call(this),this.panner&&(this.panner.disconnect(),delete this.panner)}}]),r}(me),or=rr;function mt(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?mt=function(t){return typeof t}:mt=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mt(s)}function sr(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function ar(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function ur(s,r,t){return r&&ar(s.prototype,r),s}function lr(s,r){return r&&(mt(r)==="object"||typeof r=="function")?r:cr(s)}function cr(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function vt(s,r,t){return typeof Reflect<"u"&&Reflect.get?vt=Reflect.get:vt=function(f,x,M){var N=fr(f,x);if(N){var L=Object.getOwnPropertyDescriptor(N,x);return L.get?L.get.call(M):L.value}},vt(s,r,t||s)}function fr(s,r){for(;!Object.prototype.hasOwnProperty.call(s,r)&&(s=Fe(s),s!==null););return s}function Fe(s){return Fe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Fe(s)}function hr(s,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),r&&Xt(s,r)}function Xt(s,r){return Xt=Object.setPrototypeOf||function(o,f){return o.__proto__=f,o},Xt(s,r)}var pr=function(s){hr(r,s);function r(){var t;return sr(this,r),t=lr(this,Fe(r).call(this)),t._split=t.ac.createChannelSplitter(2),t._merge=t.ac.createChannelMerger(2),t._leftGain=t.ac.createGain(),t._rightGain=t.ac.createGain(),t.leftDelay=t.ac.createDelay(),t.rightDelay=t.ac.createDelay(),t._leftFilter=new lt,t._rightFilter=new lt,t._leftFilter.disconnect(),t._rightFilter.disconnect(),t._leftFilter.biquad.frequency.setValueAtTime(1200,t.ac.currentTime),t._rightFilter.biquad.frequency.setValueAtTime(1200,t.ac.currentTime),t._leftFilter.biquad.Q.setValueAtTime(.3,t.ac.currentTime),t._rightFilter.biquad.Q.setValueAtTime(.3,t.ac.currentTime),t.input.connect(t._split),t.leftDelay.connect(t._leftGain),t.rightDelay.connect(t._rightGain),t._leftGain.connect(t._leftFilter.input),t._rightGain.connect(t._rightFilter.input),t._merge.connect(t.wet),t._leftFilter.biquad.gain.setValueAtTime(1,t.ac.currentTime),t._rightFilter.biquad.gain.setValueAtTime(1,t.ac.currentTime),t.setType(0),t._maxDelay=t.leftDelay.delayTime.maxValue,t.feedback(.5),t}return ur(r,[{key:"process",value:function(o,f,x,M){var N=x||0,L=f||0;if(N>=1)throw new Error("Feedback value will force a positive feedback loop.");if(L>=this._maxDelay)throw new Error("Delay Time exceeds maximum delay time of "+this._maxDelay+" second.");o.connect(this.input),this.leftDelay.delayTime.setValueAtTime(L,this.ac.currentTime),this.rightDelay.delayTime.setValueAtTime(L,this.ac.currentTime),this._leftGain.gain.value=N,this._rightGain.gain.value=N,M&&(this._leftFilter.freq(M),this._rightFilter.freq(M))}},{key:"delayTime",value:function(o){typeof o!="number"?(o.connect(this.leftDelay.delayTime),o.connect(this.rightDelay.delayTime)):(this.leftDelay.delayTime.cancelScheduledValues(this.ac.currentTime),this.rightDelay.delayTime.cancelScheduledValues(this.ac.currentTime),this.leftDelay.delayTime.linearRampToValueAtTime(o,this.ac.currentTime),this.rightDelay.delayTime.linearRampToValueAtTime(o,this.ac.currentTime))}},{key:"feedback",value:function(o){if(o&&typeof o!="number")o.connect(this._leftGain.gain),o.connect(this._rightGain.gain);else{if(o>=1)throw new Error("Feedback value will force a positive feedback loop.");typeof o=="number"&&(this._leftGain.gain.value=o,this._rightGain.gain.value=o)}return this._leftGain.gain.value}},{key:"filter",value:function(o,f){this._leftFilter.set(o,f),this._rightFilter.set(o,f)}},{key:"setType",value:function(o){switch(o===1&&(o="pingPong"),this._split.disconnect(),this._leftFilter.disconnect(),this._rightFilter.disconnect(),this._split.connect(this.leftDelay,0),this._split.connect(this.rightDelay,1),o){case"pingPong":this._rightFilter.setType(this._leftFilter.biquad.type),this._leftFilter.output.connect(this._merge,0,0),this._rightFilter.output.connect(this._merge,0,1),this._leftFilter.output.connect(this.rightDelay),this._rightFilter.output.connect(this.leftDelay);break;default:this._leftFilter.output.connect(this._merge,0,0),this._rightFilter.output.connect(this._merge,0,1),this._leftFilter.output.connect(this.leftDelay),this._rightFilter.output.connect(this.rightDelay)}}},{key:"dispose",value:function(){vt(Fe(r.prototype),"dispose",this).call(this),this._split.disconnect(),this._leftFilter.dispose(),this._rightFilter.dispose(),this._merge.disconnect(),this._leftGain.disconnect(),this._rightGain.disconnect(),this.leftDelay.disconnect(),this.rightDelay.disconnect(),this._split=void 0,this._leftFilter=void 0,this._rightFilter=void 0,this._merge=void 0,this._leftGain=void 0,this._rightGain=void 0,this.leftDelay=void 0,this.rightDelay=void 0}}]),r}(me),dr=pr;function yt(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?yt=function(t){return typeof t}:yt=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yt(s)}function dn(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function mr(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function mn(s,r,t){return r&&mr(s.prototype,r),s}function vn(s,r){return r&&(yt(r)==="object"||typeof r=="function")?r:vr(s)}function vr(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function Ie(s,r,t){return typeof Reflect<"u"&&Reflect.get?Ie=Reflect.get:Ie=function(f,x,M){var N=yr(f,x);if(N){var L=Object.getOwnPropertyDescriptor(N,x);return L.get?L.get.call(M):L.value}},Ie(s,r,t||s)}function yr(s,r){for(;!Object.prototype.hasOwnProperty.call(s,r)&&(s=xe(s),s!==null););return s}function xe(s){return xe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},xe(s)}function yn(s,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),r&&Qt(s,r)}function Qt(s,r){return Qt=Object.setPrototypeOf||function(o,f){return o.__proto__=f,o},Qt(s,r)}var gn=function(s){yn(r,s);function r(){var t;return dn(this,r),t=vn(this,xe(r).call(this)),t._initConvolverNode(),t.input.gain.value=.5,t._seconds=3,t._decay=2,t._reverse=!1,t._buildImpulse(),t}return mn(r,[{key:"_initConvolverNode",value:function(){this.convolverNode=this.ac.createConvolver(),this.input.connect(this.convolverNode),this.convolverNode.connect(this.wet)}},{key:"_teardownConvolverNode",value:function(){this.convolverNode&&(this.convolverNode.disconnect(),delete this.convolverNode)}},{key:"_setBuffer",value:function(o){this._teardownConvolverNode(),this._initConvolverNode(),this.convolverNode.buffer=o}},{key:"process",value:function(o,f,x,M){o.connect(this.input);var N=!1;f&&(this._seconds=f,N=!0),x&&(this._decay=x),M&&(this._reverse=M),N&&this._buildImpulse()}},{key:"set",value:function(o,f,x){var M=!1;o&&(this._seconds=o,M=!0),f&&(this._decay=f),x&&(this._reverse=x),M&&this._buildImpulse()}},{key:"_buildImpulse",value:function(){var o=this.ac.sampleRate,f=o*this._seconds,x=this._decay,M=this.ac.createBuffer(2,f,o),N=M.getChannelData(0),L=M.getChannelData(1),j,z;for(z=0;z<f;z++)j=this._reverse?f-z:z,N[z]=(Math.random()*2-1)*Math.pow(1-j/f,x),L[z]=(Math.random()*2-1)*Math.pow(1-j/f,x);this._setBuffer(M)}},{key:"dispose",value:function(){Ie(xe(r.prototype),"dispose",this).call(this),this._teardownConvolverNode()}}]),r}(me),xn=function(s){yn(r,s);function r(t,o,f){var x;return dn(this,r),x=vn(this,xe(r).call(this)),x._initConvolverNode(),x.input.gain.value=.5,t?(x.impulses=[],x._loadBuffer(t,o,f)):(x._seconds=3,x._decay=2,x._reverse=!1,x._buildImpulse()),x.impulses=[],x.set=null,x}return mn(r,[{key:"_loadBuffer",value:function(o,f,x){var M=p5.prototype._checkFileFormats(o),N=this,L=new Error().stack,j=Object(P.b)(),z=new XMLHttpRequest;z.open("GET",M,!0),z.responseType="arraybuffer",z.onload=function(){if(z.status===200)j.decodeAudioData(z.response,function(ne){var oe={},de=M.split("/");oe.name=de[de.length-1],oe.audioBuffer=ne,N.impulses.push(oe),N._setBuffer(oe.audioBuffer),f&&f(oe)},function(){var ne=new B("decodeAudioData",L,N.url),oe="AudioContext error at decodeAudioData for "+N.url;x?(ne.msg=oe,x(ne)):console.error(oe+`
 The error stack trace includes: 
`+ne.stack)});else{var X=new B("loadConvolver",L,N.url),he="Unable to load "+N.url+". The request status was: "+z.status+" ("+z.statusText+")";x?(X.message=he,x(X)):console.error(he+`
 The error stack trace includes: 
`+X.stack)}},z.onerror=function(){var X=new B("loadConvolver",L,N.url),he="There was no response from the server at "+N.url+". Check the url and internet connectivity.";x?(X.message=he,x(X)):console.error(he+`
 The error stack trace includes: 
`+X.stack)},z.send()}},{key:"process",value:function(o){o.connect(this.input)}},{key:"addImpulse",value:function(o,f,x){window.location.origin.indexOf("file://")>-1&&window.cordova==="undefined"&&alert("This sketch may require a server to load external files. Please see http://bit.ly/1qcInwS"),this._loadBuffer(o,f,x)}},{key:"resetImpulse",value:function(o,f,x){window.location.origin.indexOf("file://")>-1&&window.cordova==="undefined"&&alert("This sketch may require a server to load external files. Please see http://bit.ly/1qcInwS"),this.impulses=[],this._loadBuffer(o,f,x)}},{key:"toggleImpulse",value:function(o){if(typeof o=="number"&&o<this.impulses.length&&this._setBuffer(this.impulses[o].audioBuffer),typeof o=="string"){for(var f=0;f<this.impulses.length;f++)if(this.impulses[f].name===o){this._setBuffer(this.impulses[f].audioBuffer);break}}}},{key:"dispose",value:function(){Ie(xe(r.prototype),"dispose",this).call(this);for(var o in this.impulses)this.impulses[o]&&(this.impulses[o]=null)}}]),r}(gn);function gr(s,r,t){window.location.origin.indexOf("file://")>-1&&window.cordova==="undefined"&&alert("This sketch may require a server to load external files. Please see http://bit.ly/1qcInwS");var o=this,f=new xn(s,function(x){typeof r=="function"&&r(x),typeof o._decrementPreload=="function"&&o._decrementPreload()},t);return f.impulses=[],f}var xr=T(11),_n=T.n(xr);function _r(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function Tr(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function Sr(s,r,t){return r&&Tr(s.prototype,r),s}var wr=function(){function s(){_r(this,s),this.clock=new _n.a({callback:this.ontick.bind(this)}),this.syncedParts=[],this.bpm=120,this._init(),this.prevTick=0,this.tatumTime=0,this.tickCallback=function(){}}return Sr(s,[{key:"ontick",value:function(t){var o=t-this.prevTick,f=t-i.audiocontext.currentTime;if(!(o-this.tatumTime<=-.02)){this.prevTick=t;var x=this;this.syncedParts.forEach(function(M){M.isPlaying&&(M.incrementStep(f),M.phrases.forEach(function(N){var L=N.sequence,j=x.metroTicks%L.length;L[j]!==0&&(x.metroTicks<L.length||!N.looping)&&N.callback(f,L[j])}))}),this.metroTicks+=1,this.tickCallback(f)}}},{key:"setBPM",value:function(t){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,f=60/(t*this.tatums),x=i.audiocontext.currentTime;this.tatumTime=f,this.clock.frequency.setValueAtTime(this.clock.frequency.value,x),this.clock.frequency.linearRampToValueAtTime(t,x+o),this.bpm=t}},{key:"getBPM",value:function(){return this.clock.getRate()/this.tatums*60}},{key:"_init",value:function(){this.metroTicks=0}},{key:"resetSync",value:function(t){this.syncedParts=[t]}},{key:"pushSync",value:function(t){this.syncedParts.push(t)}},{key:"start",value:function(t){var o=t||0,f=i.audiocontext.currentTime;this.clock.start(f+o),this.setBPM(this.bpm)}},{key:"stop",value:function(t){var o=t||0,f=i.audiocontext.currentTime;this.clock.stop(f+o)}},{key:"beatLength",value:function(t){this.tatums=1/t/4}}]),s}(),Tn=wr;function br(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function Sn(s,r,t){return r&&br(s.prototype,r),s}function $t(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}var wn=120;p5.prototype.setBPM=function(s,r){wn=s;for(var t in i.parts)i.parts[t]&&i.parts[t].setBPM(s,r)};var Jt=function s(r,t,o){$t(this,s),this.phraseStep=0,this.name=r,this.callback=t,this.sequence=o},Pr=function(){function s(r,t){$t(this,s),this.length=r||0,this.partStep=0,this.phrases=[],this.isPlaying=!1,this.noLoop(),this.tatums=t||.0625,this.metro=new Tn,this.metro._init(),this.metro.beatLength(this.tatums),this.metro.setBPM(wn),i.parts.push(this),this.callback=function(){}}return Sn(s,[{key:"setBPM",value:function(t,o){this.metro.setBPM(t,o)}},{key:"getBPM",value:function(){return this.metro.getBPM()}},{key:"start",value:function(t){if(!this.isPlaying){this.isPlaying=!0,this.metro.resetSync(this);var o=t||0;this.metro.start(o)}}},{key:"loop",value:function(t){this.looping=!0,this.onended=function(){this.partStep=0};var o=t||0;this.start(o)}},{key:"noLoop",value:function(){this.looping=!1,this.onended=function(){this.stop()}}},{key:"stop",value:function(t){this.partStep=0,this.pause(t)}},{key:"pause",value:function(t){this.isPlaying=!1;var o=t||0;this.metro.stop(o)}},{key:"addPhrase",value:function(t,o,f){var x;if(arguments.length===3)x=new Jt(t,o,f);else if(arguments[0]instanceof Jt)x=arguments[0];else throw"invalid input. addPhrase accepts name, callback, array or a p5.Phrase";this.phrases.push(x),x.sequence.length>this.length&&(this.length=x.sequence.length)}},{key:"removePhrase",value:function(t){for(var o in this.phrases)this.phrases[o].name===t&&this.phrases.splice(o,1)}},{key:"getPhrase",value:function(t){for(var o in this.phrases)if(this.phrases[o].name===t)return this.phrases[o]}},{key:"replaceSequence",value:function(t,o){for(var f in this.phrases)this.phrases[f].name===t&&(this.phrases[f].sequence=o)}},{key:"incrementStep",value:function(t){this.partStep<this.length-1?(this.callback(t),this.partStep+=1):!this.looping&&this.partStep===this.length-1&&this.onended()}},{key:"onStep",value:function(t){this.callback=t}}]),s}(),Ar=function(){function s(){$t(this,s),this.parts=[],this.currentPart=new Array(arguments.length);var r=this;for(var t in arguments)this.parts[t]=arguments[t],this.parts[t].nextPart=this.parts[t+1],this.parts[t].onended=function(){r.resetPart(t),Cr(r)};this.looping=!1}return Sn(s,[{key:"onended",value:function(){this.looping?this.parts[0].start():this.parts[this.parts.length-1].onended=function(){this.stop(),this.resetParts()},this.currentPart=0}},{key:"start",value:function(){this.parts[this.currentPart].start(),this.scoreStep=0}},{key:"stop",value:function(){this.parts[this.currentPart].stop(),this.currentPart=0,this.scoreStep=0}},{key:"pause",value:function(){this.parts[this.currentPart].stop()}},{key:"loop",value:function(){this.looping=!0,this.start()}},{key:"noLoop",value:function(){this.looping=!1}},{key:"resetParts",value:function(){var t=this;this.parts.forEach(function(o){t.resetParts[o]})}},{key:"resetPart",value:function(t){this.parts[t].stop(),this.parts[t].partStep=0;for(var o in this.parts[t].phrases)this.parts[t]&&(this.parts[t].phrases[o].phraseStep=0)}},{key:"setBPM",value:function(t,o){for(var f in this.parts)this.parts[f]&&this.parts[f].setBPM(t,o)}}]),s}();function Cr(s){s.currentPart++,s.currentPart>=s.parts.length?(s.scoreStep=0,s.onended()):(s.scoreStep=0,s.parts[s.currentPart-1].stop(),s.parts[s.currentPart].start())}function kr(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function Er(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function Or(s,r,t){return r&&Er(s.prototype,r),s}var Rr=function(){function s(r,t){kr(this,s),Object.defineProperty(this,"bpm",{get:function(){return this._bpm},set:function(x){this.musicalTimeMode||console.warn('Changing the BPM in "seconds" mode has no effect. BPM is only relevant in musicalTimeMode when the interval is specified as a string ("2n", "4n", "1m"...etc)'),this._bpm=x,this._update()}}),Object.defineProperty(this,"timeSignature",{get:function(){return this._timeSignature},set:function(x){this.musicalTimeMode||console.warn('Changing the timeSignature in "seconds" mode has no effect. BPM is only relevant in musicalTimeMode when the interval is specified as a string ("2n", "4n", "1m"...etc)'),this._timeSignature=x,this._update()}}),Object.defineProperty(this,"interval",{get:function(){return this._interval},set:function(x){this.musicalTimeMode=typeof x!="number",this._interval=x,this._update()}}),Object.defineProperty(this,"iterations",{get:function(){return this.clock.ticks}}),this.callback=r,this.musicalTimeMode=typeof this._interval!="number",this._interval=t||1,this._timeSignature=4,this._bpm=60,this.isPlaying=!1,this.maxIterations=1/0;var o=this;this.clock=new _n.a({callback:function(x){var M=x-i.audiocontext.currentTime;M>0&&o.iterations<=o.maxIterations&&o.callback(M)},frequency:this._calcFreq()})}return Or(s,[{key:"start",value:function(t){var o=t||0,f=i.audiocontext.currentTime;this.isPlaying||(this.clock.start(f+o),this.isPlaying=!0)}},{key:"stop",value:function(t){var o=t||0,f=i.audiocontext.currentTime;this.isPlaying&&(this.clock.stop(f+o),this.isPlaying=!1)}},{key:"pause",value:function(t){var o=t||0,f=i.audiocontext.currentTime;this.isPlaying&&(this.clock.pause(f+o),this.isPlaying=!1)}},{key:"syncedStart",value:function(t,o){var f=o||0,x=i.audiocontext.currentTime;if(!t.isPlaying)t.clock.start(x+f),t.isPlaying=!0,this.clock.start(x+f),this.isPlaying=!0;else if(t.isPlaying){var M=t.clock._nextTick-i.audiocontext.currentTime;this.clock.start(x+M),this.isPlaying=!0}}},{key:"_update",value:function(){this.clock.frequency.value=this._calcFreq()}},{key:"_calcFreq",value:function(){if(typeof this._interval=="number")return this.musicalTimeMode=!1,1/this._interval;if(typeof this._interval=="string")return this.musicalTimeMode=!0,this._bpm/60/this._convertNotation(this._interval)*(this._timeSignature/4)}},{key:"_convertNotation",value:function(t){var o=t.slice(-1);switch(t=Number(t.slice(0,-1)),o){case"m":return this._measure(t);case"n":return this._note(t);default:console.warn("Specified interval is not formatted correctly. See Tone.js timing reference for more info: https://github.com/Tonejs/Tone.js/wiki/Time")}}},{key:"_measure",value:function(t){return t*this._timeSignature}},{key:"_note",value:function(t){return this._timeSignature/t}}]),s}(),Mr=Rr;function gt(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?gt=function(t){return typeof t}:gt=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gt(s)}function Br(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function Dr(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function Fr(s,r,t){return r&&Dr(s.prototype,r),s}function Ir(s,r){return r&&(gt(r)==="object"||typeof r=="function")?r:Nr(s)}function Nr(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function xt(s,r,t){return typeof Reflect<"u"&&Reflect.get?xt=Reflect.get:xt=function(f,x,M){var N=Lr(f,x);if(N){var L=Object.getOwnPropertyDescriptor(N,x);return L.get?L.get.call(M):L.value}},xt(s,r,t||s)}function Lr(s,r){for(;!Object.prototype.hasOwnProperty.call(s,r)&&(s=Ne(s),s!==null););return s}function Ne(s){return Ne=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ne(s)}function Vr(s,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),r&&en(s,r)}function en(s,r){return en=Object.setPrototypeOf||function(o,f){return o.__proto__=f,o},en(s,r)}var Ur=function(s){Vr(r,s);function r(){var t;return Br(this,r),t=Ir(this,Ne(r).call(this)),t.compressor=t.ac.createDynamicsCompressor(),t.input.connect(t.compressor),t.compressor.connect(t.wet),t}return Fr(r,[{key:"process",value:function(o,f,x,M,N,L){o.connect(this.input),this.set(f,x,M,N,L)}},{key:"set",value:function(o,f,x,M,N){typeof o<"u"&&this.attack(o),typeof f<"u"&&this.knee(f),typeof x<"u"&&this.ratio(x),typeof M<"u"&&this.threshold(M),typeof N<"u"&&this.release(N)}},{key:"attack",value:function(o,f){var x=f||0;return typeof o=="number"?(this.compressor.attack.value=o,this.compressor.attack.cancelScheduledValues(this.ac.currentTime+.01+x),this.compressor.attack.linearRampToValueAtTime(o,this.ac.currentTime+.02+x)):typeof o<"u"&&o.connect(this.compressor.attack),this.compressor.attack.value}},{key:"knee",value:function(o,f){var x=f||0;return typeof o=="number"?(this.compressor.knee.value=o,this.compressor.knee.cancelScheduledValues(this.ac.currentTime+.01+x),this.compressor.knee.linearRampToValueAtTime(o,this.ac.currentTime+.02+x)):typeof o<"u"&&o.connect(this.compressor.knee),this.compressor.knee.value}},{key:"ratio",value:function(o,f){var x=f||0;return typeof o=="number"?(this.compressor.ratio.value=o,this.compressor.ratio.cancelScheduledValues(this.ac.currentTime+.01+x),this.compressor.ratio.linearRampToValueAtTime(o,this.ac.currentTime+.02+x)):typeof o<"u"&&o.connect(this.compressor.ratio),this.compressor.ratio.value}},{key:"threshold",value:function(o,f){var x=f||0;return typeof o=="number"?(this.compressor.threshold.value=o,this.compressor.threshold.cancelScheduledValues(this.ac.currentTime+.01+x),this.compressor.threshold.linearRampToValueAtTime(o,this.ac.currentTime+.02+x)):typeof o<"u"&&o.connect(this.compressor.threshold),this.compressor.threshold.value}},{key:"release",value:function(o,f){var x=f||0;return typeof o=="number"?(this.compressor.release.value=o,this.compressor.release.cancelScheduledValues(this.ac.currentTime+.01+x),this.compressor.release.linearRampToValueAtTime(o,this.ac.currentTime+.02+x)):typeof number<"u"&&o.connect(this.compressor.release),this.compressor.release.value}},{key:"reduction",value:function(){return this.compressor.reduction.value}},{key:"dispose",value:function(){xt(Ne(r.prototype),"dispose",this).call(this),this.compressor&&(this.compressor.disconnect(),delete this.compressor)}}]),r}(me),Wr=Ur;function qr(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function Gr(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function jr(s,r,t){return r&&Gr(s.prototype,r),s}var zr=function(){function s(r,t,o,f){qr(this,s),this.framesPerPeak=f||20,this.framesSinceLastPeak=0,this.decayRate=.95,this.threshold=o||.35,this.cutoff=0,this.cutoffMult=1.5,this.energy=0,this.penergy=0,this.currentValue=0,this.isDetected=!1,this.f1=r||40,this.f2=t||2e4,this._onPeak=function(){}}return jr(s,[{key:"update",value:function(t){var o=this.energy=t.getEnergy(this.f1,this.f2)/255;o>this.cutoff&&o>this.threshold&&o-this.penergy>0?(this._onPeak(),this.isDetected=!0,this.cutoff=o*this.cutoffMult,this.framesSinceLastPeak=0):(this.isDetected=!1,this.framesSinceLastPeak<=this.framesPerPeak?this.framesSinceLastPeak++:(this.cutoff*=this.decayRate,this.cutoff=Math.max(this.cutoff,this.threshold))),this.currentValue=o,this.penergy=o}},{key:"onPeak",value:function(t,o){var f=this;f._onPeak=function(){t(f.energy,o)}}}]),s}(),bn=zr;function Hr(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function Yr(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function Kr(s,r,t){return r&&Yr(s.prototype,r),s}var _t=i.audiocontext,Zr=function(){function s(){Hr(this,s),this.input=_t.createGain(),this.output=_t.createGain(),this._inputChannels=2,this._outputChannels=2;var r=b(1024);this._workletNode=new AudioWorkletNode(_t,c.a.recorderProcessor,{outputChannelCount:[this._outputChannels],processorOptions:{numInputChannels:this._inputChannels,bufferSize:r}}),this._workletNode.port.onmessage=(function(t){if(t.data.name==="buffers"){var o=[new Float32Array(t.data.leftBuffer),new Float32Array(t.data.rightBuffer)];this._callback(o)}}).bind(this),this._callback=function(){},this._workletNode.connect(p5.soundOut._silentNode),this.setInput(),i.soundArray.push(this)}return Kr(s,[{key:"setInput",value:function(t){this.input.disconnect(),this.input=null,this.input=_t.createGain(),this.input.connect(this._workletNode),this.input.connect(this.output),t?t.connect(this.input):p5.soundOut.output.connect(this.input)}},{key:"record",value:function(t,o,f){this._workletNode.port.postMessage({name:"start",duration:o}),t&&f?this._callback=function(x){t.setBuffer(x),f()}:t&&(this._callback=function(x){t.setBuffer(x)})}},{key:"stop",value:function(){this._workletNode.port.postMessage({name:"stop"})}},{key:"dispose",value:function(){var t=i.soundArray.indexOf(this);i.soundArray.splice(t,1),this._callback=function(){},this.input&&this.input.disconnect(),this.input=null,this._workletNode=null}}]),s}(),Xr=Zr;function Tt(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Tt=function(t){return typeof t}:Tt=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tt(s)}function Qr(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function $r(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function Jr(s,r,t){return r&&$r(s.prototype,r),s}function eo(s,r){return r&&(Tt(r)==="object"||typeof r=="function")?r:to(s)}function to(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function St(s,r,t){return typeof Reflect<"u"&&Reflect.get?St=Reflect.get:St=function(f,x,M){var N=no(f,x);if(N){var L=Object.getOwnPropertyDescriptor(N,x);return L.get?L.get.call(M):L.value}},St(s,r,t||s)}function no(s,r){for(;!Object.prototype.hasOwnProperty.call(s,r)&&(s=Le(s),s!==null););return s}function Le(s){return Le=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Le(s)}function io(s,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),r&&tn(s,r)}function tn(s,r){return tn=Object.setPrototypeOf||function(o,f){return o.__proto__=f,o},tn(s,r)}function Pn(s){for(var r=typeof s=="number"?s:50,t=44100,o=new Float32Array(t),f=Math.PI/180,x=0,M;x<t;++x)M=x*2/t-1,o[x]=(3+r)*M*20*f/(Math.PI+r*Math.abs(M));return o}var ro=function(s){io(r,s);function r(t,o){var f;if(Qr(this,r),f=eo(this,Le(r).call(this)),typeof t>"u"&&(t=.25),typeof t!="number")throw new Error("amount must be a number");if(typeof o>"u"&&(o="2x"),typeof o!="string")throw new Error("oversample must be a String");var x=p5.prototype.map(t,0,1,0,2e3);return f.waveShaperNode=f.ac.createWaveShaper(),f.amount=x,f.waveShaperNode.curve=Pn(x),f.waveShaperNode.oversample=o,f.input.connect(f.waveShaperNode),f.waveShaperNode.connect(f.wet),f}return Jr(r,[{key:"process",value:function(o,f,x){o.connect(this.input),this.set(f,x)}},{key:"set",value:function(o,f){if(o){var x=p5.prototype.map(o,0,1,0,2e3);this.amount=x,this.waveShaperNode.curve=Pn(x)}f&&(this.waveShaperNode.oversample=f)}},{key:"getAmount",value:function(){return this.amount}},{key:"getOversample",value:function(){return this.waveShaperNode.oversample}},{key:"dispose",value:function(){St(Le(r.prototype),"dispose",this).call(this),this.waveShaperNode&&(this.waveShaperNode.disconnect(),this.waveShaperNode=null)}}]),r}(me),oo=ro;function so(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function ao(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function uo(s,r,t){return r&&ao(s.prototype,r),s}var lo=function(){function s(){so(this,s),this.ac=i.audiocontext,this.input=this.ac.createGain(),this.output=this.ac.createGain(),this.input.gain.value=.5,this.input.connect(this.output),i.soundArray.push(this)}return uo(s,[{key:"setInput",value:function(t){t.connect(this.input)}},{key:"connect",value:function(t){var o=t||p5.soundOut.input;this.output.connect(o.input?o.input:o)}},{key:"disconnect",value:function(){this.output&&this.output.disconnect()}},{key:"amp",value:function(t){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,x=i.audiocontext.currentTime,M=this.output.gain.value;this.output.gain.cancelScheduledValues(x),this.output.gain.linearRampToValueAtTime(M,x+f),this.output.gain.linearRampToValueAtTime(t,x+f+o)}},{key:"dispose",value:function(){var t=i.soundArray.indexOf(this);i.soundArray.splice(t,1),this.output&&(this.output.disconnect(),delete this.output),this.input&&(this.input.disconnect(),delete this.input)}}]),s}(),co=lo;function fo(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function ho(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function po(s,r,t){return r&&ho(s.prototype,r),s}var mo=function(){function s(){fo(this,s),this.ac=i.audiocontext,this.output=this.ac.createGain(),this.connect(),i.soundArray.push(this)}return po(s,[{key:"play",value:function(t,o,f,x){}},{key:"triggerAttack",value:function(t,o,f){}},{key:"triggerRelease",value:function(t){}},{key:"amp",value:function(t,o){}},{key:"connect",value:function(t){var o=t||i.input;this.output.connect(o.input?o.input:o)}},{key:"disconnect",value:function(){this.output.disconnect()}},{key:"dispose",value:function(){this.output&&(this.output.disconnect(),delete this.output)}}]),s}(),An=mo;function wt(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?wt=function(t){return typeof t}:wt=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wt(s)}function vo(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function yo(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function go(s,r,t){return r&&yo(s.prototype,r),s}function xo(s,r){return r&&(wt(r)==="object"||typeof r=="function")?r:nn(s)}function nn(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function bt(s,r,t){return typeof Reflect<"u"&&Reflect.get?bt=Reflect.get:bt=function(f,x,M){var N=_o(f,x);if(N){var L=Object.getOwnPropertyDescriptor(N,x);return L.get?L.get.call(M):L.value}},bt(s,r,t||s)}function _o(s,r){for(;!Object.prototype.hasOwnProperty.call(s,r)&&(s=Ve(s),s!==null););return s}function Ve(s){return Ve=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ve(s)}function To(s,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),r&&rn(s,r)}function rn(s,r){return rn=Object.setPrototypeOf||function(o,f){return o.__proto__=f,o},rn(s,r)}var So=.15,wo=function(s){To(r,s);function r(){var t;return vo(this,r),t=xo(this,Ve(r).call(this)),t.oscillator=new et,t.env=new Hn,t.env.setRange(1,0),t.env.setExp(!0),t.setADSR(.02,.25,.05,.35),t.oscillator.disconnect(),t.oscillator.connect(t.output),t.env.disconnect(),t.env.setInput(t.output.gain),t.oscillator.output.gain.value=1,t.oscillator.start(),t.connect(),i.soundArray.push(nn(t)),Object.defineProperties(nn(t),{attack:{get:function(){return this.env.aTime},set:function(f){this.env.setADSR(f,this.env.dTime,this.env.sPercent,this.env.rTime)}},decay:{get:function(){return this.env.dTime},set:function(f){this.env.setADSR(this.env.aTime,f,this.env.sPercent,this.env.rTime)}},sustain:{get:function(){return this.env.sPercent},set:function(f){this.env.setADSR(this.env.aTime,this.env.dTime,f,this.env.rTime)}},release:{get:function(){return this.env.rTime},set:function(f){this.env.setADSR(this.env.aTime,this.env.dTime,this.env.sPercent,f)}}}),t}return go(r,[{key:"play",value:function(o,f,x,M){this.triggerAttack(o,f,~~x),this.triggerRelease(~~x+(M||So))}},{key:"triggerAttack",value:function(o,f){var x=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,M=y(o),N=f||.1;this.oscillator.freq(M,0,x),this.env.ramp(this.output.gain,x,N)}},{key:"triggerRelease",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;this.env.ramp(this.output.gain,o,0)}},{key:"setADSR",value:function(o,f,x,M){this.env.setADSR(o,f,x,M)}},{key:"amp",value:function(o,f){var x=f||0;return typeof o<"u"&&this.oscillator.amp(o,x),this.oscillator.amp().value}},{key:"connect",value:function(o){var f=o||i.input;this.output.connect(f.input?f.input:f)}},{key:"disconnect",value:function(){this.output&&this.output.disconnect()}},{key:"dispose",value:function(){bt(Ve(r.prototype),"dispose",this).call(this),this.env&&this.env.dispose(),this.oscillator&&this.oscillator.dispose()}}]),r}(An),bo=wo;function Po(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function Ao(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function Co(s,r,t){return r&&Ao(s.prototype,r),s}var ko=function(){function s(r,t,o,f){Po(this,s),this.isDetected=!1,this.freqLow=r,this.freqHigh=t,this.treshold=o,this.energy=0,this.penergy=0,this.sensitivity=500,this.callback=f}return Co(s,[{key:"update",value:function(t,o){if(this.energy=t.getEnergy(this.freqLow,this.freqHigh)/255,this.isDetected===!1&&this.energy-this.penergy>this.treshold){this.isDetected=!0,this.callback?this.callback(this.energy):o&&o(this.energy);var f=this;setTimeout(function(){f.isDetected=!1},this.sensitivity)}this.penergy=this.energy}}]),s}(),Eo=ko;function Oo(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function Ro(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function Mo(s,r,t){return r&&Ro(s.prototype,r),s}var Bo=function(){function s(r,t){Oo(this,s),this.audiovoices=[],this.notes={},this._newest=0,this._oldest=0,this.maxVoices=t||8,this.AudioVoice=r===void 0?p5.MonoSynth:r,this._voicesInUse=new Vt.a(0),this.output=i.audiocontext.createGain(),this.connect(),this._allocateVoices(),i.soundArray.push(this)}return Mo(s,[{key:"_allocateVoices",value:function(){for(var t=0;t<this.maxVoices;t++)this.audiovoices.push(new this.AudioVoice),this.audiovoices[t].disconnect(),this.audiovoices[t].connect(this.output)}},{key:"play",value:function(t,o,f){var x=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;this.noteAttack(t,o,f),this.noteRelease(t,f+x)}},{key:"noteADSR",value:function(t,o,f,x,M){var N=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0,L=i.audiocontext.currentTime,j=L+N;this.audiovoices[this.notes[t].getValueAtTime(j)].setADSR(o,f,x,M)}},{key:"setADSR",value:function(t,o,f,x){this.audiovoices.forEach(function(M){M.setADSR(t,o,f,x)})}},{key:"noteAttack",value:function(t,o){var f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,x=i.audiocontext.currentTime+f,M=y(t),N=o||.1,L;this.notes[M]&&this.notes[M].getValueAtTime(x)!==null&&this.noteRelease(M,0),this._voicesInUse.getValueAtTime(x)<this.maxVoices?L=Math.max(~~this._voicesInUse.getValueAtTime(x),0):(L=this._oldest,oldestNote=d(this.audiovoices[this._oldest].oscillator.freq().value),this.noteRelease(oldestNote),this._oldest=(this._oldest+1)%(this.maxVoices-1)),this.notes[M]=new Vt.a,this.notes[M].setValueAtTime(L,x);var j=this._voicesInUse._searchBefore(x)===null?0:this._voicesInUse._searchBefore(x).value;if(this._voicesInUse.setValueAtTime(j+1,x),this._updateAfter(x,1),this._newest=L,typeof N=="number"){var z=1/this._voicesInUse.getValueAtTime(x)*2;N=N>z?z:N}this.audiovoices[L].triggerAttack(M,N,f)}},{key:"_updateAfter",value:function(t,o){if(this._voicesInUse._searchAfter(t)!==null){this._voicesInUse._searchAfter(t).value+=o;var f=this._voicesInUse._searchAfter(t).time;this._updateAfter(f,o)}}},{key:"noteRelease",value:function(t,o){var f=i.audiocontext.currentTime,x=o||0,M=f+x;if(!t){this.audiovoices.forEach(function(z){z.triggerRelease(x)}),this._voicesInUse.setValueAtTime(0,M);for(var N in this.notes)this.notes[N].dispose(),delete this.notes[N];return}var L=y(t);if(!this.notes[L]||this.notes[L].getValueAtTime(M)===null)console.warn("Cannot release a note that is not already playing");else{var j=Math.max(~~this._voicesInUse.getValueAtTime(M).value,1);this._voicesInUse.setValueAtTime(j-1,M),j>0&&this._updateAfter(M,-1),this.audiovoices[this.notes[L].getValueAtTime(M)].triggerRelease(x),this.notes[L].dispose(),delete this.notes[L],this._newest=this._newest===0?0:(this._newest-1)%(this.maxVoices-1)}}},{key:"connect",value:function(t){var o=t||i.input;this.output.connect(o.input?o.input:o)}},{key:"disconnect",value:function(){this.output&&this.output.disconnect()}},{key:"dispose",value:function(){this.audiovoices.forEach(function(t){t.dispose()}),this.output&&(this.output.disconnect(),delete this.output)}}]),s}(),Do=Bo;function Fo(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}var Io=function s(){Fo(this,s),console.warn("p5.Signal is deprecated , Use Tone.js Signal instead ")},No=Io;p5.prototype.getAudioContext=P.b,p5.prototype.userStartAudio=P.c,p5.prototype.sampleRate=m,p5.prototype.freqToMidi=d,p5.prototype.midiToFreq=a,p5.prototype.noteToFreq=y,p5.prototype.soundFormats=v,p5.prototype.disposeSound=_,p5.prototype._checkFileFormats=w,p5.prototype._mathChain=k,p5.prototype.convertToWav=A,p5.prototype.interleave=D,p5.prototype.writeUTFBytes=g,p5.prototype.safeBufferSize=b,p5.prototype.saveSound=E,p5.prototype.registerMethod("remove",p5.prototype.disposeSound),p5.Panner=J,p5.SoundFile=ie,p5.prototype.loadSound=ue,p5.prototype.registerPreloadMethod("loadSound",p5.prototype),p5.Amplitude=ke,p5.FFT=be,p5.Oscillator=et,p5.SinOsc=Wn,p5.TriOsc=qn,p5.SawOsc=cn,p5.SqrOsc=Gn,p5.Noise=ei,p5.Pulse=ci,p5.AudioIn=mi,p5.Effect=me,p5.Filter=lt,p5.LowPass=Ai,p5.HighPass=Ci,p5.BandPass=ki,p5.EQ=zi,p5.listener3D=Xi,p5.Panner3D=or,p5.Delay=dr,p5.Reverb=gn,p5.Convolver=xn,p5.prototype.createConvolver=gr,p5.prototype.registerPreloadMethod("createConvolver",p5.prototype),p5.Metro=Tn,p5.Phrase=Jt,p5.Part=Pr,p5.Score=Ar,p5.SoundLoop=Mr,p5.Compressor=Wr,p5.peakDetect=bn,p5.SoundRecorder=Xr,p5.Distortion=oo,p5.Gain=co,p5.AudioVoice=An,p5.MonoSynth=bo,p5.OnsetDetect=Eo,p5.PolySynth=Do,p5.PeakDetect=bn,p5.Signal=No}])})();let we;const as=()=>{we=p.loadSound("period2.wav")},us=()=>{we.isPlaying()?we.pause():we.play(0,1,.7,At-Dn)},ls=()=>{document.querySelector("canvas").addEventListener("click",()=>{us()})},sn=()=>we.currentTime(),cs={linear:S=>S,easeInQuad:S=>S*S,easeOutQuad:S=>S*(2-S),easeInOutQuad:S=>S<.5?2*S*S:-1+(4-2*S)*S,easeInCubic:S=>S*S*S,easeOutCubic:S=>--S*S*S+1,easeInOutCubic:S=>S<.5?4*S*S*S:(S-1)*(2*S-2)*(2*S-2)+1,easeInQuart:S=>S*S*S*S,easeOutQuart:S=>1- --S*S*S*S,easeInOutQuart:S=>S<.5?8*S*S*S*S:1-8*--S*S*S*S,easeInQuint:S=>S*S*S*S*S,easeOutQuint:S=>1+--S*S*S*S*S,easeInOutQuint:S=>S<.5?16*S*S*S*S*S:1+16*--S*S*S*S*S};let Rt,Mt,Fn=[],Se;const fs=()=>{ss(),as()},In=()=>{const S=document.querySelector("canvas");S.style.position="absolute",S.style.top="50%",S.style.left="50%";const R=Math.min(window.innerWidth/Mn,window.innerHeight/ye);S.style.transform=`translate(-50%, -50%) scale(${R})`},hs=()=>{p.createCanvas(Mn,ye,p.WEBGL),p.pixelDensity(1),p.frameRate(ns),ls(),Te.Common.setDecomp(ts),Rt=_e.Engine.create(),Se=Te.Body.create({position:{x:0,y:0}}),Se=_e.Bodies.fromVertices(0,ye/2+ye/5,[Te.Vertices.clockwiseSort(Ct.textToPoints(Bn,0,0,Ot).flat())],{isStatic:!0}),_e.World.add(Rt.world,[Se]),Mt=is.replace(/\r?\n/g,"").split("").reverse(),Fn=Mt.map(S=>({body:_e.Bodies.fromVertices(p.random(-300,300),-(ye/2+p.random(0,ye/3)),[Te.Vertices.clockwiseSort(Ct.textToPoints(S,0,0,Ot).flat())]),isAdded:!1})),p.textFont(Ct),In()},ps=()=>{p.background(0),we.isPlaying()&&_e.Engine.update(Rt),we.isPlaying()&&sn()!==0&&Fn.forEach(({body:S,isAdded:R},T,P)=>{R?(p.push(),p.fill(255),p.translate(S.position.x,S.position.y),p.rotate(S.angle),p.textSize(Ot),p.textAlign(p.CENTER,p.CENTER),p.text(Mt[T],0,0),p.pop()):p.lerp(At,rs,cs.easeInQuad(p.norm(T,0,P.length-1)))<sn()&&(Te.Body.applyForce(S,S.position,{x:p.random(-.04,.04),y:.15}),Te.Body.rotate(S,p.random(-p.PI,p.PI)),_e.World.add(Rt.world,[S]),P[T].isAdded=!0,console.log(`${Mt[T]} added`))}),Te.Body.setPosition(Se,{x:0,y:p.lerp(ye/2+ye/5,0,p.min(p.norm(sn(),At-Dn,At-os),1))}),p.push(),p.fill(255),p.translate(Se.position.x,Se.position.y),p.rotate(Se.angle),p.textSize(Ot),p.textAlign(p.CENTER,p.CENTER),p.text(Bn,0,0),p.pop()};window.onload=()=>{new p5(S=>{window.p=S,S.preload=fs,S.setup=hs,S.draw=ps,S.windowResized=In})};
