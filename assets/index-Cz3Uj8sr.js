(function(){const V=document.createElement("link").relList;if(V&&V.supports&&V.supports("modulepreload"))return;for(const v of document.querySelectorAll('link[rel="modulepreload"]'))D(v);new MutationObserver(v=>{for(const e of v)if(e.type==="childList")for(const n of e.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&D(n)}).observe(document,{childList:!0,subtree:!0});function S(v){const e={};return v.integrity&&(e.integrity=v.integrity),v.referrerPolicy&&(e.referrerPolicy=v.referrerPolicy),v.crossOrigin==="use-credentials"?e.credentials="include":v.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function D(v){if(v.ep)return;v.ep=!0;const e=S(v);fetch(v.href,e)}})();var zt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function wo(F){return F&&F.__esModule&&Object.prototype.hasOwnProperty.call(F,"default")?F.default:F}var vn={exports:{}};/*!
 * matter-js 0.20.0 by @liabru
 * http://brm.io/matter-js/
 * License MIT
 * 
 * The MIT License (MIT)
 * 
 * Copyright (c) Liam Brummitt and contributors.
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */(function(F,V){(function(D,v){F.exports=v()})(zt,function(){return function(S){var D={};function v(e){if(D[e])return D[e].exports;var n=D[e]={i:e,l:!1,exports:{}};return S[e].call(n.exports,n,n.exports,v),n.l=!0,n.exports}return v.m=S,v.c=D,v.d=function(e,n,i){v.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},v.r=function(e){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},v.t=function(e,n){if(n&1&&(e=v(e)),n&8||n&4&&typeof e=="object"&&e&&e.__esModule)return e;var i=Object.create(null);if(v.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),n&2&&typeof e!="string")for(var u in e)v.d(i,u,(function(c){return e[c]}).bind(null,u));return i},v.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return v.d(n,"a",n),n},v.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},v.p="",v(v.s=20)}([function(S,D){var v={};S.exports=v,function(){v._baseDelta=1e3/60,v._nextId=0,v._seed=0,v._nowStartTime=+new Date,v._warnedOnce={},v._decomp=null,v.extend=function(n,i){var u,c;typeof i=="boolean"?(u=2,c=i):(u=1,c=!0);for(var l=u;l<arguments.length;l++){var d=arguments[l];if(d)for(var h in d)c&&d[h]&&d[h].constructor===Object&&(!n[h]||n[h].constructor===Object)?(n[h]=n[h]||{},v.extend(n[h],c,d[h])):n[h]=d[h]}return n},v.clone=function(n,i){return v.extend({},i,n)},v.keys=function(n){if(Object.keys)return Object.keys(n);var i=[];for(var u in n)i.push(u);return i},v.values=function(n){var i=[];if(Object.keys){for(var u=Object.keys(n),c=0;c<u.length;c++)i.push(n[u[c]]);return i}for(var l in n)i.push(n[l]);return i},v.get=function(n,i,u,c){i=i.split(".").slice(u,c);for(var l=0;l<i.length;l+=1)n=n[i[l]];return n},v.set=function(n,i,u,c,l){var d=i.split(".").slice(c,l);return v.get(n,i,0,-1)[d[d.length-1]]=u,u},v.shuffle=function(n){for(var i=n.length-1;i>0;i--){var u=Math.floor(v.random()*(i+1)),c=n[i];n[i]=n[u],n[u]=c}return n},v.choose=function(n){return n[Math.floor(v.random()*n.length)]},v.isElement=function(n){return typeof HTMLElement<"u"?n instanceof HTMLElement:!!(n&&n.nodeType&&n.nodeName)},v.isArray=function(n){return Object.prototype.toString.call(n)==="[object Array]"},v.isFunction=function(n){return typeof n=="function"},v.isPlainObject=function(n){return typeof n=="object"&&n.constructor===Object},v.isString=function(n){return toString.call(n)==="[object String]"},v.clamp=function(n,i,u){return n<i?i:n>u?u:n},v.sign=function(n){return n<0?-1:1},v.now=function(){if(typeof window<"u"&&window.performance){if(window.performance.now)return window.performance.now();if(window.performance.webkitNow)return window.performance.webkitNow()}return Date.now?Date.now():new Date-v._nowStartTime},v.random=function(n,i){return n=typeof n<"u"?n:0,i=typeof i<"u"?i:1,n+e()*(i-n)};var e=function(){return v._seed=(v._seed*9301+49297)%233280,v._seed/233280};v.colorToNumber=function(n){return n=n.replace("#",""),n.length==3&&(n=n.charAt(0)+n.charAt(0)+n.charAt(1)+n.charAt(1)+n.charAt(2)+n.charAt(2)),parseInt(n,16)},v.logLevel=1,v.log=function(){console&&v.logLevel>0&&v.logLevel<=3&&console.log.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},v.info=function(){console&&v.logLevel>0&&v.logLevel<=2&&console.info.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},v.warn=function(){console&&v.logLevel>0&&v.logLevel<=3&&console.warn.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},v.warnOnce=function(){var n=Array.prototype.slice.call(arguments).join(" ");v._warnedOnce[n]||(v.warn(n),v._warnedOnce[n]=!0)},v.deprecated=function(n,i,u){n[i]=v.chain(function(){v.warnOnce("ðŸ”… deprecated ðŸ”…",u)},n[i])},v.nextId=function(){return v._nextId++},v.indexOf=function(n,i){if(n.indexOf)return n.indexOf(i);for(var u=0;u<n.length;u++)if(n[u]===i)return u;return-1},v.map=function(n,i){if(n.map)return n.map(i);for(var u=[],c=0;c<n.length;c+=1)u.push(i(n[c]));return u},v.topologicalSort=function(n){var i=[],u=[],c=[];for(var l in n)!u[l]&&!c[l]&&v._topologicalSort(l,u,c,n,i);return i},v._topologicalSort=function(n,i,u,c,l){var d=c[n]||[];u[n]=!0;for(var h=0;h<d.length;h+=1){var a=d[h];u[a]||i[a]||v._topologicalSort(a,i,u,c,l)}u[n]=!1,i[n]=!0,l.push(n)},v.chain=function(){for(var n=[],i=0;i<arguments.length;i+=1){var u=arguments[i];u._chained?n.push.apply(n,u._chained):n.push(u)}var c=function(){for(var l,d=new Array(arguments.length),h=0,a=arguments.length;h<a;h++)d[h]=arguments[h];for(h=0;h<n.length;h+=1){var y=n[h].apply(l,d);typeof y<"u"&&(l=y)}return l};return c._chained=n,c},v.chainPathBefore=function(n,i,u){return v.set(n,i,v.chain(u,v.get(n,i)))},v.chainPathAfter=function(n,i,u){return v.set(n,i,v.chain(v.get(n,i),u))},v.setDecomp=function(n){v._decomp=n},v.getDecomp=function(){var n=v._decomp;try{!n&&typeof window<"u"&&(n=window.decomp),!n&&typeof zt<"u"&&(n=zt.decomp)}catch{n=null}return n}}()},function(S,D){var v={};S.exports=v,function(){v.create=function(e){var n={min:{x:0,y:0},max:{x:0,y:0}};return e&&v.update(n,e),n},v.update=function(e,n,i){e.min.x=1/0,e.max.x=-1/0,e.min.y=1/0,e.max.y=-1/0;for(var u=0;u<n.length;u++){var c=n[u];c.x>e.max.x&&(e.max.x=c.x),c.x<e.min.x&&(e.min.x=c.x),c.y>e.max.y&&(e.max.y=c.y),c.y<e.min.y&&(e.min.y=c.y)}i&&(i.x>0?e.max.x+=i.x:e.min.x+=i.x,i.y>0?e.max.y+=i.y:e.min.y+=i.y)},v.contains=function(e,n){return n.x>=e.min.x&&n.x<=e.max.x&&n.y>=e.min.y&&n.y<=e.max.y},v.overlaps=function(e,n){return e.min.x<=n.max.x&&e.max.x>=n.min.x&&e.max.y>=n.min.y&&e.min.y<=n.max.y},v.translate=function(e,n){e.min.x+=n.x,e.max.x+=n.x,e.min.y+=n.y,e.max.y+=n.y},v.shift=function(e,n){var i=e.max.x-e.min.x,u=e.max.y-e.min.y;e.min.x=n.x,e.max.x=n.x+i,e.min.y=n.y,e.max.y=n.y+u}}()},function(S,D){var v={};S.exports=v,function(){v.create=function(e,n){return{x:e||0,y:n||0}},v.clone=function(e){return{x:e.x,y:e.y}},v.magnitude=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},v.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y},v.rotate=function(e,n,i){var u=Math.cos(n),c=Math.sin(n);i||(i={});var l=e.x*u-e.y*c;return i.y=e.x*c+e.y*u,i.x=l,i},v.rotateAbout=function(e,n,i,u){var c=Math.cos(n),l=Math.sin(n);u||(u={});var d=i.x+((e.x-i.x)*c-(e.y-i.y)*l);return u.y=i.y+((e.x-i.x)*l+(e.y-i.y)*c),u.x=d,u},v.normalise=function(e){var n=v.magnitude(e);return n===0?{x:0,y:0}:{x:e.x/n,y:e.y/n}},v.dot=function(e,n){return e.x*n.x+e.y*n.y},v.cross=function(e,n){return e.x*n.y-e.y*n.x},v.cross3=function(e,n,i){return(n.x-e.x)*(i.y-e.y)-(n.y-e.y)*(i.x-e.x)},v.add=function(e,n,i){return i||(i={}),i.x=e.x+n.x,i.y=e.y+n.y,i},v.sub=function(e,n,i){return i||(i={}),i.x=e.x-n.x,i.y=e.y-n.y,i},v.mult=function(e,n){return{x:e.x*n,y:e.y*n}},v.div=function(e,n){return{x:e.x/n,y:e.y/n}},v.perp=function(e,n){return n=n===!0?-1:1,{x:n*-e.y,y:n*e.x}},v.neg=function(e){return{x:-e.x,y:-e.y}},v.angle=function(e,n){return Math.atan2(n.y-e.y,n.x-e.x)},v._temp=[v.create(),v.create(),v.create(),v.create(),v.create(),v.create()]}()},function(S,D,v){var e={};S.exports=e;var n=v(2),i=v(0);(function(){e.create=function(u,c){for(var l=[],d=0;d<u.length;d++){var h=u[d],a={x:h.x,y:h.y,index:d,body:c,isInternal:!1};l.push(a)}return l},e.fromPath=function(u,c){var l=/L?\s*([-\d.e]+)[\s,]*([-\d.e]+)*/ig,d=[];return u.replace(l,function(h,a,y){d.push({x:parseFloat(a),y:parseFloat(y)})}),e.create(d,c)},e.centre=function(u){for(var c=e.area(u,!0),l={x:0,y:0},d,h,a,y=0;y<u.length;y++)a=(y+1)%u.length,d=n.cross(u[y],u[a]),h=n.mult(n.add(u[y],u[a]),d),l=n.add(l,h);return n.div(l,6*c)},e.mean=function(u){for(var c={x:0,y:0},l=0;l<u.length;l++)c.x+=u[l].x,c.y+=u[l].y;return n.div(c,u.length)},e.area=function(u,c){for(var l=0,d=u.length-1,h=0;h<u.length;h++)l+=(u[d].x-u[h].x)*(u[d].y+u[h].y),d=h;return c?l/2:Math.abs(l)/2},e.inertia=function(u,c){for(var l=0,d=0,h=u,a,y,m=0;m<h.length;m++)y=(m+1)%h.length,a=Math.abs(n.cross(h[y],h[m])),l+=a*(n.dot(h[y],h[y])+n.dot(h[y],h[m])+n.dot(h[m],h[m])),d+=a;return c/6*(l/d)},e.translate=function(u,c,l){l=typeof l<"u"?l:1;var d=u.length,h=c.x*l,a=c.y*l,y;for(y=0;y<d;y++)u[y].x+=h,u[y].y+=a;return u},e.rotate=function(u,c,l){if(c!==0){var d=Math.cos(c),h=Math.sin(c),a=l.x,y=l.y,m=u.length,x,T,P,E;for(E=0;E<m;E++)x=u[E],T=x.x-a,P=x.y-y,x.x=a+(T*d-P*h),x.y=y+(T*h+P*d);return u}},e.contains=function(u,c){for(var l=c.x,d=c.y,h=u.length,a=u[h-1],y,m=0;m<h;m++){if(y=u[m],(l-a.x)*(y.y-a.y)+(d-a.y)*(a.x-y.x)>0)return!1;a=y}return!0},e.scale=function(u,c,l,d){if(c===1&&l===1)return u;d=d||e.centre(u);for(var h,a,y=0;y<u.length;y++)h=u[y],a=n.sub(h,d),u[y].x=d.x+a.x*c,u[y].y=d.y+a.y*l;return u},e.chamfer=function(u,c,l,d,h){typeof c=="number"?c=[c]:c=c||[8],l=typeof l<"u"?l:-1,d=d||2,h=h||14;for(var a=[],y=0;y<u.length;y++){var m=u[y-1>=0?y-1:u.length-1],x=u[y],T=u[(y+1)%u.length],P=c[y<c.length?y:c.length-1];if(P===0){a.push(x);continue}var E=n.normalise({x:x.y-m.y,y:m.x-x.x}),B=n.normalise({x:T.y-x.y,y:x.x-T.x}),_=Math.sqrt(2*Math.pow(P,2)),w=n.mult(i.clone(E),P),A=n.normalise(n.mult(n.add(E,B),.5)),b=n.sub(x,n.mult(A,_)),O=l;l===-1&&(O=Math.pow(P,.32)*1.75),O=i.clamp(O,d,h),O%2===1&&(O+=1);for(var C=Math.acos(n.dot(E,B)),M=C/O,R=0;R<O;R++)a.push(n.add(n.rotate(w,M*R),b))}return a},e.clockwiseSort=function(u){var c=e.mean(u);return u.sort(function(l,d){return n.angle(c,l)-n.angle(c,d)}),u},e.isConvex=function(u){var c=0,l=u.length,d,h,a,y;if(l<3)return null;for(d=0;d<l;d++)if(h=(d+1)%l,a=(d+2)%l,y=(u[h].x-u[d].x)*(u[a].y-u[h].y),y-=(u[h].y-u[d].y)*(u[a].x-u[h].x),y<0?c|=1:y>0&&(c|=2),c===3)return!1;return c!==0?!0:null},e.hull=function(u){var c=[],l=[],d,h;for(u=u.slice(0),u.sort(function(a,y){var m=a.x-y.x;return m!==0?m:a.y-y.y}),h=0;h<u.length;h+=1){for(d=u[h];l.length>=2&&n.cross3(l[l.length-2],l[l.length-1],d)<=0;)l.pop();l.push(d)}for(h=u.length-1;h>=0;h-=1){for(d=u[h];c.length>=2&&n.cross3(c[c.length-2],c[c.length-1],d)<=0;)c.pop();c.push(d)}return c.pop(),l.pop(),c.concat(l)}})()},function(S,D,v){var e={};S.exports=e;var n=v(3),i=v(2),u=v(7),c=v(0),l=v(1),d=v(11);(function(){e._timeCorrection=!0,e._inertiaScale=4,e._nextCollidingGroupId=1,e._nextNonCollidingGroupId=-1,e._nextCategory=1,e._baseDelta=1e3/60,e.create=function(a){var y={id:c.nextId(),type:"body",label:"Body",parts:[],plugin:{},angle:0,vertices:n.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"),position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1,render:{visible:!0,opacity:1,strokeStyle:null,fillStyle:null,lineWidth:null,sprite:{xScale:1,yScale:1,xOffset:0,yOffset:0}},events:null,bounds:null,chamfer:null,circleRadius:0,positionPrev:null,anglePrev:0,parent:null,axes:null,area:0,mass:0,inertia:0,deltaTime:16.666666666666668,_original:null},m=c.extend(y,a);return h(m,a),m},e.nextGroup=function(a){return a?e._nextNonCollidingGroupId--:e._nextCollidingGroupId++},e.nextCategory=function(){return e._nextCategory=e._nextCategory<<1,e._nextCategory};var h=function(a,y){y=y||{},e.set(a,{bounds:a.bounds||l.create(a.vertices),positionPrev:a.positionPrev||i.clone(a.position),anglePrev:a.anglePrev||a.angle,vertices:a.vertices,parts:a.parts||[a],isStatic:a.isStatic,isSleeping:a.isSleeping,parent:a.parent||a}),n.rotate(a.vertices,a.angle,a.position),d.rotate(a.axes,a.angle),l.update(a.bounds,a.vertices,a.velocity),e.set(a,{axes:y.axes||a.axes,area:y.area||a.area,mass:y.mass||a.mass,inertia:y.inertia||a.inertia});var m=a.isStatic?"#14151f":c.choose(["#f19648","#f5d259","#f55a3c","#063e7b","#ececd1"]),x=a.isStatic?"#555":"#ccc",T=a.isStatic&&a.render.fillStyle===null?1:0;a.render.fillStyle=a.render.fillStyle||m,a.render.strokeStyle=a.render.strokeStyle||x,a.render.lineWidth=a.render.lineWidth||T,a.render.sprite.xOffset+=-(a.bounds.min.x-a.position.x)/(a.bounds.max.x-a.bounds.min.x),a.render.sprite.yOffset+=-(a.bounds.min.y-a.position.y)/(a.bounds.max.y-a.bounds.min.y)};e.set=function(a,y,m){var x;typeof y=="string"&&(x=y,y={},y[x]=m);for(x in y)if(Object.prototype.hasOwnProperty.call(y,x))switch(m=y[x],x){case"isStatic":e.setStatic(a,m);break;case"isSleeping":u.set(a,m);break;case"mass":e.setMass(a,m);break;case"density":e.setDensity(a,m);break;case"inertia":e.setInertia(a,m);break;case"vertices":e.setVertices(a,m);break;case"position":e.setPosition(a,m);break;case"angle":e.setAngle(a,m);break;case"velocity":e.setVelocity(a,m);break;case"angularVelocity":e.setAngularVelocity(a,m);break;case"speed":e.setSpeed(a,m);break;case"angularSpeed":e.setAngularSpeed(a,m);break;case"parts":e.setParts(a,m);break;case"centre":e.setCentre(a,m);break;default:a[x]=m}},e.setStatic=function(a,y){for(var m=0;m<a.parts.length;m++){var x=a.parts[m];y?(x.isStatic||(x._original={restitution:x.restitution,friction:x.friction,mass:x.mass,inertia:x.inertia,density:x.density,inverseMass:x.inverseMass,inverseInertia:x.inverseInertia}),x.restitution=0,x.friction=1,x.mass=x.inertia=x.density=1/0,x.inverseMass=x.inverseInertia=0,x.positionPrev.x=x.position.x,x.positionPrev.y=x.position.y,x.anglePrev=x.angle,x.angularVelocity=0,x.speed=0,x.angularSpeed=0,x.motion=0):x._original&&(x.restitution=x._original.restitution,x.friction=x._original.friction,x.mass=x._original.mass,x.inertia=x._original.inertia,x.density=x._original.density,x.inverseMass=x._original.inverseMass,x.inverseInertia=x._original.inverseInertia,x._original=null),x.isStatic=y}},e.setMass=function(a,y){var m=a.inertia/(a.mass/6);a.inertia=m*(y/6),a.inverseInertia=1/a.inertia,a.mass=y,a.inverseMass=1/a.mass,a.density=a.mass/a.area},e.setDensity=function(a,y){e.setMass(a,y*a.area),a.density=y},e.setInertia=function(a,y){a.inertia=y,a.inverseInertia=1/a.inertia},e.setVertices=function(a,y){y[0].body===a?a.vertices=y:a.vertices=n.create(y,a),a.axes=d.fromVertices(a.vertices),a.area=n.area(a.vertices),e.setMass(a,a.density*a.area);var m=n.centre(a.vertices);n.translate(a.vertices,m,-1),e.setInertia(a,e._inertiaScale*n.inertia(a.vertices,a.mass)),n.translate(a.vertices,a.position),l.update(a.bounds,a.vertices,a.velocity)},e.setParts=function(a,y,m){var x;for(y=y.slice(0),a.parts.length=0,a.parts.push(a),a.parent=a,x=0;x<y.length;x++){var T=y[x];T!==a&&(T.parent=a,a.parts.push(T))}if(a.parts.length!==1){if(m=typeof m<"u"?m:!0,m){var P=[];for(x=0;x<y.length;x++)P=P.concat(y[x].vertices);n.clockwiseSort(P);var E=n.hull(P),B=n.centre(E);e.setVertices(a,E),n.translate(a.vertices,B)}var _=e._totalProperties(a);a.area=_.area,a.parent=a,a.position.x=_.centre.x,a.position.y=_.centre.y,a.positionPrev.x=_.centre.x,a.positionPrev.y=_.centre.y,e.setMass(a,_.mass),e.setInertia(a,_.inertia),e.setPosition(a,_.centre)}},e.setCentre=function(a,y,m){m?(a.positionPrev.x+=y.x,a.positionPrev.y+=y.y,a.position.x+=y.x,a.position.y+=y.y):(a.positionPrev.x=y.x-(a.position.x-a.positionPrev.x),a.positionPrev.y=y.y-(a.position.y-a.positionPrev.y),a.position.x=y.x,a.position.y=y.y)},e.setPosition=function(a,y,m){var x=i.sub(y,a.position);m?(a.positionPrev.x=a.position.x,a.positionPrev.y=a.position.y,a.velocity.x=x.x,a.velocity.y=x.y,a.speed=i.magnitude(x)):(a.positionPrev.x+=x.x,a.positionPrev.y+=x.y);for(var T=0;T<a.parts.length;T++){var P=a.parts[T];P.position.x+=x.x,P.position.y+=x.y,n.translate(P.vertices,x),l.update(P.bounds,P.vertices,a.velocity)}},e.setAngle=function(a,y,m){var x=y-a.angle;m?(a.anglePrev=a.angle,a.angularVelocity=x,a.angularSpeed=Math.abs(x)):a.anglePrev+=x;for(var T=0;T<a.parts.length;T++){var P=a.parts[T];P.angle+=x,n.rotate(P.vertices,x,a.position),d.rotate(P.axes,x),l.update(P.bounds,P.vertices,a.velocity),T>0&&i.rotateAbout(P.position,x,a.position,P.position)}},e.setVelocity=function(a,y){var m=a.deltaTime/e._baseDelta;a.positionPrev.x=a.position.x-y.x*m,a.positionPrev.y=a.position.y-y.y*m,a.velocity.x=(a.position.x-a.positionPrev.x)/m,a.velocity.y=(a.position.y-a.positionPrev.y)/m,a.speed=i.magnitude(a.velocity)},e.getVelocity=function(a){var y=e._baseDelta/a.deltaTime;return{x:(a.position.x-a.positionPrev.x)*y,y:(a.position.y-a.positionPrev.y)*y}},e.getSpeed=function(a){return i.magnitude(e.getVelocity(a))},e.setSpeed=function(a,y){e.setVelocity(a,i.mult(i.normalise(e.getVelocity(a)),y))},e.setAngularVelocity=function(a,y){var m=a.deltaTime/e._baseDelta;a.anglePrev=a.angle-y*m,a.angularVelocity=(a.angle-a.anglePrev)/m,a.angularSpeed=Math.abs(a.angularVelocity)},e.getAngularVelocity=function(a){return(a.angle-a.anglePrev)*e._baseDelta/a.deltaTime},e.getAngularSpeed=function(a){return Math.abs(e.getAngularVelocity(a))},e.setAngularSpeed=function(a,y){e.setAngularVelocity(a,c.sign(e.getAngularVelocity(a))*y)},e.translate=function(a,y,m){e.setPosition(a,i.add(a.position,y),m)},e.rotate=function(a,y,m,x){if(!m)e.setAngle(a,a.angle+y,x);else{var T=Math.cos(y),P=Math.sin(y),E=a.position.x-m.x,B=a.position.y-m.y;e.setPosition(a,{x:m.x+(E*T-B*P),y:m.y+(E*P+B*T)},x),e.setAngle(a,a.angle+y,x)}},e.scale=function(a,y,m,x){var T=0,P=0;x=x||a.position;for(var E=0;E<a.parts.length;E++){var B=a.parts[E];n.scale(B.vertices,y,m,x),B.axes=d.fromVertices(B.vertices),B.area=n.area(B.vertices),e.setMass(B,a.density*B.area),n.translate(B.vertices,{x:-B.position.x,y:-B.position.y}),e.setInertia(B,e._inertiaScale*n.inertia(B.vertices,B.mass)),n.translate(B.vertices,{x:B.position.x,y:B.position.y}),E>0&&(T+=B.area,P+=B.inertia),B.position.x=x.x+(B.position.x-x.x)*y,B.position.y=x.y+(B.position.y-x.y)*m,l.update(B.bounds,B.vertices,a.velocity)}a.parts.length>1&&(a.area=T,a.isStatic||(e.setMass(a,a.density*T),e.setInertia(a,P))),a.circleRadius&&(y===m?a.circleRadius*=y:a.circleRadius=null)},e.update=function(a,y){y=(typeof y<"u"?y:1e3/60)*a.timeScale;var m=y*y,x=e._timeCorrection?y/(a.deltaTime||y):1,T=1-a.frictionAir*(y/c._baseDelta),P=(a.position.x-a.positionPrev.x)*x,E=(a.position.y-a.positionPrev.y)*x;a.velocity.x=P*T+a.force.x/a.mass*m,a.velocity.y=E*T+a.force.y/a.mass*m,a.positionPrev.x=a.position.x,a.positionPrev.y=a.position.y,a.position.x+=a.velocity.x,a.position.y+=a.velocity.y,a.deltaTime=y,a.angularVelocity=(a.angle-a.anglePrev)*T*x+a.torque/a.inertia*m,a.anglePrev=a.angle,a.angle+=a.angularVelocity;for(var B=0;B<a.parts.length;B++){var _=a.parts[B];n.translate(_.vertices,a.velocity),B>0&&(_.position.x+=a.velocity.x,_.position.y+=a.velocity.y),a.angularVelocity!==0&&(n.rotate(_.vertices,a.angularVelocity,a.position),d.rotate(_.axes,a.angularVelocity),B>0&&i.rotateAbout(_.position,a.angularVelocity,a.position,_.position)),l.update(_.bounds,_.vertices,a.velocity)}},e.updateVelocities=function(a){var y=e._baseDelta/a.deltaTime,m=a.velocity;m.x=(a.position.x-a.positionPrev.x)*y,m.y=(a.position.y-a.positionPrev.y)*y,a.speed=Math.sqrt(m.x*m.x+m.y*m.y),a.angularVelocity=(a.angle-a.anglePrev)*y,a.angularSpeed=Math.abs(a.angularVelocity)},e.applyForce=function(a,y,m){var x={x:y.x-a.position.x,y:y.y-a.position.y};a.force.x+=m.x,a.force.y+=m.y,a.torque+=x.x*m.y-x.y*m.x},e._totalProperties=function(a){for(var y={mass:0,area:0,inertia:0,centre:{x:0,y:0}},m=a.parts.length===1?0:1;m<a.parts.length;m++){var x=a.parts[m],T=x.mass!==1/0?x.mass:1;y.mass+=T,y.area+=x.area,y.inertia+=x.inertia,y.centre=i.add(y.centre,i.mult(x.position,T))}return y.centre=i.div(y.centre,y.mass),y}})()},function(S,D,v){var e={};S.exports=e;var n=v(0);(function(){e.on=function(i,u,c){for(var l=u.split(" "),d,h=0;h<l.length;h++)d=l[h],i.events=i.events||{},i.events[d]=i.events[d]||[],i.events[d].push(c);return c},e.off=function(i,u,c){if(!u){i.events={};return}typeof u=="function"&&(c=u,u=n.keys(i.events).join(" "));for(var l=u.split(" "),d=0;d<l.length;d++){var h=i.events[l[d]],a=[];if(c&&h)for(var y=0;y<h.length;y++)h[y]!==c&&a.push(h[y]);i.events[l[d]]=a}},e.trigger=function(i,u,c){var l,d,h,a,y=i.events;if(y&&n.keys(y).length>0){c||(c={}),l=u.split(" ");for(var m=0;m<l.length;m++)if(d=l[m],h=y[d],h){a=n.clone(c,!1),a.name=d,a.source=i;for(var x=0;x<h.length;x++)h[x].apply(i,[a])}}}})()},function(S,D,v){var e={};S.exports=e;var n=v(5),i=v(0),u=v(1),c=v(4);(function(){e.create=function(l){return i.extend({id:i.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite",plugin:{},cache:{allBodies:null,allConstraints:null,allComposites:null}},l)},e.setModified=function(l,d,h,a){if(l.isModified=d,d&&l.cache&&(l.cache.allBodies=null,l.cache.allConstraints=null,l.cache.allComposites=null),h&&l.parent&&e.setModified(l.parent,d,h,a),a)for(var y=0;y<l.composites.length;y++){var m=l.composites[y];e.setModified(m,d,h,a)}},e.add=function(l,d){var h=[].concat(d);n.trigger(l,"beforeAdd",{object:d});for(var a=0;a<h.length;a++){var y=h[a];switch(y.type){case"body":if(y.parent!==y){i.warn("Composite.add: skipped adding a compound body part (you must add its parent instead)");break}e.addBody(l,y);break;case"constraint":e.addConstraint(l,y);break;case"composite":e.addComposite(l,y);break;case"mouseConstraint":e.addConstraint(l,y.constraint);break}}return n.trigger(l,"afterAdd",{object:d}),l},e.remove=function(l,d,h){var a=[].concat(d);n.trigger(l,"beforeRemove",{object:d});for(var y=0;y<a.length;y++){var m=a[y];switch(m.type){case"body":e.removeBody(l,m,h);break;case"constraint":e.removeConstraint(l,m,h);break;case"composite":e.removeComposite(l,m,h);break;case"mouseConstraint":e.removeConstraint(l,m.constraint);break}}return n.trigger(l,"afterRemove",{object:d}),l},e.addComposite=function(l,d){return l.composites.push(d),d.parent=l,e.setModified(l,!0,!0,!1),l},e.removeComposite=function(l,d,h){var a=i.indexOf(l.composites,d);if(a!==-1){var y=e.allBodies(d);e.removeCompositeAt(l,a);for(var m=0;m<y.length;m++)y[m].sleepCounter=0}if(h)for(var m=0;m<l.composites.length;m++)e.removeComposite(l.composites[m],d,!0);return l},e.removeCompositeAt=function(l,d){return l.composites.splice(d,1),e.setModified(l,!0,!0,!1),l},e.addBody=function(l,d){return l.bodies.push(d),e.setModified(l,!0,!0,!1),l},e.removeBody=function(l,d,h){var a=i.indexOf(l.bodies,d);if(a!==-1&&(e.removeBodyAt(l,a),d.sleepCounter=0),h)for(var y=0;y<l.composites.length;y++)e.removeBody(l.composites[y],d,!0);return l},e.removeBodyAt=function(l,d){return l.bodies.splice(d,1),e.setModified(l,!0,!0,!1),l},e.addConstraint=function(l,d){return l.constraints.push(d),e.setModified(l,!0,!0,!1),l},e.removeConstraint=function(l,d,h){var a=i.indexOf(l.constraints,d);if(a!==-1&&e.removeConstraintAt(l,a),h)for(var y=0;y<l.composites.length;y++)e.removeConstraint(l.composites[y],d,!0);return l},e.removeConstraintAt=function(l,d){return l.constraints.splice(d,1),e.setModified(l,!0,!0,!1),l},e.clear=function(l,d,h){if(h)for(var a=0;a<l.composites.length;a++)e.clear(l.composites[a],d,!0);return d?l.bodies=l.bodies.filter(function(y){return y.isStatic}):l.bodies.length=0,l.constraints.length=0,l.composites.length=0,e.setModified(l,!0,!0,!1),l},e.allBodies=function(l){if(l.cache&&l.cache.allBodies)return l.cache.allBodies;for(var d=[].concat(l.bodies),h=0;h<l.composites.length;h++)d=d.concat(e.allBodies(l.composites[h]));return l.cache&&(l.cache.allBodies=d),d},e.allConstraints=function(l){if(l.cache&&l.cache.allConstraints)return l.cache.allConstraints;for(var d=[].concat(l.constraints),h=0;h<l.composites.length;h++)d=d.concat(e.allConstraints(l.composites[h]));return l.cache&&(l.cache.allConstraints=d),d},e.allComposites=function(l){if(l.cache&&l.cache.allComposites)return l.cache.allComposites;for(var d=[].concat(l.composites),h=0;h<l.composites.length;h++)d=d.concat(e.allComposites(l.composites[h]));return l.cache&&(l.cache.allComposites=d),d},e.get=function(l,d,h){var a,y;switch(h){case"body":a=e.allBodies(l);break;case"constraint":a=e.allConstraints(l);break;case"composite":a=e.allComposites(l).concat(l);break}return a?(y=a.filter(function(m){return m.id.toString()===d.toString()}),y.length===0?null:y[0]):null},e.move=function(l,d,h){return e.remove(l,d),e.add(h,d),l},e.rebase=function(l){for(var d=e.allBodies(l).concat(e.allConstraints(l)).concat(e.allComposites(l)),h=0;h<d.length;h++)d[h].id=i.nextId();return l},e.translate=function(l,d,h){for(var a=h?e.allBodies(l):l.bodies,y=0;y<a.length;y++)c.translate(a[y],d);return l},e.rotate=function(l,d,h,a){for(var y=Math.cos(d),m=Math.sin(d),x=a?e.allBodies(l):l.bodies,T=0;T<x.length;T++){var P=x[T],E=P.position.x-h.x,B=P.position.y-h.y;c.setPosition(P,{x:h.x+(E*y-B*m),y:h.y+(E*m+B*y)}),c.rotate(P,d)}return l},e.scale=function(l,d,h,a,y){for(var m=y?e.allBodies(l):l.bodies,x=0;x<m.length;x++){var T=m[x],P=T.position.x-a.x,E=T.position.y-a.y;c.setPosition(T,{x:a.x+P*d,y:a.y+E*h}),c.scale(T,d,h)}return l},e.bounds=function(l){for(var d=e.allBodies(l),h=[],a=0;a<d.length;a+=1){var y=d[a];h.push(y.bounds.min,y.bounds.max)}return u.create(h)}})()},function(S,D,v){var e={};S.exports=e;var n=v(4),i=v(5),u=v(0);(function(){e._motionWakeThreshold=.18,e._motionSleepThreshold=.08,e._minBias=.9,e.update=function(c,l){for(var d=l/u._baseDelta,h=e._motionSleepThreshold,a=0;a<c.length;a++){var y=c[a],m=n.getSpeed(y),x=n.getAngularSpeed(y),T=m*m+x*x;if(y.force.x!==0||y.force.y!==0){e.set(y,!1);continue}var P=Math.min(y.motion,T),E=Math.max(y.motion,T);y.motion=e._minBias*P+(1-e._minBias)*E,y.sleepThreshold>0&&y.motion<h?(y.sleepCounter+=1,y.sleepCounter>=y.sleepThreshold/d&&e.set(y,!0)):y.sleepCounter>0&&(y.sleepCounter-=1)}},e.afterCollisions=function(c){for(var l=e._motionSleepThreshold,d=0;d<c.length;d++){var h=c[d];if(h.isActive){var a=h.collision,y=a.bodyA.parent,m=a.bodyB.parent;if(!(y.isSleeping&&m.isSleeping||y.isStatic||m.isStatic)&&(y.isSleeping||m.isSleeping)){var x=y.isSleeping&&!y.isStatic?y:m,T=x===y?m:y;!x.isStatic&&T.motion>l&&e.set(x,!1)}}}},e.set=function(c,l){var d=c.isSleeping;l?(c.isSleeping=!0,c.sleepCounter=c.sleepThreshold,c.positionImpulse.x=0,c.positionImpulse.y=0,c.positionPrev.x=c.position.x,c.positionPrev.y=c.position.y,c.anglePrev=c.angle,c.speed=0,c.angularSpeed=0,c.motion=0,d||i.trigger(c,"sleepStart")):(c.isSleeping=!1,c.sleepCounter=0,d&&i.trigger(c,"sleepEnd"))}})()},function(S,D,v){var e={};S.exports=e;var n=v(3),i=v(9);(function(){var u=[],c={overlap:0,axis:null},l={overlap:0,axis:null};e.create=function(d,h){return{pair:null,collided:!1,bodyA:d,bodyB:h,parentA:d.parent,parentB:h.parent,depth:0,normal:{x:0,y:0},tangent:{x:0,y:0},penetration:{x:0,y:0},supports:[null,null],supportCount:0}},e.collides=function(d,h,a){if(e._overlapAxes(c,d.vertices,h.vertices,d.axes),c.overlap<=0||(e._overlapAxes(l,h.vertices,d.vertices,h.axes),l.overlap<=0))return null;var y=a&&a.table[i.id(d,h)],m;y?m=y.collision:(m=e.create(d,h),m.collided=!0,m.bodyA=d.id<h.id?d:h,m.bodyB=d.id<h.id?h:d,m.parentA=m.bodyA.parent,m.parentB=m.bodyB.parent),d=m.bodyA,h=m.bodyB;var x;c.overlap<l.overlap?x=c:x=l;var T=m.normal,P=m.tangent,E=m.penetration,B=m.supports,_=x.overlap,w=x.axis,A=w.x,b=w.y,O=h.position.x-d.position.x,C=h.position.y-d.position.y;A*O+b*C>=0&&(A=-A,b=-b),T.x=A,T.y=b,P.x=-b,P.y=A,E.x=A*_,E.y=b*_,m.depth=_;var M=e._findSupports(d,h,T,1),R=0;if(n.contains(d.vertices,M[0])&&(B[R++]=M[0]),n.contains(d.vertices,M[1])&&(B[R++]=M[1]),R<2){var L=e._findSupports(h,d,T,-1);n.contains(h.vertices,L[0])&&(B[R++]=L[0]),R<2&&n.contains(h.vertices,L[1])&&(B[R++]=L[1])}return R===0&&(B[R++]=M[0]),m.supportCount=R,m},e._overlapAxes=function(d,h,a,y){var m=h.length,x=a.length,T=h[0].x,P=h[0].y,E=a[0].x,B=a[0].y,_=y.length,w=Number.MAX_VALUE,A=0,b,O,C,M,R,L;for(R=0;R<_;R++){var U=y[R],W=U.x,z=U.y,q=T*W+P*z,Y=E*W+B*z,K=q,X=Y;for(L=1;L<m;L+=1)M=h[L].x*W+h[L].y*z,M>K?K=M:M<q&&(q=M);for(L=1;L<x;L+=1)M=a[L].x*W+a[L].y*z,M>X?X=M:M<Y&&(Y=M);if(O=K-Y,C=X-q,b=O<C?O:C,b<w&&(w=b,A=R,b<=0))break}d.axis=y[A],d.overlap=w},e._findSupports=function(d,h,a,y){var m=h.vertices,x=m.length,T=d.position.x,P=d.position.y,E=a.x*y,B=a.y*y,_=m[0],w=_,A=E*(T-w.x)+B*(P-w.y),b,O,C;for(C=1;C<x;C+=1)w=m[C],O=E*(T-w.x)+B*(P-w.y),O<A&&(A=O,_=w);return b=m[(x+_.index-1)%x],A=E*(T-b.x)+B*(P-b.y),w=m[(_.index+1)%x],E*(T-w.x)+B*(P-w.y)<A?(u[0]=_,u[1]=w,u):(u[0]=_,u[1]=b,u)}})()},function(S,D,v){var e={};S.exports=e;var n=v(16);(function(){e.create=function(i,u){var c=i.bodyA,l=i.bodyB,d={id:e.id(c,l),bodyA:c,bodyB:l,collision:i,contacts:[n.create(),n.create()],contactCount:0,separation:0,isActive:!0,isSensor:c.isSensor||l.isSensor,timeCreated:u,timeUpdated:u,inverseMass:0,friction:0,frictionStatic:0,restitution:0,slop:0};return e.update(d,i,u),d},e.update=function(i,u,c){var l=u.supports,d=u.supportCount,h=i.contacts,a=u.parentA,y=u.parentB;i.isActive=!0,i.timeUpdated=c,i.collision=u,i.separation=u.depth,i.inverseMass=a.inverseMass+y.inverseMass,i.friction=a.friction<y.friction?a.friction:y.friction,i.frictionStatic=a.frictionStatic>y.frictionStatic?a.frictionStatic:y.frictionStatic,i.restitution=a.restitution>y.restitution?a.restitution:y.restitution,i.slop=a.slop>y.slop?a.slop:y.slop,i.contactCount=d,u.pair=i;var m=l[0],x=h[0],T=l[1],P=h[1];(P.vertex===m||x.vertex===T)&&(h[1]=x,h[0]=x=P,P=h[1]),x.vertex=m,P.vertex=T},e.setActive=function(i,u,c){u?(i.isActive=!0,i.timeUpdated=c):(i.isActive=!1,i.contactCount=0)},e.id=function(i,u){return i.id<u.id?i.id.toString(36)+":"+u.id.toString(36):u.id.toString(36)+":"+i.id.toString(36)}})()},function(S,D,v){var e={};S.exports=e;var n=v(3),i=v(2),u=v(7),c=v(1),l=v(11),d=v(0);(function(){e._warming=.4,e._torqueDampen=1,e._minLength=1e-6,e.create=function(h){var a=h;a.bodyA&&!a.pointA&&(a.pointA={x:0,y:0}),a.bodyB&&!a.pointB&&(a.pointB={x:0,y:0});var y=a.bodyA?i.add(a.bodyA.position,a.pointA):a.pointA,m=a.bodyB?i.add(a.bodyB.position,a.pointB):a.pointB,x=i.magnitude(i.sub(y,m));a.length=typeof a.length<"u"?a.length:x,a.id=a.id||d.nextId(),a.label=a.label||"Constraint",a.type="constraint",a.stiffness=a.stiffness||(a.length>0?1:.7),a.damping=a.damping||0,a.angularStiffness=a.angularStiffness||0,a.angleA=a.bodyA?a.bodyA.angle:a.angleA,a.angleB=a.bodyB?a.bodyB.angle:a.angleB,a.plugin={};var T={visible:!0,lineWidth:2,strokeStyle:"#ffffff",type:"line",anchors:!0};return a.length===0&&a.stiffness>.1?(T.type="pin",T.anchors=!1):a.stiffness<.9&&(T.type="spring"),a.render=d.extend(T,a.render),a},e.preSolveAll=function(h){for(var a=0;a<h.length;a+=1){var y=h[a],m=y.constraintImpulse;y.isStatic||m.x===0&&m.y===0&&m.angle===0||(y.position.x+=m.x,y.position.y+=m.y,y.angle+=m.angle)}},e.solveAll=function(h,a){for(var y=d.clamp(a/d._baseDelta,0,1),m=0;m<h.length;m+=1){var x=h[m],T=!x.bodyA||x.bodyA&&x.bodyA.isStatic,P=!x.bodyB||x.bodyB&&x.bodyB.isStatic;(T||P)&&e.solve(h[m],y)}for(m=0;m<h.length;m+=1)x=h[m],T=!x.bodyA||x.bodyA&&x.bodyA.isStatic,P=!x.bodyB||x.bodyB&&x.bodyB.isStatic,!T&&!P&&e.solve(h[m],y)},e.solve=function(h,a){var y=h.bodyA,m=h.bodyB,x=h.pointA,T=h.pointB;if(!(!y&&!m)){y&&!y.isStatic&&(i.rotate(x,y.angle-h.angleA,x),h.angleA=y.angle),m&&!m.isStatic&&(i.rotate(T,m.angle-h.angleB,T),h.angleB=m.angle);var P=x,E=T;if(y&&(P=i.add(y.position,x)),m&&(E=i.add(m.position,T)),!(!P||!E)){var B=i.sub(P,E),_=i.magnitude(B);_<e._minLength&&(_=e._minLength);var w=(_-h.length)/_,A=h.stiffness>=1||h.length===0,b=A?h.stiffness*a:h.stiffness*a*a,O=h.damping*a,C=i.mult(B,w*b),M=(y?y.inverseMass:0)+(m?m.inverseMass:0),R=(y?y.inverseInertia:0)+(m?m.inverseInertia:0),L=M+R,U,W,z,q,Y;if(O>0){var K=i.create();z=i.div(B,_),Y=i.sub(m&&i.sub(m.position,m.positionPrev)||K,y&&i.sub(y.position,y.positionPrev)||K),q=i.dot(z,Y)}y&&!y.isStatic&&(W=y.inverseMass/M,y.constraintImpulse.x-=C.x*W,y.constraintImpulse.y-=C.y*W,y.position.x-=C.x*W,y.position.y-=C.y*W,O>0&&(y.positionPrev.x-=O*z.x*q*W,y.positionPrev.y-=O*z.y*q*W),U=i.cross(x,C)/L*e._torqueDampen*y.inverseInertia*(1-h.angularStiffness),y.constraintImpulse.angle-=U,y.angle-=U),m&&!m.isStatic&&(W=m.inverseMass/M,m.constraintImpulse.x+=C.x*W,m.constraintImpulse.y+=C.y*W,m.position.x+=C.x*W,m.position.y+=C.y*W,O>0&&(m.positionPrev.x+=O*z.x*q*W,m.positionPrev.y+=O*z.y*q*W),U=i.cross(T,C)/L*e._torqueDampen*m.inverseInertia*(1-h.angularStiffness),m.constraintImpulse.angle+=U,m.angle+=U)}}},e.postSolveAll=function(h){for(var a=0;a<h.length;a++){var y=h[a],m=y.constraintImpulse;if(!(y.isStatic||m.x===0&&m.y===0&&m.angle===0)){u.set(y,!1);for(var x=0;x<y.parts.length;x++){var T=y.parts[x];n.translate(T.vertices,m),x>0&&(T.position.x+=m.x,T.position.y+=m.y),m.angle!==0&&(n.rotate(T.vertices,m.angle,y.position),l.rotate(T.axes,m.angle),x>0&&i.rotateAbout(T.position,m.angle,y.position,T.position)),c.update(T.bounds,T.vertices,y.velocity)}m.angle*=e._warming,m.x*=e._warming,m.y*=e._warming}}},e.pointAWorld=function(h){return{x:(h.bodyA?h.bodyA.position.x:0)+(h.pointA?h.pointA.x:0),y:(h.bodyA?h.bodyA.position.y:0)+(h.pointA?h.pointA.y:0)}},e.pointBWorld=function(h){return{x:(h.bodyB?h.bodyB.position.x:0)+(h.pointB?h.pointB.x:0),y:(h.bodyB?h.bodyB.position.y:0)+(h.pointB?h.pointB.y:0)}},e.currentLength=function(h){var a=(h.bodyA?h.bodyA.position.x:0)+(h.pointA?h.pointA.x:0),y=(h.bodyA?h.bodyA.position.y:0)+(h.pointA?h.pointA.y:0),m=(h.bodyB?h.bodyB.position.x:0)+(h.pointB?h.pointB.x:0),x=(h.bodyB?h.bodyB.position.y:0)+(h.pointB?h.pointB.y:0),T=a-m,P=y-x;return Math.sqrt(T*T+P*P)}})()},function(S,D,v){var e={};S.exports=e;var n=v(2),i=v(0);(function(){e.fromVertices=function(u){for(var c={},l=0;l<u.length;l++){var d=(l+1)%u.length,h=n.normalise({x:u[d].y-u[l].y,y:u[l].x-u[d].x}),a=h.y===0?1/0:h.x/h.y;a=a.toFixed(3).toString(),c[a]=h}return i.values(c)},e.rotate=function(u,c){if(c!==0)for(var l=Math.cos(c),d=Math.sin(c),h=0;h<u.length;h++){var a=u[h],y;y=a.x*l-a.y*d,a.y=a.x*d+a.y*l,a.x=y}}})()},function(S,D,v){var e={};S.exports=e;var n=v(3),i=v(0),u=v(4),c=v(1),l=v(2);(function(){e.rectangle=function(d,h,a,y,m){m=m||{};var x={label:"Rectangle Body",position:{x:d,y:h},vertices:n.fromPath("L 0 0 L "+a+" 0 L "+a+" "+y+" L 0 "+y)};if(m.chamfer){var T=m.chamfer;x.vertices=n.chamfer(x.vertices,T.radius,T.quality,T.qualityMin,T.qualityMax),delete m.chamfer}return u.create(i.extend({},x,m))},e.trapezoid=function(d,h,a,y,m,x){x=x||{},m>=1&&i.warn("Bodies.trapezoid: slope parameter must be < 1."),m*=.5;var T=(1-m*2)*a,P=a*m,E=P+T,B=E+P,_;m<.5?_="L 0 0 L "+P+" "+-y+" L "+E+" "+-y+" L "+B+" 0":_="L 0 0 L "+E+" "+-y+" L "+B+" 0";var w={label:"Trapezoid Body",position:{x:d,y:h},vertices:n.fromPath(_)};if(x.chamfer){var A=x.chamfer;w.vertices=n.chamfer(w.vertices,A.radius,A.quality,A.qualityMin,A.qualityMax),delete x.chamfer}return u.create(i.extend({},w,x))},e.circle=function(d,h,a,y,m){y=y||{};var x={label:"Circle Body",circleRadius:a};m=m||25;var T=Math.ceil(Math.max(10,Math.min(m,a)));return T%2===1&&(T+=1),e.polygon(d,h,T,a,i.extend({},x,y))},e.polygon=function(d,h,a,y,m){if(m=m||{},a<3)return e.circle(d,h,y,m);for(var x=2*Math.PI/a,T="",P=x*.5,E=0;E<a;E+=1){var B=P+E*x,_=Math.cos(B)*y,w=Math.sin(B)*y;T+="L "+_.toFixed(3)+" "+w.toFixed(3)+" "}var A={label:"Polygon Body",position:{x:d,y:h},vertices:n.fromPath(T)};if(m.chamfer){var b=m.chamfer;A.vertices=n.chamfer(A.vertices,b.radius,b.quality,b.qualityMin,b.qualityMax),delete m.chamfer}return u.create(i.extend({},A,m))},e.fromVertices=function(d,h,a,y,m,x,T,P){var E=i.getDecomp(),B,_,w,A,b,O,C,M,R,L,U;for(B=!!(E&&E.quickDecomp),y=y||{},w=[],m=typeof m<"u"?m:!1,x=typeof x<"u"?x:.01,T=typeof T<"u"?T:10,P=typeof P<"u"?P:.01,i.isArray(a[0])||(a=[a]),L=0;L<a.length;L+=1)if(O=a[L],A=n.isConvex(O),b=!A,b&&!B&&i.warnOnce("Bodies.fromVertices: Install the 'poly-decomp' library and use Common.setDecomp or provide 'decomp' as a global to decompose concave vertices."),A||!B)A?O=n.clockwiseSort(O):O=n.hull(O),w.push({position:{x:d,y:h},vertices:O});else{var W=O.map(function(H){return[H.x,H.y]});E.makeCCW(W),x!==!1&&E.removeCollinearPoints(W,x),P!==!1&&E.removeDuplicatePoints&&E.removeDuplicatePoints(W,P);var z=E.quickDecomp(W);for(C=0;C<z.length;C++){var q=z[C],Y=q.map(function(H){return{x:H[0],y:H[1]}});T>0&&n.area(Y)<T||w.push({position:n.centre(Y),vertices:Y})}}for(C=0;C<w.length;C++)w[C]=u.create(i.extend(w[C],y));if(m){var K=5;for(C=0;C<w.length;C++){var X=w[C];for(M=C+1;M<w.length;M++){var $=w[M];if(c.overlaps(X.bounds,$.bounds)){var Q=X.vertices,ee=$.vertices;for(R=0;R<X.vertices.length;R++)for(U=0;U<$.vertices.length;U++){var fe=l.magnitudeSquared(l.sub(Q[(R+1)%Q.length],ee[U])),ie=l.magnitudeSquared(l.sub(Q[R],ee[(U+1)%ee.length]));fe<K&&ie<K&&(Q[R].isInternal=!0,ee[U].isInternal=!0)}}}}}return w.length>1?(_=u.create(i.extend({parts:w.slice(0)},y)),u.setPosition(_,{x:d,y:h}),_):w[0]}})()},function(S,D,v){var e={};S.exports=e;var n=v(0),i=v(8);(function(){e.create=function(u){var c={bodies:[],collisions:[],pairs:null};return n.extend(c,u)},e.setBodies=function(u,c){u.bodies=c.slice(0)},e.clear=function(u){u.bodies=[],u.collisions=[]},e.collisions=function(u){var c=u.pairs,l=u.bodies,d=l.length,h=e.canCollide,a=i.collides,y=u.collisions,m=0,x,T;for(l.sort(e._compareBoundsX),x=0;x<d;x++){var P=l[x],E=P.bounds,B=P.bounds.max.x,_=P.bounds.max.y,w=P.bounds.min.y,A=P.isStatic||P.isSleeping,b=P.parts.length,O=b===1;for(T=x+1;T<d;T++){var C=l[T],M=C.bounds;if(M.min.x>B)break;if(!(_<M.min.y||w>M.max.y)&&!(A&&(C.isStatic||C.isSleeping))&&h(P.collisionFilter,C.collisionFilter)){var R=C.parts.length;if(O&&R===1){var L=a(P,C,c);L&&(y[m++]=L)}else for(var U=b>1?1:0,W=R>1?1:0,z=U;z<b;z++)for(var q=P.parts[z],E=q.bounds,Y=W;Y<R;Y++){var K=C.parts[Y],M=K.bounds;if(!(E.min.x>M.max.x||E.max.x<M.min.x||E.max.y<M.min.y||E.min.y>M.max.y)){var L=a(q,K,c);L&&(y[m++]=L)}}}}}return y.length!==m&&(y.length=m),y},e.canCollide=function(u,c){return u.group===c.group&&u.group!==0?u.group>0:(u.mask&c.category)!==0&&(c.mask&u.category)!==0},e._compareBoundsX=function(u,c){return u.bounds.min.x-c.bounds.min.x}})()},function(S,D,v){var e={};S.exports=e;var n=v(0);(function(){e.create=function(i){var u={};return i||n.log("Mouse.create: element was undefined, defaulting to document.body","warn"),u.element=i||document.body,u.absolute={x:0,y:0},u.position={x:0,y:0},u.mousedownPosition={x:0,y:0},u.mouseupPosition={x:0,y:0},u.offset={x:0,y:0},u.scale={x:1,y:1},u.wheelDelta=0,u.button=-1,u.pixelRatio=parseInt(u.element.getAttribute("data-pixel-ratio"),10)||1,u.sourceEvents={mousemove:null,mousedown:null,mouseup:null,mousewheel:null},u.mousemove=function(c){var l=e._getRelativeMousePosition(c,u.element,u.pixelRatio),d=c.changedTouches;d&&(u.button=0,c.preventDefault()),u.absolute.x=l.x,u.absolute.y=l.y,u.position.x=u.absolute.x*u.scale.x+u.offset.x,u.position.y=u.absolute.y*u.scale.y+u.offset.y,u.sourceEvents.mousemove=c},u.mousedown=function(c){var l=e._getRelativeMousePosition(c,u.element,u.pixelRatio),d=c.changedTouches;d?(u.button=0,c.preventDefault()):u.button=c.button,u.absolute.x=l.x,u.absolute.y=l.y,u.position.x=u.absolute.x*u.scale.x+u.offset.x,u.position.y=u.absolute.y*u.scale.y+u.offset.y,u.mousedownPosition.x=u.position.x,u.mousedownPosition.y=u.position.y,u.sourceEvents.mousedown=c},u.mouseup=function(c){var l=e._getRelativeMousePosition(c,u.element,u.pixelRatio),d=c.changedTouches;d&&c.preventDefault(),u.button=-1,u.absolute.x=l.x,u.absolute.y=l.y,u.position.x=u.absolute.x*u.scale.x+u.offset.x,u.position.y=u.absolute.y*u.scale.y+u.offset.y,u.mouseupPosition.x=u.position.x,u.mouseupPosition.y=u.position.y,u.sourceEvents.mouseup=c},u.mousewheel=function(c){u.wheelDelta=Math.max(-1,Math.min(1,c.wheelDelta||-c.detail)),c.preventDefault(),u.sourceEvents.mousewheel=c},e.setElement(u,u.element),u},e.setElement=function(i,u){i.element=u,u.addEventListener("mousemove",i.mousemove,{passive:!0}),u.addEventListener("mousedown",i.mousedown,{passive:!0}),u.addEventListener("mouseup",i.mouseup,{passive:!0}),u.addEventListener("wheel",i.mousewheel,{passive:!1}),u.addEventListener("touchmove",i.mousemove,{passive:!1}),u.addEventListener("touchstart",i.mousedown,{passive:!1}),u.addEventListener("touchend",i.mouseup,{passive:!1})},e.clearSourceEvents=function(i){i.sourceEvents.mousemove=null,i.sourceEvents.mousedown=null,i.sourceEvents.mouseup=null,i.sourceEvents.mousewheel=null,i.wheelDelta=0},e.setOffset=function(i,u){i.offset.x=u.x,i.offset.y=u.y,i.position.x=i.absolute.x*i.scale.x+i.offset.x,i.position.y=i.absolute.y*i.scale.y+i.offset.y},e.setScale=function(i,u){i.scale.x=u.x,i.scale.y=u.y,i.position.x=i.absolute.x*i.scale.x+i.offset.x,i.position.y=i.absolute.y*i.scale.y+i.offset.y},e._getRelativeMousePosition=function(i,u,c){var l=u.getBoundingClientRect(),d=document.documentElement||document.body.parentNode||document.body,h=window.pageXOffset!==void 0?window.pageXOffset:d.scrollLeft,a=window.pageYOffset!==void 0?window.pageYOffset:d.scrollTop,y=i.changedTouches,m,x;return y?(m=y[0].pageX-l.left-h,x=y[0].pageY-l.top-a):(m=i.pageX-l.left-h,x=i.pageY-l.top-a),{x:m/(u.clientWidth/(u.width||u.clientWidth)*c),y:x/(u.clientHeight/(u.height||u.clientHeight)*c)}}})()},function(S,D,v){var e={};S.exports=e;var n=v(0);(function(){e._registry={},e.register=function(i){if(e.isPlugin(i)||n.warn("Plugin.register:",e.toString(i),"does not implement all required fields."),i.name in e._registry){var u=e._registry[i.name],c=e.versionParse(i.version).number,l=e.versionParse(u.version).number;c>l?(n.warn("Plugin.register:",e.toString(u),"was upgraded to",e.toString(i)),e._registry[i.name]=i):c<l?n.warn("Plugin.register:",e.toString(u),"can not be downgraded to",e.toString(i)):i!==u&&n.warn("Plugin.register:",e.toString(i),"is already registered to different plugin object")}else e._registry[i.name]=i;return i},e.resolve=function(i){return e._registry[e.dependencyParse(i).name]},e.toString=function(i){return typeof i=="string"?i:(i.name||"anonymous")+"@"+(i.version||i.range||"0.0.0")},e.isPlugin=function(i){return i&&i.name&&i.version&&i.install},e.isUsed=function(i,u){return i.used.indexOf(u)>-1},e.isFor=function(i,u){var c=i.for&&e.dependencyParse(i.for);return!i.for||u.name===c.name&&e.versionSatisfies(u.version,c.range)},e.use=function(i,u){if(i.uses=(i.uses||[]).concat(u||[]),i.uses.length===0){n.warn("Plugin.use:",e.toString(i),"does not specify any dependencies to install.");return}for(var c=e.dependencies(i),l=n.topologicalSort(c),d=[],h=0;h<l.length;h+=1)if(l[h]!==i.name){var a=e.resolve(l[h]);if(!a){d.push("âŒ "+l[h]);continue}e.isUsed(i,a.name)||(e.isFor(a,i)||(n.warn("Plugin.use:",e.toString(a),"is for",a.for,"but installed on",e.toString(i)+"."),a._warned=!0),a.install?a.install(i):(n.warn("Plugin.use:",e.toString(a),"does not specify an install function."),a._warned=!0),a._warned?(d.push("ðŸ”¶ "+e.toString(a)),delete a._warned):d.push("âœ… "+e.toString(a)),i.used.push(a.name))}d.length>0&&n.info(d.join("  "))},e.dependencies=function(i,u){var c=e.dependencyParse(i),l=c.name;if(u=u||{},!(l in u)){i=e.resolve(i)||i,u[l]=n.map(i.uses||[],function(h){e.isPlugin(h)&&e.register(h);var a=e.dependencyParse(h),y=e.resolve(h);return y&&!e.versionSatisfies(y.version,a.range)?(n.warn("Plugin.dependencies:",e.toString(y),"does not satisfy",e.toString(a),"used by",e.toString(c)+"."),y._warned=!0,i._warned=!0):y||(n.warn("Plugin.dependencies:",e.toString(h),"used by",e.toString(c),"could not be resolved."),i._warned=!0),a.name});for(var d=0;d<u[l].length;d+=1)e.dependencies(u[l][d],u);return u}},e.dependencyParse=function(i){if(n.isString(i)){var u=/^[\w-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-+]+)?))?$/;return u.test(i)||n.warn("Plugin.dependencyParse:",i,"is not a valid dependency string."),{name:i.split("@")[0],range:i.split("@")[1]||"*"}}return{name:i.name,range:i.range||i.version}},e.versionParse=function(i){var u=/^(\*)|(\^|~|>=|>)?\s*((\d+)\.(\d+)\.(\d+))(-[0-9A-Za-z-+]+)?$/;u.test(i)||n.warn("Plugin.versionParse:",i,"is not a valid version or range.");var c=u.exec(i),l=Number(c[4]),d=Number(c[5]),h=Number(c[6]);return{isRange:!!(c[1]||c[2]),version:c[3],range:i,operator:c[1]||c[2]||"",major:l,minor:d,patch:h,parts:[l,d,h],prerelease:c[7],number:l*1e8+d*1e4+h}},e.versionSatisfies=function(i,u){u=u||"*";var c=e.versionParse(u),l=e.versionParse(i);if(c.isRange){if(c.operator==="*"||i==="*")return!0;if(c.operator===">")return l.number>c.number;if(c.operator===">=")return l.number>=c.number;if(c.operator==="~")return l.major===c.major&&l.minor===c.minor&&l.patch>=c.patch;if(c.operator==="^")return c.major>0?l.major===c.major&&l.number>=c.number:c.minor>0?l.minor===c.minor&&l.patch>=c.patch:l.patch===c.patch}return i===u||i==="*"}})()},function(S,D){var v={};S.exports=v,function(){v.create=function(e){return{vertex:e,normalImpulse:0,tangentImpulse:0}}}()},function(S,D,v){var e={};S.exports=e;var n=v(7),i=v(18),u=v(13),c=v(19),l=v(5),d=v(6),h=v(10),a=v(0),y=v(4);(function(){e._deltaMax=1e3/60,e.create=function(m){m=m||{};var x={positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],plugin:{},gravity:{x:0,y:1,scale:.001},timing:{timestamp:0,timeScale:1,lastDelta:0,lastElapsed:0,lastUpdatesPerFrame:0}},T=a.extend(x,m);return T.world=m.world||d.create({label:"World"}),T.pairs=m.pairs||c.create(),T.detector=m.detector||u.create(),T.detector.pairs=T.pairs,T.grid={buckets:[]},T.world.gravity=T.gravity,T.broadphase=T.grid,T.metrics={},T},e.update=function(m,x){var T=a.now(),P=m.world,E=m.detector,B=m.pairs,_=m.timing,w=_.timestamp,A;x>e._deltaMax&&a.warnOnce("Matter.Engine.update: delta argument is recommended to be less than or equal to",e._deltaMax.toFixed(3),"ms."),x=typeof x<"u"?x:a._baseDelta,x*=_.timeScale,_.timestamp+=x,_.lastDelta=x;var b={timestamp:_.timestamp,delta:x};l.trigger(m,"beforeUpdate",b);var O=d.allBodies(P),C=d.allConstraints(P);for(P.isModified&&(u.setBodies(E,O),d.setModified(P,!1,!1,!0)),m.enableSleeping&&n.update(O,x),e._bodiesApplyGravity(O,m.gravity),x>0&&e._bodiesUpdate(O,x),l.trigger(m,"beforeSolve",b),h.preSolveAll(O),A=0;A<m.constraintIterations;A++)h.solveAll(C,x);h.postSolveAll(O);var M=u.collisions(E);c.update(B,M,w),m.enableSleeping&&n.afterCollisions(B.list),B.collisionStart.length>0&&l.trigger(m,"collisionStart",{pairs:B.collisionStart,timestamp:_.timestamp,delta:x});var R=a.clamp(20/m.positionIterations,0,1);for(i.preSolvePosition(B.list),A=0;A<m.positionIterations;A++)i.solvePosition(B.list,x,R);for(i.postSolvePosition(O),h.preSolveAll(O),A=0;A<m.constraintIterations;A++)h.solveAll(C,x);for(h.postSolveAll(O),i.preSolveVelocity(B.list),A=0;A<m.velocityIterations;A++)i.solveVelocity(B.list,x);return e._bodiesUpdateVelocities(O),B.collisionActive.length>0&&l.trigger(m,"collisionActive",{pairs:B.collisionActive,timestamp:_.timestamp,delta:x}),B.collisionEnd.length>0&&l.trigger(m,"collisionEnd",{pairs:B.collisionEnd,timestamp:_.timestamp,delta:x}),e._bodiesClearForces(O),l.trigger(m,"afterUpdate",b),m.timing.lastElapsed=a.now()-T,m},e.merge=function(m,x){if(a.extend(m,x),x.world){m.world=x.world,e.clear(m);for(var T=d.allBodies(m.world),P=0;P<T.length;P++){var E=T[P];n.set(E,!1),E.id=a.nextId()}}},e.clear=function(m){c.clear(m.pairs),u.clear(m.detector)},e._bodiesClearForces=function(m){for(var x=m.length,T=0;T<x;T++){var P=m[T];P.force.x=0,P.force.y=0,P.torque=0}},e._bodiesApplyGravity=function(m,x){var T=typeof x.scale<"u"?x.scale:.001,P=m.length;if(!(x.x===0&&x.y===0||T===0))for(var E=0;E<P;E++){var B=m[E];B.isStatic||B.isSleeping||(B.force.y+=B.mass*x.y*T,B.force.x+=B.mass*x.x*T)}},e._bodiesUpdate=function(m,x){for(var T=m.length,P=0;P<T;P++){var E=m[P];E.isStatic||E.isSleeping||y.update(E,x)}},e._bodiesUpdateVelocities=function(m){for(var x=m.length,T=0;T<x;T++)y.updateVelocities(m[T])}})()},function(S,D,v){var e={};S.exports=e;var n=v(3),i=v(0),u=v(1);(function(){e._restingThresh=2,e._restingThreshTangent=Math.sqrt(6),e._positionDampen=.9,e._positionWarming=.8,e._frictionNormalMultiplier=5,e._frictionMaxStatic=Number.MAX_VALUE,e.preSolvePosition=function(c){var l,d,h,a=c.length;for(l=0;l<a;l++)d=c[l],d.isActive&&(h=d.contactCount,d.collision.parentA.totalContacts+=h,d.collision.parentB.totalContacts+=h)},e.solvePosition=function(c,l,d){var h,a,y,m,x,T,P,E,B=e._positionDampen*(d||1),_=i.clamp(l/i._baseDelta,0,1),w=c.length;for(h=0;h<w;h++)a=c[h],!(!a.isActive||a.isSensor)&&(y=a.collision,m=y.parentA,x=y.parentB,T=y.normal,a.separation=y.depth+T.x*(x.positionImpulse.x-m.positionImpulse.x)+T.y*(x.positionImpulse.y-m.positionImpulse.y));for(h=0;h<w;h++)a=c[h],!(!a.isActive||a.isSensor)&&(y=a.collision,m=y.parentA,x=y.parentB,T=y.normal,E=a.separation-a.slop*_,(m.isStatic||x.isStatic)&&(E*=2),m.isStatic||m.isSleeping||(P=B/m.totalContacts,m.positionImpulse.x+=T.x*E*P,m.positionImpulse.y+=T.y*E*P),x.isStatic||x.isSleeping||(P=B/x.totalContacts,x.positionImpulse.x-=T.x*E*P,x.positionImpulse.y-=T.y*E*P))},e.postSolvePosition=function(c){for(var l=e._positionWarming,d=c.length,h=n.translate,a=u.update,y=0;y<d;y++){var m=c[y],x=m.positionImpulse,T=x.x,P=x.y,E=m.velocity;if(m.totalContacts=0,T!==0||P!==0){for(var B=0;B<m.parts.length;B++){var _=m.parts[B];h(_.vertices,x),a(_.bounds,_.vertices,E),_.position.x+=T,_.position.y+=P}m.positionPrev.x+=T,m.positionPrev.y+=P,T*E.x+P*E.y<0?(x.x=0,x.y=0):(x.x*=l,x.y*=l)}}},e.preSolveVelocity=function(c){var l=c.length,d,h;for(d=0;d<l;d++){var a=c[d];if(!(!a.isActive||a.isSensor)){var y=a.contacts,m=a.contactCount,x=a.collision,T=x.parentA,P=x.parentB,E=x.normal,B=x.tangent;for(h=0;h<m;h++){var _=y[h],w=_.vertex,A=_.normalImpulse,b=_.tangentImpulse;if(A!==0||b!==0){var O=E.x*A+B.x*b,C=E.y*A+B.y*b;T.isStatic||T.isSleeping||(T.positionPrev.x+=O*T.inverseMass,T.positionPrev.y+=C*T.inverseMass,T.anglePrev+=T.inverseInertia*((w.x-T.position.x)*C-(w.y-T.position.y)*O)),P.isStatic||P.isSleeping||(P.positionPrev.x-=O*P.inverseMass,P.positionPrev.y-=C*P.inverseMass,P.anglePrev-=P.inverseInertia*((w.x-P.position.x)*C-(w.y-P.position.y)*O))}}}}},e.solveVelocity=function(c,l){var d=l/i._baseDelta,h=d*d,a=h*d,y=-e._restingThresh*d,m=e._restingThreshTangent,x=e._frictionNormalMultiplier*d,T=e._frictionMaxStatic,P=c.length,E,B,_,w;for(_=0;_<P;_++){var A=c[_];if(!(!A.isActive||A.isSensor)){var b=A.collision,O=b.parentA,C=b.parentB,M=b.normal.x,R=b.normal.y,L=b.tangent.x,U=b.tangent.y,W=A.inverseMass,z=A.friction*A.frictionStatic*x,q=A.contacts,Y=A.contactCount,K=1/Y,X=O.position.x-O.positionPrev.x,$=O.position.y-O.positionPrev.y,Q=O.angle-O.anglePrev,ee=C.position.x-C.positionPrev.x,fe=C.position.y-C.positionPrev.y,ie=C.angle-C.anglePrev;for(w=0;w<Y;w++){var H=q[w],oe=H.vertex,J=oe.x-O.position.x,ve=oe.y-O.position.y,se=oe.x-C.position.x,ae=oe.y-C.position.y,ne=X-ve*Q,_t=$+J*Q,Tt=ee-ae*ie,St=fe+se*ie,Ie=ne-Tt,be=_t-St,Pe=M*Ie+R*be,ue=L*Ie+U*be,Ne=A.separation+Pe,Ae=Math.min(Ne,1);Ae=Ne<0?0:Ae;var Le=Ae*z;ue<-Le||ue>Le?(B=ue>0?ue:-ue,E=A.friction*(ue>0?1:-1)*a,E<-B?E=-B:E>B&&(E=B)):(E=ue,B=T);var Ve=J*R-ve*M,Ue=se*R-ae*M,We=K/(W+O.inverseInertia*Ve*Ve+C.inverseInertia*Ue*Ue),_e=(1+A.restitution)*Pe*We;if(E*=We,Pe<y)H.normalImpulse=0;else{var wt=H.normalImpulse;H.normalImpulse+=_e,H.normalImpulse>0&&(H.normalImpulse=0),_e=H.normalImpulse-wt}if(ue<-m||ue>m)H.tangentImpulse=0;else{var Te=H.tangentImpulse;H.tangentImpulse+=E,H.tangentImpulse<-B&&(H.tangentImpulse=-B),H.tangentImpulse>B&&(H.tangentImpulse=B),E=H.tangentImpulse-Te}var Se=M*_e+L*E,le=R*_e+U*E;O.isStatic||O.isSleeping||(O.positionPrev.x+=Se*O.inverseMass,O.positionPrev.y+=le*O.inverseMass,O.anglePrev+=(J*le-ve*Se)*O.inverseInertia),C.isStatic||C.isSleeping||(C.positionPrev.x-=Se*C.inverseMass,C.positionPrev.y-=le*C.inverseMass,C.anglePrev-=(se*le-ae*Se)*C.inverseInertia)}}}}})()},function(S,D,v){var e={};S.exports=e;var n=v(9),i=v(0);(function(){e.create=function(u){return i.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},u)},e.update=function(u,c,l){var d=n.update,h=n.create,a=n.setActive,y=u.table,m=u.list,x=m.length,T=x,P=u.collisionStart,E=u.collisionEnd,B=u.collisionActive,_=c.length,w=0,A=0,b=0,O,C,M;for(M=0;M<_;M++)O=c[M],C=O.pair,C?(C.isActive&&(B[b++]=C),d(C,O,l)):(C=h(O,l),y[C.id]=C,P[w++]=C,m[T++]=C);for(T=0,x=m.length,M=0;M<x;M++)C=m[M],C.timeUpdated>=l?m[T++]=C:(a(C,!1,l),C.collision.bodyA.sleepCounter>0&&C.collision.bodyB.sleepCounter>0?m[T++]=C:(E[A++]=C,delete y[C.id]));m.length!==T&&(m.length=T),P.length!==w&&(P.length=w),E.length!==A&&(E.length=A),B.length!==b&&(B.length=b)},e.clear=function(u){return u.table={},u.list.length=0,u.collisionStart.length=0,u.collisionActive.length=0,u.collisionEnd.length=0,u}})()},function(S,D,v){var e=S.exports=v(21);e.Axes=v(11),e.Bodies=v(12),e.Body=v(4),e.Bounds=v(1),e.Collision=v(8),e.Common=v(0),e.Composite=v(6),e.Composites=v(22),e.Constraint=v(10),e.Contact=v(16),e.Detector=v(13),e.Engine=v(17),e.Events=v(5),e.Grid=v(23),e.Mouse=v(14),e.MouseConstraint=v(24),e.Pair=v(9),e.Pairs=v(19),e.Plugin=v(15),e.Query=v(25),e.Render=v(26),e.Resolver=v(18),e.Runner=v(27),e.SAT=v(28),e.Sleeping=v(7),e.Svg=v(29),e.Vector=v(2),e.Vertices=v(3),e.World=v(30),e.Engine.run=e.Runner.run,e.Common.deprecated(e.Engine,"run","Engine.run âž¤ use Matter.Runner.run(engine) instead")},function(S,D,v){var e={};S.exports=e;var n=v(15),i=v(0);(function(){e.name="matter-js",e.version="0.20.0",e.uses=[],e.used=[],e.use=function(){n.use(e,Array.prototype.slice.call(arguments))},e.before=function(u,c){return u=u.replace(/^Matter./,""),i.chainPathBefore(e,u,c)},e.after=function(u,c){return u=u.replace(/^Matter./,""),i.chainPathAfter(e,u,c)}})()},function(S,D,v){var e={};S.exports=e;var n=v(6),i=v(10),u=v(0),c=v(4),l=v(12),d=u.deprecated;(function(){e.stack=function(h,a,y,m,x,T,P){for(var E=n.create({label:"Stack"}),B=h,_=a,w,A=0,b=0;b<m;b++){for(var O=0,C=0;C<y;C++){var M=P(B,_,C,b,w,A);if(M){var R=M.bounds.max.y-M.bounds.min.y,L=M.bounds.max.x-M.bounds.min.x;R>O&&(O=R),c.translate(M,{x:L*.5,y:R*.5}),B=M.bounds.max.x+x,n.addBody(E,M),w=M,A+=1}else B+=x}_+=O+T,B=h}return E},e.chain=function(h,a,y,m,x,T){for(var P=h.bodies,E=1;E<P.length;E++){var B=P[E-1],_=P[E],w=B.bounds.max.y-B.bounds.min.y,A=B.bounds.max.x-B.bounds.min.x,b=_.bounds.max.y-_.bounds.min.y,O=_.bounds.max.x-_.bounds.min.x,C={bodyA:B,pointA:{x:A*a,y:w*y},bodyB:_,pointB:{x:O*m,y:b*x}},M=u.extend(C,T);n.addConstraint(h,i.create(M))}return h.label+=" Chain",h},e.mesh=function(h,a,y,m,x){var T=h.bodies,P,E,B,_,w;for(P=0;P<y;P++){for(E=1;E<a;E++)B=T[E-1+P*a],_=T[E+P*a],n.addConstraint(h,i.create(u.extend({bodyA:B,bodyB:_},x)));if(P>0)for(E=0;E<a;E++)B=T[E+(P-1)*a],_=T[E+P*a],n.addConstraint(h,i.create(u.extend({bodyA:B,bodyB:_},x))),m&&E>0&&(w=T[E-1+(P-1)*a],n.addConstraint(h,i.create(u.extend({bodyA:w,bodyB:_},x)))),m&&E<a-1&&(w=T[E+1+(P-1)*a],n.addConstraint(h,i.create(u.extend({bodyA:w,bodyB:_},x))))}return h.label+=" Mesh",h},e.pyramid=function(h,a,y,m,x,T,P){return e.stack(h,a,y,m,x,T,function(E,B,_,w,A,b){var O=Math.min(m,Math.ceil(y/2)),C=A?A.bounds.max.x-A.bounds.min.x:0;if(!(w>O)){w=O-w;var M=w,R=y-1-w;if(!(_<M||_>R)){b===1&&c.translate(A,{x:(_+(y%2===1?1:-1))*C,y:0});var L=A?_*C:0;return P(h+L+_*x,B,_,w,A,b)}}})},e.newtonsCradle=function(h,a,y,m,x){for(var T=n.create({label:"Newtons Cradle"}),P=0;P<y;P++){var E=1.9,B=l.circle(h+P*(m*E),a+x,m,{inertia:1/0,restitution:1,friction:0,frictionAir:1e-4,slop:1}),_=i.create({pointA:{x:h+P*(m*E),y:a},bodyB:B});n.addBody(T,B),n.addConstraint(T,_)}return T},d(e,"newtonsCradle","Composites.newtonsCradle âž¤ moved to newtonsCradle example"),e.car=function(h,a,y,m,x){var T=c.nextGroup(!0),P=20,E=-y*.5+P,B=y*.5-P,_=0,w=n.create({label:"Car"}),A=l.rectangle(h,a,y,m,{collisionFilter:{group:T},chamfer:{radius:m*.5},density:2e-4}),b=l.circle(h+E,a+_,x,{collisionFilter:{group:T},friction:.8}),O=l.circle(h+B,a+_,x,{collisionFilter:{group:T},friction:.8}),C=i.create({bodyB:A,pointB:{x:E,y:_},bodyA:b,stiffness:1,length:0}),M=i.create({bodyB:A,pointB:{x:B,y:_},bodyA:O,stiffness:1,length:0});return n.addBody(w,A),n.addBody(w,b),n.addBody(w,O),n.addConstraint(w,C),n.addConstraint(w,M),w},d(e,"car","Composites.car âž¤ moved to car example"),e.softBody=function(h,a,y,m,x,T,P,E,B,_){B=u.extend({inertia:1/0},B),_=u.extend({stiffness:.2,render:{type:"line",anchors:!1}},_);var w=e.stack(h,a,y,m,x,T,function(A,b){return l.circle(A,b,E,B)});return e.mesh(w,y,m,P,_),w.label="Soft Body",w},d(e,"softBody","Composites.softBody âž¤ moved to softBody and cloth examples")})()},function(S,D,v){var e={};S.exports=e;var n=v(9),i=v(0),u=i.deprecated;(function(){e.create=function(c){var l={buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48};return i.extend(l,c)},e.update=function(c,l,d,h){var a,y,m,x=d.world,T=c.buckets,P,E,B=!1;for(a=0;a<l.length;a++){var _=l[a];if(!(_.isSleeping&&!h)&&!(x.bounds&&(_.bounds.max.x<x.bounds.min.x||_.bounds.min.x>x.bounds.max.x||_.bounds.max.y<x.bounds.min.y||_.bounds.min.y>x.bounds.max.y))){var w=e._getRegion(c,_);if(!_.region||w.id!==_.region.id||h){(!_.region||h)&&(_.region=w);var A=e._regionUnion(w,_.region);for(y=A.startCol;y<=A.endCol;y++)for(m=A.startRow;m<=A.endRow;m++){E=e._getBucketId(y,m),P=T[E];var b=y>=w.startCol&&y<=w.endCol&&m>=w.startRow&&m<=w.endRow,O=y>=_.region.startCol&&y<=_.region.endCol&&m>=_.region.startRow&&m<=_.region.endRow;!b&&O&&O&&P&&e._bucketRemoveBody(c,P,_),(_.region===w||b&&!O||h)&&(P||(P=e._createBucket(T,E)),e._bucketAddBody(c,P,_))}_.region=w,B=!0}}}B&&(c.pairsList=e._createActivePairsList(c))},u(e,"update","Grid.update âž¤ replaced by Matter.Detector"),e.clear=function(c){c.buckets={},c.pairs={},c.pairsList=[]},u(e,"clear","Grid.clear âž¤ replaced by Matter.Detector"),e._regionUnion=function(c,l){var d=Math.min(c.startCol,l.startCol),h=Math.max(c.endCol,l.endCol),a=Math.min(c.startRow,l.startRow),y=Math.max(c.endRow,l.endRow);return e._createRegion(d,h,a,y)},e._getRegion=function(c,l){var d=l.bounds,h=Math.floor(d.min.x/c.bucketWidth),a=Math.floor(d.max.x/c.bucketWidth),y=Math.floor(d.min.y/c.bucketHeight),m=Math.floor(d.max.y/c.bucketHeight);return e._createRegion(h,a,y,m)},e._createRegion=function(c,l,d,h){return{id:c+","+l+","+d+","+h,startCol:c,endCol:l,startRow:d,endRow:h}},e._getBucketId=function(c,l){return"C"+c+"R"+l},e._createBucket=function(c,l){var d=c[l]=[];return d},e._bucketAddBody=function(c,l,d){var h=c.pairs,a=n.id,y=l.length,m;for(m=0;m<y;m++){var x=l[m];if(!(d.id===x.id||d.isStatic&&x.isStatic)){var T=a(d,x),P=h[T];P?P[2]+=1:h[T]=[d,x,1]}}l.push(d)},e._bucketRemoveBody=function(c,l,d){var h=c.pairs,a=n.id,y;l.splice(i.indexOf(l,d),1);var m=l.length;for(y=0;y<m;y++){var x=h[a(d,l[y])];x&&(x[2]-=1)}},e._createActivePairsList=function(c){var l,d=c.pairs,h=i.keys(d),a=h.length,y=[],m;for(m=0;m<a;m++)l=d[h[m]],l[2]>0?y.push(l):delete d[h[m]];return y}})()},function(S,D,v){var e={};S.exports=e;var n=v(3),i=v(7),u=v(14),c=v(5),l=v(13),d=v(10),h=v(6),a=v(0),y=v(1);(function(){e.create=function(m,x){var T=(m?m.mouse:null)||(x?x.mouse:null);T||(m&&m.render&&m.render.canvas?T=u.create(m.render.canvas):x&&x.element?T=u.create(x.element):(T=u.create(),a.warn("MouseConstraint.create: options.mouse was undefined, options.element was undefined, may not function as expected")));var P=d.create({label:"Mouse Constraint",pointA:T.position,pointB:{x:0,y:0},length:.01,stiffness:.1,angularStiffness:1,render:{strokeStyle:"#90EE90",lineWidth:3}}),E={type:"mouseConstraint",mouse:T,element:null,body:null,constraint:P,collisionFilter:{category:1,mask:4294967295,group:0}},B=a.extend(E,x);return c.on(m,"beforeUpdate",function(){var _=h.allBodies(m.world);e.update(B,_),e._triggerEvents(B)}),B},e.update=function(m,x){var T=m.mouse,P=m.constraint,E=m.body;if(T.button===0){if(P.bodyB)i.set(P.bodyB,!1),P.pointA=T.position;else for(var B=0;B<x.length;B++)if(E=x[B],y.contains(E.bounds,T.position)&&l.canCollide(E.collisionFilter,m.collisionFilter))for(var _=E.parts.length>1?1:0;_<E.parts.length;_++){var w=E.parts[_];if(n.contains(w.vertices,T.position)){P.pointA=T.position,P.bodyB=m.body=E,P.pointB={x:T.position.x-E.position.x,y:T.position.y-E.position.y},P.angleB=E.angle,i.set(E,!1),c.trigger(m,"startdrag",{mouse:T,body:E});break}}}else P.bodyB=m.body=null,P.pointB=null,E&&c.trigger(m,"enddrag",{mouse:T,body:E})},e._triggerEvents=function(m){var x=m.mouse,T=x.sourceEvents;T.mousemove&&c.trigger(m,"mousemove",{mouse:x}),T.mousedown&&c.trigger(m,"mousedown",{mouse:x}),T.mouseup&&c.trigger(m,"mouseup",{mouse:x}),u.clearSourceEvents(x)}})()},function(S,D,v){var e={};S.exports=e;var n=v(2),i=v(8),u=v(1),c=v(12),l=v(3);(function(){e.collides=function(d,h){for(var a=[],y=h.length,m=d.bounds,x=i.collides,T=u.overlaps,P=0;P<y;P++){var E=h[P],B=E.parts.length,_=B===1?0:1;if(T(E.bounds,m))for(var w=_;w<B;w++){var A=E.parts[w];if(T(A.bounds,m)){var b=x(A,d);if(b){a.push(b);break}}}}return a},e.ray=function(d,h,a,y){y=y||1e-100;for(var m=n.angle(h,a),x=n.magnitude(n.sub(h,a)),T=(a.x+h.x)*.5,P=(a.y+h.y)*.5,E=c.rectangle(T,P,x,y,{angle:m}),B=e.collides(E,d),_=0;_<B.length;_+=1){var w=B[_];w.body=w.bodyB=w.bodyA}return B},e.region=function(d,h,a){for(var y=[],m=0;m<d.length;m++){var x=d[m],T=u.overlaps(x.bounds,h);(T&&!a||!T&&a)&&y.push(x)}return y},e.point=function(d,h){for(var a=[],y=0;y<d.length;y++){var m=d[y];if(u.contains(m.bounds,h))for(var x=m.parts.length===1?0:1;x<m.parts.length;x++){var T=m.parts[x];if(u.contains(T.bounds,h)&&l.contains(T.vertices,h)){a.push(m);break}}}return a}})()},function(S,D,v){var e={};S.exports=e;var n=v(4),i=v(0),u=v(6),c=v(1),l=v(5),d=v(2),h=v(14);(function(){var a,y;typeof window<"u"&&(a=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(_){window.setTimeout(function(){_(i.now())},1e3/60)},y=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),e._goodFps=30,e._goodDelta=1e3/60,e.create=function(_){var w={engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,timing:{historySize:60,delta:0,deltaHistory:[],lastTime:0,lastTimestamp:0,lastElapsed:0,timestampElapsed:0,timestampElapsedHistory:[],engineDeltaHistory:[],engineElapsedHistory:[],engineUpdatesHistory:[],elapsedHistory:[]},options:{width:800,height:600,pixelRatio:1,background:"#14151f",wireframeBackground:"#14151f",wireframeStrokeStyle:"#bbb",hasBounds:!!_.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showStats:!1,showPerformance:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},A=i.extend(w,_);return A.canvas&&(A.canvas.width=A.options.width||A.canvas.width,A.canvas.height=A.options.height||A.canvas.height),A.mouse=_.mouse,A.engine=_.engine,A.canvas=A.canvas||T(A.options.width,A.options.height),A.context=A.canvas.getContext("2d"),A.textures={},A.bounds=A.bounds||{min:{x:0,y:0},max:{x:A.canvas.width,y:A.canvas.height}},A.controller=e,A.options.showBroadphase=!1,A.options.pixelRatio!==1&&e.setPixelRatio(A,A.options.pixelRatio),i.isElement(A.element)&&A.element.appendChild(A.canvas),A},e.run=function(_){(function w(A){_.frameRequestId=a(w),m(_,A),e.world(_,A),_.context.setTransform(_.options.pixelRatio,0,0,_.options.pixelRatio,0,0),(_.options.showStats||_.options.showDebug)&&e.stats(_,_.context,A),(_.options.showPerformance||_.options.showDebug)&&e.performance(_,_.context,A),_.context.setTransform(1,0,0,1,0,0)})()},e.stop=function(_){y(_.frameRequestId)},e.setPixelRatio=function(_,w){var A=_.options,b=_.canvas;w==="auto"&&(w=P(b)),A.pixelRatio=w,b.setAttribute("data-pixel-ratio",w),b.width=A.width*w,b.height=A.height*w,b.style.width=A.width+"px",b.style.height=A.height+"px"},e.setSize=function(_,w,A){_.options.width=w,_.options.height=A,_.bounds.max.x=_.bounds.min.x+w,_.bounds.max.y=_.bounds.min.y+A,_.options.pixelRatio!==1?e.setPixelRatio(_,_.options.pixelRatio):(_.canvas.width=w,_.canvas.height=A)},e.lookAt=function(_,w,A,b){b=typeof b<"u"?b:!0,w=i.isArray(w)?w:[w],A=A||{x:0,y:0};for(var O={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},C=0;C<w.length;C+=1){var M=w[C],R=M.bounds?M.bounds.min:M.min||M.position||M,L=M.bounds?M.bounds.max:M.max||M.position||M;R&&L&&(R.x<O.min.x&&(O.min.x=R.x),L.x>O.max.x&&(O.max.x=L.x),R.y<O.min.y&&(O.min.y=R.y),L.y>O.max.y&&(O.max.y=L.y))}var U=O.max.x-O.min.x+2*A.x,W=O.max.y-O.min.y+2*A.y,z=_.canvas.height,q=_.canvas.width,Y=q/z,K=U/W,X=1,$=1;K>Y?$=K/Y:X=Y/K,_.options.hasBounds=!0,_.bounds.min.x=O.min.x,_.bounds.max.x=O.min.x+U*X,_.bounds.min.y=O.min.y,_.bounds.max.y=O.min.y+W*$,b&&(_.bounds.min.x+=U*.5-U*X*.5,_.bounds.max.x+=U*.5-U*X*.5,_.bounds.min.y+=W*.5-W*$*.5,_.bounds.max.y+=W*.5-W*$*.5),_.bounds.min.x-=A.x,_.bounds.max.x-=A.x,_.bounds.min.y-=A.y,_.bounds.max.y-=A.y,_.mouse&&(h.setScale(_.mouse,{x:(_.bounds.max.x-_.bounds.min.x)/_.canvas.width,y:(_.bounds.max.y-_.bounds.min.y)/_.canvas.height}),h.setOffset(_.mouse,_.bounds.min))},e.startViewTransform=function(_){var w=_.bounds.max.x-_.bounds.min.x,A=_.bounds.max.y-_.bounds.min.y,b=w/_.options.width,O=A/_.options.height;_.context.setTransform(_.options.pixelRatio/b,0,0,_.options.pixelRatio/O,0,0),_.context.translate(-_.bounds.min.x,-_.bounds.min.y)},e.endViewTransform=function(_){_.context.setTransform(_.options.pixelRatio,0,0,_.options.pixelRatio,0,0)},e.world=function(_,w){var A=i.now(),b=_.engine,O=b.world,C=_.canvas,M=_.context,R=_.options,L=_.timing,U=u.allBodies(O),W=u.allConstraints(O),z=R.wireframes?R.wireframeBackground:R.background,q=[],Y=[],K,X={timestamp:b.timing.timestamp};if(l.trigger(_,"beforeRender",X),_.currentBackground!==z&&B(_,z),M.globalCompositeOperation="source-in",M.fillStyle="transparent",M.fillRect(0,0,C.width,C.height),M.globalCompositeOperation="source-over",R.hasBounds){for(K=0;K<U.length;K++){var $=U[K];c.overlaps($.bounds,_.bounds)&&q.push($)}for(K=0;K<W.length;K++){var Q=W[K],ee=Q.bodyA,fe=Q.bodyB,ie=Q.pointA,H=Q.pointB;ee&&(ie=d.add(ee.position,Q.pointA)),fe&&(H=d.add(fe.position,Q.pointB)),!(!ie||!H)&&(c.contains(_.bounds,ie)||c.contains(_.bounds,H))&&Y.push(Q)}e.startViewTransform(_),_.mouse&&(h.setScale(_.mouse,{x:(_.bounds.max.x-_.bounds.min.x)/_.options.width,y:(_.bounds.max.y-_.bounds.min.y)/_.options.height}),h.setOffset(_.mouse,_.bounds.min))}else Y=W,q=U,_.options.pixelRatio!==1&&_.context.setTransform(_.options.pixelRatio,0,0,_.options.pixelRatio,0,0);!R.wireframes||b.enableSleeping&&R.showSleeping?e.bodies(_,q,M):(R.showConvexHulls&&e.bodyConvexHulls(_,q,M),e.bodyWireframes(_,q,M)),R.showBounds&&e.bodyBounds(_,q,M),(R.showAxes||R.showAngleIndicator)&&e.bodyAxes(_,q,M),R.showPositions&&e.bodyPositions(_,q,M),R.showVelocity&&e.bodyVelocity(_,q,M),R.showIds&&e.bodyIds(_,q,M),R.showSeparations&&e.separations(_,b.pairs.list,M),R.showCollisions&&e.collisions(_,b.pairs.list,M),R.showVertexNumbers&&e.vertexNumbers(_,q,M),R.showMousePosition&&e.mousePosition(_,_.mouse,M),e.constraints(Y,M),R.hasBounds&&e.endViewTransform(_),l.trigger(_,"afterRender",X),L.lastElapsed=i.now()-A},e.stats=function(_,w,A){for(var b=_.engine,O=b.world,C=u.allBodies(O),M=0,R=55,L=44,U=0,W=0,z=0;z<C.length;z+=1)M+=C[z].parts.length;var q={Part:M,Body:C.length,Cons:u.allConstraints(O).length,Comp:u.allComposites(O).length,Pair:b.pairs.list.length};w.fillStyle="#0e0f19",w.fillRect(U,W,R*5.5,L),w.font="12px Arial",w.textBaseline="top",w.textAlign="right";for(var Y in q){var K=q[Y];w.fillStyle="#aaa",w.fillText(Y,U+R,W+8),w.fillStyle="#eee",w.fillText(K,U+R,W+26),U+=R}},e.performance=function(_,w){var A=_.engine,b=_.timing,O=b.deltaHistory,C=b.elapsedHistory,M=b.timestampElapsedHistory,R=b.engineDeltaHistory,L=b.engineUpdatesHistory,U=b.engineElapsedHistory,W=A.timing.lastUpdatesPerFrame,z=A.timing.lastDelta,q=x(O),Y=x(C),K=x(R),X=x(L),$=x(U),Q=x(M),ee=Q/q||0,fe=Math.round(q/z),ie=1e3/q||0,H=4,oe=12,J=60,ve=34,se=10,ae=69;w.fillStyle="#0e0f19",w.fillRect(0,50,oe*5+J*6+22,ve),e.status(w,se,ae,J,H,O.length,Math.round(ie)+" fps",ie/e._goodFps,function(ne){return O[ne]/q-1}),e.status(w,se+oe+J,ae,J,H,R.length,z.toFixed(2)+" dt",e._goodDelta/z,function(ne){return R[ne]/K-1}),e.status(w,se+(oe+J)*2,ae,J,H,L.length,W+" upf",Math.pow(i.clamp(X/fe||1,0,1),4),function(ne){return L[ne]/X-1}),e.status(w,se+(oe+J)*3,ae,J,H,U.length,$.toFixed(2)+" ut",1-W*$/e._goodFps,function(ne){return U[ne]/$-1}),e.status(w,se+(oe+J)*4,ae,J,H,C.length,Y.toFixed(2)+" rt",1-Y/e._goodFps,function(ne){return C[ne]/Y-1}),e.status(w,se+(oe+J)*5,ae,J,H,M.length,ee.toFixed(2)+" x",ee*ee*ee,function(ne){return(M[ne]/O[ne]/ee||0)-1})},e.status=function(_,w,A,b,O,C,M,R,L){_.strokeStyle="#888",_.fillStyle="#444",_.lineWidth=1,_.fillRect(w,A+7,b,1),_.beginPath(),_.moveTo(w,A+7-O*i.clamp(.4*L(0),-2,2));for(var U=0;U<b;U+=1)_.lineTo(w+U,A+7-(U<C?O*i.clamp(.4*L(U),-2,2):0));_.stroke(),_.fillStyle="hsl("+i.clamp(25+95*R,0,120)+",100%,60%)",_.fillRect(w,A-7,4,4),_.font="12px Arial",_.textBaseline="middle",_.textAlign="right",_.fillStyle="#eee",_.fillText(M,w+b,A-5)},e.constraints=function(_,w){for(var A=w,b=0;b<_.length;b++){var O=_[b];if(!(!O.render.visible||!O.pointA||!O.pointB)){var C=O.bodyA,M=O.bodyB,R,L;if(C?R=d.add(C.position,O.pointA):R=O.pointA,O.render.type==="pin")A.beginPath(),A.arc(R.x,R.y,3,0,2*Math.PI),A.closePath();else{if(M?L=d.add(M.position,O.pointB):L=O.pointB,A.beginPath(),A.moveTo(R.x,R.y),O.render.type==="spring")for(var U=d.sub(L,R),W=d.perp(d.normalise(U)),z=Math.ceil(i.clamp(O.length/5,12,20)),q,Y=1;Y<z;Y+=1)q=Y%2===0?1:-1,A.lineTo(R.x+U.x*(Y/z)+W.x*q*4,R.y+U.y*(Y/z)+W.y*q*4);A.lineTo(L.x,L.y)}O.render.lineWidth&&(A.lineWidth=O.render.lineWidth,A.strokeStyle=O.render.strokeStyle,A.stroke()),O.render.anchors&&(A.fillStyle=O.render.strokeStyle,A.beginPath(),A.arc(R.x,R.y,3,0,2*Math.PI),A.arc(L.x,L.y,3,0,2*Math.PI),A.closePath(),A.fill())}}},e.bodies=function(_,w,A){var b=A;_.engine;var O=_.options,C=O.showInternalEdges||!O.wireframes,M,R,L,U;for(L=0;L<w.length;L++)if(M=w[L],!!M.render.visible){for(U=M.parts.length>1?1:0;U<M.parts.length;U++)if(R=M.parts[U],!!R.render.visible){if(O.showSleeping&&M.isSleeping?b.globalAlpha=.5*R.render.opacity:R.render.opacity!==1&&(b.globalAlpha=R.render.opacity),R.render.sprite&&R.render.sprite.texture&&!O.wireframes){var W=R.render.sprite,z=E(_,W.texture);b.translate(R.position.x,R.position.y),b.rotate(R.angle),b.drawImage(z,z.width*-W.xOffset*W.xScale,z.height*-W.yOffset*W.yScale,z.width*W.xScale,z.height*W.yScale),b.rotate(-R.angle),b.translate(-R.position.x,-R.position.y)}else{if(R.circleRadius)b.beginPath(),b.arc(R.position.x,R.position.y,R.circleRadius,0,2*Math.PI);else{b.beginPath(),b.moveTo(R.vertices[0].x,R.vertices[0].y);for(var q=1;q<R.vertices.length;q++)!R.vertices[q-1].isInternal||C?b.lineTo(R.vertices[q].x,R.vertices[q].y):b.moveTo(R.vertices[q].x,R.vertices[q].y),R.vertices[q].isInternal&&!C&&b.moveTo(R.vertices[(q+1)%R.vertices.length].x,R.vertices[(q+1)%R.vertices.length].y);b.lineTo(R.vertices[0].x,R.vertices[0].y),b.closePath()}O.wireframes?(b.lineWidth=1,b.strokeStyle=_.options.wireframeStrokeStyle,b.stroke()):(b.fillStyle=R.render.fillStyle,R.render.lineWidth&&(b.lineWidth=R.render.lineWidth,b.strokeStyle=R.render.strokeStyle,b.stroke()),b.fill())}b.globalAlpha=1}}},e.bodyWireframes=function(_,w,A){var b=A,O=_.options.showInternalEdges,C,M,R,L,U;for(b.beginPath(),R=0;R<w.length;R++)if(C=w[R],!!C.render.visible)for(U=C.parts.length>1?1:0;U<C.parts.length;U++){for(M=C.parts[U],b.moveTo(M.vertices[0].x,M.vertices[0].y),L=1;L<M.vertices.length;L++)!M.vertices[L-1].isInternal||O?b.lineTo(M.vertices[L].x,M.vertices[L].y):b.moveTo(M.vertices[L].x,M.vertices[L].y),M.vertices[L].isInternal&&!O&&b.moveTo(M.vertices[(L+1)%M.vertices.length].x,M.vertices[(L+1)%M.vertices.length].y);b.lineTo(M.vertices[0].x,M.vertices[0].y)}b.lineWidth=1,b.strokeStyle=_.options.wireframeStrokeStyle,b.stroke()},e.bodyConvexHulls=function(_,w,A){var b=A,O,C,M;for(b.beginPath(),C=0;C<w.length;C++)if(O=w[C],!(!O.render.visible||O.parts.length===1)){for(b.moveTo(O.vertices[0].x,O.vertices[0].y),M=1;M<O.vertices.length;M++)b.lineTo(O.vertices[M].x,O.vertices[M].y);b.lineTo(O.vertices[0].x,O.vertices[0].y)}b.lineWidth=1,b.strokeStyle="rgba(255,255,255,0.2)",b.stroke()},e.vertexNumbers=function(_,w,A){var b=A,O,C,M;for(O=0;O<w.length;O++){var R=w[O].parts;for(M=R.length>1?1:0;M<R.length;M++){var L=R[M];for(C=0;C<L.vertices.length;C++)b.fillStyle="rgba(255,255,255,0.2)",b.fillText(O+"_"+C,L.position.x+(L.vertices[C].x-L.position.x)*.8,L.position.y+(L.vertices[C].y-L.position.y)*.8)}}},e.mousePosition=function(_,w,A){var b=A;b.fillStyle="rgba(255,255,255,0.8)",b.fillText(w.position.x+"  "+w.position.y,w.position.x+5,w.position.y-5)},e.bodyBounds=function(_,w,A){var b=A;_.engine;var O=_.options;b.beginPath();for(var C=0;C<w.length;C++){var M=w[C];if(M.render.visible)for(var R=w[C].parts,L=R.length>1?1:0;L<R.length;L++){var U=R[L];b.rect(U.bounds.min.x,U.bounds.min.y,U.bounds.max.x-U.bounds.min.x,U.bounds.max.y-U.bounds.min.y)}}O.wireframes?b.strokeStyle="rgba(255,255,255,0.08)":b.strokeStyle="rgba(0,0,0,0.1)",b.lineWidth=1,b.stroke()},e.bodyAxes=function(_,w,A){var b=A;_.engine;var O=_.options,C,M,R,L;for(b.beginPath(),M=0;M<w.length;M++){var U=w[M],W=U.parts;if(U.render.visible)if(O.showAxes)for(R=W.length>1?1:0;R<W.length;R++)for(C=W[R],L=0;L<C.axes.length;L++){var z=C.axes[L];b.moveTo(C.position.x,C.position.y),b.lineTo(C.position.x+z.x*20,C.position.y+z.y*20)}else for(R=W.length>1?1:0;R<W.length;R++)for(C=W[R],L=0;L<C.axes.length;L++)b.moveTo(C.position.x,C.position.y),b.lineTo((C.vertices[0].x+C.vertices[C.vertices.length-1].x)/2,(C.vertices[0].y+C.vertices[C.vertices.length-1].y)/2)}O.wireframes?(b.strokeStyle="indianred",b.lineWidth=1):(b.strokeStyle="rgba(255, 255, 255, 0.4)",b.globalCompositeOperation="overlay",b.lineWidth=2),b.stroke(),b.globalCompositeOperation="source-over"},e.bodyPositions=function(_,w,A){var b=A;_.engine;var O=_.options,C,M,R,L;for(b.beginPath(),R=0;R<w.length;R++)if(C=w[R],!!C.render.visible)for(L=0;L<C.parts.length;L++)M=C.parts[L],b.arc(M.position.x,M.position.y,3,0,2*Math.PI,!1),b.closePath();for(O.wireframes?b.fillStyle="indianred":b.fillStyle="rgba(0,0,0,0.5)",b.fill(),b.beginPath(),R=0;R<w.length;R++)C=w[R],C.render.visible&&(b.arc(C.positionPrev.x,C.positionPrev.y,2,0,2*Math.PI,!1),b.closePath());b.fillStyle="rgba(255,165,0,0.8)",b.fill()},e.bodyVelocity=function(_,w,A){var b=A;b.beginPath();for(var O=0;O<w.length;O++){var C=w[O];if(C.render.visible){var M=n.getVelocity(C);b.moveTo(C.position.x,C.position.y),b.lineTo(C.position.x+M.x,C.position.y+M.y)}}b.lineWidth=3,b.strokeStyle="cornflowerblue",b.stroke()},e.bodyIds=function(_,w,A){var b=A,O,C;for(O=0;O<w.length;O++)if(w[O].render.visible){var M=w[O].parts;for(C=M.length>1?1:0;C<M.length;C++){var R=M[C];b.font="12px Arial",b.fillStyle="rgba(255,255,255,0.5)",b.fillText(R.id,R.position.x+10,R.position.y-10)}}},e.collisions=function(_,w,A){var b=A,O=_.options,C,M,R,L;for(b.beginPath(),R=0;R<w.length;R++)if(C=w[R],!!C.isActive)for(M=C.collision,L=0;L<C.contactCount;L++){var U=C.contacts[L],W=U.vertex;b.rect(W.x-1.5,W.y-1.5,3.5,3.5)}for(O.wireframes?b.fillStyle="rgba(255,255,255,0.7)":b.fillStyle="orange",b.fill(),b.beginPath(),R=0;R<w.length;R++)if(C=w[R],!!C.isActive&&(M=C.collision,C.contactCount>0)){var z=C.contacts[0].vertex.x,q=C.contacts[0].vertex.y;C.contactCount===2&&(z=(C.contacts[0].vertex.x+C.contacts[1].vertex.x)/2,q=(C.contacts[0].vertex.y+C.contacts[1].vertex.y)/2),M.bodyB===M.supports[0].body||M.bodyA.isStatic===!0?b.moveTo(z-M.normal.x*8,q-M.normal.y*8):b.moveTo(z+M.normal.x*8,q+M.normal.y*8),b.lineTo(z,q)}O.wireframes?b.strokeStyle="rgba(255,165,0,0.7)":b.strokeStyle="orange",b.lineWidth=1,b.stroke()},e.separations=function(_,w,A){var b=A,O=_.options,C,M,R,L,U;for(b.beginPath(),U=0;U<w.length;U++)if(C=w[U],!!C.isActive){M=C.collision,R=M.bodyA,L=M.bodyB;var W=1;!L.isStatic&&!R.isStatic&&(W=.5),L.isStatic&&(W=0),b.moveTo(L.position.x,L.position.y),b.lineTo(L.position.x-M.penetration.x*W,L.position.y-M.penetration.y*W),W=1,!L.isStatic&&!R.isStatic&&(W=.5),R.isStatic&&(W=0),b.moveTo(R.position.x,R.position.y),b.lineTo(R.position.x+M.penetration.x*W,R.position.y+M.penetration.y*W)}O.wireframes?b.strokeStyle="rgba(255,165,0,0.5)":b.strokeStyle="orange",b.stroke()},e.inspector=function(_,w){_.engine;var A=_.selected,b=_.render,O=b.options,C;if(O.hasBounds){var M=b.bounds.max.x-b.bounds.min.x,R=b.bounds.max.y-b.bounds.min.y,L=M/b.options.width,U=R/b.options.height;w.scale(1/L,1/U),w.translate(-b.bounds.min.x,-b.bounds.min.y)}for(var W=0;W<A.length;W++){var z=A[W].data;switch(w.translate(.5,.5),w.lineWidth=1,w.strokeStyle="rgba(255,165,0,0.9)",w.setLineDash([1,2]),z.type){case"body":C=z.bounds,w.beginPath(),w.rect(Math.floor(C.min.x-3),Math.floor(C.min.y-3),Math.floor(C.max.x-C.min.x+6),Math.floor(C.max.y-C.min.y+6)),w.closePath(),w.stroke();break;case"constraint":var q=z.pointA;z.bodyA&&(q=z.pointB),w.beginPath(),w.arc(q.x,q.y,10,0,2*Math.PI),w.closePath(),w.stroke();break}w.setLineDash([]),w.translate(-.5,-.5)}_.selectStart!==null&&(w.translate(.5,.5),w.lineWidth=1,w.strokeStyle="rgba(255,165,0,0.6)",w.fillStyle="rgba(255,165,0,0.1)",C=_.selectBounds,w.beginPath(),w.rect(Math.floor(C.min.x),Math.floor(C.min.y),Math.floor(C.max.x-C.min.x),Math.floor(C.max.y-C.min.y)),w.closePath(),w.stroke(),w.fill(),w.translate(-.5,-.5)),O.hasBounds&&w.setTransform(1,0,0,1,0,0)};var m=function(_,w){var A=_.engine,b=_.timing,O=b.historySize,C=A.timing.timestamp;b.delta=w-b.lastTime||e._goodDelta,b.lastTime=w,b.timestampElapsed=C-b.lastTimestamp||0,b.lastTimestamp=C,b.deltaHistory.unshift(b.delta),b.deltaHistory.length=Math.min(b.deltaHistory.length,O),b.engineDeltaHistory.unshift(A.timing.lastDelta),b.engineDeltaHistory.length=Math.min(b.engineDeltaHistory.length,O),b.timestampElapsedHistory.unshift(b.timestampElapsed),b.timestampElapsedHistory.length=Math.min(b.timestampElapsedHistory.length,O),b.engineUpdatesHistory.unshift(A.timing.lastUpdatesPerFrame),b.engineUpdatesHistory.length=Math.min(b.engineUpdatesHistory.length,O),b.engineElapsedHistory.unshift(A.timing.lastElapsed),b.engineElapsedHistory.length=Math.min(b.engineElapsedHistory.length,O),b.elapsedHistory.unshift(b.lastElapsed),b.elapsedHistory.length=Math.min(b.elapsedHistory.length,O)},x=function(_){for(var w=0,A=0;A<_.length;A+=1)w+=_[A];return w/_.length||0},T=function(_,w){var A=document.createElement("canvas");return A.width=_,A.height=w,A.oncontextmenu=function(){return!1},A.onselectstart=function(){return!1},A},P=function(_){var w=_.getContext("2d"),A=window.devicePixelRatio||1,b=w.webkitBackingStorePixelRatio||w.mozBackingStorePixelRatio||w.msBackingStorePixelRatio||w.oBackingStorePixelRatio||w.backingStorePixelRatio||1;return A/b},E=function(_,w){var A=_.textures[w];return A||(A=_.textures[w]=new Image,A.src=w,A)},B=function(_,w){var A=w;/(jpg|gif|png)$/.test(w)&&(A="url("+w+")"),_.canvas.style.background=A,_.canvas.style.backgroundSize="contain",_.currentBackground=w}})()},function(S,D,v){var e={};S.exports=e;var n=v(5),i=v(17),u=v(0);(function(){e._maxFrameDelta=1e3/15,e._frameDeltaFallback=1e3/60,e._timeBufferMargin=1.5,e._elapsedNextEstimate=1,e._smoothingLowerBound=.1,e._smoothingUpperBound=.9,e.create=function(l){var d={delta:16.666666666666668,frameDelta:null,frameDeltaSmoothing:!0,frameDeltaSnapping:!0,frameDeltaHistory:[],frameDeltaHistorySize:100,frameRequestId:null,timeBuffer:0,timeLastTick:null,maxUpdates:null,maxFrameTime:33.333333333333336,lastUpdatesDeferred:0,enabled:!0},h=u.extend(d,l);return h.fps=0,h},e.run=function(l,d){return l.timeBuffer=e._frameDeltaFallback,function h(a){l.frameRequestId=e._onNextFrame(l,h),a&&l.enabled&&e.tick(l,d,a)}(),l},e.tick=function(l,d,h){var a=u.now(),y=l.delta,m=0,x=h-l.timeLastTick;if((!x||!l.timeLastTick||x>Math.max(e._maxFrameDelta,l.maxFrameTime))&&(x=l.frameDelta||e._frameDeltaFallback),l.frameDeltaSmoothing){l.frameDeltaHistory.push(x),l.frameDeltaHistory=l.frameDeltaHistory.slice(-l.frameDeltaHistorySize);var T=l.frameDeltaHistory.slice(0).sort(),P=l.frameDeltaHistory.slice(T.length*e._smoothingLowerBound,T.length*e._smoothingUpperBound),E=c(P);x=E||x}l.frameDeltaSnapping&&(x=1e3/Math.round(1e3/x)),l.frameDelta=x,l.timeLastTick=h,l.timeBuffer+=l.frameDelta,l.timeBuffer=u.clamp(l.timeBuffer,0,l.frameDelta+y*e._timeBufferMargin),l.lastUpdatesDeferred=0;var B=l.maxUpdates||Math.ceil(l.maxFrameTime/y),_={timestamp:d.timing.timestamp};n.trigger(l,"beforeTick",_),n.trigger(l,"tick",_);for(var w=u.now();y>0&&l.timeBuffer>=y*e._timeBufferMargin;){n.trigger(l,"beforeUpdate",_),i.update(d,y),n.trigger(l,"afterUpdate",_),l.timeBuffer-=y,m+=1;var A=u.now()-a,b=u.now()-w,O=A+e._elapsedNextEstimate*b/m;if(m>=B||O>l.maxFrameTime){l.lastUpdatesDeferred=Math.round(Math.max(0,l.timeBuffer/y-e._timeBufferMargin));break}}d.timing.lastUpdatesPerFrame=m,n.trigger(l,"afterTick",_),l.frameDeltaHistory.length>=100&&(l.lastUpdatesDeferred&&Math.round(l.frameDelta/y)>B?u.warnOnce("Matter.Runner: runner reached runner.maxUpdates, see docs."):l.lastUpdatesDeferred&&u.warnOnce("Matter.Runner: runner reached runner.maxFrameTime, see docs."),typeof l.isFixed<"u"&&u.warnOnce("Matter.Runner: runner.isFixed is now redundant, see docs."),(l.deltaMin||l.deltaMax)&&u.warnOnce("Matter.Runner: runner.deltaMin and runner.deltaMax were removed, see docs."),l.fps!==0&&u.warnOnce("Matter.Runner: runner.fps was replaced by runner.delta, see docs."))},e.stop=function(l){e._cancelNextFrame(l)},e._onNextFrame=function(l,d){if(typeof window<"u"&&window.requestAnimationFrame)l.frameRequestId=window.requestAnimationFrame(d);else throw new Error("Matter.Runner: missing required global window.requestAnimationFrame.");return l.frameRequestId},e._cancelNextFrame=function(l){if(typeof window<"u"&&window.cancelAnimationFrame)window.cancelAnimationFrame(l.frameRequestId);else throw new Error("Matter.Runner: missing required global window.cancelAnimationFrame.")};var c=function(l){for(var d=0,h=l.length,a=0;a<h;a+=1)d+=l[a];return d/h||0}})()},function(S,D,v){var e={};S.exports=e;var n=v(8),i=v(0),u=i.deprecated;(function(){e.collides=function(c,l){return n.collides(c,l)},u(e,"collides","SAT.collides âž¤ replaced by Collision.collides")})()},function(S,D,v){var e={};S.exports=e,v(1);var n=v(0);(function(){e.pathToVertices=function(i,u){typeof window<"u"&&!("SVGPathSeg"in window)&&n.warn("Svg.pathToVertices: SVGPathSeg not defined, a polyfill is required.");var c,l,d,h,a,y,m,x,T,P,E=[],B,_,w=0,A=0,b=0;u=u||15;var O=function(M,R,L){var U=L%2===1&&L>1;if(!T||M!=T.x||R!=T.y){T&&U?(B=T.x,_=T.y):(B=0,_=0);var W={x:B+M,y:_+R};(U||!T)&&(T=W),E.push(W),A=B+M,b=_+R}},C=function(M){var R=M.pathSegTypeAsLetter.toUpperCase();if(R!=="Z"){switch(R){case"M":case"L":case"T":case"C":case"S":case"Q":A=M.x,b=M.y;break;case"H":A=M.x;break;case"V":b=M.y;break}O(A,b,M.pathSegType)}};for(e._svgPathToAbsolute(i),d=i.getTotalLength(),y=[],c=0;c<i.pathSegList.numberOfItems;c+=1)y.push(i.pathSegList.getItem(c));for(m=y.concat();w<d;){if(P=i.getPathSegAtLength(w),a=y[P],a!=x){for(;m.length&&m[0]!=a;)C(m.shift());x=a}switch(a.pathSegTypeAsLetter.toUpperCase()){case"C":case"T":case"S":case"Q":case"A":h=i.getPointAtLength(w),O(h.x,h.y,0);break}w+=u}for(c=0,l=m.length;c<l;++c)C(m[c]);return E},e._svgPathToAbsolute=function(i){for(var u,c,l,d,h,a,y=i.pathSegList,m=0,x=0,T=y.numberOfItems,P=0;P<T;++P){var E=y.getItem(P),B=E.pathSegTypeAsLetter;if(/[MLHVCSQTA]/.test(B))"x"in E&&(m=E.x),"y"in E&&(x=E.y);else switch("x1"in E&&(l=m+E.x1),"x2"in E&&(h=m+E.x2),"y1"in E&&(d=x+E.y1),"y2"in E&&(a=x+E.y2),"x"in E&&(m+=E.x),"y"in E&&(x+=E.y),B){case"m":y.replaceItem(i.createSVGPathSegMovetoAbs(m,x),P);break;case"l":y.replaceItem(i.createSVGPathSegLinetoAbs(m,x),P);break;case"h":y.replaceItem(i.createSVGPathSegLinetoHorizontalAbs(m),P);break;case"v":y.replaceItem(i.createSVGPathSegLinetoVerticalAbs(x),P);break;case"c":y.replaceItem(i.createSVGPathSegCurvetoCubicAbs(m,x,l,d,h,a),P);break;case"s":y.replaceItem(i.createSVGPathSegCurvetoCubicSmoothAbs(m,x,h,a),P);break;case"q":y.replaceItem(i.createSVGPathSegCurvetoQuadraticAbs(m,x,l,d),P);break;case"t":y.replaceItem(i.createSVGPathSegCurvetoQuadraticSmoothAbs(m,x),P);break;case"a":y.replaceItem(i.createSVGPathSegArcAbs(m,x,E.r1,E.r2,E.angle,E.largeArcFlag,E.sweepFlag),P);break;case"z":case"Z":m=u,x=c;break}(B=="M"||B=="m")&&(u=m,c=x)}}})()},function(S,D,v){var e={};S.exports=e;var n=v(6);v(0),function(){e.create=n.create,e.add=n.add,e.remove=n.remove,e.clear=n.clear,e.addComposite=n.addComposite,e.addBody=n.addBody,e.addConstraint=n.addConstraint}()}])})})(vn);var ge=vn.exports;const Ht=wo(ge),yn=1920,Yt=1080,bo=30,Po=`å¾Œã¯é‡Žã¨ãªã‚Œå±±ã¨ãªã‚Œã¨ã€
ä½•ã‚‚æˆã—é‚ã’ã‚‰ã‚Œãšå±…ã‚‹ã€
å¶åƒå´‡æ‹å¦„ä¿¡è€…ãŒã€
æºœé£²ã‚’ä¸‹ã’ã‚‹ã€‚
å››è¾ºå½¢ã«åŽå®¹ã•ã‚ŒãŸã€
è·¯å‚ã®äººã®æ…°ã¿ãŒã€
æ¤ãˆã¤ã‘ã‚‹æ§˜ã«ã“ã¡ã‚‰ã‚’å‘ã„ã¦ã€
å’Žã‚ã‚‹ã®ã§ã—ã‚‡ã†ã€‚

ç ‚ã‚’å™›ã¿ã€
é¤éª¨ã‚’é½§ã‚Šã€
ãƒŠãƒ¡ã‚¯ã‚¸ãŒæº¶ã‘ã¦ã¾ã—ãŸã€‚

ãã‚Œã¯ä¸‡æœ‰å¼•åŠ›ã®ã€
æ§˜ãªãƒ¢ãƒŽã§ã‚ã‚Šã€
æŠ—ãˆã°æŠ—ã†ç¨‹ã€
é’ãç‡ƒãˆä¸ŠãŒã‚‹ã®ã§ã™ã€‚
ãã‚Œã¯ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªä¿¡å·ãŒã€
æŒ‡ã—ç¤ºã™é€šã‚Šã€
ã‚‚ãŒãè…•ã‚„è¶³ã¯ã‚‚ã†ã€
æ„å‘³ã‚’ãªã•ãªã„ã®ã§ã™ã€‚

é€™ã„ãšã‚Šæ–¹ãŒã€
æ€ã„å‡ºã›ãªããªã‚Šã¾ã—ãŸã€`,gn="å…¨ã¦matter.jsã®æ‰€ç‚ºã§ã™ã€‚",gt=80,xn=188,Ao=210;let yt;const Co=()=>{yt=p.loadFont("GenZenGothic.ttf")};(function(){(function(F){var V={};function S(D){if(V[D])return V[D].exports;var v=V[D]={i:D,l:!1,exports:{}};return F[D].call(v.exports,v,v.exports,S),v.l=!0,v.exports}return S.m=F,S.c=V,S.d=function(D,v,e){S.o(D,v)||Object.defineProperty(D,v,{enumerable:!0,get:e})},S.r=function(D){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(D,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(D,"__esModule",{value:!0})},S.t=function(D,v){if(v&1&&(D=S(D)),v&8||v&4&&typeof D=="object"&&D&&D.__esModule)return D;var e=Object.create(null);if(S.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:D}),v&2&&typeof D!="string")for(var n in D)S.d(e,n,(function(i){return D[i]}).bind(null,n));return e},S.n=function(D){var v=D&&D.__esModule?function(){return D.default}:function(){return D};return S.d(v,"a",v),v},S.o=function(D,v){return Object.prototype.hasOwnProperty.call(D,v)},S.p="",S(S.s=40)})([function(F,V,S){var D;D=(function(){function v(n,i){this.isUndef(n)||n===1?this.input=this.context.createGain():1<n&&(this.input=new Array(n)),this.isUndef(i)||i===1?this.output=this.context.createGain():1<i&&(this.output=new Array(n))}var e;return v.prototype.set=function(n,i,u){if(this.isObject(n))u=i;else if(this.isString(n)){var c={};c[n]=i,n=c}e:for(var l in n){i=n[l];var d=this;if(l.indexOf(".")!==-1){for(var h=l.split("."),a=0;a<h.length-1;a++)if((d=d[h[a]])instanceof v){h.splice(0,a+1);var y=h.join(".");d.set(y,i);continue e}l=h[h.length-1]}var m=d[l];this.isUndef(m)||(v.Signal&&m instanceof v.Signal||v.Param&&m instanceof v.Param?m.value!==i&&(this.isUndef(u)?m.value=i:m.rampTo(i,u)):m instanceof AudioParam?m.value!==i&&(m.value=i):m instanceof v?m.set(i):m!==i&&(d[l]=i))}return this},v.prototype.get=function(n){this.isUndef(n)?n=this._collectDefaults(this.constructor):this.isString(n)&&(n=[n]);for(var i={},u=0;u<n.length;u++){var c=n[u],l=this,d=i;if(c.indexOf(".")!==-1){for(var h=c.split("."),a=0;a<h.length-1;a++){var y=h[a];d[y]=d[y]||{},d=d[y],l=l[y]}c=h[h.length-1]}var m=l[c];this.isObject(n[c])?d[c]=m.get():v.Signal&&m instanceof v.Signal||v.Param&&m instanceof v.Param||m instanceof AudioParam?d[c]=m.value:m instanceof v?d[c]=m.get():this.isFunction(m)||this.isUndef(m)||(d[c]=m)}return i},v.prototype._collectDefaults=function(n){var i=[];if(this.isUndef(n.defaults)||(i=Object.keys(n.defaults)),!this.isUndef(n._super))for(var u=this._collectDefaults(n._super),c=0;c<u.length;c++)i.indexOf(u[c])===-1&&i.push(u[c]);return i},v.prototype.toString=function(){for(var n in v){var i=n[0].match(/^[A-Z]$/),u=v[n]===this.constructor;if(this.isFunction(v[n])&&i&&u)return n}return"Tone"},Object.defineProperty(v.prototype,"numberOfInputs",{get:function(){return this.input?this.isArray(this.input)?this.input.length:1:0}}),Object.defineProperty(v.prototype,"numberOfOutputs",{get:function(){return this.output?this.isArray(this.output)?this.output.length:1:0}}),v.prototype.dispose=function(){return this.isUndef(this.input)||(this.input instanceof AudioNode&&this.input.disconnect(),this.input=null),this.isUndef(this.output)||(this.output instanceof AudioNode&&this.output.disconnect(),this.output=null),this},v.prototype.connect=function(n,i,u){return Array.isArray(this.output)?(i=this.defaultArg(i,0),this.output[i].connect(n,0,u)):this.output.connect(n,i,u),this},v.prototype.disconnect=function(n,i,u){this.isArray(this.output)?this.isNumber(n)?this.output[n].disconnect():(i=this.defaultArg(i,0),this.output[i].disconnect(n,0,u)):this.output.disconnect.apply(this.output,arguments)},v.prototype.connectSeries=function(){if(1<arguments.length)for(var n=arguments[0],i=1;i<arguments.length;i++){var u=arguments[i];n.connect(u),n=u}return this},v.prototype.chain=function(){if(0<arguments.length)for(var n=this,i=0;i<arguments.length;i++){var u=arguments[i];n.connect(u),n=u}return this},v.prototype.fan=function(){if(0<arguments.length)for(var n=0;n<arguments.length;n++)this.connect(arguments[n]);return this},AudioNode.prototype.chain=v.prototype.chain,AudioNode.prototype.fan=v.prototype.fan,v.prototype.defaultArg=function(n,i){if(this.isObject(n)&&this.isObject(i)){var u={};for(var c in n)u[c]=this.defaultArg(i[c],n[c]);for(var l in i)u[l]=this.defaultArg(n[l],i[l]);return u}return this.isUndef(n)?i:n},v.prototype.optionsObject=function(n,i,u){var c={};if(n.length===1&&this.isObject(n[0]))c=n[0];else for(var l=0;l<i.length;l++)c[i[l]]=n[l];return this.isUndef(u)?c:this.defaultArg(c,u)},v.prototype.isUndef=function(n){return n===void 0},v.prototype.isFunction=function(n){return typeof n=="function"},v.prototype.isNumber=function(n){return typeof n=="number"},v.prototype.isObject=function(n){return Object.prototype.toString.call(n)==="[object Object]"&&n.constructor===Object},v.prototype.isBoolean=function(n){return typeof n=="boolean"},v.prototype.isArray=function(n){return Array.isArray(n)},v.prototype.isString=function(n){return typeof n=="string"},v.noOp=function(){},v.prototype._readOnly=function(n){if(Array.isArray(n))for(var i=0;i<n.length;i++)this._readOnly(n[i]);else Object.defineProperty(this,n,{writable:!1,enumerable:!0})},v.prototype._writable=function(n){if(Array.isArray(n))for(var i=0;i<n.length;i++)this._writable(n[i]);else Object.defineProperty(this,n,{writable:!0})},v.State={Started:"started",Stopped:"stopped",Paused:"paused"},v.prototype.equalPowerScale=function(n){var i=.5*Math.PI;return Math.sin(n*i)},v.prototype.dbToGain=function(n){return Math.pow(2,n/6)},v.prototype.gainToDb=function(n){return Math.log(n)/Math.LN10*20},v.prototype.intervalToFrequencyRatio=function(n){return Math.pow(2,n/12)},v.prototype.now=function(){return v.context.now()},v.now=function(){return v.context.now()},v.extend=function(n,i){function u(){}v.prototype.isUndef(i)&&(i=v),u.prototype=i.prototype,n.prototype=new u,(n.prototype.constructor=n)._super=i},Object.defineProperty(v,"context",{get:function(){return e},set:function(n){e=v.Context&&n instanceof v.Context?n:new v.Context(n),v.Context&&v.Context.emit("init",e)}}),Object.defineProperty(v.prototype,"context",{get:function(){return v.context}}),v.setContext=function(n){v.context=n},Object.defineProperty(v.prototype,"blockTime",{get:function(){return 128/this.context.sampleRate}}),Object.defineProperty(v.prototype,"sampleTime",{get:function(){return 1/this.context.sampleRate}}),Object.defineProperty(v,"supported",{get:function(){var n=window.hasOwnProperty("AudioContext")||window.hasOwnProperty("webkitAudioContext"),i=window.hasOwnProperty("Promise"),u=window.hasOwnProperty("Worker");return n&&i&&u}}),v.version="r10",window.TONE_SILENCE_VERSION_LOGGING||console.log("%c * Tone.js "+v.version+" * ","background: #000; color: #fff"),v}).call(V,S,V,F),D!==void 0&&(F.exports=D)},function(F,V,S){var D,v;D=[S(0),S(2),S(10)],v=(function(e){return e.Multiply=function(n){this.createInsOuts(2,0),this._mult=this.input[0]=this.output=new e.Gain,this._param=this.input[1]=this.output.gain,this._param.value=this.defaultArg(n,0)},e.extend(e.Multiply,e.Signal),e.Multiply.prototype.dispose=function(){return e.prototype.dispose.call(this),this._mult.dispose(),this._mult=null,this._param=null,this},e.Multiply}).apply(V,D),v!==void 0&&(F.exports=v)},function(F,V,S){var D,v;D=[S(0),S(6),S(9),S(18),S(10)],v=(function(e){return e.Signal=function(){var n=this.optionsObject(arguments,["value","units"],e.Signal.defaults);this.output=this._gain=this.context.createGain(),n.param=this._gain.gain,e.Param.call(this,n),this.input=this._param=this._gain.gain,this.context.getConstant(1).chain(this._gain)},e.extend(e.Signal,e.Param),e.Signal.defaults={value:0,units:e.Type.Default,convert:!0},e.Signal.prototype.connect=e.SignalBase.prototype.connect,e.Signal.prototype.dispose=function(){return e.Param.prototype.dispose.call(this),this._param=null,this._gain.disconnect(),this._gain=null,this},e.Signal}).apply(V,D),v!==void 0&&(F.exports=v)},function(F,V,S){(function(D){S.d(V,"b",function(){return l}),S.d(V,"c",function(){return d});var v=S(22),e=S.n(v),n=S(0),i=S.n(n),u=S(12);S.n(u),D.TONE_SILENCE_VERSION_LOGGING=!0;var c=new window.AudioContext;i.a.setContext(c);function l(){return c}function d(h,a){var y=h;return h instanceof p5.Element?y=h.elt:h instanceof Array&&h[0]instanceof p5.Element&&(y=h.map(function(m){return m.elt})),e()(c,y,a)}V.a=c}).call(this,S(26))},function(F,V,S){var D,v;D=[S(0),S(2),S(10)],v=(function(e){return e.Add=function(n){this.createInsOuts(2,0),this._sum=this.input[0]=this.input[1]=this.output=new e.Gain,this._param=this.input[1]=new e.Signal(n),this._param.connect(this._sum)},e.extend(e.Add,e.Signal),e.Add.prototype.dispose=function(){return e.prototype.dispose.call(this),this._sum.dispose(),this._sum=null,this._param.dispose(),this._param=null,this},e.Add}).apply(V,D),v!==void 0&&(F.exports=v)},function(F,V){F.exports={recorderProcessor:"recorder-processor",soundFileProcessor:"sound-file-processor",amplitudeProcessor:"amplitude-processor"}},function(F,V,S){var D,v;D=[S(0),S(15)],v=(function(e){return e.WaveShaper=function(n,i){this._shaper=this.input=this.output=this.context.createWaveShaper(),this._curve=null,Array.isArray(n)?this.curve=n:isFinite(n)||this.isUndef(n)?this._curve=new Float32Array(this.defaultArg(n,1024)):this.isFunction(n)&&(this._curve=new Float32Array(this.defaultArg(i,1024)),this.setMap(n))},e.extend(e.WaveShaper,e.SignalBase),e.WaveShaper.prototype.setMap=function(n){for(var i=0,u=this._curve.length;i<u;i++){var c=i/(u-1)*2-1;this._curve[i]=n(c,i)}return this._shaper.curve=this._curve,this},Object.defineProperty(e.WaveShaper.prototype,"curve",{get:function(){return this._shaper.curve},set:function(n){this._curve=new Float32Array(n),this._shaper.curve=this._curve}}),Object.defineProperty(e.WaveShaper.prototype,"oversample",{get:function(){return this._shaper.oversample},set:function(n){if(["none","2x","4x"].indexOf(n)===-1)throw new RangeError("Tone.WaveShaper: oversampling must be either 'none', '2x', or '4x'");this._shaper.oversample=n}}),e.WaveShaper.prototype.dispose=function(){return e.prototype.dispose.call(this),this._shaper.disconnect(),this._shaper=null,this._curve=null,this},e.WaveShaper}).apply(V,D),v!==void 0&&(F.exports=v)},function(F,V,S){var D,v;D=[S(0),S(2),S(19)],v=(function(e){return e.TimelineSignal=function(){var n=this.optionsObject(arguments,["value","units"],e.Signal.defaults);this._events=new e.Timeline(10),e.Signal.apply(this,n),n.param=this._param,e.Param.call(this,n),this._initial=this._fromUnits(this._param.value)},e.extend(e.TimelineSignal,e.Param),e.TimelineSignal.Type={Linear:"linear",Exponential:"exponential",Target:"target",Curve:"curve",Set:"set"},Object.defineProperty(e.TimelineSignal.prototype,"value",{get:function(){var n=this.now(),i=this.getValueAtTime(n);return this._toUnits(i)},set:function(n){var i=this._fromUnits(n);this._initial=i,this.cancelScheduledValues(),this._param.value=i}}),e.TimelineSignal.prototype.setValueAtTime=function(n,i){return n=this._fromUnits(n),i=this.toSeconds(i),this._events.add({type:e.TimelineSignal.Type.Set,value:n,time:i}),this._param.setValueAtTime(n,i),this},e.TimelineSignal.prototype.linearRampToValueAtTime=function(n,i){return n=this._fromUnits(n),i=this.toSeconds(i),this._events.add({type:e.TimelineSignal.Type.Linear,value:n,time:i}),this._param.linearRampToValueAtTime(n,i),this},e.TimelineSignal.prototype.exponentialRampToValueAtTime=function(n,i){i=this.toSeconds(i);var u=this._searchBefore(i);u&&u.value===0&&this.setValueAtTime(this._minOutput,u.time),n=this._fromUnits(n);var c=Math.max(n,this._minOutput);return this._events.add({type:e.TimelineSignal.Type.Exponential,value:c,time:i}),n<this._minOutput?(this._param.exponentialRampToValueAtTime(this._minOutput,i-this.sampleTime),this.setValueAtTime(0,i)):this._param.exponentialRampToValueAtTime(n,i),this},e.TimelineSignal.prototype.setTargetAtTime=function(n,i,u){return n=this._fromUnits(n),n=Math.max(this._minOutput,n),u=Math.max(this._minOutput,u),i=this.toSeconds(i),this._events.add({type:e.TimelineSignal.Type.Target,value:n,time:i,constant:u}),this._param.setTargetAtTime(n,i,u),this},e.TimelineSignal.prototype.setValueCurveAtTime=function(n,i,u,c){c=this.defaultArg(c,1);for(var l=new Array(n.length),d=0;d<l.length;d++)l[d]=this._fromUnits(n[d])*c;i=this.toSeconds(i),u=this.toSeconds(u),this._events.add({type:e.TimelineSignal.Type.Curve,value:l,time:i,duration:u}),this._param.setValueAtTime(l[0],i);for(var h=1;h<l.length;h++){var a=i+h/(l.length-1)*u;this._param.linearRampToValueAtTime(l[h],a)}return this},e.TimelineSignal.prototype.cancelScheduledValues=function(n){return n=this.toSeconds(n),this._events.cancel(n),this._param.cancelScheduledValues(n),this},e.TimelineSignal.prototype.setRampPoint=function(n){n=this.toSeconds(n);var i=this._toUnits(this.getValueAtTime(n)),u=this._searchBefore(n);if(u&&u.time===n)this.cancelScheduledValues(n+this.sampleTime);else if(u&&u.type===e.TimelineSignal.Type.Curve&&u.time+u.duration>n)this.cancelScheduledValues(n),this.linearRampToValueAtTime(i,n);else{var c=this._searchAfter(n);c&&(this.cancelScheduledValues(n),c.type===e.TimelineSignal.Type.Linear?this.linearRampToValueAtTime(i,n):c.type===e.TimelineSignal.Type.Exponential&&this.exponentialRampToValueAtTime(i,n)),this.setValueAtTime(i,n)}return this},e.TimelineSignal.prototype.linearRampToValueBetween=function(n,i,u){return this.setRampPoint(i),this.linearRampToValueAtTime(n,u),this},e.TimelineSignal.prototype.exponentialRampToValueBetween=function(n,i,u){return this.setRampPoint(i),this.exponentialRampToValueAtTime(n,u),this},e.TimelineSignal.prototype._searchBefore=function(n){return this._events.get(n)},e.TimelineSignal.prototype._searchAfter=function(n){return this._events.getAfter(n)},e.TimelineSignal.prototype.getValueAtTime=function(n){n=this.toSeconds(n);var i=this._searchAfter(n),u=this._searchBefore(n),c=this._initial;if(u===null)c=this._initial;else if(u.type===e.TimelineSignal.Type.Target){var l,d=this._events.getBefore(u.time);l=d===null?this._initial:d.value,c=this._exponentialApproach(u.time,l,u.value,u.constant,n)}else c=u.type===e.TimelineSignal.Type.Curve?this._curveInterpolate(u.time,u.value,u.duration,n):i===null?u.value:i.type===e.TimelineSignal.Type.Linear?this._linearInterpolate(u.time,u.value,i.time,i.value,n):i.type===e.TimelineSignal.Type.Exponential?this._exponentialInterpolate(u.time,u.value,i.time,i.value,n):u.value;return c},e.TimelineSignal.prototype.connect=e.SignalBase.prototype.connect,e.TimelineSignal.prototype._exponentialApproach=function(n,i,u,c,l){return u+(i-u)*Math.exp(-(l-n)/c)},e.TimelineSignal.prototype._linearInterpolate=function(n,i,u,c,l){return i+(l-n)/(u-n)*(c-i)},e.TimelineSignal.prototype._exponentialInterpolate=function(n,i,u,c,l){return(i=Math.max(this._minOutput,i))*Math.pow(c/i,(l-n)/(u-n))},e.TimelineSignal.prototype._curveInterpolate=function(n,i,u,c){var l=i.length;if(n+u<=c)return i[l-1];if(c<=n)return i[0];var d=(c-n)/u,h=Math.floor((l-1)*d),a=Math.ceil((l-1)*d),y=i[h],m=i[a];return a===h?y:this._linearInterpolate(h,y,a,m,d*(l-1))},e.TimelineSignal.prototype.dispose=function(){e.Signal.prototype.dispose.call(this),e.Param.prototype.dispose.call(this),this._events.dispose(),this._events=null},e.TimelineSignal}).apply(V,D),v!==void 0&&(F.exports=v)},function(F,V,S){var D,v;D=[S(0),S(4),S(1),S(2)],v=(function(e){return e.Scale=function(n,i){this._outputMin=this.defaultArg(n,0),this._outputMax=this.defaultArg(i,1),this._scale=this.input=new e.Multiply(1),this._add=this.output=new e.Add(0),this._scale.connect(this._add),this._setRange()},e.extend(e.Scale,e.SignalBase),Object.defineProperty(e.Scale.prototype,"min",{get:function(){return this._outputMin},set:function(n){this._outputMin=n,this._setRange()}}),Object.defineProperty(e.Scale.prototype,"max",{get:function(){return this._outputMax},set:function(n){this._outputMax=n,this._setRange()}}),e.Scale.prototype._setRange=function(){this._add.value=this._outputMin,this._scale.value=this._outputMax-this._outputMin},e.Scale.prototype.dispose=function(){return e.prototype.dispose.call(this),this._add.dispose(),this._add=null,this._scale.dispose(),this._scale=null,this},e.Scale}).apply(V,D),v!==void 0&&(F.exports=v)},function(F,V,S){var D,v;D=[S(0),S(16),S(30),S(31),S(12)],v=(function(e){return e.Type={Default:"number",Time:"time",Frequency:"frequency",TransportTime:"transportTime",Ticks:"ticks",NormalRange:"normalRange",AudioRange:"audioRange",Decibels:"db",Interval:"interval",BPM:"bpm",Positive:"positive",Cents:"cents",Degrees:"degrees",MIDI:"midi",BarsBeatsSixteenths:"barsBeatsSixteenths",Samples:"samples",Hertz:"hertz",Note:"note",Milliseconds:"milliseconds",Seconds:"seconds",Notation:"notation"},e.prototype.toSeconds=function(n){return this.isNumber(n)?n:this.isUndef(n)?this.now():this.isString(n)?new e.Time(n).toSeconds():n instanceof e.TimeBase?n.toSeconds():void 0},e.prototype.toFrequency=function(n){return this.isNumber(n)?n:this.isString(n)||this.isUndef(n)?new e.Frequency(n).valueOf():n instanceof e.TimeBase?n.toFrequency():void 0},e.prototype.toTicks=function(n){return this.isNumber(n)||this.isString(n)?new e.TransportTime(n).toTicks():this.isUndef(n)?e.Transport.ticks:n instanceof e.TimeBase?n.toTicks():void 0},e}).apply(V,D),v!==void 0&&(F.exports=v)},function(F,V,S){var D,v;D=[S(0),S(18),S(9)],v=(function(e){return window.GainNode&&!AudioContext.prototype.createGain&&(AudioContext.prototype.createGain=AudioContext.prototype.createGainNode),e.Gain=function(){var n=this.optionsObject(arguments,["gain","units"],e.Gain.defaults);this.input=this.output=this._gainNode=this.context.createGain(),this.gain=new e.Param({param:this._gainNode.gain,units:n.units,value:n.gain,convert:n.convert}),this._readOnly("gain")},e.extend(e.Gain),e.Gain.defaults={gain:1,convert:!0},e.Gain.prototype.dispose=function(){e.Param.prototype.dispose.call(this),this._gainNode.disconnect(),this._gainNode=null,this._writable("gain"),this.gain.dispose(),this.gain=null},e.prototype.createInsOuts=function(n,i){n===1?this.input=new e.Gain:1<n&&(this.input=new Array(n)),i===1?this.output=new e.Gain:1<i&&(this.output=new Array(n))},e.Gain}).apply(V,D),v!==void 0&&(F.exports=v)},function(F,V,S){var D,v;D=[S(0),S(7),S(39),S(14),S(12)],v=(function(e){return e.Clock=function(){e.Emitter.call(this);var n=this.optionsObject(arguments,["callback","frequency"],e.Clock.defaults);this.callback=n.callback,this._nextTick=0,this._lastState=e.State.Stopped,this.frequency=new e.TimelineSignal(n.frequency,e.Type.Frequency),this._readOnly("frequency"),this.ticks=0,this._state=new e.TimelineState(e.State.Stopped),this._boundLoop=this._loop.bind(this),this.context.on("tick",this._boundLoop)},e.extend(e.Clock,e.Emitter),e.Clock.defaults={callback:e.noOp,frequency:1,lookAhead:"auto"},Object.defineProperty(e.Clock.prototype,"state",{get:function(){return this._state.getValueAtTime(this.now())}}),e.Clock.prototype.start=function(n,i){return n=this.toSeconds(n),this._state.getValueAtTime(n)!==e.State.Started&&this._state.add({state:e.State.Started,time:n,offset:i}),this},e.Clock.prototype.stop=function(n){return n=this.toSeconds(n),this._state.cancel(n),this._state.setStateAtTime(e.State.Stopped,n),this},e.Clock.prototype.pause=function(n){return n=this.toSeconds(n),this._state.getValueAtTime(n)===e.State.Started&&this._state.setStateAtTime(e.State.Paused,n),this},e.Clock.prototype._loop=function(){for(var n=this.now()+this.context.lookAhead+this.context.updateInterval+2*this.context.lag;n>this._nextTick&&this._state;){var i=this._state.getValueAtTime(this._nextTick);if(i!==this._lastState){this._lastState=i;var u=this._state.get(this._nextTick);i===e.State.Started?(this._nextTick=u.time,this.isUndef(u.offset)||(this.ticks=u.offset),this.emit("start",u.time,this.ticks)):i===e.State.Stopped?(this.ticks=0,this.emit("stop",u.time)):i===e.State.Paused&&this.emit("pause",u.time)}var c=this._nextTick;this.frequency&&(this._nextTick+=1/this.frequency.getValueAtTime(this._nextTick),i===e.State.Started&&(this.callback(c),this.ticks++))}},e.Clock.prototype.getStateAtTime=function(n){return n=this.toSeconds(n),this._state.getValueAtTime(n)},e.Clock.prototype.dispose=function(){e.Emitter.prototype.dispose.call(this),this.context.off("tick",this._boundLoop),this._writable("frequency"),this.frequency.dispose(),this.frequency=null,this._boundLoop=null,this._nextTick=1/0,this.callback=null,this._state.dispose(),this._state=null},e.Clock}).apply(V,D),v!==void 0&&(F.exports=v)},function(F,V,S){var D,v;D=[S(0),S(14)],v=(function(e){function n(c,l,d){if(c.input)Array.isArray(c.input)?(e.prototype.isUndef(d)&&(d=0),this.connect(c.input[d])):this.connect(c.input,l,d);else try{c instanceof AudioNode?i.call(this,c,l,d):i.call(this,c,l)}catch(h){throw new Error("error connecting to node: "+c+`
`+h)}}var i,u;return!window.hasOwnProperty("AudioContext")&&window.hasOwnProperty("webkitAudioContext")&&(window.AudioContext=window.webkitAudioContext),e.Context=function(c){for(var l in e.Emitter.call(this),c=c||new window.AudioContext,this._context=c,this._context)this._defineProperty(this._context,l);this._latencyHint="interactive",this._lookAhead=.1,this._updateInterval=this._lookAhead/3,this._computedUpdateInterval=0,this._worker=this._createWorker(),this._constants={}},e.extend(e.Context,e.Emitter),e.Emitter.mixin(e.Context),e.Context.prototype._defineProperty=function(c,l){this.isUndef(this[l])&&Object.defineProperty(this,l,{get:function(){return typeof c[l]=="function"?c[l].bind(c):c[l]},set:function(d){c[l]=d}})},e.Context.prototype.now=function(){return this._context.currentTime},e.Context.prototype._createWorker=function(){window.URL=window.URL||window.webkitURL;var c=new Blob(["var timeoutTime = "+(1e3*this._updateInterval).toFixed(1)+";self.onmessage = function(msg){	timeoutTime = parseInt(msg.data);};function tick(){	setTimeout(tick, timeoutTime);	self.postMessage('tick');}tick();"]),l=URL.createObjectURL(c),d=new Worker(l);return d.addEventListener("message",(function(){this.emit("tick")}).bind(this)),d.addEventListener("message",(function(){var h=this.now();if(this.isNumber(this._lastUpdate)){var a=h-this._lastUpdate;this._computedUpdateInterval=Math.max(a,.97*this._computedUpdateInterval)}this._lastUpdate=h}).bind(this)),d},e.Context.prototype.getConstant=function(c){if(this._constants[c])return this._constants[c];for(var l=this._context.createBuffer(1,128,this._context.sampleRate),d=l.getChannelData(0),h=0;h<d.length;h++)d[h]=c;var a=this._context.createBufferSource();return a.channelCount=1,a.channelCountMode="explicit",a.buffer=l,a.loop=!0,a.start(0),this._constants[c]=a},Object.defineProperty(e.Context.prototype,"lag",{get:function(){var c=this._computedUpdateInterval-this._updateInterval;return c=Math.max(c,0)}}),Object.defineProperty(e.Context.prototype,"lookAhead",{get:function(){return this._lookAhead},set:function(c){this._lookAhead=c}}),Object.defineProperty(e.Context.prototype,"updateInterval",{get:function(){return this._updateInterval},set:function(c){this._updateInterval=Math.max(c,e.prototype.blockTime),this._worker.postMessage(Math.max(1e3*c,1))}}),Object.defineProperty(e.Context.prototype,"latencyHint",{get:function(){return this._latencyHint},set:function(c){var l=c;if(this._latencyHint=c,this.isString(c))switch(c){case"interactive":l=.1,this._context.latencyHint=c;break;case"playback":l=.8,this._context.latencyHint=c;break;case"balanced":l=.25,this._context.latencyHint=c;break;case"fastest":l=.01}this.lookAhead=l,this.updateInterval=l/3}}),e.supported?(i=AudioNode.prototype.connect,u=AudioNode.prototype.disconnect,AudioNode.prototype.connect!==n&&(AudioNode.prototype.connect=n,AudioNode.prototype.disconnect=function(c,l,d){if(c&&c.input&&Array.isArray(c.input))e.prototype.isUndef(d)&&(d=0),this.disconnect(c.input[d],l,d);else if(c&&c.input)this.disconnect(c.input,l,d);else try{u.apply(this,arguments)}catch(h){throw new Error("error disconnecting node: "+c+`
`+h)}}),e.context=new e.Context):console.warn("This browser does not support Tone.js"),e.Context}).apply(V,D),v!==void 0&&(F.exports=v)},function(F,V,S){var D,v;D=[S(0),S(4),S(20),S(2),S(10)],v=(function(e){return e.Subtract=function(n){this.createInsOuts(2,0),this._sum=this.input[0]=this.output=new e.Gain,this._neg=new e.Negate,this._param=this.input[1]=new e.Signal(n),this._param.chain(this._neg,this._sum)},e.extend(e.Subtract,e.Signal),e.Subtract.prototype.dispose=function(){return e.prototype.dispose.call(this),this._neg.dispose(),this._neg=null,this._sum.disconnect(),this._sum=null,this._param.dispose(),this._param=null,this},e.Subtract}).apply(V,D),v!==void 0&&(F.exports=v)},function(F,V,S){var D,v;D=[S(0)],v=(function(e){return e.Emitter=function(){this._events={}},e.extend(e.Emitter),e.Emitter.prototype.on=function(n,i){for(var u=n.split(/\W+/),c=0;c<u.length;c++){var l=u[c];this._events.hasOwnProperty(l)||(this._events[l]=[]),this._events[l].push(i)}return this},e.Emitter.prototype.off=function(n,i){for(var u=n.split(/\W+/),c=0;c<u.length;c++)if(n=u[c],this._events.hasOwnProperty(n))if(e.prototype.isUndef(i))this._events[n]=[];else for(var l=this._events[n],d=0;d<l.length;d++)l[d]===i&&l.splice(d,1);return this},e.Emitter.prototype.emit=function(n){if(this._events){var i=Array.apply(null,arguments).slice(1);if(this._events.hasOwnProperty(n))for(var u=this._events[n],c=0,l=u.length;c<l;c++)u[c].apply(this,i)}return this},e.Emitter.mixin=function(n){var i=["on","off","emit"];n._events={};for(var u=0;u<i.length;u++){var c=i[u],l=e.Emitter.prototype[c];n[c]=l}},e.Emitter.prototype.dispose=function(){return e.prototype.dispose.call(this),this._events=null,this},e.Emitter}).apply(V,D),v!==void 0&&(F.exports=v)},function(F,V,S){var D,v;D=[S(0)],v=(function(e){return e.SignalBase=function(){},e.extend(e.SignalBase),e.SignalBase.prototype.connect=function(n,i,u){return e.Signal&&e.Signal===n.constructor||e.Param&&e.Param===n.constructor||e.TimelineSignal&&e.TimelineSignal===n.constructor?(n._param.cancelScheduledValues(0),n._param.value=0,n.overridden=!0):n instanceof AudioParam&&(n.cancelScheduledValues(0),n.value=0),e.prototype.connect.call(this,n,i,u),this},e.SignalBase}).apply(V,D),v!==void 0&&(F.exports=v)},function(F,V,S){var D,v;D=[S(0),S(17)],v=(function(e){return e.Time=function(n,i){if(!(this instanceof e.Time))return new e.Time(n,i);this._plusNow=!1,e.TimeBase.call(this,n,i)},e.extend(e.Time,e.TimeBase),e.Time.prototype._unaryExpressions=Object.create(e.TimeBase.prototype._unaryExpressions),e.Time.prototype._unaryExpressions.quantize={regexp:/^@/,method:function(n){return e.Transport.nextSubdivision(n())}},e.Time.prototype._unaryExpressions.now={regexp:/^\+/,method:function(n){return this._plusNow=!0,n()}},e.Time.prototype.quantize=function(n,i){return i=this.defaultArg(i,1),this._expr=(function(u,c,l){return u=u(),c=c.toSeconds(),u+(Math.round(u/c)*c-u)*l}).bind(this,this._expr,new this.constructor(n),i),this},e.Time.prototype.addNow=function(){return this._plusNow=!0,this},e.Time.prototype._defaultExpr=function(){return this._plusNow=!0,this._noOp},e.Time.prototype.copy=function(n){return e.TimeBase.prototype.copy.call(this,n),this._plusNow=n._plusNow,this},e.Time.prototype.toNotation=function(){var n=this.toSeconds(),i=this._toNotationHelper(n,["1m","2n","4n","8n","16n","32n","64n","128n"]),u=this._toNotationHelper(n,["1m","2n","2t","4n","4t","8n","8t","16n","16t","32n","32t","64n","64t","128n"]);return u.split("+").length<i.split("+").length?u:i},e.Time.prototype._toNotationHelper=function(n,i){for(var u=this._notationToUnits(i[i.length-1]),c="",l=0;l<i.length;l++){var d=this._notationToUnits(i[l]),h=n/d;if(1-h%1<1e-6&&(h+=1e-6),0<(h=Math.floor(h))){if(c+=h===1?i[l]:h.toString()+"*"+i[l],(n-=h*d)<u)break;c+=" + "}}return c===""&&(c="0"),c},e.Time.prototype._notationToUnits=function(n){for(var i=this._primaryExpressions,u=[i.n,i.t,i.m],c=0;c<u.length;c++){var l=u[c],d=n.match(l.regexp);if(d)return l.method.call(this,d[1])}},e.Time.prototype.toBarsBeatsSixteenths=function(){var n=this._beatsToUnits(1),i=this.toSeconds()/n,u=Math.floor(i/this._timeSignature()),c=i%1*4;return i=Math.floor(i)%this._timeSignature(),3<(c=c.toString()).length&&(c=parseFloat(c).toFixed(3)),[u,i,c].join(":")},e.Time.prototype.toTicks=function(){var n=this._beatsToUnits(1),i=this.valueOf()/n;return Math.floor(i*e.Transport.PPQ)},e.Time.prototype.toSamples=function(){return this.toSeconds()*this.context.sampleRate},e.Time.prototype.toFrequency=function(){return 1/this.toSeconds()},e.Time.prototype.toSeconds=function(){return this.valueOf()},e.Time.prototype.toMilliseconds=function(){return 1e3*this.toSeconds()},e.Time.prototype.valueOf=function(){return this._expr()+(this._plusNow?this.now():0)},e.Time}).apply(V,D),v!==void 0&&(F.exports=v)},function(F,V,S){var D,v;D=[S(0)],v=(function(e){return e.TimeBase=function(n,i){if(!(this instanceof e.TimeBase))return new e.TimeBase(n,i);if(this._expr=this._noOp,n instanceof e.TimeBase)this.copy(n);else if(!this.isUndef(i)||this.isNumber(n)){i=this.defaultArg(i,this._defaultUnits);var u=this._primaryExpressions[i].method;this._expr=u.bind(this,n)}else this.isString(n)?this.set(n):this.isUndef(n)&&(this._expr=this._defaultExpr())},e.extend(e.TimeBase),e.TimeBase.prototype.set=function(n){return this._expr=this._parseExprString(n),this},e.TimeBase.prototype.clone=function(){var n=new this.constructor;return n.copy(this),n},e.TimeBase.prototype.copy=function(n){var i=n._expr();return this.set(i)},e.TimeBase.prototype._primaryExpressions={n:{regexp:/^(\d+)n/i,method:function(n){return(n=parseInt(n))===1?this._beatsToUnits(this._timeSignature()):this._beatsToUnits(4/n)}},t:{regexp:/^(\d+)t/i,method:function(n){return n=parseInt(n),this._beatsToUnits(8/(3*parseInt(n)))}},m:{regexp:/^(\d+)m/i,method:function(n){return this._beatsToUnits(parseInt(n)*this._timeSignature())}},i:{regexp:/^(\d+)i/i,method:function(n){return this._ticksToUnits(parseInt(n))}},hz:{regexp:/^(\d+(?:\.\d+)?)hz/i,method:function(n){return this._frequencyToUnits(parseFloat(n))}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method:function(n,i,u){var c=0;return n&&n!=="0"&&(c+=this._beatsToUnits(this._timeSignature()*parseFloat(n))),i&&i!=="0"&&(c+=this._beatsToUnits(parseFloat(i))),u&&u!=="0"&&(c+=this._beatsToUnits(parseFloat(u)/4)),c}},s:{regexp:/^(\d+(?:\.\d+)?s)/,method:function(n){return this._secondsToUnits(parseFloat(n))}},samples:{regexp:/^(\d+)samples/,method:function(n){return parseInt(n)/this.context.sampleRate}},default:{regexp:/^(\d+(?:\.\d+)?)/,method:function(n){return this._primaryExpressions[this._defaultUnits].method.call(this,n)}}},e.TimeBase.prototype._binaryExpressions={"+":{regexp:/^\+/,precedence:2,method:function(n,i){return n()+i()}},"-":{regexp:/^\-/,precedence:2,method:function(n,i){return n()-i()}},"*":{regexp:/^\*/,precedence:1,method:function(n,i){return n()*i()}},"/":{regexp:/^\//,precedence:1,method:function(n,i){return n()/i()}}},e.TimeBase.prototype._unaryExpressions={neg:{regexp:/^\-/,method:function(n){return-n()}}},e.TimeBase.prototype._syntaxGlue={"(":{regexp:/^\(/},")":{regexp:/^\)/}},e.TimeBase.prototype._tokenize=function(n){for(var i=-1,u=[];0<n.length;){var c=l(n=n.trim(),this);u.push(c),n=n.substr(c.value.length)}function l(d,h){for(var a=["_binaryExpressions","_unaryExpressions","_primaryExpressions","_syntaxGlue"],y=0;y<a.length;y++){var m=h[a[y]];for(var x in m){var T=m[x],P=T.regexp,E=d.match(P);if(E!==null)return{method:T.method,precedence:T.precedence,regexp:T.regexp,value:E[0]}}}throw new SyntaxError("Tone.TimeBase: Unexpected token "+d)}return{next:function(){return u[++i]},peek:function(){return u[i+1]}}},e.TimeBase.prototype._matchGroup=function(n,i,u){if(!this.isUndef(n))for(var c in i){var l=i[c];if(l.regexp.test(n.value)&&(this.isUndef(u)||l.precedence===u))return l}return!1},e.TimeBase.prototype._parseBinary=function(n,i){var u;this.isUndef(i)&&(i=2),u=i<0?this._parseUnary(n):this._parseBinary(n,i-1);for(var c=n.peek();c&&this._matchGroup(c,this._binaryExpressions,i);)u=(c=n.next()).method.bind(this,u,this._parseBinary(n,i-1)),c=n.peek();return u},e.TimeBase.prototype._parseUnary=function(n){var i,u;i=n.peek();var c=this._matchGroup(i,this._unaryExpressions);return c?(i=n.next(),u=this._parseUnary(n),c.method.bind(this,u)):this._parsePrimary(n)},e.TimeBase.prototype._parsePrimary=function(n){var i,u;if(i=n.peek(),this.isUndef(i))throw new SyntaxError("Tone.TimeBase: Unexpected end of expression");if(this._matchGroup(i,this._primaryExpressions)){var c=(i=n.next()).value.match(i.regexp);return i.method.bind(this,c[1],c[2],c[3])}if(i&&i.value==="("){if(n.next(),u=this._parseBinary(n),!(i=n.next())||i.value!==")")throw new SyntaxError("Expected )");return u}throw new SyntaxError("Tone.TimeBase: Cannot process token "+i.value)},e.TimeBase.prototype._parseExprString=function(n){this.isString(n)||(n=n.toString());var i=this._tokenize(n);return this._parseBinary(i)},e.TimeBase.prototype._noOp=function(){return 0},e.TimeBase.prototype._defaultExpr=function(){return this._noOp},e.TimeBase.prototype._defaultUnits="s",e.TimeBase.prototype._frequencyToUnits=function(n){return 1/n},e.TimeBase.prototype._beatsToUnits=function(n){return 60/e.Transport.bpm.value*n},e.TimeBase.prototype._secondsToUnits=function(n){return n},e.TimeBase.prototype._ticksToUnits=function(n){return n*(this._beatsToUnits(1)/e.Transport.PPQ)},e.TimeBase.prototype._timeSignature=function(){return e.Transport.timeSignature},e.TimeBase.prototype._pushExpr=function(n,i,u){return n instanceof e.TimeBase||(n=new this.constructor(n,u)),this._expr=this._binaryExpressions[i].method.bind(this,this._expr,n._expr),this},e.TimeBase.prototype.add=function(n,i){return this._pushExpr(n,"+",i)},e.TimeBase.prototype.sub=function(n,i){return this._pushExpr(n,"-",i)},e.TimeBase.prototype.mult=function(n,i){return this._pushExpr(n,"*",i)},e.TimeBase.prototype.div=function(n,i){return this._pushExpr(n,"/",i)},e.TimeBase.prototype.valueOf=function(){return this._expr()},e.TimeBase.prototype.dispose=function(){this._expr=null},e.TimeBase}).apply(V,D),v!==void 0&&(F.exports=v)},function(F,V,S){var D,v;D=[S(0),S(9)],v=(function(e){return e.Param=function(){var n=this.optionsObject(arguments,["param","units","convert"],e.Param.defaults);this._param=this.input=n.param,this.units=n.units,this.convert=n.convert,this.overridden=!1,this._lfo=null,this.isObject(n.lfo)?this.value=n.lfo:this.isUndef(n.value)||(this.value=n.value)},e.extend(e.Param),e.Param.defaults={units:e.Type.Default,convert:!0,param:void 0},Object.defineProperty(e.Param.prototype,"value",{get:function(){return this._toUnits(this._param.value)},set:function(n){if(this.isObject(n)){if(this.isUndef(e.LFO))throw new Error("Include 'Tone.LFO' to use an LFO as a Param value.");this._lfo&&this._lfo.dispose(),this._lfo=new e.LFO(n).start(),this._lfo.connect(this.input)}else{var i=this._fromUnits(n);this._param.cancelScheduledValues(0),this._param.value=i}}}),e.Param.prototype._fromUnits=function(n){if(!this.convert&&!this.isUndef(this.convert))return n;switch(this.units){case e.Type.Time:return this.toSeconds(n);case e.Type.Frequency:return this.toFrequency(n);case e.Type.Decibels:return this.dbToGain(n);case e.Type.NormalRange:return Math.min(Math.max(n,0),1);case e.Type.AudioRange:return Math.min(Math.max(n,-1),1);case e.Type.Positive:return Math.max(n,0);default:return n}},e.Param.prototype._toUnits=function(n){if(!this.convert&&!this.isUndef(this.convert))return n;switch(this.units){case e.Type.Decibels:return this.gainToDb(n);default:return n}},e.Param.prototype._minOutput=1e-5,e.Param.prototype.setValueAtTime=function(n,i){return n=this._fromUnits(n),(i=this.toSeconds(i))<=this.now()+this.blockTime?this._param.value=n:this._param.setValueAtTime(n,i),this},e.Param.prototype.setRampPoint=function(n){n=this.defaultArg(n,this.now());var i=this._param.value;return i===0&&(i=this._minOutput),this._param.setValueAtTime(i,n),this},e.Param.prototype.linearRampToValueAtTime=function(n,i){return n=this._fromUnits(n),this._param.linearRampToValueAtTime(n,this.toSeconds(i)),this},e.Param.prototype.exponentialRampToValueAtTime=function(n,i){return n=this._fromUnits(n),n=Math.max(this._minOutput,n),this._param.exponentialRampToValueAtTime(n,this.toSeconds(i)),this},e.Param.prototype.exponentialRampToValue=function(n,i,u){return u=this.toSeconds(u),this.setRampPoint(u),this.exponentialRampToValueAtTime(n,u+this.toSeconds(i)),this},e.Param.prototype.linearRampToValue=function(n,i,u){return u=this.toSeconds(u),this.setRampPoint(u),this.linearRampToValueAtTime(n,u+this.toSeconds(i)),this},e.Param.prototype.setTargetAtTime=function(n,i,u){return n=this._fromUnits(n),n=Math.max(this._minOutput,n),u=Math.max(this._minOutput,u),this._param.setTargetAtTime(n,this.toSeconds(i),u),this},e.Param.prototype.setValueCurveAtTime=function(n,i,u){for(var c=0;c<n.length;c++)n[c]=this._fromUnits(n[c]);return this._param.setValueCurveAtTime(n,this.toSeconds(i),this.toSeconds(u)),this},e.Param.prototype.cancelScheduledValues=function(n){return this._param.cancelScheduledValues(this.toSeconds(n)),this},e.Param.prototype.rampTo=function(n,i,u){return i=this.defaultArg(i,0),this.units===e.Type.Frequency||this.units===e.Type.BPM||this.units===e.Type.Decibels?this.exponentialRampToValue(n,i,u):this.linearRampToValue(n,i,u),this},Object.defineProperty(e.Param.prototype,"lfo",{get:function(){return this._lfo}}),e.Param.prototype.dispose=function(){return e.prototype.dispose.call(this),this._param=null,this._lfo&&(this._lfo.dispose(),this._lfo=null),this},e.Param}).apply(V,D),v!==void 0&&(F.exports=v)},function(F,V,S){var D,v;D=[S(0),S(9)],v=(function(e){return e.Timeline=function(){var n=this.optionsObject(arguments,["memory"],e.Timeline.defaults);this._timeline=[],this._toRemove=[],this._iterating=!1,this.memory=n.memory},e.extend(e.Timeline),e.Timeline.defaults={memory:1/0},Object.defineProperty(e.Timeline.prototype,"length",{get:function(){return this._timeline.length}}),e.Timeline.prototype.add=function(n){if(this.isUndef(n.time))throw new Error("Tone.Timeline: events must have a time attribute");if(this._timeline.length){var i=this._search(n.time);this._timeline.splice(i+1,0,n)}else this._timeline.push(n);if(this.length>this.memory){var u=this.length-this.memory;this._timeline.splice(0,u)}return this},e.Timeline.prototype.remove=function(n){if(this._iterating)this._toRemove.push(n);else{var i=this._timeline.indexOf(n);i!==-1&&this._timeline.splice(i,1)}return this},e.Timeline.prototype.get=function(n){var i=this._search(n);return i!==-1?this._timeline[i]:null},e.Timeline.prototype.peek=function(){return this._timeline[0]},e.Timeline.prototype.shift=function(){return this._timeline.shift()},e.Timeline.prototype.getAfter=function(n){var i=this._search(n);return i+1<this._timeline.length?this._timeline[i+1]:null},e.Timeline.prototype.getBefore=function(n){var i=this._timeline.length;if(0<i&&this._timeline[i-1].time<n)return this._timeline[i-1];var u=this._search(n);return 0<=u-1?this._timeline[u-1]:null},e.Timeline.prototype.cancel=function(n){if(1<this._timeline.length){var i=this._search(n);if(0<=i)if(this._timeline[i].time===n){for(var u=i;0<=u&&this._timeline[u].time===n;u--)i=u;this._timeline=this._timeline.slice(0,i)}else this._timeline=this._timeline.slice(0,i+1);else this._timeline=[]}else this._timeline.length===1&&this._timeline[0].time>=n&&(this._timeline=[]);return this},e.Timeline.prototype.cancelBefore=function(n){if(this._timeline.length){var i=this._search(n);0<=i&&(this._timeline=this._timeline.slice(i+1))}return this},e.Timeline.prototype._search=function(n){var i=0,u=this._timeline.length,c=u;if(0<u&&this._timeline[u-1].time<=n)return u-1;for(;i<c;){var l=Math.floor(i+(c-i)/2),d=this._timeline[l],h=this._timeline[l+1];if(d.time===n){for(var a=l;a<this._timeline.length;a++)this._timeline[a].time===n&&(l=a);return l}if(d.time<n&&h.time>n)return l;d.time>n?c=l:d.time<n&&(i=l+1)}return-1},e.Timeline.prototype._iterate=function(n,i,u){this._iterating=!0,i=this.defaultArg(i,0),u=this.defaultArg(u,this._timeline.length-1);for(var c=i;c<=u;c++)n(this._timeline[c]);if(this._iterating=!1,0<this._toRemove.length){for(var l=0;l<this._toRemove.length;l++){var d=this._timeline.indexOf(this._toRemove[l]);d!==-1&&this._timeline.splice(d,1)}this._toRemove=[]}},e.Timeline.prototype.forEach=function(n){return this._iterate(n),this},e.Timeline.prototype.forEachBefore=function(n,i){var u=this._search(n);return u!==-1&&this._iterate(i,0,u),this},e.Timeline.prototype.forEachAfter=function(n,i){var u=this._search(n);return this._iterate(i,u+1),this},e.Timeline.prototype.forEachFrom=function(n,i){for(var u=this._search(n);0<=u&&this._timeline[u].time>=n;)u--;return this._iterate(i,u+1),this},e.Timeline.prototype.forEachAtTime=function(n,i){var u=this._search(n);return u!==-1&&this._iterate(function(c){c.time===n&&i(c)},0,u),this},e.Timeline.prototype.dispose=function(){e.prototype.dispose.call(this),this._timeline=null,this._toRemove=null},e.Timeline}).apply(V,D),v!==void 0&&(F.exports=v)},function(F,V,S){var D,v;D=[S(0),S(1),S(2)],v=(function(e){return e.Negate=function(){this._multiply=this.input=this.output=new e.Multiply(-1)},e.extend(e.Negate,e.SignalBase),e.Negate.prototype.dispose=function(){return e.prototype.dispose.call(this),this._multiply.dispose(),this._multiply=null,this},e.Negate}).apply(V,D),v!==void 0&&(F.exports=v)},function(F,V,S){var D,v;D=[S(0),S(2),S(1),S(6)],v=(function(e){return e.GreaterThanZero=function(){this._thresh=this.output=new e.WaveShaper(function(n){return n<=0?0:1},127),this._scale=this.input=new e.Multiply(1e4),this._scale.connect(this._thresh)},e.extend(e.GreaterThanZero,e.SignalBase),e.GreaterThanZero.prototype.dispose=function(){return e.prototype.dispose.call(this),this._scale.dispose(),this._scale=null,this._thresh.dispose(),this._thresh=null,this},e.GreaterThanZero}).apply(V,D),v!==void 0&&(F.exports=v)},function(F,V,S){var D,v,e;(function(n,i){v=[],D=i,e=typeof D=="function"?D.apply(V,v):D,e!==void 0&&(F.exports=e)})(this,function(){var n=function(u,c){this._dragged=!1,this._element=u,this._bindedMove=this._moved.bind(this),this._bindedEnd=this._ended.bind(this,c),u.addEventListener("touchstart",this._bindedEnd),u.addEventListener("touchmove",this._bindedMove),u.addEventListener("touchend",this._bindedEnd),u.addEventListener("mouseup",this._bindedEnd)};function i(u){return u.state==="running"}return n.prototype._moved=function(u){this._dragged=!0},n.prototype._ended=function(u){this._dragged||function(c){var l=c.createBuffer(1,1,c.sampleRate),d=c.createBufferSource();d.buffer=l,d.connect(c.destination),d.start(0),c.resume&&c.resume()}(u),this._dragged=!1},n.prototype.dispose=function(){this._element.removeEventListener("touchstart",this._bindedEnd),this._element.removeEventListener("touchmove",this._bindedMove),this._element.removeEventListener("touchend",this._bindedEnd),this._element.removeEventListener("mouseup",this._bindedEnd),this._bindedMove=null,this._bindedEnd=null,this._element=null},function(u,c,l){var d=new Promise(function(a){(function(y,m){i(y)?m():function x(){i(y)?m():(requestAnimationFrame(x),y.resume&&y.resume())}()})(u,a)}),h=[];return function a(y,m,x){if(Array.isArray(y)||NodeList&&y instanceof NodeList)for(var T=0;T<y.length;T++)a(y[T],m,x);else if(typeof y=="string")a(document.querySelectorAll(y),m,x);else if(y.jquery&&typeof y.toArray=="function")a(y.toArray(),m,x);else if(Element&&y instanceof Element){var P=new n(y,x);m.push(P)}}(c=c||document.body,h,u),d.then(function(){for(var a=0;a<h.length;a++)h[a].dispose();h=null,l&&l()}),d}})},function(F,V,S){var D,v;D=[S(0),S(2),S(32),S(38),S(10)],v=(function(e){return e.CrossFade=function(n){this.createInsOuts(2,1),this.a=this.input[0]=new e.Gain,this.b=this.input[1]=new e.Gain,this.fade=new e.Signal(this.defaultArg(n,.5),e.Type.NormalRange),this._equalPowerA=new e.EqualPowerGain,this._equalPowerB=new e.EqualPowerGain,this._invert=new e.Expr("1 - $0"),this.a.connect(this.output),this.b.connect(this.output),this.fade.chain(this._equalPowerB,this.b.gain),this.fade.chain(this._invert,this._equalPowerA,this.a.gain),this._readOnly("fade")},e.extend(e.CrossFade),e.CrossFade.prototype.dispose=function(){return e.prototype.dispose.call(this),this._writable("fade"),this._equalPowerA.dispose(),this._equalPowerA=null,this._equalPowerB.dispose(),this._equalPowerB=null,this.fade.dispose(),this.fade=null,this._invert.dispose(),this._invert=null,this.a.dispose(),this.a=null,this.b.dispose(),this.b=null,this},e.CrossFade}).apply(V,D),v!==void 0&&(F.exports=v)},function(F,V){(function(){var S,D=[];function v(u){var c=this,l={},d=-1;this.parameters.forEach(function(y,m){var x=D[++d]||(D[d]=new Float32Array(c.bufferSize));x.fill(y.value),l[m]=x}),this.processor.realm.exec("self.sampleRate=sampleRate="+this.context.sampleRate+";self.currentTime=currentTime="+this.context.currentTime);var h=e(u.inputBuffer),a=e(u.outputBuffer);this.instance.process([h],[a],l)}function e(u){for(var c=[],l=0;l<u.numberOfChannels;l++)c[l]=u.getChannelData(l);return c}function n(u){return u.$$processors||(u.$$processors={})}function i(u){this.$$context=u}typeof AudioWorkletNode!="function"&&(self.AudioWorkletNode=function(u,c,l){var d=n(u)[c],h=u.createScriptProcessor(void 0,2,l&&l.outputChannelCount?l.outputChannelCount[0]:2);if(h.parameters=new Map,d.properties)for(var a=0;a<d.properties.length;a++){var y=d.properties[a],m=u.createGain().gain;m.value=y.defaultValue,h.parameters.set(y.name,m)}var x=new MessageChannel;S=x.port2;var T=new d.Processor(l||{});return S=null,h.port=x.port1,h.processor=d,h.instance=T,h.onaudioprocess=v,h},Object.defineProperty((self.AudioContext||self.webkitAudioContext).prototype,"audioWorklet",{get:function(){return this.$$audioWorklet||(this.$$audioWorklet=new self.AudioWorklet(this))}}),self.AudioWorklet=(i.prototype.addModule=function(u,c){var l=this;return fetch(u).then(function(d){if(!d.ok)throw Error(d.status);return d.text()}).then(function(d){var h={sampleRate:0,currentTime:0,AudioWorkletProcessor:function(){this.port=S},registerProcessor:function(y,m){n(l.$$context)[y]={realm:a,context:h,Processor:m,properties:m.parameterDescriptors||[]}}},a=new function(y,m){var x=document.createElement("iframe");x.style.cssText="position:absolute;left:0;top:-999px;width:1px;height:1px;",m.appendChild(x);var T=x.contentWindow,P=T.document,E="var window,$hook";for(var B in T)B in y||B==="eval"||(E+=",",E+=B);for(var _ in y)E+=",",E+=_,E+="=self.",E+=_;var w=P.createElement("script");w.appendChild(P.createTextNode(`function $hook(self,console) {"use strict";
        `+E+";return function() {return eval(arguments[0])}}")),P.body.appendChild(w),this.exec=T.$hook(y,console)}(h.self=h,document.documentElement);return a.exec((c&&c.transpile||String)(d)),null})},i))})()},function(F,V){(function(){function u(c){c&&(c.setTargetAtTime||(c.setTargetAtTime=c.setTargetValueAtTime))}window.hasOwnProperty("webkitAudioContext")&&!window.hasOwnProperty("AudioContext")&&(window.AudioContext=window.webkitAudioContext,typeof AudioContext.prototype.createGain!="function"&&(AudioContext.prototype.createGain=AudioContext.prototype.createGainNode),typeof AudioContext.prototype.createDelay!="function"&&(AudioContext.prototype.createDelay=AudioContext.prototype.createDelayNode),typeof AudioContext.prototype.createScriptProcessor!="function"&&(AudioContext.prototype.createScriptProcessor=AudioContext.prototype.createJavaScriptNode),typeof AudioContext.prototype.createPeriodicWave!="function"&&(AudioContext.prototype.createPeriodicWave=AudioContext.prototype.createWaveTable),AudioContext.prototype.internal_createGain=AudioContext.prototype.createGain,AudioContext.prototype.createGain=function(){var c=this.internal_createGain();return u(c.gain),c},AudioContext.prototype.internal_createDelay=AudioContext.prototype.createDelay,AudioContext.prototype.createDelay=function(c){var l=c?this.internal_createDelay(c):this.internal_createDelay();return u(l.delayTime),l},AudioContext.prototype.internal_createBufferSource=AudioContext.prototype.createBufferSource,AudioContext.prototype.createBufferSource=function(){var c=this.internal_createBufferSource();return c.start?(c.internal_start=c.start,c.start=function(l,d,h){typeof h<"u"?c.internal_start(l||0,d,h):c.internal_start(l||0,d||0)}):c.start=function(l,d,h){d||h?this.noteGrainOn(l||0,d,h):this.noteOn(l||0)},c.stop?(c.internal_stop=c.stop,c.stop=function(l){c.internal_stop(l||0)}):c.stop=function(l){this.noteOff(l||0)},u(c.playbackRate),c},AudioContext.prototype.internal_createDynamicsCompressor=AudioContext.prototype.createDynamicsCompressor,AudioContext.prototype.createDynamicsCompressor=function(){var c=this.internal_createDynamicsCompressor();return u(c.threshold),u(c.knee),u(c.ratio),u(c.reduction),u(c.attack),u(c.release),c},AudioContext.prototype.internal_createBiquadFilter=AudioContext.prototype.createBiquadFilter,AudioContext.prototype.createBiquadFilter=function(){var c=this.internal_createBiquadFilter();return u(c.frequency),u(c.detune),u(c.Q),u(c.gain),c},typeof AudioContext.prototype.createOscillator!="function"&&(AudioContext.prototype.internal_createOscillator=AudioContext.prototype.createOscillator,AudioContext.prototype.createOscillator=function(){var c=this.internal_createOscillator();return c.start?(c.internal_start=c.start,c.start=function(l){c.internal_start(l||0)}):c.start=function(l){this.noteOn(l||0)},c.stop?(c.internal_stop=c.stop,c.stop=function(l){c.internal_stop(l||0)}):c.stop=function(l){this.noteOff(l||0)},c.setPeriodicWave||(c.setPeriodicWave=c.setWaveTable),u(c.frequency),u(c.detune),c})),window.hasOwnProperty("webkitOfflineAudioContext")&&!window.hasOwnProperty("OfflineAudioContext")&&(window.OfflineAudioContext=window.webkitOfflineAudioContext)})(),navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;var S=document.createElement("audio");p5.prototype.isSupported=function(){return!!S.canPlayType};var D=function(){return!!S.canPlayType&&S.canPlayType('audio/ogg; codecs="vorbis"')},v=function(){return!!S.canPlayType&&S.canPlayType("audio/mpeg;")},e=function(){return!!S.canPlayType&&S.canPlayType('audio/wav; codecs="1"')},n=function(){return!!S.canPlayType&&(S.canPlayType("audio/x-m4a;")||S.canPlayType("audio/aac;"))},i=function(){return!!S.canPlayType&&S.canPlayType("audio/x-aiff;")};p5.prototype.isFileSupported=function(u){switch(u.toLowerCase()){case"mp3":return v();case"wav":return e();case"ogg":return D();case"aac":case"m4a":case"mp4":return n();case"aif":case"aiff":return i();default:return!1}}},function(F,V){var S;S=function(){return this}();try{S=S||new Function("return this")()}catch{typeof window=="object"&&(S=window)}F.exports=S},function(F,V,S){S.r(V),V.default=`function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _wrapNativeSuper(Class) { var _cache = typeof Map === "function" ? new Map() : undefined; _wrapNativeSuper = function _wrapNativeSuper(Class) { if (Class === null || !_isNativeFunction(Class)) return Class; if (typeof Class !== "function") { throw new TypeError("Super expression must either be null or a function"); } if (typeof _cache !== "undefined") { if (_cache.has(Class)) return _cache.get(Class); _cache.set(Class, Wrapper); } function Wrapper() { return _construct(Class, arguments, _getPrototypeOf(this).constructor); } Wrapper.prototype = Object.create(Class.prototype, { constructor: { value: Wrapper, enumerable: false, writable: true, configurable: true } }); return _setPrototypeOf(Wrapper, Class); }; return _wrapNativeSuper(Class); }

function isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function _construct(Parent, args, Class) { if (isNativeReflectConstruct()) { _construct = Reflect.construct; } else { _construct = function _construct(Parent, args, Class) { var a = [null]; a.push.apply(a, args); var Constructor = Function.bind.apply(Parent, a); var instance = new Constructor(); if (Class) _setPrototypeOf(instance, Class.prototype); return instance; }; } return _construct.apply(null, arguments); }

function _isNativeFunction(fn) { return Function.toString.call(fn).indexOf("[native code]") !== -1; }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

// import dependencies via preval.require so that they're available as values at compile time
var processorNames = {
  "recorderProcessor": "recorder-processor",
  "soundFileProcessor": "sound-file-processor",
  "amplitudeProcessor": "amplitude-processor"
};
var RingBuffer = {
  "default":
  /*#__PURE__*/
  function () {
    /**
     * @constructor
     * @param  {number} length Buffer length in frames.
     * @param  {number} channelCount Buffer channel count.
     */
    function RingBuffer(length, channelCount) {
      _classCallCheck(this, RingBuffer);

      this._readIndex = 0;
      this._writeIndex = 0;
      this._framesAvailable = 0;
      this._channelCount = channelCount;
      this._length = length;
      this._channelData = [];

      for (var i = 0; i < this._channelCount; ++i) {
        this._channelData[i] = new Float32Array(length);
      }
    }
    /**
     * Getter for Available frames in buffer.
     *
     * @return {number} Available frames in buffer.
     */


    _createClass(RingBuffer, [{
      key: "push",

      /**
       * Push a sequence of Float32Arrays to buffer.
       *
       * @param  {array} arraySequence A sequence of Float32Arrays.
       */
      value: function push(arraySequence) {
        // The channel count of arraySequence and the length of each channel must
        // match with this buffer obejct.
        // Transfer data from the |arraySequence| storage to the internal buffer.
        var sourceLength = arraySequence[0] ? arraySequence[0].length : 0;

        for (var i = 0; i < sourceLength; ++i) {
          var writeIndex = (this._writeIndex + i) % this._length;

          for (var channel = 0; channel < this._channelCount; ++channel) {
            this._channelData[channel][writeIndex] = arraySequence[channel][i];
          }
        }

        this._writeIndex += sourceLength;

        if (this._writeIndex >= this._length) {
          this._writeIndex = 0;
        } // For excessive frames, the buffer will be overwritten.


        this._framesAvailable += sourceLength;

        if (this._framesAvailable > this._length) {
          this._framesAvailable = this._length;
        }
      }
      /**
       * Pull data out of buffer and fill a given sequence of Float32Arrays.
       *
       * @param  {array} arraySequence An array of Float32Arrays.
       */

    }, {
      key: "pull",
      value: function pull(arraySequence) {
        // The channel count of arraySequence and the length of each channel must
        // match with this buffer obejct.
        // If the FIFO is completely empty, do nothing.
        if (this._framesAvailable === 0) {
          return;
        }

        var destinationLength = arraySequence[0].length; // Transfer data from the internal buffer to the |arraySequence| storage.

        for (var i = 0; i < destinationLength; ++i) {
          var readIndex = (this._readIndex + i) % this._length;

          for (var channel = 0; channel < this._channelCount; ++channel) {
            arraySequence[channel][i] = this._channelData[channel][readIndex];
          }
        }

        this._readIndex += destinationLength;

        if (this._readIndex >= this._length) {
          this._readIndex = 0;
        }

        this._framesAvailable -= destinationLength;

        if (this._framesAvailable < 0) {
          this._framesAvailable = 0;
        }
      }
    }, {
      key: "framesAvailable",
      get: function get() {
        return this._framesAvailable;
      }
    }]);

    return RingBuffer;
  }()
}["default"];

var RecorderProcessor =
/*#__PURE__*/
function (_AudioWorkletProcesso) {
  _inherits(RecorderProcessor, _AudioWorkletProcesso);

  function RecorderProcessor(options) {
    var _this;

    _classCallCheck(this, RecorderProcessor);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(RecorderProcessor).call(this));
    var processorOptions = options.processorOptions || {};
    _this.numOutputChannels = options.outputChannelCount || 2;
    _this.numInputChannels = processorOptions.numInputChannels || 2;
    _this.bufferSize = processorOptions.bufferSize || 1024;
    _this.recording = false;

    _this.clear();

    _this.port.onmessage = function (event) {
      var data = event.data;

      if (data.name === 'start') {
        _this.record(data.duration);
      } else if (data.name === 'stop') {
        _this.stop();
      }
    };

    return _this;
  }

  _createClass(RecorderProcessor, [{
    key: "process",
    value: function process(inputs) {
      if (!this.recording) {
        return true;
      } else if (this.sampleLimit && this.recordedSamples >= this.sampleLimit) {
        this.stop();
        return true;
      }

      var input = inputs[0];
      this.inputRingBuffer.push(input);

      if (this.inputRingBuffer.framesAvailable >= this.bufferSize) {
        this.inputRingBuffer.pull(this.inputRingBufferArraySequence);

        for (var channel = 0; channel < this.numOutputChannels; ++channel) {
          var inputChannelCopy = this.inputRingBufferArraySequence[channel].slice();

          if (channel === 0) {
            this.leftBuffers.push(inputChannelCopy);

            if (this.numInputChannels === 1) {
              this.rightBuffers.push(inputChannelCopy);
            }
          } else if (channel === 1 && this.numInputChannels > 1) {
            this.rightBuffers.push(inputChannelCopy);
          }
        }

        this.recordedSamples += this.bufferSize;
      }

      return true;
    }
  }, {
    key: "record",
    value: function record(duration) {
      if (duration) {
        this.sampleLimit = Math.round(duration * sampleRate);
      }

      this.recording = true;
    }
  }, {
    key: "stop",
    value: function stop() {
      this.recording = false;
      var buffers = this.getBuffers();
      var leftBuffer = buffers[0].buffer;
      var rightBuffer = buffers[1].buffer;
      this.port.postMessage({
        name: 'buffers',
        leftBuffer: leftBuffer,
        rightBuffer: rightBuffer
      }, [leftBuffer, rightBuffer]);
      this.clear();
    }
  }, {
    key: "getBuffers",
    value: function getBuffers() {
      var buffers = [];
      buffers.push(this.mergeBuffers(this.leftBuffers));
      buffers.push(this.mergeBuffers(this.rightBuffers));
      return buffers;
    }
  }, {
    key: "mergeBuffers",
    value: function mergeBuffers(channelBuffer) {
      var result = new Float32Array(this.recordedSamples);
      var offset = 0;
      var lng = channelBuffer.length;

      for (var i = 0; i < lng; i++) {
        var buffer = channelBuffer[i];
        result.set(buffer, offset);
        offset += buffer.length;
      }

      return result;
    }
  }, {
    key: "clear",
    value: function clear() {
      var _this2 = this;

      this.leftBuffers = [];
      this.rightBuffers = [];
      this.inputRingBuffer = new RingBuffer(this.bufferSize, this.numInputChannels);
      this.inputRingBufferArraySequence = new Array(this.numInputChannels).fill(null).map(function () {
        return new Float32Array(_this2.bufferSize);
      });
      this.recordedSamples = 0;
      this.sampleLimit = null;
    }
  }]);

  return RecorderProcessor;
}(_wrapNativeSuper(AudioWorkletProcessor));

registerProcessor(processorNames.recorderProcessor, RecorderProcessor);`},function(F,V,S){S.r(V),V.default=`function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _wrapNativeSuper(Class) { var _cache = typeof Map === "function" ? new Map() : undefined; _wrapNativeSuper = function _wrapNativeSuper(Class) { if (Class === null || !_isNativeFunction(Class)) return Class; if (typeof Class !== "function") { throw new TypeError("Super expression must either be null or a function"); } if (typeof _cache !== "undefined") { if (_cache.has(Class)) return _cache.get(Class); _cache.set(Class, Wrapper); } function Wrapper() { return _construct(Class, arguments, _getPrototypeOf(this).constructor); } Wrapper.prototype = Object.create(Class.prototype, { constructor: { value: Wrapper, enumerable: false, writable: true, configurable: true } }); return _setPrototypeOf(Wrapper, Class); }; return _wrapNativeSuper(Class); }

function isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function _construct(Parent, args, Class) { if (isNativeReflectConstruct()) { _construct = Reflect.construct; } else { _construct = function _construct(Parent, args, Class) { var a = [null]; a.push.apply(a, args); var Constructor = Function.bind.apply(Parent, a); var instance = new Constructor(); if (Class) _setPrototypeOf(instance, Class.prototype); return instance; }; } return _construct.apply(null, arguments); }

function _isNativeFunction(fn) { return Function.toString.call(fn).indexOf("[native code]") !== -1; }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

// import dependencies via preval.require so that they're available as values at compile time
var processorNames = {
  "recorderProcessor": "recorder-processor",
  "soundFileProcessor": "sound-file-processor",
  "amplitudeProcessor": "amplitude-processor"
};
var RingBuffer = {
  "default":
  /*#__PURE__*/
  function () {
    /**
     * @constructor
     * @param  {number} length Buffer length in frames.
     * @param  {number} channelCount Buffer channel count.
     */
    function RingBuffer(length, channelCount) {
      _classCallCheck(this, RingBuffer);

      this._readIndex = 0;
      this._writeIndex = 0;
      this._framesAvailable = 0;
      this._channelCount = channelCount;
      this._length = length;
      this._channelData = [];

      for (var i = 0; i < this._channelCount; ++i) {
        this._channelData[i] = new Float32Array(length);
      }
    }
    /**
     * Getter for Available frames in buffer.
     *
     * @return {number} Available frames in buffer.
     */


    _createClass(RingBuffer, [{
      key: "push",

      /**
       * Push a sequence of Float32Arrays to buffer.
       *
       * @param  {array} arraySequence A sequence of Float32Arrays.
       */
      value: function push(arraySequence) {
        // The channel count of arraySequence and the length of each channel must
        // match with this buffer obejct.
        // Transfer data from the |arraySequence| storage to the internal buffer.
        var sourceLength = arraySequence[0] ? arraySequence[0].length : 0;

        for (var i = 0; i < sourceLength; ++i) {
          var writeIndex = (this._writeIndex + i) % this._length;

          for (var channel = 0; channel < this._channelCount; ++channel) {
            this._channelData[channel][writeIndex] = arraySequence[channel][i];
          }
        }

        this._writeIndex += sourceLength;

        if (this._writeIndex >= this._length) {
          this._writeIndex = 0;
        } // For excessive frames, the buffer will be overwritten.


        this._framesAvailable += sourceLength;

        if (this._framesAvailable > this._length) {
          this._framesAvailable = this._length;
        }
      }
      /**
       * Pull data out of buffer and fill a given sequence of Float32Arrays.
       *
       * @param  {array} arraySequence An array of Float32Arrays.
       */

    }, {
      key: "pull",
      value: function pull(arraySequence) {
        // The channel count of arraySequence and the length of each channel must
        // match with this buffer obejct.
        // If the FIFO is completely empty, do nothing.
        if (this._framesAvailable === 0) {
          return;
        }

        var destinationLength = arraySequence[0].length; // Transfer data from the internal buffer to the |arraySequence| storage.

        for (var i = 0; i < destinationLength; ++i) {
          var readIndex = (this._readIndex + i) % this._length;

          for (var channel = 0; channel < this._channelCount; ++channel) {
            arraySequence[channel][i] = this._channelData[channel][readIndex];
          }
        }

        this._readIndex += destinationLength;

        if (this._readIndex >= this._length) {
          this._readIndex = 0;
        }

        this._framesAvailable -= destinationLength;

        if (this._framesAvailable < 0) {
          this._framesAvailable = 0;
        }
      }
    }, {
      key: "framesAvailable",
      get: function get() {
        return this._framesAvailable;
      }
    }]);

    return RingBuffer;
  }()
}["default"];

var SoundFileProcessor =
/*#__PURE__*/
function (_AudioWorkletProcesso) {
  _inherits(SoundFileProcessor, _AudioWorkletProcesso);

  function SoundFileProcessor(options) {
    var _this;

    _classCallCheck(this, SoundFileProcessor);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(SoundFileProcessor).call(this));
    var processorOptions = options.processorOptions || {};
    _this.bufferSize = processorOptions.bufferSize || 256;
    _this.inputRingBuffer = new RingBuffer(_this.bufferSize, 1);
    _this.inputRingBufferArraySequence = [new Float32Array(_this.bufferSize)];
    return _this;
  }

  _createClass(SoundFileProcessor, [{
    key: "process",
    value: function process(inputs) {
      var input = inputs[0]; // we only care about the first input channel, because that contains the position data

      this.inputRingBuffer.push([input[0]]);

      if (this.inputRingBuffer.framesAvailable >= this.bufferSize) {
        this.inputRingBuffer.pull(this.inputRingBufferArraySequence);
        var inputChannel = this.inputRingBufferArraySequence[0];
        var position = inputChannel[inputChannel.length - 1] || 0;
        this.port.postMessage({
          name: 'position',
          position: position
        });
      }

      return true;
    }
  }]);

  return SoundFileProcessor;
}(_wrapNativeSuper(AudioWorkletProcessor));

registerProcessor(processorNames.soundFileProcessor, SoundFileProcessor);`},function(F,V,S){S.r(V),V.default=`function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _wrapNativeSuper(Class) { var _cache = typeof Map === "function" ? new Map() : undefined; _wrapNativeSuper = function _wrapNativeSuper(Class) { if (Class === null || !_isNativeFunction(Class)) return Class; if (typeof Class !== "function") { throw new TypeError("Super expression must either be null or a function"); } if (typeof _cache !== "undefined") { if (_cache.has(Class)) return _cache.get(Class); _cache.set(Class, Wrapper); } function Wrapper() { return _construct(Class, arguments, _getPrototypeOf(this).constructor); } Wrapper.prototype = Object.create(Class.prototype, { constructor: { value: Wrapper, enumerable: false, writable: true, configurable: true } }); return _setPrototypeOf(Wrapper, Class); }; return _wrapNativeSuper(Class); }

function isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function _construct(Parent, args, Class) { if (isNativeReflectConstruct()) { _construct = Reflect.construct; } else { _construct = function _construct(Parent, args, Class) { var a = [null]; a.push.apply(a, args); var Constructor = Function.bind.apply(Parent, a); var instance = new Constructor(); if (Class) _setPrototypeOf(instance, Class.prototype); return instance; }; } return _construct.apply(null, arguments); }

function _isNativeFunction(fn) { return Function.toString.call(fn).indexOf("[native code]") !== -1; }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

// import dependencies via preval.require so that they're available as values at compile time
var processorNames = {
  "recorderProcessor": "recorder-processor",
  "soundFileProcessor": "sound-file-processor",
  "amplitudeProcessor": "amplitude-processor"
};
var RingBuffer = {
  "default":
  /*#__PURE__*/
  function () {
    /**
     * @constructor
     * @param  {number} length Buffer length in frames.
     * @param  {number} channelCount Buffer channel count.
     */
    function RingBuffer(length, channelCount) {
      _classCallCheck(this, RingBuffer);

      this._readIndex = 0;
      this._writeIndex = 0;
      this._framesAvailable = 0;
      this._channelCount = channelCount;
      this._length = length;
      this._channelData = [];

      for (var i = 0; i < this._channelCount; ++i) {
        this._channelData[i] = new Float32Array(length);
      }
    }
    /**
     * Getter for Available frames in buffer.
     *
     * @return {number} Available frames in buffer.
     */


    _createClass(RingBuffer, [{
      key: "push",

      /**
       * Push a sequence of Float32Arrays to buffer.
       *
       * @param  {array} arraySequence A sequence of Float32Arrays.
       */
      value: function push(arraySequence) {
        // The channel count of arraySequence and the length of each channel must
        // match with this buffer obejct.
        // Transfer data from the |arraySequence| storage to the internal buffer.
        var sourceLength = arraySequence[0] ? arraySequence[0].length : 0;

        for (var i = 0; i < sourceLength; ++i) {
          var writeIndex = (this._writeIndex + i) % this._length;

          for (var channel = 0; channel < this._channelCount; ++channel) {
            this._channelData[channel][writeIndex] = arraySequence[channel][i];
          }
        }

        this._writeIndex += sourceLength;

        if (this._writeIndex >= this._length) {
          this._writeIndex = 0;
        } // For excessive frames, the buffer will be overwritten.


        this._framesAvailable += sourceLength;

        if (this._framesAvailable > this._length) {
          this._framesAvailable = this._length;
        }
      }
      /**
       * Pull data out of buffer and fill a given sequence of Float32Arrays.
       *
       * @param  {array} arraySequence An array of Float32Arrays.
       */

    }, {
      key: "pull",
      value: function pull(arraySequence) {
        // The channel count of arraySequence and the length of each channel must
        // match with this buffer obejct.
        // If the FIFO is completely empty, do nothing.
        if (this._framesAvailable === 0) {
          return;
        }

        var destinationLength = arraySequence[0].length; // Transfer data from the internal buffer to the |arraySequence| storage.

        for (var i = 0; i < destinationLength; ++i) {
          var readIndex = (this._readIndex + i) % this._length;

          for (var channel = 0; channel < this._channelCount; ++channel) {
            arraySequence[channel][i] = this._channelData[channel][readIndex];
          }
        }

        this._readIndex += destinationLength;

        if (this._readIndex >= this._length) {
          this._readIndex = 0;
        }

        this._framesAvailable -= destinationLength;

        if (this._framesAvailable < 0) {
          this._framesAvailable = 0;
        }
      }
    }, {
      key: "framesAvailable",
      get: function get() {
        return this._framesAvailable;
      }
    }]);

    return RingBuffer;
  }()
}["default"];

var AmplitudeProcessor =
/*#__PURE__*/
function (_AudioWorkletProcesso) {
  _inherits(AmplitudeProcessor, _AudioWorkletProcesso);

  function AmplitudeProcessor(options) {
    var _this;

    _classCallCheck(this, AmplitudeProcessor);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(AmplitudeProcessor).call(this));
    var processorOptions = options.processorOptions || {};
    _this.numOutputChannels = options.outputChannelCount || 1;
    _this.numInputChannels = processorOptions.numInputChannels || 2;
    _this.normalize = processorOptions.normalize || false;
    _this.smoothing = processorOptions.smoothing || 0;
    _this.bufferSize = processorOptions.bufferSize || 2048;
    _this.inputRingBuffer = new RingBuffer(_this.bufferSize, _this.numInputChannels);
    _this.outputRingBuffer = new RingBuffer(_this.bufferSize, _this.numOutputChannels);
    _this.inputRingBufferArraySequence = new Array(_this.numInputChannels).fill(null).map(function () {
      return new Float32Array(_this.bufferSize);
    });
    _this.stereoVol = [0, 0];
    _this.stereoVolNorm = [0, 0];
    _this.volMax = 0.001;

    _this.port.onmessage = function (event) {
      var data = event.data;

      if (data.name === 'toggleNormalize') {
        _this.normalize = data.normalize;
      } else if (data.name === 'smoothing') {
        _this.smoothing = Math.max(0, Math.min(1, data.smoothing));
      }
    };

    return _this;
  } // TO DO make this stereo / dependent on # of audio channels


  _createClass(AmplitudeProcessor, [{
    key: "process",
    value: function process(inputs, outputs) {
      var input = inputs[0];
      var output = outputs[0];
      var smoothing = this.smoothing;
      this.inputRingBuffer.push(input);

      if (this.inputRingBuffer.framesAvailable >= this.bufferSize) {
        this.inputRingBuffer.pull(this.inputRingBufferArraySequence);

        for (var channel = 0; channel < this.numInputChannels; ++channel) {
          var inputBuffer = this.inputRingBufferArraySequence[channel];
          var bufLength = inputBuffer.length;
          var sum = 0;

          for (var i = 0; i < bufLength; i++) {
            var x = inputBuffer[i];

            if (this.normalize) {
              sum += Math.max(Math.min(x / this.volMax, 1), -1) * Math.max(Math.min(x / this.volMax, 1), -1);
            } else {
              sum += x * x;
            }
          } // ... then take the square root of the sum.


          var rms = Math.sqrt(sum / bufLength);
          this.stereoVol[channel] = Math.max(rms, this.stereoVol[channel] * smoothing);
          this.volMax = Math.max(this.stereoVol[channel], this.volMax);
        } // calculate stero normalized volume and add volume from all channels together


        var volSum = 0;

        for (var index = 0; index < this.stereoVol.length; index++) {
          this.stereoVolNorm[index] = Math.max(Math.min(this.stereoVol[index] / this.volMax, 1), 0);
          volSum += this.stereoVol[index];
        } // volume is average of channels


        var volume = volSum / this.stereoVol.length; // normalized value

        var volNorm = Math.max(Math.min(volume / this.volMax, 1), 0);
        this.port.postMessage({
          name: 'amplitude',
          volume: volume,
          volNorm: volNorm,
          stereoVol: this.stereoVol,
          stereoVolNorm: this.stereoVolNorm
        }); // pass input through to output

        this.outputRingBuffer.push(this.inputRingBufferArraySequence);
      } // pull 128 frames out of the ring buffer
      // if the ring buffer does not have enough frames, the output will be silent


      this.outputRingBuffer.pull(output);
      return true;
    }
  }]);

  return AmplitudeProcessor;
}(_wrapNativeSuper(AudioWorkletProcessor));

registerProcessor(processorNames.amplitudeProcessor, AmplitudeProcessor);`},function(F,V,S){var D,v;D=[S(0),S(17)],v=(function(e){e.Frequency=function(u,c){if(!(this instanceof e.Frequency))return new e.Frequency(u,c);e.TimeBase.call(this,u,c)},e.extend(e.Frequency,e.TimeBase),e.Frequency.prototype._primaryExpressions=Object.create(e.TimeBase.prototype._primaryExpressions),e.Frequency.prototype._primaryExpressions.midi={regexp:/^(\d+(?:\.\d+)?midi)/,method:function(u){return this.midiToFrequency(u)}},e.Frequency.prototype._primaryExpressions.note={regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method:function(u,c){var l=n[u.toLowerCase()]+12*(parseInt(c)+1);return this.midiToFrequency(l)}},e.Frequency.prototype._primaryExpressions.tr={regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method:function(u,c,l){var d=1;return u&&u!=="0"&&(d*=this._beatsToUnits(this._timeSignature()*parseFloat(u))),c&&c!=="0"&&(d*=this._beatsToUnits(parseFloat(c))),l&&l!=="0"&&(d*=this._beatsToUnits(parseFloat(l)/4)),d}},e.Frequency.prototype.transpose=function(u){return this._expr=(function(c,l){return c()*this.intervalToFrequencyRatio(l)}).bind(this,this._expr,u),this},e.Frequency.prototype.harmonize=function(u){return this._expr=(function(c,l){for(var d=c(),h=[],a=0;a<l.length;a++)h[a]=d*this.intervalToFrequencyRatio(l[a]);return h}).bind(this,this._expr,u),this},e.Frequency.prototype.toMidi=function(){return this.frequencyToMidi(this.valueOf())},e.Frequency.prototype.toNote=function(){var u=this.valueOf(),c=Math.log(u/e.Frequency.A4)/Math.LN2,l=Math.round(12*c)+57,d=Math.floor(l/12);return d<0&&(l+=-12*d),i[l%12]+d.toString()},e.Frequency.prototype.toSeconds=function(){return 1/this.valueOf()},e.Frequency.prototype.toFrequency=function(){return this.valueOf()},e.Frequency.prototype.toTicks=function(){var u=this._beatsToUnits(1),c=this.valueOf()/u;return Math.floor(c*e.Transport.PPQ)},e.Frequency.prototype._frequencyToUnits=function(u){return u},e.Frequency.prototype._ticksToUnits=function(u){return 1/(60*u/(e.Transport.bpm.value*e.Transport.PPQ))},e.Frequency.prototype._beatsToUnits=function(u){return 1/e.TimeBase.prototype._beatsToUnits.call(this,u)},e.Frequency.prototype._secondsToUnits=function(u){return 1/u},e.Frequency.prototype._defaultUnits="hz";var n={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},i=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];return e.Frequency.A4=440,e.Frequency.prototype.midiToFrequency=function(u){return e.Frequency.A4*Math.pow(2,(u-69)/12)},e.Frequency.prototype.frequencyToMidi=function(u){return 69+12*Math.log(u/e.Frequency.A4)/Math.LN2},e.Frequency}).apply(V,D),v!==void 0&&(F.exports=v)},function(F,V,S){var D,v;D=[S(0),S(16)],v=(function(e){return e.TransportTime=function(n,i){if(!(this instanceof e.TransportTime))return new e.TransportTime(n,i);e.Time.call(this,n,i)},e.extend(e.TransportTime,e.Time),e.TransportTime.prototype._unaryExpressions=Object.create(e.Time.prototype._unaryExpressions),e.TransportTime.prototype._unaryExpressions.quantize={regexp:/^@/,method:function(n){var i=this._secondsToTicks(n()),u=Math.ceil(e.Transport.ticks/i);return this._ticksToUnits(u*i)}},e.TransportTime.prototype._secondsToTicks=function(n){var i=n/this._beatsToUnits(1);return Math.round(i*e.Transport.PPQ)},e.TransportTime.prototype.valueOf=function(){return this._secondsToTicks(this._expr())+(this._plusNow?e.Transport.ticks:0)},e.TransportTime.prototype.toTicks=function(){return this.valueOf()},e.TransportTime.prototype.toSeconds=function(){return this._expr()+(this._plusNow?e.Transport.seconds:0)},e.TransportTime.prototype.toFrequency=function(){return 1/this.toSeconds()},e.TransportTime}).apply(V,D),v!==void 0&&(F.exports=v)},function(F,V,S){var D,v;D=[S(0),S(4),S(13),S(1),S(33),S(21),S(34),S(20),S(35),S(36),S(37)],v=(function(e){function n(l,d,h){var a=new l;return h._eval(d[0]).connect(a,0,0),h._eval(d[1]).connect(a,0,1),a}function i(l,d,h){var a=new l;return h._eval(d[0]).connect(a,0,0),a}function u(l){return l?parseFloat(l):void 0}function c(l){return l&&l.args?parseFloat(l.args):void 0}return e.Expr=function(){var l=this._replacements(Array.prototype.slice.call(arguments)),d=this._parseInputs(l);this._nodes=[],this.input=new Array(d);for(var h=0;h<d;h++)this.input[h]=this.context.createGain();var a,y=this._parseTree(l);try{a=this._eval(y)}catch{throw this._disposeNodes(),new Error("Tone.Expr: Could evaluate expression: "+l)}this.output=a},e.extend(e.Expr,e.SignalBase),e.Expr._Expressions={value:{signal:{regexp:/^\d+\.\d+|^\d+/,method:function(l){return new e.Signal(u(l))}},input:{regexp:/^\$\d/,method:function(l,d){return d.input[u(l.substr(1))]}}},glue:{"(":{regexp:/^\(/},")":{regexp:/^\)/},",":{regexp:/^,/}},func:{abs:{regexp:/^abs/,method:i.bind(this,e.Abs)},mod:{regexp:/^mod/,method:function(l,d){var h=c(l[1]),a=new e.Modulo(h);return d._eval(l[0]).connect(a),a}},pow:{regexp:/^pow/,method:function(l,d){var h=c(l[1]),a=new e.Pow(h);return d._eval(l[0]).connect(a),a}},a2g:{regexp:/^a2g/,method:function(l,d){var h=new e.AudioToGain;return d._eval(l[0]).connect(h),h}}},binary:{"+":{regexp:/^\+/,precedence:1,method:n.bind(this,e.Add)},"-":{regexp:/^\-/,precedence:1,method:function(l,d){return l.length===1?i(e.Negate,l,d):n(e.Subtract,l,d)}},"*":{regexp:/^\*/,precedence:0,method:n.bind(this,e.Multiply)}},unary:{"-":{regexp:/^\-/,method:i.bind(this,e.Negate)},"!":{regexp:/^\!/,method:i.bind(this,e.NOT)}}},e.Expr.prototype._parseInputs=function(l){var d=l.match(/\$\d/g),h=0;if(d!==null)for(var a=0;a<d.length;a++){var y=parseInt(d[a].substr(1))+1;h=Math.max(h,y)}return h},e.Expr.prototype._replacements=function(l){for(var d=l.shift(),h=0;h<l.length;h++)d=d.replace(/\%/i,l[h]);return d},e.Expr.prototype._tokenize=function(l){for(var d=-1,h=[];0<l.length;){var a=y(l=l.trim());h.push(a),l=l.substr(a.value.length)}function y(m){for(var x in e.Expr._Expressions){var T=e.Expr._Expressions[x];for(var P in T){var E=T[P],B=E.regexp,_=m.match(B);if(_!==null)return{type:x,value:_[0],method:E.method}}}throw new SyntaxError("Tone.Expr: Unexpected token "+m)}return{next:function(){return h[++d]},peek:function(){return h[d+1]}}},e.Expr.prototype._parseTree=function(l){var d=this._tokenize(l),h=this.isUndef.bind(this);function a(T,P){return!h(T)&&T.type==="glue"&&T.value===P}function y(T,P,E){var B=e.Expr._Expressions[P];if(!h(T))for(var _ in B){var w=B[_];if(w.regexp.test(T.value)&&(h(E)||w.precedence===E))return!0}return!1}function m(T){var P;h(T)&&(T=5),P=T<0?function B(){var _,w;return _=d.peek(),y(_,"unary")?(_=d.next(),w=B(),{operator:_.value,method:_.method,args:[w]}):x()}():m(T-1);for(var E=d.peek();y(E,"binary",T);)P={operator:(E=d.next()).value,method:E.method,args:[P,m(T-1)]},E=d.peek();return P}function x(){var T,P;if(T=d.peek(),h(T))throw new SyntaxError("Tone.Expr: Unexpected termination of expression");if(T.type==="func")return function(E){var B=[];if(!a(d.next(),"("))throw new SyntaxError('Tone.Expr: Expected ( in a function call "'+E.value+'"');if(a(d.peek(),")")||(B=function(){for(var _,w=[];_=m(),!h(_)&&(w.push(_),a(d.peek(),","));)d.next();return w}()),a(d.next(),")"))return{method:E.method,args:B,name};throw new SyntaxError('Tone.Expr: Expected ) in a function call "'+E.value+'"')}(T=d.next());if(T.type==="value")return{method:(T=d.next()).method,args:T.value};if(a(T,"(")){if(d.next(),P=m(),!a(T=d.next(),")"))throw new SyntaxError("Expected )");return P}throw new SyntaxError("Tone.Expr: Parse error, cannot process token "+T.value)}return m()},e.Expr.prototype._eval=function(l){if(!this.isUndef(l)){var d=l.method(l.args,this);return this._nodes.push(d),d}},e.Expr.prototype._disposeNodes=function(){for(var l=0;l<this._nodes.length;l++){var d=this._nodes[l];this.isFunction(d.dispose)?d.dispose():this.isFunction(d.disconnect)&&d.disconnect(),d=null,this._nodes[l]=null}this._nodes=null},e.Expr.prototype.dispose=function(){e.prototype.dispose.call(this),this._disposeNodes()},e.Expr}).apply(V,D),v!==void 0&&(F.exports=v)},function(F,V,S){var D,v;D=[S(0),S(21),S(13),S(2)],v=(function(e){return e.GreaterThan=function(n){this.createInsOuts(2,0),this._param=this.input[0]=new e.Subtract(n),this.input[1]=this._param.input[1],this._gtz=this.output=new e.GreaterThanZero,this._param.connect(this._gtz)},e.extend(e.GreaterThan,e.Signal),e.GreaterThan.prototype.dispose=function(){return e.prototype.dispose.call(this),this._param.dispose(),this._param=null,this._gtz.dispose(),this._gtz=null,this},e.GreaterThan}).apply(V,D),v!==void 0&&(F.exports=v)},function(F,V,S){var D,v;D=[S(0),S(6),S(15)],v=(function(e){return e.Abs=function(){this._abs=this.input=this.output=new e.WaveShaper(function(n){return n===0?0:Math.abs(n)},127)},e.extend(e.Abs,e.SignalBase),e.Abs.prototype.dispose=function(){return e.prototype.dispose.call(this),this._abs.dispose(),this._abs=null,this},e.Abs}).apply(V,D),v!==void 0&&(F.exports=v)},function(F,V,S){var D,v;D=[S(0),S(6),S(1),S(13)],v=(function(e){return e.Modulo=function(n){this.createInsOuts(1,0),this._shaper=new e.WaveShaper(Math.pow(2,16)),this._multiply=new e.Multiply,this._subtract=this.output=new e.Subtract,this._modSignal=new e.Signal(n),this.input.fan(this._shaper,this._subtract),this._modSignal.connect(this._multiply,0,0),this._shaper.connect(this._multiply,0,1),this._multiply.connect(this._subtract,0,1),this._setWaveShaper(n)},e.extend(e.Modulo,e.SignalBase),e.Modulo.prototype._setWaveShaper=function(n){this._shaper.setMap(function(i){return Math.floor((i+1e-4)/n)})},Object.defineProperty(e.Modulo.prototype,"value",{get:function(){return this._modSignal.value},set:function(n){this._modSignal.value=n,this._setWaveShaper(n)}}),e.Modulo.prototype.dispose=function(){return e.prototype.dispose.call(this),this._shaper.dispose(),this._shaper=null,this._multiply.dispose(),this._multiply=null,this._subtract.dispose(),this._subtract=null,this._modSignal.dispose(),this._modSignal=null,this},e.Modulo}).apply(V,D),v!==void 0&&(F.exports=v)},function(F,V,S){var D,v;D=[S(0),S(6)],v=(function(e){return e.Pow=function(n){this._exp=this.defaultArg(n,1),this._expScaler=this.input=this.output=new e.WaveShaper(this._expFunc(this._exp),8192)},e.extend(e.Pow,e.SignalBase),Object.defineProperty(e.Pow.prototype,"value",{get:function(){return this._exp},set:function(n){this._exp=n,this._expScaler.setMap(this._expFunc(this._exp))}}),e.Pow.prototype._expFunc=function(n){return function(i){return Math.pow(Math.abs(i),n)}},e.Pow.prototype.dispose=function(){return e.prototype.dispose.call(this),this._expScaler.dispose(),this._expScaler=null,this},e.Pow}).apply(V,D),v!==void 0&&(F.exports=v)},function(F,V,S){var D,v;D=[S(0),S(6),S(2)],v=(function(e){return e.AudioToGain=function(){this._norm=this.input=this.output=new e.WaveShaper(function(n){return(n+1)/2})},e.extend(e.AudioToGain,e.SignalBase),e.AudioToGain.prototype.dispose=function(){return e.prototype.dispose.call(this),this._norm.dispose(),this._norm=null,this},e.AudioToGain}).apply(V,D),v!==void 0&&(F.exports=v)},function(F,V,S){var D,v;D=[S(0),S(6)],v=(function(e){return e.EqualPowerGain=function(){this._eqPower=this.input=this.output=new e.WaveShaper((function(n){return Math.abs(n)<.001?0:this.equalPowerScale(n)}).bind(this),4096)},e.extend(e.EqualPowerGain,e.SignalBase),e.EqualPowerGain.prototype.dispose=function(){return e.prototype.dispose.call(this),this._eqPower.dispose(),this._eqPower=null,this},e.EqualPowerGain}).apply(V,D),v!==void 0&&(F.exports=v)},function(F,V,S){var D,v;D=[S(0),S(19),S(9)],v=(function(e){return e.TimelineState=function(n){e.Timeline.call(this),this._initial=n},e.extend(e.TimelineState,e.Timeline),e.TimelineState.prototype.getValueAtTime=function(n){var i=this.get(n);return i!==null?i.state:this._initial},e.TimelineState.prototype.setStateAtTime=function(n,i){this.add({state:n,time:i})},e.TimelineState}).apply(V,D),v!==void 0&&(F.exports=v)},function(F,V,S){S.r(V),S(24),S(25);var D=S(3);function v(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}var e=function s(){v(this,s),this.input=D.a.createGain(),this.output=D.a.createGain(),this.limiter=D.a.createDynamicsCompressor(),this.limiter.threshold.value=-3,this.limiter.ratio.value=20,this.limiter.knee.value=1,this.audiocontext=D.a,this.output.disconnect(),this.input.connect(this.limiter),this.limiter.connect(this.output),this.meter=D.a.createGain(),this.fftMeter=D.a.createGain(),this.output.connect(this.meter),this.output.connect(this.fftMeter),this.output.connect(this.audiocontext.destination),this.soundArray=[],this.parts=[],this.extensions=[]},n=new e;p5.prototype.getOutputVolume=function(){return n.output.gain.value},p5.prototype.outputVolume=function(s){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;if(typeof s=="number"){var o=n.audiocontext.currentTime,f=n.output.gain.value;n.output.gain.cancelScheduledValues(o+t),n.output.gain.linearRampToValueAtTime(f,o+t),n.output.gain.linearRampToValueAtTime(s,o+t+r)}else if(s)s.connect(n.output.gain);else return n.output.gain},p5.prototype.soundOut=p5.soundOut=n,p5.soundOut._silentNode=n.audiocontext.createGain(),p5.soundOut._silentNode.gain.value=0,p5.soundOut._silentNode.connect(n.audiocontext.destination);var i=n,u=S(5),c=S.n(u);function l(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?l=function(t){return typeof t}:l=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(s)}function d(){return i.audiocontext.sampleRate}function h(s){var r=Math.log(s/440)/Math.log(2),t=Math.round(12*r)+69;return t}function a(s){return 440*Math.pow(2,(s-69)/12)}function y(s){if(typeof s!="string")return s;var r={A:21,B:23,C:24,D:26,E:28,F:29,G:31},t=r[s[0].toUpperCase()],o=~~s.slice(-1);switch(t+=12*(o-1),s[1]){case"#":t+=1;break;case"b":t-=1;break}return a(t)}function m(){i.extensions=[];for(var s=0;s<arguments.length;s++)if(arguments[s]=arguments[s].toLowerCase(),["mp3","wav","ogg","m4a","aac"].indexOf(arguments[s])>-1)i.extensions.push(arguments[s]);else throw arguments[s]+" is not a valid sound format!"}function x(){for(var s=0;s<i.soundArray.length;s++)i.soundArray[s].dispose()}function T(s){var r;if(typeof s=="string"){r=s;var t=r.split(".").pop();if(["mp3","wav","ogg","m4a","aac"].indexOf(t)>-1){if(!p5.prototype.isFileSupported(t))for(var o=r.split("."),f=o[o.length-1],g=0;g<i.extensions.length;g++){var k=i.extensions[g],I=p5.prototype.isFileSupported(k);if(I){f="",o.length===2&&(f+=o[0]);for(var N=1;N<=o.length-2;N++){var G=o[N];f+="."+G}r=f+=".",r=r+=k;break}}}else for(var j=0;j<i.extensions.length;j++){var Z=i.extensions[j],ce=p5.prototype.isFileSupported(Z);if(ce){r=r+"."+Z;break}}}else if(l(s)==="object")for(var te=0;te<s.length;te++){var re=s[te].split(".").pop(),he=p5.prototype.isFileSupported(re);if(he){r=s[te];break}}return r}function P(s,r,t,o,f){for(var g in s.mathOps)s.mathOps[g]instanceof f&&(s.mathOps[g].dispose(),t=g,t<s.mathOps.length-1&&(o=s.mathOps[g+1]));return s.mathOps[t-1].disconnect(),s.mathOps[t-1].connect(r),r.connect(o),s.mathOps[t]=r,s}function E(s){var r,t;r=s.getChannelData(0),s.numberOfChannels>1?t=s.getChannelData(1):t=r;var o=B(r,t),f=new window.ArrayBuffer(44+o.length*2),g=new window.DataView(f);_(g,0,"RIFF"),g.setUint32(4,36+o.length*2,!0),_(g,8,"WAVE"),_(g,12,"fmt "),g.setUint32(16,16,!0),g.setUint16(20,1,!0),g.setUint16(22,2,!0),g.setUint32(24,i.audiocontext.sampleRate,!0),g.setUint32(28,i.audiocontext.sampleRate*4,!0),g.setUint16(32,4,!0),g.setUint16(34,16,!0),_(g,36,"data"),g.setUint32(40,o.length*2,!0);for(var k=o.length,I=44,N=1,G=0;G<k;G++)g.setInt16(I,o[G]*(32767*N),!0),I+=2;return g}function B(s,r){for(var t=s.length+r.length,o=new Float32Array(t),f=0,g=0;g<t;)o[g++]=s[f],o[g++]=r[f],f++;return o}function _(s,r,t){for(var o=t.length,f=0;f<o;f++)s.setUint8(r+f,t.charCodeAt(f))}function w(s){var r=s,t=new AudioWorkletNode(i.audiocontext,c.a.soundFileProcessor);return t instanceof ScriptProcessorNode&&(r=t.bufferSize),t.disconnect(),t=null,r}function A(s,r){var t=E(s.buffer);p5.prototype.writeFile([t],r,"wav")}var b=function(r,t,o){var f=new Error,g,k;return f.name=r,f.originalStack=f.stack+t,g=f.stack+t,f.failedPath=o,k=g.split(`
`).filter(function(I){return!I.match(/(p5.|native code|globalInit)/g)}),f.stack=k.join(`
`),f},O=b,C=[S(27).default,S(28).default,S(29).default],M=i.audiocontext,R=!1;function L(){return Promise.all(C.map(function(s){var r=new Blob([s],{type:"application/javascript"}),t=URL.createObjectURL(r);return M.audioWorklet.addModule(t)}))}p5.prototype.registerMethod("init",function(){if(!R){!this.preload&&!window.preload&&(this.preload=function(){}),this._incrementPreload();var s=(function(){R=!0,this._decrementPreload()}).bind(this);L().then(s)}});function U(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function W(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function z(s,r,t){return r&&W(s.prototype,r),s}var q=i.audiocontext,Y;if(typeof q.createStereoPanner<"u"){var K=function(){function s(r,t){U(this,s),this.stereoPanner=this.input=q.createStereoPanner(),r.connect(this.stereoPanner),this.stereoPanner.connect(t)}return z(s,[{key:"pan",value:function(t,o){var f=o||0,g=q.currentTime+f;this.stereoPanner.pan.linearRampToValueAtTime(t,g)}},{key:"inputChannels",value:function(){}},{key:"connect",value:function(t){this.stereoPanner.connect(t)}},{key:"disconnect",value:function(){this.stereoPanner&&this.stereoPanner.disconnect()}}]),s}();Y=K}else{var X=function(){function s(r,t,o){U(this,s),this.input=q.createGain(),r.connect(this.input),this.left=q.createGain(),this.right=q.createGain(),this.left.channelInterpretation="discrete",this.right.channelInterpretation="discrete",o>1?(this.splitter=q.createChannelSplitter(2),this.input.connect(this.splitter),this.splitter.connect(this.left,1),this.splitter.connect(this.right,0)):(this.input.connect(this.left),this.input.connect(this.right)),this.output=q.createChannelMerger(2),this.left.connect(this.output,0,1),this.right.connect(this.output,0,0),this.output.connect(t)}return z(s,[{key:"pan",value:function(t,o){var f=o||0,g=q.currentTime+f,k=(t+1)/2,I=Math.cos(k*Math.PI/2),N=Math.sin(k*Math.PI/2);this.left.gain.linearRampToValueAtTime(N,g),this.right.gain.linearRampToValueAtTime(I,g)}},{key:"inputChannels",value:function(t){t===1?(this.input.disconnect(),this.input.connect(this.left),this.input.connect(this.right)):t===2&&(typeof this.splitter>"u"&&(this.splitter=q.createChannelSplitter(2)),this.input.disconnect(),this.input.connect(this.splitter),this.splitter.connect(this.left,1),this.splitter.connect(this.right,0))}},{key:"connect",value:function(t){this.output.connect(t)}},{key:"disconnect",value:function(){this.output&&this.output.disconnect()}}]),s}();Y=X}var $=Y;function Q(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Q=function(t){return typeof t}:Q=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Q(s)}function ee(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function fe(s,r,t){return r&&ee(s.prototype,r),s}function ie(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}var H=i.audiocontext,oe=function(r){for(var t=r.length,o=H.createBuffer(1,r.length,H.sampleRate),f=o.getChannelData(0),g=0;g<t;g++)f[g]=g;return o},J=function s(r,t,o,f){ie(this,s),this.callback=r,this.time=t,this.id=o,this.val=f};function ve(s){var r=s.target,t=this;r._playing=!1,r.removeEventListener("ended",t._clearOnEnd),t._onended(t),t.bufferSourceNodes.map(function(o,f){return f}).reverse().forEach(function(o){var f=t.bufferSourceNodes[o];f._playing===!1&&t.bufferSourceNodes.splice(o,1)}),t.bufferSourceNodes.length===0&&(t._playing=!1)}var se=function(){function s(r,t,o,f){if(ie(this,s),typeof r<"u"){if(typeof r=="string"||typeof r[0]=="string"){var g=p5.prototype._checkFileFormats(r);this.url=g}else if(Q(r)==="object"&&!(window.File&&window.FileReader&&window.FileList&&window.Blob))throw"Unable to load file because the File API is not supported";r.file&&(r=r.file),this.file=r}this._onended=function(){},this._looping=!1,this._playing=!1,this._paused=!1,this._pauseTime=0,this._cues=[],this._cueIDCounter=0,this._lastPos=0,this._counterNode=null,this._workletNode=null,this.bufferSourceNodes=[],this.bufferSourceNode=null,this.buffer=null,this.playbackRate=1,this.input=i.audiocontext.createGain(),this.output=i.audiocontext.createGain(),this.reversed=!1,this.startTime=0,this.endTime=null,this.pauseTime=0,this.mode="sustain",this.startMillis=null,this.panPosition=0,this.panner=new $(this.output,i.input,2),(this.url||this.file)&&this.load(t,o),i.soundArray.push(this),typeof f=="function"?this._whileLoading=f:this._whileLoading=function(){},this._clearOnEnd=ve.bind(this),this.amp=this.setVolume,this.fade=this.setVolume}return fe(s,[{key:"load",value:function(t,o){var f=this,g=new Error().stack;if(this.url!==void 0&&this.url!==""){var k=new XMLHttpRequest;k.addEventListener("progress",function(N){f._updateProgress(N)},!1),k.open("GET",this.url,!0),k.responseType="arraybuffer",k.onload=function(){if(k.status===200){if(!f.panner)return;H.decodeAudioData(k.response,function(j){f.panner&&(f.buffer=j,f.panner.inputChannels(j.numberOfChannels),t&&t(f))},function(){if(f.panner){var j=new O("decodeAudioData",g,f.url),Z="AudioContext error at decodeAudioData for "+f.url;o?(j.msg=Z,o(j)):console.error(Z+`
 The error stack trace includes: 
`+j.stack)}})}else{if(!f.panner)return;var N=new O("loadSound",g,f.url),G="Unable to load "+f.url+". The request status was: "+k.status+" ("+k.statusText+")";o?(N.message=G,o(N)):console.error(G+`
 The error stack trace includes: 
`+N.stack)}},k.onerror=function(){var N=new O("loadSound",g,f.url),G="There was no response from the server at "+f.url+". Check the url and internet connectivity.";o?(N.message=G,o(N)):console.error(G+`
 The error stack trace includes: 
`+N.stack)},k.send()}else if(this.file!==void 0){var I=new FileReader;I.onload=function(){f.panner&&H.decodeAudioData(I.result,function(N){f.panner&&(f.buffer=N,f.panner.inputChannels(N.numberOfChannels),t&&t(f))})},I.onerror=function(N){f.panner&&onerror&&onerror(N)},I.readAsArrayBuffer(this.file)}}},{key:"_updateProgress",value:function(t){if(t.lengthComputable){var o=t.loaded/t.total*.99;this._whileLoading(o,t)}else this._whileLoading("size unknown")}},{key:"isLoaded",value:function(){return!!this.buffer}},{key:"play",value:function(t,o,f,g,k){if(!this.output){console.warn("SoundFile.play() called after dispose");return}var I=i.audiocontext.currentTime,N,G,j=t||0;if(j<0&&(j=0),j=j+I,typeof o<"u"&&this.rate(o),typeof f<"u"&&this.setVolume(f),this.buffer){if(this._pauseTime=0,this.mode==="restart"&&this.buffer&&this.bufferSourceNode&&(this.bufferSourceNode.stop(j),this._counterNode.stop(j)),this.mode==="untildone"&&this.isPlaying())return;if(this.bufferSourceNode=this._initSourceNode(),delete this._counterNode,this._counterNode=this._initCounterNode(),g)if(g>=0&&g<this.buffer.duration)N=g;else throw"start time out of range";else N=0;k&&(k=k<=this.buffer.duration-N?k:this.buffer.duration),this._paused?(this.bufferSourceNode.start(j,this.pauseTime,k),this._counterNode.start(j,this.pauseTime,k)):(this.bufferSourceNode.start(j,N,k),this._counterNode.start(j,N,k)),this._playing=!0,this._paused=!1,this.bufferSourceNodes.push(this.bufferSourceNode),this.bufferSourceNode._arrayIndex=this.bufferSourceNodes.length-1,this.bufferSourceNode.addEventListener("ended",this._clearOnEnd)}else throw"not ready to play file, buffer has yet to load. Try preload()";this.bufferSourceNode.loop=this._looping,this._counterNode.loop=this._looping,this._looping===!0&&(G=k||N-1e-15,this.bufferSourceNode.loopStart=N,this.bufferSourceNode.loopEnd=G,this._counterNode.loopStart=N,this._counterNode.loopEnd=G)}},{key:"playMode",value:function(t){var o=t.toLowerCase();if(o==="restart"&&this.buffer&&this.bufferSourceNode)for(var f=0;f<this.bufferSourceNodes.length-1;f++){var g=i.audiocontext.currentTime;this.bufferSourceNodes[f].stop(g)}if(o==="restart"||o==="sustain"||o==="untildone")this.mode=o;else throw'Invalid play mode. Must be either "restart" or "sustain"'}},{key:"pause",value:function(t){var o=i.audiocontext.currentTime,f=t||0,g=f+o;this.isPlaying()&&this.buffer&&this.bufferSourceNode?(this._paused=!0,this._playing=!1,this.pauseTime=this.currentTime(),this.bufferSourceNode.stop(g),this._counterNode.stop(g),this._pauseTime=this.currentTime()):this._pauseTime=0}},{key:"loop",value:function(t,o,f,g,k){this._looping=!0,this.play(t,o,f,g,k)}},{key:"setLoop",value:function(t){if(t===!0)this._looping=!0;else if(t===!1)this._looping=!1;else throw"Error: setLoop accepts either true or false";this.bufferSourceNode&&(this.bufferSourceNode.loop=this._looping,this._counterNode.loop=this._looping)}},{key:"isLooping",value:function(){return this.bufferSourceNode?this._looping===!0&&this.isPlaying()===!0:!1}},{key:"isPlaying",value:function(){return this._playing}},{key:"isPaused",value:function(){return this._paused}},{key:"stop",value:function(t){var o=t||0;if(this.mode==="sustain"||this.mode==="untildone")this.stopAll(o),this._playing=!1,this.pauseTime=0,this._paused=!1;else if(this.buffer&&this.bufferSourceNode){var f=i.audiocontext.currentTime,g=o||0;this.pauseTime=0,this.bufferSourceNode.stop(f+g),this._counterNode.stop(f+g),this._playing=!1,this._paused=!1}}},{key:"stopAll",value:function(t){var o=i.audiocontext.currentTime,f=t||0;if(this.buffer&&this.bufferSourceNode){for(var g in this.bufferSourceNodes){var k=this.bufferSourceNodes[g];if(k)try{k.stop(o+f)}catch{}}this._counterNode.stop(o+f)}}},{key:"getVolume",value:function(){return this.output.gain.value}},{key:"pan",value:function(t,o){this.panPosition=t,this.panner.pan(t,o)}},{key:"getPan",value:function(){return this.panPosition}},{key:"rate",value:function(t){var o=!1;if(typeof t>"u")return this.playbackRate;if(this.playbackRate=t,t===0?t=1e-13:t<0&&!this.reversed?(t=Math.abs(t),o=!0):t>0&&this.reversed&&(o=!0),this.bufferSourceNode){var f=i.audiocontext.currentTime;this.bufferSourceNode.playbackRate.cancelScheduledValues(f),this.bufferSourceNode.playbackRate.linearRampToValueAtTime(Math.abs(t),f),this._counterNode.playbackRate.cancelScheduledValues(f),this._counterNode.playbackRate.linearRampToValueAtTime(Math.abs(t),f)}return o&&this.reverseBuffer(),this.playbackRate}},{key:"setPitch",value:function(t){var o=a(t)/a(60);this.rate(o)}},{key:"getPlaybackRate",value:function(){return this.playbackRate}},{key:"setVolume",value:function(t,o,f){if(typeof t=="number"){var g=o||0,k=f||0,I=i.audiocontext.currentTime,N=this.output.gain.value;this.output.gain.cancelScheduledValues(I+k),this.output.gain.linearRampToValueAtTime(N,I+k),this.output.gain.linearRampToValueAtTime(t,I+k+g)}else if(t)t.connect(this.output.gain);else return this.output.gain}},{key:"duration",value:function(){return this.buffer?this.buffer.duration:0}},{key:"currentTime",value:function(){return this.reversed?Math.abs(this._lastPos-this.buffer.length)/H.sampleRate:this._lastPos/H.sampleRate}},{key:"jump",value:function(t,o){if(t<0||t>this.buffer.duration)throw"jump time out of range";if(o>this.buffer.duration-t)throw"end time out of range";var f=t||0,g=o||void 0;this.isPlaying()&&(this.stop(0),this.play(0,this.playbackRate,this.output.gain.value,f,g))}},{key:"channels",value:function(){return this.buffer.numberOfChannels}},{key:"sampleRate",value:function(){return this.buffer.sampleRate}},{key:"frames",value:function(){return this.buffer.length}},{key:"getPeaks",value:function(t){if(this.buffer){if(t||(t=window.width*5),this.buffer){for(var o=this.buffer,f=o.length/t,g=~~(f/10)||1,k=o.numberOfChannels,I=new Float32Array(Math.round(t)),N=0;N<k;N++)for(var G=o.getChannelData(N),j=0;j<t;j++){for(var Z=~~(j*f),ce=~~(Z+f),te=0,re=Z;re<ce;re+=g){var he=G[re];(he>te||-he>te)&&(te=he)}(N===0||Math.abs(te)>I[j])&&(I[j]=te)}return I}}else throw"Cannot load peaks yet, buffer is not loaded"}},{key:"reverseBuffer",value:function(){if(this.buffer){var t=this._lastPos/H.sampleRate,o=this.getVolume();this.setVolume(0,.001);for(var f=this.buffer.numberOfChannels,g=0;g<f;g++)this.buffer.getChannelData(g).reverse();this.reversed=!this.reversed,this.isPlaying()&&t&&this.jump(this.duration()-t),this.setVolume(o,.001)}else throw"SoundFile is not done loading"}},{key:"onended",value:function(t){return this._onended=t,this}},{key:"add",value:function(){}},{key:"dispose",value:function(){var t=i.audiocontext.currentTime,o=i.soundArray.indexOf(this);if(i.soundArray.splice(o,1),this.stop(t),this.buffer&&this.bufferSourceNode){for(var f=0;f<this.bufferSourceNodes.length-1;f++)if(this.bufferSourceNodes[f]!==null){this.bufferSourceNodes[f].disconnect();try{this.bufferSourceNodes[f].stop(t)}catch{console.warn("no buffer source node to dispose")}this.bufferSourceNodes[f]=null}if(this.isPlaying()){try{this._counterNode.stop(t)}catch(g){console.log(g)}this._counterNode=null}}this.output&&(this.output.disconnect(),this.output=null),this.panner&&(this.panner.disconnect(),this.panner=null)}},{key:"connect",value:function(t){t?t.hasOwnProperty("input")?this.panner.connect(t.input):this.panner.connect(t):this.panner.connect(i.input)}},{key:"disconnect",value:function(){this.panner&&this.panner.disconnect()}},{key:"getLevel",value:function(){console.warn("p5.SoundFile.getLevel has been removed from the library. Use p5.Amplitude instead")}},{key:"setPath",value:function(t,o){var f=p5.prototype._checkFileFormats(t);this.url=f,this.load(o)}},{key:"setBuffer",value:function(t){var o=t.length,f=t[0].length,g=H.createBuffer(o,f,H.sampleRate);t[0]instanceof Float32Array||(t[0]=new Float32Array(t[0]));for(var k=0;k<o;k++){var I=g.getChannelData(k);I.set(t[k])}this.buffer=g,this.panner.inputChannels(o)}},{key:"_initCounterNode",value:function(){var t=this,o=this,f=H.currentTime,g=H.createBufferSource(),k=w(256);return o._workletNode&&(o._workletNode.disconnect(),delete o._workletNode),o._workletNode=new AudioWorkletNode(H,c.a.soundFileProcessor,{processorOptions:{bufferSize:k}}),o._workletNode.port.onmessage=function(I){if(I.data.name==="position"){if(I.data.position===0)return;t._lastPos=I.data.position,t._onTimeUpdate(o._lastPos)}},g.buffer=oe(o.buffer),g.playbackRate.setValueAtTime(o.playbackRate,f),g.connect(o._workletNode),o._workletNode.connect(p5.soundOut._silentNode),g}},{key:"_initSourceNode",value:function(){var t=H.createBufferSource();return t.buffer=this.buffer,t.playbackRate.value=this.playbackRate,t.connect(this.output),t}},{key:"processPeaks",value:function(t,o,f,g){console.warn("processPeaks is deprecated")}},{key:"addCue",value:function(t,o,f){var g=this._cueIDCounter++,k=new J(o,t,g,f);return this._cues.push(k),g}},{key:"removeCue",value:function(t){for(var o=this._cues.length,f=0;f<o;f++){var g=this._cues[f];if(g.id===t){this._cues.splice(f,1);break}}this._cues.length}},{key:"clearCues",value:function(){this._cues=[]}},{key:"_onTimeUpdate",value:function(t){for(var o=t/this.buffer.sampleRate,f=this._cues.length,g=0;g<f;g++){var k=this._cues[g],I=k.time,N=k.val,G=this._prevUpdateTime||0,j=o;G<=I&&I<=j&&k.callback(N)}this._prevUpdateTime=o}},{key:"save",value:function(t){p5.prototype.saveSound(this,t,"wav")}},{key:"getBlob",value:function(){var t=E(this.buffer);return new Blob([t],{type:"audio/wav"})}}]),s}();function ae(s,r,t,o){window.location.origin.indexOf("file://")>-1&&window.cordova==="undefined"&&window.alert("This sketch may require a server to load external files. Please see http://bit.ly/1qcInwS");var f=this,g=new se(s,function(){typeof r=="function"&&r.apply(f,arguments),typeof f._decrementPreload=="function"&&f._decrementPreload()},t,o);return g}var ne=se;function _t(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function Tt(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function St(s,r,t){return r&&Tt(s.prototype,r),s}var Ie=function(){function s(r){_t(this,s),this.bufferSize=w(2048),this.audiocontext=i.audiocontext,this._workletNode=new AudioWorkletNode(this.audiocontext,c.a.amplitudeProcessor,{outputChannelCount:[1],parameterData:{smoothing:r||0},processorOptions:{normalize:!1,smoothing:r||0,numInputChannels:2,bufferSize:this.bufferSize}}),this._workletNode.port.onmessage=(function(t){t.data.name==="amplitude"&&(this.volume=t.data.volume,this.volNorm=t.data.volNorm,this.stereoVol=t.data.stereoVol,this.stereoVolNorm=t.data.stereoVolNorm)}).bind(this),this.input=this._workletNode,this.output=this.audiocontext.createGain(),this.volume=0,this.volNorm=0,this.stereoVol=[0,0],this.stereoVolNorm=[0,0],this.normalize=!1,this._workletNode.connect(this.output),this.output.gain.value=0,this.output.connect(this.audiocontext.destination),i.meter.connect(this._workletNode),i.soundArray.push(this)}return St(s,[{key:"setInput",value:function(t,o){i.meter.disconnect(),o&&(this._workletNode.parameters.get("smoothing").value=o),t==null?(console.log("Amplitude input source is not ready! Connecting to main output instead"),i.meter.connect(this._workletNode)):t?(t.connect(this._workletNode),this._workletNode.disconnect(),this._workletNode.connect(this.output)):i.meter.connect(this._workletNode)}},{key:"connect",value:function(t){t?t.hasOwnProperty("input")?this.output.connect(t.input):this.output.connect(t):this.output.connect(this.panner.connect(i.input))}},{key:"disconnect",value:function(){this.output&&this.output.disconnect()}},{key:"getLevel",value:function(t){return typeof t<"u"?this.normalize?this.stereoVolNorm[t]:this.stereoVol[t]:this.normalize?this.volNorm:this.volume}},{key:"toggleNormalize",value:function(t){typeof t=="boolean"?this.normalize=t:this.normalize=!this.normalize,this._workletNode.port.postMessage({name:"toggleNormalize",normalize:this.normalize})}},{key:"smooth",value:function(t){t>=0&&t<1?this._workletNode.port.postMessage({name:"smoothing",smoothing:t}):console.log("Error: smoothing must be between 0 and 1")}},{key:"dispose",value:function(){var t=i.soundArray.indexOf(this);i.soundArray.splice(t,1),this.input&&(this.input.disconnect(),delete this.input),this.output&&(this.output.disconnect(),delete this.output),this._workletNode.disconnect(),delete this._workletNode}}]),s}(),be=Ie;function Pe(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function ue(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function Ne(s,r,t){return r&&ue(s.prototype,r),s}var Ae=function(){function s(r,t){Pe(this,s),this.input=this.analyser=i.audiocontext.createAnalyser(),Object.defineProperties(this,{bins:{get:function(){return this.analyser.fftSize/2},set:function(f){this.analyser.fftSize=f*2},configurable:!0,enumerable:!0},smoothing:{get:function(){return this.analyser.smoothingTimeConstant},set:function(f){this.analyser.smoothingTimeConstant=f},configurable:!0,enumerable:!0}}),this.smooth(r),this.bins=t||1024,i.fftMeter.connect(this.analyser),this.freqDomain=new Uint8Array(this.analyser.frequencyBinCount),this.timeDomain=new Uint8Array(this.analyser.frequencyBinCount),this.bass=[20,140],this.lowMid=[140,400],this.mid=[400,2600],this.highMid=[2600,5200],this.treble=[5200,14e3],i.soundArray.push(this)}return Ne(s,[{key:"setInput",value:function(t){t?(t.output?t.output.connect(this.analyser):t.connect&&t.connect(this.analyser),i.fftMeter.disconnect()):i.fftMeter.connect(this.analyser)}},{key:"waveform",value:function(){for(var t,o,f=new Array,g=0;g<arguments.length;g++)typeof arguments[g]=="number"&&(t=arguments[g],this.analyser.fftSize=t*2),typeof arguments[g]=="string"&&(o=arguments[g]);if(o&&!p5.prototype._isSafari())return Ue(this,this.timeDomain),this.analyser.getFloatTimeDomainData(this.timeDomain),this.timeDomain;We(this,this.timeDomain),this.analyser.getByteTimeDomainData(this.timeDomain);for(var k=0;k<this.timeDomain.length;k++){var I=p5.prototype.map(this.timeDomain[k],0,255,-1,1);f.push(I)}return f}},{key:"analyze",value:function(){for(var t,o=0;o<arguments.length;o++)typeof arguments[o]=="number"&&(this.bins=arguments[o],this.analyser.fftSize=this.bins*2),typeof arguments[o]=="string"&&(t=arguments[o]);if(t&&t.toLowerCase()==="db")return Le(this),this.analyser.getFloatFrequencyData(this.freqDomain),this.freqDomain;Ve(this,this.freqDomain),this.analyser.getByteFrequencyData(this.freqDomain);var f=Array.apply([],this.freqDomain);return f}},{key:"getEnergy",value:function(t,o){var f=i.audiocontext.sampleRate/2;if(t==="bass"?(t=this.bass[0],o=this.bass[1]):t==="lowMid"?(t=this.lowMid[0],o=this.lowMid[1]):t==="mid"?(t=this.mid[0],o=this.mid[1]):t==="highMid"?(t=this.highMid[0],o=this.highMid[1]):t==="treble"&&(t=this.treble[0],o=this.treble[1]),typeof t!="number")throw"invalid input for getEnergy()";if(o)if(t&&o){if(t>o){var k=o;o=t,t=k}for(var I=Math.round(t/f*this.freqDomain.length),N=Math.round(o/f*this.freqDomain.length),G=0,j=0,Z=I;Z<=N;Z++)G+=this.freqDomain[Z],j+=1;var ce=G/j;return ce}else throw"invalid input for getEnergy()";else{var g=Math.round(t/f*this.freqDomain.length);return this.freqDomain[g]}}},{key:"getFreq",value:function(t,o){console.log("getFreq() is deprecated. Please use getEnergy() instead.");var f=this.getEnergy(t,o);return f}},{key:"getCentroid",value:function(){for(var t=i.audiocontext.sampleRate/2,o=0,f=0,g=0;g<this.freqDomain.length;g++)o+=g*this.freqDomain[g],f+=this.freqDomain[g];var k=0;f!==0&&(k=o/f);var I=k*(t/this.freqDomain.length);return I}},{key:"smooth",value:function(t){return typeof t<"u"&&(this.smoothing=t),this.smoothing}},{key:"dispose",value:function(){var t=i.soundArray.indexOf(this);i.soundArray.splice(t,1),this.analyser&&(this.analyser.disconnect(),delete this.analyser)}},{key:"linAverages",value:function(t){for(var o=t||16,f=this.freqDomain,g=f.length,k=Math.floor(g/o),I=new Array(o),N=0,G=0;G<g;G++)I[N]=I[N]!==void 0?(I[N]+f[G])/2:f[G],G%k===k-1&&N++;return I}},{key:"logAverages",value:function(t){for(var o=i.audiocontext.sampleRate/2,f=this.freqDomain,g=f.length,k=new Array(t.length),I=0,N=0;N<g;N++){var G=Math.round(N*o/this.freqDomain.length);G>t[I].hi&&I++,k[I]=k[I]!==void 0?(k[I]+f[N])/2:f[N]}return k}},{key:"getOctaveBands",value:function(t,o){var f=t||3,g=o||15.625,k=[],I={lo:g/Math.pow(2,1/(2*f)),ctr:g,hi:g*Math.pow(2,1/(2*f))};k.push(I);for(var N=i.audiocontext.sampleRate/2;I.hi<N;){var G={};G.lo=I.hi,G.ctr=I.ctr*Math.pow(2,1/f),G.hi=G.ctr*Math.pow(2,1/(2*f)),k.push(G),I=G}return k}}]),s}();function Le(s){s.freqDomain instanceof Float32Array||(s.freqDomain=new Float32Array(s.analyser.frequencyBinCount))}function Ve(s){s.freqDomain instanceof Uint8Array||(s.freqDomain=new Uint8Array(s.analyser.frequencyBinCount))}function Ue(s){s.timeDomain instanceof Float32Array||(s.timeDomain=new Float32Array(s.analyser.frequencyBinCount))}function We(s){s.timeDomain instanceof Uint8Array||(s.timeDomain=new Uint8Array(s.analyser.frequencyBinCount))}var _e=Ae,wt=S(4),Te=S.n(wt),Se=S(1),le=S.n(Se),Sn=S(8),qe=S.n(Sn);function Ge(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Ge=function(t){return typeof t}:Ge=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ge(s)}function je(s,r){return r&&(Ge(r)==="object"||typeof r=="function")?r:wn(s)}function wn(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function we(s){return we=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},we(s)}function ze(s,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),r&&bt(s,r)}function bt(s,r){return bt=Object.setPrototypeOf||function(o,f){return o.__proto__=f,o},bt(s,r)}function Ce(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function bn(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function Pn(s,r,t){return r&&bn(s.prototype,r),s}function Pt(s,r,t,o,f){var g=s.oscillator;for(var k in s.mathOps)s.mathOps[k]instanceof f&&(g.disconnect(),s.mathOps[k].dispose(),t=k,t<s.mathOps.length-2&&(o=s.mathOps[k+1]));return t===s.mathOps.length-1&&s.mathOps.push(o),k>0&&(g=s.mathOps[k-1]),g.disconnect(),g.connect(r),r.connect(o),s.mathOps[t]=r,s}var Ee=function(){function s(r,t){if(Ce(this,s),typeof r=="string"){var o=t;t=r,r=o}if(typeof t=="number"){var f=t;t=r,r=f}this.started=!1,this.phaseAmount=void 0,this.oscillator=i.audiocontext.createOscillator(),this.f=r||440,this.oscillator.type=t||"sine",this.oscillator.frequency.setValueAtTime(this.f,i.audiocontext.currentTime),this.output=i.audiocontext.createGain(),this._freqMods=[],this.output.gain.value=.5,this.output.gain.setValueAtTime(.5,i.audiocontext.currentTime),this.oscillator.connect(this.output),this.panPosition=0,this.connection=i.input,this.panner=new $(this.output,this.connection,1),this.mathOps=[this.output],i.soundArray.push(this),this.fade=this.amp}return Pn(s,[{key:"start",value:function(t,o){if(this.started){var f=i.audiocontext.currentTime;this.stop(f)}if(!this.started){var g=o||this.f,k=this.oscillator.type;this.oscillator&&(this.oscillator.disconnect(),delete this.oscillator),this.oscillator=i.audiocontext.createOscillator(),this.oscillator.frequency.value=Math.abs(g),this.oscillator.type=k,this.oscillator.connect(this.output),t=t||0,this.oscillator.start(t+i.audiocontext.currentTime),this.freqNode=this.oscillator.frequency;for(var I in this._freqMods)typeof this._freqMods[I].connect<"u"&&this._freqMods[I].connect(this.oscillator.frequency);this.started=!0}}},{key:"stop",value:function(t){if(this.started){var o=t||0,f=i.audiocontext.currentTime;this.oscillator.stop(o+f),this.started=!1}}},{key:"amp",value:function(t){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;if(typeof t=="number"){var g=i.audiocontext.currentTime;this.output.gain.linearRampToValueAtTime(t,g+f+o)}else if(t)t.connect(this.output.gain);else return this.output.gain}},{key:"getAmp",value:function(){return this.output.gain.value}},{key:"freq",value:function(t){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;if(typeof t=="number"&&!isNaN(t)){this.f=t;var g=i.audiocontext.currentTime;o===0?this.oscillator.frequency.setValueAtTime(t,f+g):t>0?this.oscillator.frequency.exponentialRampToValueAtTime(t,f+o+g):this.oscillator.frequency.linearRampToValueAtTime(t,f+o+g),this.phaseAmount&&this.phase(this.phaseAmount)}else if(t)t.output&&(t=t.output),t.connect(this.oscillator.frequency),this._freqMods.push(t);else return this.oscillator.frequency}},{key:"getFreq",value:function(){return this.oscillator.frequency.value}},{key:"setType",value:function(t){this.oscillator.type=t}},{key:"getType",value:function(){return this.oscillator.type}},{key:"connect",value:function(t){t?t.hasOwnProperty("input")?(this.panner.connect(t.input),this.connection=t.input):(this.panner.connect(t),this.connection=t):this.panner.connect(i.input)}},{key:"disconnect",value:function(){this.output&&this.output.disconnect(),this.panner&&(this.panner.disconnect(),this.output&&this.output.connect(this.panner)),this.oscMods=[]}},{key:"pan",value:function(t,o){this.panPosition=t,this.panner.pan(t,o)}},{key:"getPan",value:function(){return this.panPosition}},{key:"dispose",value:function(){var t=i.soundArray.indexOf(this);if(i.soundArray.splice(t,1),this.oscillator){var o=i.audiocontext.currentTime;this.stop(o),this.disconnect(),this.panner=null,this.oscillator=null}this.osc2&&this.osc2.dispose()}},{key:"phase",value:function(t){var o=p5.prototype.map(t,0,1,0,1/this.f),f=i.audiocontext.currentTime;this.phaseAmount=t,this.dNode||(this.dNode=i.audiocontext.createDelay(),this.oscillator.disconnect(),this.oscillator.connect(this.dNode),this.dNode.connect(this.output)),this.dNode.delayTime.setValueAtTime(o,f)}},{key:"add",value:function(t){var o=new Te.a(t),f=this.mathOps.length-1,g=this.output;return Pt(this,o,f,g,Te.a)}},{key:"mult",value:function(t){var o=new le.a(t),f=this.mathOps.length-1,g=this.output;return Pt(this,o,f,g,le.a)}},{key:"scale",value:function(t,o,f,g){var k,I;arguments.length===4?(k=p5.prototype.map(f,t,o,0,1)-.5,I=p5.prototype.map(g,t,o,0,1)-.5):(k=arguments[0],I=arguments[1]);var N=new qe.a(k,I),G=this.mathOps.length-1,j=this.output;return Pt(this,N,G,j,qe.a)}}]),s}(),An=function(s){ze(r,s);function r(t){return Ce(this,r),je(this,we(r).call(this,t,"sine"))}return r}(Ee),Cn=function(s){ze(r,s);function r(t){return Ce(this,r),je(this,we(r).call(this,t,"triangle"))}return r}(Ee),Zt=function(s){ze(r,s);function r(t){return Ce(this,r),je(this,we(r).call(this,t,"sawtooth"))}return r}(Ee),En=function(s){ze(r,s);function r(t){return Ce(this,r),je(this,we(r).call(this,t,"square"))}return r}(Ee),He=Ee,kn=S(7),At=S.n(kn);p5.Envelope=function(s,r,t,o,f,g){this.aTime=s||.1,this.aLevel=r||1,this.dTime=t||.5,this.dLevel=o||0,this.rTime=f||0,this.rLevel=g||0,this._rampHighPercentage=.98,this._rampLowPercentage=.02,this.output=i.audiocontext.createGain(),this.control=new At.a,this._init(),this.control.connect(this.output),this.connection=null,this.mathOps=[this.control],this.isExponential=!1,this.sourceToClear=null,this.wasTriggered=!1,i.soundArray.push(this)},p5.Envelope.prototype._init=function(){var s=i.audiocontext.currentTime,r=s;this.control.setTargetAtTime(1e-5,r,.001),this._setRampAD(this.aTime,this.dTime)},p5.Envelope.prototype.set=function(s,r,t,o,f,g){this.aTime=s,this.aLevel=r,this.dTime=t||0,this.dLevel=o||0,this.rTime=f||0,this.rLevel=g||0,this._setRampAD(s,t)},p5.Envelope.prototype.setADSR=function(s,r,t,o){this.aTime=s,this.dTime=r||0,this.sPercent=t||0,this.dLevel=typeof t<"u"?t*(this.aLevel-this.rLevel)+this.rLevel:0,this.rTime=o||0,this._setRampAD(s,r)},p5.Envelope.prototype.setRange=function(s,r){this.aLevel=s||1,this.rLevel=r||0},p5.Envelope.prototype._setRampAD=function(s,r){this._rampAttackTime=this.checkExpInput(s),this._rampDecayTime=this.checkExpInput(r);var t=1;t=Math.log(1/this.checkExpInput(1-this._rampHighPercentage)),this._rampAttackTC=s/this.checkExpInput(t),t=Math.log(1/this._rampLowPercentage),this._rampDecayTC=r/this.checkExpInput(t)},p5.Envelope.prototype.setRampPercentages=function(s,r){this._rampHighPercentage=this.checkExpInput(s),this._rampLowPercentage=this.checkExpInput(r);var t=1;t=Math.log(1/this.checkExpInput(1-this._rampHighPercentage)),this._rampAttackTC=this._rampAttackTime/this.checkExpInput(t),t=Math.log(1/this._rampLowPercentage),this._rampDecayTC=this._rampDecayTime/this.checkExpInput(t)},p5.Envelope.prototype.setInput=function(){for(var s=0;s<arguments.length;s++)this.connect(arguments[s])},p5.Envelope.prototype.setExp=function(s){this.isExponential=s},p5.Envelope.prototype.checkExpInput=function(s){return s<=0&&(s=1e-8),s},p5.Envelope.prototype.play=function(s,r,t){var o=r||0;s&&this.connection!==s&&this.connect(s),this.triggerAttack(s,o),this.triggerRelease(s,o+this.aTime+this.dTime+~~t)},p5.Envelope.prototype.triggerAttack=function(s,r){var t=i.audiocontext.currentTime,o=r||0,f=t+o;this.lastAttack=f,this.wasTriggered=!0,s&&this.connection!==s&&this.connect(s);var g=this.control.getValueAtTime(f);this.isExponential===!0?this.control.exponentialRampToValueAtTime(this.checkExpInput(g),f):this.control.linearRampToValueAtTime(g,f),f+=this.aTime,this.isExponential===!0?(this.control.exponentialRampToValueAtTime(this.checkExpInput(this.aLevel),f),g=this.checkExpInput(this.control.getValueAtTime(f)),this.control.cancelScheduledValues(f),this.control.exponentialRampToValueAtTime(g,f)):(this.control.linearRampToValueAtTime(this.aLevel,f),g=this.control.getValueAtTime(f),this.control.cancelScheduledValues(f),this.control.linearRampToValueAtTime(g,f)),f+=this.dTime,this.isExponential===!0?(this.control.exponentialRampToValueAtTime(this.checkExpInput(this.dLevel),f),g=this.checkExpInput(this.control.getValueAtTime(f)),this.control.cancelScheduledValues(f),this.control.exponentialRampToValueAtTime(g,f)):(this.control.linearRampToValueAtTime(this.dLevel,f),g=this.control.getValueAtTime(f),this.control.cancelScheduledValues(f),this.control.linearRampToValueAtTime(g,f))},p5.Envelope.prototype.triggerRelease=function(s,r){if(this.wasTriggered){var t=i.audiocontext.currentTime,o=r||0,f=t+o;s&&this.connection!==s&&this.connect(s);var g=this.control.getValueAtTime(f);this.isExponential===!0?this.control.exponentialRampToValueAtTime(this.checkExpInput(g),f):this.control.linearRampToValueAtTime(g,f),f+=this.rTime,this.isExponential===!0?(this.control.exponentialRampToValueAtTime(this.checkExpInput(this.rLevel),f),g=this.checkExpInput(this.control.getValueAtTime(f)),this.control.cancelScheduledValues(f),this.control.exponentialRampToValueAtTime(g,f)):(this.control.linearRampToValueAtTime(this.rLevel,f),g=this.control.getValueAtTime(f),this.control.cancelScheduledValues(f),this.control.linearRampToValueAtTime(g,f)),this.wasTriggered=!1}},p5.Envelope.prototype.ramp=function(s,r,t,o){var f=i.audiocontext.currentTime,g=r||0,k=f+g,I=this.checkExpInput(t),N=typeof o<"u"?this.checkExpInput(o):void 0;s&&this.connection!==s&&this.connect(s);var G=this.checkExpInput(this.control.getValueAtTime(k));I>G?(this.control.setTargetAtTime(I,k,this._rampAttackTC),k+=this._rampAttackTime):I<G&&(this.control.setTargetAtTime(I,k,this._rampDecayTC),k+=this._rampDecayTime),N!==void 0&&(N>I?this.control.setTargetAtTime(N,k,this._rampAttackTC):N<I&&this.control.setTargetAtTime(N,k,this._rampDecayTC))},p5.Envelope.prototype.connect=function(s){this.connection=s,(s instanceof p5.Oscillator||s instanceof p5.SoundFile||s instanceof p5.AudioIn||s instanceof p5.Reverb||s instanceof p5.Noise||s instanceof p5.Filter||s instanceof p5.Delay)&&(s=s.output.gain),s instanceof AudioParam&&s.setValueAtTime(0,i.audiocontext.currentTime),this.output.connect(s)},p5.Envelope.prototype.disconnect=function(){this.output&&this.output.disconnect()},p5.Envelope.prototype.add=function(s){var r=new Te.a(s),t=this.mathOps.length,o=this.output;return p5.prototype._mathChain(this,r,t,o,Te.a)},p5.Envelope.prototype.mult=function(s){var r=new le.a(s),t=this.mathOps.length,o=this.output;return p5.prototype._mathChain(this,r,t,o,le.a)},p5.Envelope.prototype.scale=function(s,r,t,o){var f=new qe.a(s,r,t,o),g=this.mathOps.length,k=this.output;return p5.prototype._mathChain(this,f,g,k,qe.a)},p5.Envelope.prototype.dispose=function(){var s=i.soundArray.indexOf(this);i.soundArray.splice(s,1),this.disconnect(),this.control&&(this.control.dispose(),this.control=null);for(var r=1;r<this.mathOps.length;r++)this.mathOps[r].dispose()},p5.Env=function(s,r,t,o,f,g){console.warn("WARNING: p5.Env is now deprecated and may be removed in future versions. Please use the new p5.Envelope instead."),p5.Envelope.call(this,s,r,t,o,f,g)},p5.Env.prototype=Object.create(p5.Envelope.prototype);var On=p5.Envelope,Rn=On;function Ye(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Ye=function(t){return typeof t}:Ye=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ye(s)}function Mn(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function Bn(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function Dn(s,r,t){return r&&Bn(s.prototype,r),s}function Fn(s,r){return r&&(Ye(r)==="object"||typeof r=="function")?r:In(s)}function In(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function Ct(s){return Ct=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ct(s)}function Nn(s,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),r&&Et(s,r)}function Et(s,r){return Et=Object.setPrototypeOf||function(o,f){return o.__proto__=f,o},Et(s,r)}var kt=function(){for(var s=2*i.audiocontext.sampleRate,r=i.audiocontext.createBuffer(1,s,i.audiocontext.sampleRate),t=r.getChannelData(0),o=0;o<s;o++)t[o]=Math.random()*2-1;return r.type="white",r}(),Xt=function(){var s=2*i.audiocontext.sampleRate,r=i.audiocontext.createBuffer(1,s,i.audiocontext.sampleRate),t=r.getChannelData(0),o,f,g,k,I,N,G;o=f=g=k=I=N=G=0;for(var j=0;j<s;j++){var Z=Math.random()*2-1;o=.99886*o+Z*.0555179,f=.99332*f+Z*.0750759,g=.969*g+Z*.153852,k=.8665*k+Z*.3104856,I=.55*I+Z*.5329522,N=-.7616*N-Z*.016898,t[j]=o+f+g+k+I+N+G+Z*.5362,t[j]*=.11,G=Z*.115926}return r.type="pink",r}(),Qt=function(){for(var s=2*i.audiocontext.sampleRate,r=i.audiocontext.createBuffer(1,s,i.audiocontext.sampleRate),t=r.getChannelData(0),o=0,f=0;f<s;f++){var g=Math.random()*2-1;t[f]=(o+.02*g)/1.02,o=t[f],t[f]*=3.5}return r.type="brown",r}(),Ln=function(s){Nn(r,s);function r(t){var o;Mn(this,r),o=Fn(this,Ct(r).call(this));var f;return delete o.f,delete o.freq,delete o.oscillator,t==="brown"?f=Qt:t==="pink"?f=Xt:f=kt,o.buffer=f,o}return Dn(r,[{key:"setType",value:function(o){switch(o){case"white":this.buffer=kt;break;case"pink":this.buffer=Xt;break;case"brown":this.buffer=Qt;break;default:this.buffer=kt}if(this.started){var f=i.audiocontext.currentTime;this.stop(f),this.start(f+.01)}}},{key:"getType",value:function(){return this.buffer.type}},{key:"start",value:function(){this.started&&this.stop(),this.noise=i.audiocontext.createBufferSource(),this.noise.buffer=this.buffer,this.noise.loop=!0,this.noise.connect(this.output);var o=i.audiocontext.currentTime;this.noise.start(o),this.started=!0}},{key:"stop",value:function(){var o=i.audiocontext.currentTime;this.noise&&(this.noise.stop(o),this.started=!1)}},{key:"dispose",value:function(){var o=i.audiocontext.currentTime,f=i.soundArray.indexOf(this);i.soundArray.splice(f,1),this.noise&&(this.noise.disconnect(),this.stop(o)),this.output&&this.output.disconnect(),this.panner&&this.panner.disconnect(),this.output=null,this.panner=null,this.buffer=null,this.noise=null}}]),r}(He),Vn=Ln,Un=S(2),Wn=S.n(Un);function Ke(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Ke=function(t){return typeof t}:Ke=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ke(s)}function qn(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function Gn(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function jn(s,r,t){return r&&Gn(s.prototype,r),s}function zn(s,r){return r&&(Ke(r)==="object"||typeof r=="function")?r:Hn(s)}function Hn(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function Ot(s){return Ot=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ot(s)}function Yn(s,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),r&&Rt(s,r)}function Rt(s,r){return Rt=Object.setPrototypeOf||function(o,f){return o.__proto__=f,o},Rt(s,r)}var Kn=function(s){Yn(r,s);function r(t,o){var f;qn(this,r),f=zn(this,Ot(r).call(this,t,"sawtooth")),f.w=o||0,f.osc2=new Zt(t),f.dNode=i.audiocontext.createDelay(),f.dcOffset=$t(),f.dcGain=i.audiocontext.createGain(),f.dcOffset.connect(f.dcGain),f.dcGain.connect(f.output),f.f=t||440;var g=f.w/f.oscillator.frequency.value;return f.dNode.delayTime.value=g,f.dcGain.gain.value=1.7*(.5-f.w),f.osc2.disconnect(),f.osc2.panner.disconnect(),f.osc2.amp(-1),f.osc2.output.connect(f.dNode),f.dNode.connect(f.output),f.output.gain.value=1,f.output.connect(f.panner),f}return jn(r,[{key:"width",value:function(o){if(typeof o=="number"){if(o<=1&&o>=0){this.w=o;var f=this.w/this.oscillator.frequency.value;this.dNode.delayTime.value=f}this.dcGain.gain.value=1.7*(.5-this.w)}else{o.connect(this.dNode.delayTime);var g=new Wn.a(-.5);o.connect(g);var k=new le.a(-1),I=new le.a(1.7);g=g.connect(k).connect(I),g.connect(this.dcGain.gain)}}},{key:"start",value:function(o,f){var g=i.audiocontext.currentTime,k=f||0;if(!this.started){var I=o||this.f,N=this.oscillator.type;this.oscillator=i.audiocontext.createOscillator(),this.oscillator.frequency.setValueAtTime(I,g),this.oscillator.type=N,this.oscillator.connect(this.output),this.oscillator.start(k+g),this.osc2.oscillator=i.audiocontext.createOscillator(),this.osc2.oscillator.frequency.setValueAtTime(I,k+g),this.osc2.oscillator.type=N,this.osc2.oscillator.connect(this.osc2.output),this.osc2.start(k+g),this.freqNode=[this.oscillator.frequency,this.osc2.oscillator.frequency],this.dcOffset=$t(),this.dcOffset.connect(this.dcGain),this.dcOffset.start(k+g),this.mods!==void 0&&this.mods.frequency!==void 0&&(this.mods.frequency.connect(this.freqNode[0]),this.mods.frequency.connect(this.freqNode[1])),this.started=!0,this.osc2.started=!0}}},{key:"stop",value:function(o){if(this.started){var f=o||0,g=i.audiocontext.currentTime;this.oscillator.stop(f+g),this.osc2.oscillator&&this.osc2.oscillator.stop(f+g),this.dcOffset.stop(f+g),this.started=!1,this.osc2.started=!1}}},{key:"freq",value:function(o){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;if(typeof o=="number"){this.f=o;var k=i.audiocontext.currentTime,I=this.oscillator.frequency.value;this.oscillator.frequency.cancelScheduledValues(k),this.oscillator.frequency.setValueAtTime(I,k+g),this.oscillator.frequency.exponentialRampToValueAtTime(o,g+f+k),this.osc2.oscillator.frequency.cancelScheduledValues(k),this.osc2.oscillator.frequency.setValueAtTime(I,k+g),this.osc2.oscillator.frequency.exponentialRampToValueAtTime(o,g+f+k),this.freqMod&&(this.freqMod.output.disconnect(),this.freqMod=null)}else o.output&&(o.output.disconnect(),o.output.connect(this.oscillator.frequency),o.output.connect(this.osc2.oscillator.frequency),this.freqMod=o)}}]),r}(He);function $t(){for(var s=i.audiocontext,r=s.createBuffer(1,2048,s.sampleRate),t=r.getChannelData(0),o=0;o<2048;o++)t[o]=1;var f=s.createBufferSource();return f.buffer=r,f.loop=!0,f}var Zn=Kn;function Xn(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function Qn(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function $n(s,r,t){return r&&Qn(s.prototype,r),s}i.inputSources=[];var Jn=function(){function s(r){Xn(this,s),this.input=i.audiocontext.createGain(),this.output=i.audiocontext.createGain(),this.stream=null,this.mediaStream=null,this.currentSource=null,this.enabled=!1,this.amplitude=new be,this.output.connect(this.amplitude.input),(!window.MediaStreamTrack||!window.navigator.mediaDevices||!window.navigator.mediaDevices.getUserMedia)&&(r?r():window.alert("This browser does not support MediaStreamTrack and mediaDevices")),i.soundArray.push(this)}return $n(s,[{key:"start",value:function(t,o){var f=this;this.stream&&this.stop();var g=i.inputSources[f.currentSource],k={audio:{sampleRate:i.audiocontext.sampleRate,echoCancellation:!1}};i.inputSources[this.currentSource]&&(k.audio.deviceId=g.deviceId),window.navigator.mediaDevices.getUserMedia(k).then(function(I){f.stream=I,f.enabled=!0,f.mediaStream=i.audiocontext.createMediaStreamSource(I),f.mediaStream.connect(f.output),f.amplitude.setInput(f.output),t&&t()}).catch(function(I){o?o(I):console.error(I)})}},{key:"stop",value:function(){this.stream&&(this.stream.getTracks().forEach(function(t){t.stop()}),this.mediaStream.disconnect(),delete this.mediaStream,delete this.stream)}},{key:"connect",value:function(t){t?t.hasOwnProperty("input")?this.output.connect(t.input):t.hasOwnProperty("analyser")?this.output.connect(t.analyser):this.output.connect(t):this.output.connect(i.input)}},{key:"disconnect",value:function(){this.output&&(this.output.disconnect(),this.output.connect(this.amplitude.input))}},{key:"getLevel",value:function(t){return t&&(this.amplitude.smoothing=t),this.amplitude.getLevel()}},{key:"amp",value:function(t,o){if(o){var f=o||0,g=this.output.gain.value;this.output.gain.cancelScheduledValues(i.audiocontext.currentTime),this.output.gain.setValueAtTime(g,i.audiocontext.currentTime),this.output.gain.linearRampToValueAtTime(t,f+i.audiocontext.currentTime)}else this.output.gain.cancelScheduledValues(i.audiocontext.currentTime),this.output.gain.setValueAtTime(t,i.audiocontext.currentTime)}},{key:"getSources",value:function(t,o){return new Promise(function(f,g){window.navigator.mediaDevices.enumerateDevices().then(function(k){i.inputSources=k.filter(function(I){return I.kind==="audioinput"}),f(i.inputSources),t&&t(i.inputSources)}).catch(function(k){g(k),o?o(k):console.error("This browser does not support MediaStreamTrack.getSources()")})})}},{key:"setSource",value:function(t){i.inputSources.length>0&&t<i.inputSources.length?(this.currentSource=t,console.log("set source to ",i.inputSources[this.currentSource])):console.log("unable to set input source"),this.stream&&this.stream.active&&this.start()}},{key:"dispose",value:function(){var t=i.soundArray.indexOf(this);i.soundArray.splice(t,1),this.stop(),this.output&&this.output.disconnect(),this.amplitude&&this.amplitude.disconnect(),delete this.amplitude,delete this.output}}]),s}(),ei=Jn,ti=S(23),ni=S.n(ti);function ii(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function ri(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function oi(s,r,t){return r&&ri(s.prototype,r),s}var si=function(){function s(){ii(this,s),this.ac=i.audiocontext,this.input=this.ac.createGain(),this.output=this.ac.createGain(),this._drywet=new ni.a(1),this.wet=this.ac.createGain(),this.input.connect(this._drywet.a),this.wet.connect(this._drywet.b),this._drywet.connect(this.output),this.connect(),i.soundArray.push(this)}return oi(s,[{key:"amp",value:function(t){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,g=i.audiocontext.currentTime,k=g+f,I=k+o+.001,N=this.output.gain.value;this.output.gain.cancelScheduledValues(g),this.output.gain.linearRampToValueAtTime(N,k+.001),this.output.gain.linearRampToValueAtTime(t,I)}},{key:"chain",value:function(){if(arguments.length>0){this.connect(arguments[0]);for(var t=1;t<arguments.length;t+=1)arguments[t-1].connect(arguments[t])}return this}},{key:"drywet",value:function(t){return typeof t<"u"&&(this._drywet.fade.value=t),this._drywet.fade.value}},{key:"connect",value:function(t){var o=t||p5.soundOut.input;this.output.connect(o.input?o.input:o)}},{key:"disconnect",value:function(){this.output&&this.output.disconnect()}},{key:"dispose",value:function(){var t=i.soundArray.indexOf(this);i.soundArray.splice(t,1),this.input&&(this.input.disconnect(),delete this.input),this.output&&(this.output.disconnect(),delete this.output),this._drywet&&(this._drywet.disconnect(),delete this._drywet),this.wet&&(this.wet.disconnect(),delete this.wet),this.ac=void 0}}]),s}(),pe=si;function Ze(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Ze=function(t){return typeof t}:Ze=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ze(s)}function Xe(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function ai(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function ui(s,r,t){return r&&ai(s.prototype,r),s}function Qe(s,r){return r&&(Ze(r)==="object"||typeof r=="function")?r:li(s)}function li(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function $e(s,r,t){return typeof Reflect<"u"&&Reflect.get?$e=Reflect.get:$e=function(f,g,k){var I=ci(f,g);if(I){var N=Object.getOwnPropertyDescriptor(I,g);return N.get?N.get.call(k):N.value}},$e(s,r,t||s)}function ci(s,r){for(;!Object.prototype.hasOwnProperty.call(s,r)&&(s=de(s),s!==null););return s}function de(s){return de=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},de(s)}function Je(s,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),r&&Mt(s,r)}function Mt(s,r){return Mt=Object.setPrototypeOf||function(o,f){return o.__proto__=f,o},Mt(s,r)}var et=function(s){Je(r,s);function r(t){var o;return Xe(this,r),o=Qe(this,de(r).call(this)),o.biquad=o.ac.createBiquadFilter(),o.input.connect(o.biquad),o.biquad.connect(o.wet),t&&o.setType(t),o._on=!0,o._untoggledType=o.biquad.type,o}return ui(r,[{key:"process",value:function(o,f,g,k){o.connect(this.input),this.set(f,g,k)}},{key:"set",value:function(o,f,g){o&&this.freq(o,g),f&&this.res(f,g)}},{key:"freq",value:function(o,f){var g=f||0;return o<=0&&(o=1),typeof o=="number"?(this.biquad.frequency.cancelScheduledValues(this.ac.currentTime+.01+g),this.biquad.frequency.exponentialRampToValueAtTime(o,this.ac.currentTime+.02+g)):o&&o.connect(this.biquad.frequency),this.biquad.frequency.value}},{key:"res",value:function(o,f){var g=f||0;return typeof o=="number"?(this.biquad.Q.value=o,this.biquad.Q.cancelScheduledValues(this.ac.currentTime+.01+g),this.biquad.Q.linearRampToValueAtTime(o,this.ac.currentTime+.02+g)):o&&o.connect(this.biquad.Q),this.biquad.Q.value}},{key:"gain",value:function(o,f){var g=f||0;return typeof o=="number"?(this.biquad.gain.value=o,this.biquad.gain.cancelScheduledValues(this.ac.currentTime+.01+g),this.biquad.gain.linearRampToValueAtTime(o,this.ac.currentTime+.02+g)):o&&o.connect(this.biquad.gain),this.biquad.gain.value}},{key:"toggle",value:function(){return this._on=!this._on,this._on===!0?this.biquad.type=this._untoggledType:this._on===!1&&(this.biquad.type="allpass"),this._on}},{key:"setType",value:function(o){this.biquad.type=o,this._untoggledType=this.biquad.type}},{key:"dispose",value:function(){$e(de(r.prototype),"dispose",this).call(this),this.biquad&&(this.biquad.disconnect(),delete this.biquad)}}]),r}(pe),fi=function(s){Je(r,s);function r(){return Xe(this,r),Qe(this,de(r).call(this,"lowpass"))}return r}(et),hi=function(s){Je(r,s);function r(){return Xe(this,r),Qe(this,de(r).call(this,"highpass"))}return r}(et),pi=function(s){Je(r,s);function r(){return Xe(this,r),Qe(this,de(r).call(this,"bandpass"))}return r}(et),tt=et;function nt(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?nt=function(t){return typeof t}:nt=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nt(s)}function di(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function mi(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function vi(s,r,t){return r&&mi(s.prototype,r),s}function yi(s,r){return r&&(nt(r)==="object"||typeof r=="function")?r:gi(s)}function gi(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function Bt(s){return Bt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Bt(s)}function xi(s,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),r&&Dt(s,r)}function Dt(s,r){return Dt=Object.setPrototypeOf||function(o,f){return o.__proto__=f,o},Dt(s,r)}var _i=function(s){xi(r,s);function r(t,o){var f;return di(this,r),f=yi(this,Bt(r).call(this,"peaking")),f.disconnect(),f.set(t,o),f.biquad.gain.value=0,delete f.input,delete f.output,delete f._drywet,delete f.wet,f}return vi(r,[{key:"amp",value:function(){console.warn("`amp()` is not available for p5.EQ bands. Use `.gain()`")}},{key:"drywet",value:function(){console.warn("`drywet()` is not available for p5.EQ bands.")}},{key:"connect",value:function(o){var f=o||p5.soundOut.input;this.biquad?this.biquad.connect(f.input?f.input:f):this.output.connect(f.input?f.input:f)}},{key:"disconnect",value:function(){this.biquad&&this.biquad.disconnect()}},{key:"dispose",value:function(){var o=i.soundArray.indexOf(this);i.soundArray.splice(o,1),this.disconnect(),delete this.biquad}}]),r}(tt),Ti=_i;function it(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?it=function(t){return typeof t}:it=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},it(s)}function Si(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function wi(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function bi(s,r,t){return r&&wi(s.prototype,r),s}function Pi(s,r){return r&&(it(r)==="object"||typeof r=="function")?r:Ai(s)}function Ai(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function rt(s,r,t){return typeof Reflect<"u"&&Reflect.get?rt=Reflect.get:rt=function(f,g,k){var I=Ci(f,g);if(I){var N=Object.getOwnPropertyDescriptor(I,g);return N.get?N.get.call(k):N.value}},rt(s,r,t||s)}function Ci(s,r){for(;!Object.prototype.hasOwnProperty.call(s,r)&&(s=ke(s),s!==null););return s}function ke(s){return ke=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ke(s)}function Ei(s,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),r&&Ft(s,r)}function Ft(s,r){return Ft=Object.setPrototypeOf||function(o,f){return o.__proto__=f,o},Ft(s,r)}var ki=function(s){Ei(r,s);function r(t){var o;Si(this,r),o=Pi(this,ke(r).call(this)),t=t===3||t===8?t:3;var f;t===3?f=Math.pow(2,3):f=2,o.bands=[];for(var g,k,I=0;I<t;I++)I===t-1?(g=21e3,k=.01):I===0?(g=100,k=.1):I===1?(g=t===3?360*f:360,k=1):(g=o.bands[I-1].freq()*f,k=1),o.bands[I]=o._newBand(g,k),I>0?o.bands[I-1].connect(o.bands[I].biquad):o.input.connect(o.bands[I].biquad);return o.bands[t-1].connect(o.output),o}return bi(r,[{key:"process",value:function(o){o.connect(this.input)}},{key:"set",value:function(){if(arguments.length===this.bands.length*2)for(var o=0;o<arguments.length;o+=2)this.bands[o/2].freq(arguments[o]),this.bands[o/2].gain(arguments[o+1]);else console.error("Argument mismatch. .set() should be called with "+this.bands.length*2+" arguments. (one frequency and gain value pair for each band of the eq)")}},{key:"_newBand",value:function(o,f){return new Ti(o,f)}},{key:"dispose",value:function(){if(rt(ke(r.prototype),"dispose",this).call(this),this.bands){for(;this.bands.length>0;)delete this.bands.pop().dispose();delete this.bands}}}]),r}(pe),Oi=ki;function Ri(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function Mi(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function Bi(s,r,t){return r&&Mi(s.prototype,r),s}var Di=function(){function s(r){Ri(this,s),this.ac=i.audiocontext,this.listener=this.ac.listener}return Bi(s,[{key:"process",value:function(t){t.connect(this.input)}},{key:"position",value:function(t,o,f,g){return this.positionX(t,g),this.positionY(o,g),this.positionZ(f,g),[this.listener.positionX.value,this.listener.positionY.value,this.listener.positionZ.value]}},{key:"positionX",value:function(t,o){var f=o||0;return typeof t=="number"?(this.listener.positionX.value=t,this.listener.positionX.cancelScheduledValues(this.ac.currentTime+.01+f),this.listener.positionX.linearRampToValueAtTime(t,this.ac.currentTime+.02+f)):t&&t.connect(this.listener.positionX),this.listener.positionX.value}},{key:"positionY",value:function(t,o){var f=o||0;return typeof t=="number"?(this.listener.positionY.value=t,this.listener.positionY.cancelScheduledValues(this.ac.currentTime+.01+f),this.listener.positionY.linearRampToValueAtTime(t,this.ac.currentTime+.02+f)):t&&t.connect(this.listener.positionY),this.listener.positionY.value}},{key:"positionZ",value:function(t,o){var f=o||0;return typeof t=="number"?(this.listener.positionZ.value=t,this.listener.positionZ.cancelScheduledValues(this.ac.currentTime+.01+f),this.listener.positionZ.linearRampToValueAtTime(t,this.ac.currentTime+.02+f)):t&&t.connect(this.listener.positionZ),this.listener.positionZ.value}},{key:"orient",value:function(t,o,f,g,k,I,N){return arguments.length===3||arguments.length===4?(N=arguments[3],this.orientForward(t,o,f,N)):(arguments.length===6||arguments===7)&&(this.orientForward(t,o,f),this.orientUp(g,k,I,N)),[this.listener.forwardX.value,this.listener.forwardY.value,this.listener.forwardZ.value,this.listener.upX.value,this.listener.upY.value,this.listener.upZ.value]}},{key:"orientForward",value:function(t,o,f,g){return this.forwardX(t,g),this.forwardY(o,g),this.forwardZ(f,g),[this.listener.forwardX,this.listener.forwardY,this.listener.forwardZ]}},{key:"orientUp",value:function(t,o,f,g){return this.upX(t,g),this.upY(o,g),this.upZ(f,g),[this.listener.upX,this.listener.upY,this.listener.upZ]}},{key:"forwardX",value:function(t,o){var f=o||0;return typeof t=="number"?(this.listener.forwardX.value=t,this.listener.forwardX.cancelScheduledValues(this.ac.currentTime+.01+f),this.listener.forwardX.linearRampToValueAtTime(t,this.ac.currentTime+.02+f)):t&&t.connect(this.listener.forwardX),this.listener.forwardX.value}},{key:"forwardY",value:function(t,o){var f=o||0;return typeof t=="number"?(this.listener.forwardY.value=t,this.listener.forwardY.cancelScheduledValues(this.ac.currentTime+.01+f),this.listener.forwardY.linearRampToValueAtTime(t,this.ac.currentTime+.02+f)):t&&t.connect(this.listener.forwardY),this.listener.forwardY.value}},{key:"forwardZ",value:function(t,o){var f=o||0;return typeof t=="number"?(this.listener.forwardZ.value=t,this.listener.forwardZ.cancelScheduledValues(this.ac.currentTime+.01+f),this.listener.forwardZ.linearRampToValueAtTime(t,this.ac.currentTime+.02+f)):t&&t.connect(this.listener.forwardZ),this.listener.forwardZ.value}},{key:"upX",value:function(t,o){var f=o||0;return typeof t=="number"?(this.listener.upX.value=t,this.listener.upX.cancelScheduledValues(this.ac.currentTime+.01+f),this.listener.upX.linearRampToValueAtTime(t,this.ac.currentTime+.02+f)):t&&t.connect(this.listener.upX),this.listener.upX.value}},{key:"upY",value:function(t,o){var f=o||0;return typeof t=="number"?(this.listener.upY.value=t,this.listener.upY.cancelScheduledValues(this.ac.currentTime+.01+f),this.listener.upY.linearRampToValueAtTime(t,this.ac.currentTime+.02+f)):t&&t.connect(this.listener.upY),this.listener.upY.value}},{key:"upZ",value:function(t,o){var f=o||0;return typeof t=="number"?(this.listener.upZ.value=t,this.listener.upZ.cancelScheduledValues(this.ac.currentTime+.01+f),this.listener.upZ.linearRampToValueAtTime(t,this.ac.currentTime+.02+f)):t&&t.connect(this.listener.upZ),this.listener.upZ.value}}]),s}(),Fi=Di;function ot(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ot=function(t){return typeof t}:ot=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ot(s)}function Ii(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function Ni(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function Li(s,r,t){return r&&Ni(s.prototype,r),s}function Vi(s,r){return r&&(ot(r)==="object"||typeof r=="function")?r:Ui(s)}function Ui(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function st(s,r,t){return typeof Reflect<"u"&&Reflect.get?st=Reflect.get:st=function(f,g,k){var I=Wi(f,g);if(I){var N=Object.getOwnPropertyDescriptor(I,g);return N.get?N.get.call(k):N.value}},st(s,r,t||s)}function Wi(s,r){for(;!Object.prototype.hasOwnProperty.call(s,r)&&(s=Oe(s),s!==null););return s}function Oe(s){return Oe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Oe(s)}function qi(s,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),r&&It(s,r)}function It(s,r){return It=Object.setPrototypeOf||function(o,f){return o.__proto__=f,o},It(s,r)}var Gi=function(s){qi(r,s);function r(){var t;return Ii(this,r),t=Vi(this,Oe(r).call(this)),t.panner=t.ac.createPanner(),t.panner.panningModel="HRTF",t.panner.distanceModel="linear",t.panner.connect(t.output),t.input.connect(t.panner),t}return Li(r,[{key:"process",value:function(o){o.connect(this.input)}},{key:"set",value:function(o,f,g,k){return this.positionX(o,k),this.positionY(f,k),this.positionZ(g,k),[this.panner.positionX.value,this.panner.positionY.value,this.panner.positionZ.value]}},{key:"positionX",value:function(o,f){var g=f||0;return typeof o=="number"?(this.panner.positionX.value=o,this.panner.positionX.cancelScheduledValues(this.ac.currentTime+.01+g),this.panner.positionX.linearRampToValueAtTime(o,this.ac.currentTime+.02+g)):o&&o.connect(this.panner.positionX),this.panner.positionX.value}},{key:"positionY",value:function(o,f){var g=f||0;return typeof o=="number"?(this.panner.positionY.value=o,this.panner.positionY.cancelScheduledValues(this.ac.currentTime+.01+g),this.panner.positionY.linearRampToValueAtTime(o,this.ac.currentTime+.02+g)):o&&o.connect(this.panner.positionY),this.panner.positionY.value}},{key:"positionZ",value:function(o,f){var g=f||0;return typeof o=="number"?(this.panner.positionZ.value=o,this.panner.positionZ.cancelScheduledValues(this.ac.currentTime+.01+g),this.panner.positionZ.linearRampToValueAtTime(o,this.ac.currentTime+.02+g)):o&&o.connect(this.panner.positionZ),this.panner.positionZ.value}},{key:"orient",value:function(o,f,g,k){return this.orientX(o,k),this.orientY(f,k),this.orientZ(g,k),[this.panner.orientationX.value,this.panner.orientationY.value,this.panner.orientationZ.value]}},{key:"orientX",value:function(o,f){var g=f||0;return typeof o=="number"?(this.panner.orientationX.value=o,this.panner.orientationX.cancelScheduledValues(this.ac.currentTime+.01+g),this.panner.orientationX.linearRampToValueAtTime(o,this.ac.currentTime+.02+g)):o&&o.connect(this.panner.orientationX),this.panner.orientationX.value}},{key:"orientY",value:function(o,f){var g=f||0;return typeof o=="number"?(this.panner.orientationY.value=o,this.panner.orientationY.cancelScheduledValues(this.ac.currentTime+.01+g),this.panner.orientationY.linearRampToValueAtTime(o,this.ac.currentTime+.02+g)):o&&o.connect(this.panner.orientationY),this.panner.orientationY.value}},{key:"orientZ",value:function(o,f){var g=f||0;return typeof o=="number"?(this.panner.orientationZ.value=o,this.panner.orientationZ.cancelScheduledValues(this.ac.currentTime+.01+g),this.panner.orientationZ.linearRampToValueAtTime(o,this.ac.currentTime+.02+g)):o&&o.connect(this.panner.orientationZ),this.panner.orientationZ.value}},{key:"setFalloff",value:function(o,f){this.maxDist(o),this.rolloff(f)}},{key:"maxDist",value:function(o){return typeof o=="number"&&(this.panner.maxDistance=o),this.panner.maxDistance}},{key:"rolloff",value:function(o){return typeof o=="number"&&(this.panner.rolloffFactor=o),this.panner.rolloffFactor}},{key:"dispose",value:function(){st(Oe(r.prototype),"dispose",this).call(this),this.panner&&(this.panner.disconnect(),delete this.panner)}}]),r}(pe),ji=Gi;function at(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?at=function(t){return typeof t}:at=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},at(s)}function zi(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function Hi(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function Yi(s,r,t){return r&&Hi(s.prototype,r),s}function Ki(s,r){return r&&(at(r)==="object"||typeof r=="function")?r:Zi(s)}function Zi(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function ut(s,r,t){return typeof Reflect<"u"&&Reflect.get?ut=Reflect.get:ut=function(f,g,k){var I=Xi(f,g);if(I){var N=Object.getOwnPropertyDescriptor(I,g);return N.get?N.get.call(k):N.value}},ut(s,r,t||s)}function Xi(s,r){for(;!Object.prototype.hasOwnProperty.call(s,r)&&(s=Re(s),s!==null););return s}function Re(s){return Re=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Re(s)}function Qi(s,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),r&&Nt(s,r)}function Nt(s,r){return Nt=Object.setPrototypeOf||function(o,f){return o.__proto__=f,o},Nt(s,r)}var $i=function(s){Qi(r,s);function r(){var t;return zi(this,r),t=Ki(this,Re(r).call(this)),t._split=t.ac.createChannelSplitter(2),t._merge=t.ac.createChannelMerger(2),t._leftGain=t.ac.createGain(),t._rightGain=t.ac.createGain(),t.leftDelay=t.ac.createDelay(),t.rightDelay=t.ac.createDelay(),t._leftFilter=new tt,t._rightFilter=new tt,t._leftFilter.disconnect(),t._rightFilter.disconnect(),t._leftFilter.biquad.frequency.setValueAtTime(1200,t.ac.currentTime),t._rightFilter.biquad.frequency.setValueAtTime(1200,t.ac.currentTime),t._leftFilter.biquad.Q.setValueAtTime(.3,t.ac.currentTime),t._rightFilter.biquad.Q.setValueAtTime(.3,t.ac.currentTime),t.input.connect(t._split),t.leftDelay.connect(t._leftGain),t.rightDelay.connect(t._rightGain),t._leftGain.connect(t._leftFilter.input),t._rightGain.connect(t._rightFilter.input),t._merge.connect(t.wet),t._leftFilter.biquad.gain.setValueAtTime(1,t.ac.currentTime),t._rightFilter.biquad.gain.setValueAtTime(1,t.ac.currentTime),t.setType(0),t._maxDelay=t.leftDelay.delayTime.maxValue,t.feedback(.5),t}return Yi(r,[{key:"process",value:function(o,f,g,k){var I=g||0,N=f||0;if(I>=1)throw new Error("Feedback value will force a positive feedback loop.");if(N>=this._maxDelay)throw new Error("Delay Time exceeds maximum delay time of "+this._maxDelay+" second.");o.connect(this.input),this.leftDelay.delayTime.setValueAtTime(N,this.ac.currentTime),this.rightDelay.delayTime.setValueAtTime(N,this.ac.currentTime),this._leftGain.gain.value=I,this._rightGain.gain.value=I,k&&(this._leftFilter.freq(k),this._rightFilter.freq(k))}},{key:"delayTime",value:function(o){typeof o!="number"?(o.connect(this.leftDelay.delayTime),o.connect(this.rightDelay.delayTime)):(this.leftDelay.delayTime.cancelScheduledValues(this.ac.currentTime),this.rightDelay.delayTime.cancelScheduledValues(this.ac.currentTime),this.leftDelay.delayTime.linearRampToValueAtTime(o,this.ac.currentTime),this.rightDelay.delayTime.linearRampToValueAtTime(o,this.ac.currentTime))}},{key:"feedback",value:function(o){if(o&&typeof o!="number")o.connect(this._leftGain.gain),o.connect(this._rightGain.gain);else{if(o>=1)throw new Error("Feedback value will force a positive feedback loop.");typeof o=="number"&&(this._leftGain.gain.value=o,this._rightGain.gain.value=o)}return this._leftGain.gain.value}},{key:"filter",value:function(o,f){this._leftFilter.set(o,f),this._rightFilter.set(o,f)}},{key:"setType",value:function(o){switch(o===1&&(o="pingPong"),this._split.disconnect(),this._leftFilter.disconnect(),this._rightFilter.disconnect(),this._split.connect(this.leftDelay,0),this._split.connect(this.rightDelay,1),o){case"pingPong":this._rightFilter.setType(this._leftFilter.biquad.type),this._leftFilter.output.connect(this._merge,0,0),this._rightFilter.output.connect(this._merge,0,1),this._leftFilter.output.connect(this.rightDelay),this._rightFilter.output.connect(this.leftDelay);break;default:this._leftFilter.output.connect(this._merge,0,0),this._rightFilter.output.connect(this._merge,0,1),this._leftFilter.output.connect(this.leftDelay),this._rightFilter.output.connect(this.rightDelay)}}},{key:"dispose",value:function(){ut(Re(r.prototype),"dispose",this).call(this),this._split.disconnect(),this._leftFilter.dispose(),this._rightFilter.dispose(),this._merge.disconnect(),this._leftGain.disconnect(),this._rightGain.disconnect(),this.leftDelay.disconnect(),this.rightDelay.disconnect(),this._split=void 0,this._leftFilter=void 0,this._rightFilter=void 0,this._merge=void 0,this._leftGain=void 0,this._rightGain=void 0,this.leftDelay=void 0,this.rightDelay=void 0}}]),r}(pe),Ji=$i;function lt(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?lt=function(t){return typeof t}:lt=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lt(s)}function Jt(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function er(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function en(s,r,t){return r&&er(s.prototype,r),s}function tn(s,r){return r&&(lt(r)==="object"||typeof r=="function")?r:tr(s)}function tr(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function Me(s,r,t){return typeof Reflect<"u"&&Reflect.get?Me=Reflect.get:Me=function(f,g,k){var I=nr(f,g);if(I){var N=Object.getOwnPropertyDescriptor(I,g);return N.get?N.get.call(k):N.value}},Me(s,r,t||s)}function nr(s,r){for(;!Object.prototype.hasOwnProperty.call(s,r)&&(s=ye(s),s!==null););return s}function ye(s){return ye=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ye(s)}function nn(s,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),r&&Lt(s,r)}function Lt(s,r){return Lt=Object.setPrototypeOf||function(o,f){return o.__proto__=f,o},Lt(s,r)}var rn=function(s){nn(r,s);function r(){var t;return Jt(this,r),t=tn(this,ye(r).call(this)),t._initConvolverNode(),t.input.gain.value=.5,t._seconds=3,t._decay=2,t._reverse=!1,t._buildImpulse(),t}return en(r,[{key:"_initConvolverNode",value:function(){this.convolverNode=this.ac.createConvolver(),this.input.connect(this.convolverNode),this.convolverNode.connect(this.wet)}},{key:"_teardownConvolverNode",value:function(){this.convolverNode&&(this.convolverNode.disconnect(),delete this.convolverNode)}},{key:"_setBuffer",value:function(o){this._teardownConvolverNode(),this._initConvolverNode(),this.convolverNode.buffer=o}},{key:"process",value:function(o,f,g,k){o.connect(this.input);var I=!1;f&&(this._seconds=f,I=!0),g&&(this._decay=g),k&&(this._reverse=k),I&&this._buildImpulse()}},{key:"set",value:function(o,f,g){var k=!1;o&&(this._seconds=o,k=!0),f&&(this._decay=f),g&&(this._reverse=g),k&&this._buildImpulse()}},{key:"_buildImpulse",value:function(){var o=this.ac.sampleRate,f=o*this._seconds,g=this._decay,k=this.ac.createBuffer(2,f,o),I=k.getChannelData(0),N=k.getChannelData(1),G,j;for(j=0;j<f;j++)G=this._reverse?f-j:j,I[j]=(Math.random()*2-1)*Math.pow(1-G/f,g),N[j]=(Math.random()*2-1)*Math.pow(1-G/f,g);this._setBuffer(k)}},{key:"dispose",value:function(){Me(ye(r.prototype),"dispose",this).call(this),this._teardownConvolverNode()}}]),r}(pe),on=function(s){nn(r,s);function r(t,o,f){var g;return Jt(this,r),g=tn(this,ye(r).call(this)),g._initConvolverNode(),g.input.gain.value=.5,t?(g.impulses=[],g._loadBuffer(t,o,f)):(g._seconds=3,g._decay=2,g._reverse=!1,g._buildImpulse()),g.impulses=[],g.set=null,g}return en(r,[{key:"_loadBuffer",value:function(o,f,g){var k=p5.prototype._checkFileFormats(o),I=this,N=new Error().stack,G=Object(D.b)(),j=new XMLHttpRequest;j.open("GET",k,!0),j.responseType="arraybuffer",j.onload=function(){if(j.status===200)G.decodeAudioData(j.response,function(te){var re={},he=k.split("/");re.name=he[he.length-1],re.audioBuffer=te,I.impulses.push(re),I._setBuffer(re.audioBuffer),f&&f(re)},function(){var te=new O("decodeAudioData",N,I.url),re="AudioContext error at decodeAudioData for "+I.url;g?(te.msg=re,g(te)):console.error(re+`
 The error stack trace includes: 
`+te.stack)});else{var Z=new O("loadConvolver",N,I.url),ce="Unable to load "+I.url+". The request status was: "+j.status+" ("+j.statusText+")";g?(Z.message=ce,g(Z)):console.error(ce+`
 The error stack trace includes: 
`+Z.stack)}},j.onerror=function(){var Z=new O("loadConvolver",N,I.url),ce="There was no response from the server at "+I.url+". Check the url and internet connectivity.";g?(Z.message=ce,g(Z)):console.error(ce+`
 The error stack trace includes: 
`+Z.stack)},j.send()}},{key:"process",value:function(o){o.connect(this.input)}},{key:"addImpulse",value:function(o,f,g){window.location.origin.indexOf("file://")>-1&&window.cordova==="undefined"&&alert("This sketch may require a server to load external files. Please see http://bit.ly/1qcInwS"),this._loadBuffer(o,f,g)}},{key:"resetImpulse",value:function(o,f,g){window.location.origin.indexOf("file://")>-1&&window.cordova==="undefined"&&alert("This sketch may require a server to load external files. Please see http://bit.ly/1qcInwS"),this.impulses=[],this._loadBuffer(o,f,g)}},{key:"toggleImpulse",value:function(o){if(typeof o=="number"&&o<this.impulses.length&&this._setBuffer(this.impulses[o].audioBuffer),typeof o=="string"){for(var f=0;f<this.impulses.length;f++)if(this.impulses[f].name===o){this._setBuffer(this.impulses[f].audioBuffer);break}}}},{key:"dispose",value:function(){Me(ye(r.prototype),"dispose",this).call(this);for(var o in this.impulses)this.impulses[o]&&(this.impulses[o]=null)}}]),r}(rn);function ir(s,r,t){window.location.origin.indexOf("file://")>-1&&window.cordova==="undefined"&&alert("This sketch may require a server to load external files. Please see http://bit.ly/1qcInwS");var o=this,f=new on(s,function(g){typeof r=="function"&&r(g),typeof o._decrementPreload=="function"&&o._decrementPreload()},t);return f.impulses=[],f}var rr=S(11),sn=S.n(rr);function or(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function sr(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function ar(s,r,t){return r&&sr(s.prototype,r),s}var ur=function(){function s(){or(this,s),this.clock=new sn.a({callback:this.ontick.bind(this)}),this.syncedParts=[],this.bpm=120,this._init(),this.prevTick=0,this.tatumTime=0,this.tickCallback=function(){}}return ar(s,[{key:"ontick",value:function(t){var o=t-this.prevTick,f=t-i.audiocontext.currentTime;if(!(o-this.tatumTime<=-.02)){this.prevTick=t;var g=this;this.syncedParts.forEach(function(k){k.isPlaying&&(k.incrementStep(f),k.phrases.forEach(function(I){var N=I.sequence,G=g.metroTicks%N.length;N[G]!==0&&(g.metroTicks<N.length||!I.looping)&&I.callback(f,N[G])}))}),this.metroTicks+=1,this.tickCallback(f)}}},{key:"setBPM",value:function(t){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,f=60/(t*this.tatums),g=i.audiocontext.currentTime;this.tatumTime=f,this.clock.frequency.setValueAtTime(this.clock.frequency.value,g),this.clock.frequency.linearRampToValueAtTime(t,g+o),this.bpm=t}},{key:"getBPM",value:function(){return this.clock.getRate()/this.tatums*60}},{key:"_init",value:function(){this.metroTicks=0}},{key:"resetSync",value:function(t){this.syncedParts=[t]}},{key:"pushSync",value:function(t){this.syncedParts.push(t)}},{key:"start",value:function(t){var o=t||0,f=i.audiocontext.currentTime;this.clock.start(f+o),this.setBPM(this.bpm)}},{key:"stop",value:function(t){var o=t||0,f=i.audiocontext.currentTime;this.clock.stop(f+o)}},{key:"beatLength",value:function(t){this.tatums=1/t/4}}]),s}(),an=ur;function lr(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function un(s,r,t){return r&&lr(s.prototype,r),s}function Vt(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}var ln=120;p5.prototype.setBPM=function(s,r){ln=s;for(var t in i.parts)i.parts[t]&&i.parts[t].setBPM(s,r)};var Ut=function s(r,t,o){Vt(this,s),this.phraseStep=0,this.name=r,this.callback=t,this.sequence=o},cr=function(){function s(r,t){Vt(this,s),this.length=r||0,this.partStep=0,this.phrases=[],this.isPlaying=!1,this.noLoop(),this.tatums=t||.0625,this.metro=new an,this.metro._init(),this.metro.beatLength(this.tatums),this.metro.setBPM(ln),i.parts.push(this),this.callback=function(){}}return un(s,[{key:"setBPM",value:function(t,o){this.metro.setBPM(t,o)}},{key:"getBPM",value:function(){return this.metro.getBPM()}},{key:"start",value:function(t){if(!this.isPlaying){this.isPlaying=!0,this.metro.resetSync(this);var o=t||0;this.metro.start(o)}}},{key:"loop",value:function(t){this.looping=!0,this.onended=function(){this.partStep=0};var o=t||0;this.start(o)}},{key:"noLoop",value:function(){this.looping=!1,this.onended=function(){this.stop()}}},{key:"stop",value:function(t){this.partStep=0,this.pause(t)}},{key:"pause",value:function(t){this.isPlaying=!1;var o=t||0;this.metro.stop(o)}},{key:"addPhrase",value:function(t,o,f){var g;if(arguments.length===3)g=new Ut(t,o,f);else if(arguments[0]instanceof Ut)g=arguments[0];else throw"invalid input. addPhrase accepts name, callback, array or a p5.Phrase";this.phrases.push(g),g.sequence.length>this.length&&(this.length=g.sequence.length)}},{key:"removePhrase",value:function(t){for(var o in this.phrases)this.phrases[o].name===t&&this.phrases.splice(o,1)}},{key:"getPhrase",value:function(t){for(var o in this.phrases)if(this.phrases[o].name===t)return this.phrases[o]}},{key:"replaceSequence",value:function(t,o){for(var f in this.phrases)this.phrases[f].name===t&&(this.phrases[f].sequence=o)}},{key:"incrementStep",value:function(t){this.partStep<this.length-1?(this.callback(t),this.partStep+=1):!this.looping&&this.partStep===this.length-1&&this.onended()}},{key:"onStep",value:function(t){this.callback=t}}]),s}(),fr=function(){function s(){Vt(this,s),this.parts=[],this.currentPart=new Array(arguments.length);var r=this;for(var t in arguments)this.parts[t]=arguments[t],this.parts[t].nextPart=this.parts[t+1],this.parts[t].onended=function(){r.resetPart(t),hr(r)};this.looping=!1}return un(s,[{key:"onended",value:function(){this.looping?this.parts[0].start():this.parts[this.parts.length-1].onended=function(){this.stop(),this.resetParts()},this.currentPart=0}},{key:"start",value:function(){this.parts[this.currentPart].start(),this.scoreStep=0}},{key:"stop",value:function(){this.parts[this.currentPart].stop(),this.currentPart=0,this.scoreStep=0}},{key:"pause",value:function(){this.parts[this.currentPart].stop()}},{key:"loop",value:function(){this.looping=!0,this.start()}},{key:"noLoop",value:function(){this.looping=!1}},{key:"resetParts",value:function(){var t=this;this.parts.forEach(function(o){t.resetParts[o]})}},{key:"resetPart",value:function(t){this.parts[t].stop(),this.parts[t].partStep=0;for(var o in this.parts[t].phrases)this.parts[t]&&(this.parts[t].phrases[o].phraseStep=0)}},{key:"setBPM",value:function(t,o){for(var f in this.parts)this.parts[f]&&this.parts[f].setBPM(t,o)}}]),s}();function hr(s){s.currentPart++,s.currentPart>=s.parts.length?(s.scoreStep=0,s.onended()):(s.scoreStep=0,s.parts[s.currentPart-1].stop(),s.parts[s.currentPart].start())}function pr(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function dr(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function mr(s,r,t){return r&&dr(s.prototype,r),s}var vr=function(){function s(r,t){pr(this,s),Object.defineProperty(this,"bpm",{get:function(){return this._bpm},set:function(g){this.musicalTimeMode||console.warn('Changing the BPM in "seconds" mode has no effect. BPM is only relevant in musicalTimeMode when the interval is specified as a string ("2n", "4n", "1m"...etc)'),this._bpm=g,this._update()}}),Object.defineProperty(this,"timeSignature",{get:function(){return this._timeSignature},set:function(g){this.musicalTimeMode||console.warn('Changing the timeSignature in "seconds" mode has no effect. BPM is only relevant in musicalTimeMode when the interval is specified as a string ("2n", "4n", "1m"...etc)'),this._timeSignature=g,this._update()}}),Object.defineProperty(this,"interval",{get:function(){return this._interval},set:function(g){this.musicalTimeMode=typeof g!="number",this._interval=g,this._update()}}),Object.defineProperty(this,"iterations",{get:function(){return this.clock.ticks}}),this.callback=r,this.musicalTimeMode=typeof this._interval!="number",this._interval=t||1,this._timeSignature=4,this._bpm=60,this.isPlaying=!1,this.maxIterations=1/0;var o=this;this.clock=new sn.a({callback:function(g){var k=g-i.audiocontext.currentTime;k>0&&o.iterations<=o.maxIterations&&o.callback(k)},frequency:this._calcFreq()})}return mr(s,[{key:"start",value:function(t){var o=t||0,f=i.audiocontext.currentTime;this.isPlaying||(this.clock.start(f+o),this.isPlaying=!0)}},{key:"stop",value:function(t){var o=t||0,f=i.audiocontext.currentTime;this.isPlaying&&(this.clock.stop(f+o),this.isPlaying=!1)}},{key:"pause",value:function(t){var o=t||0,f=i.audiocontext.currentTime;this.isPlaying&&(this.clock.pause(f+o),this.isPlaying=!1)}},{key:"syncedStart",value:function(t,o){var f=o||0,g=i.audiocontext.currentTime;if(!t.isPlaying)t.clock.start(g+f),t.isPlaying=!0,this.clock.start(g+f),this.isPlaying=!0;else if(t.isPlaying){var k=t.clock._nextTick-i.audiocontext.currentTime;this.clock.start(g+k),this.isPlaying=!0}}},{key:"_update",value:function(){this.clock.frequency.value=this._calcFreq()}},{key:"_calcFreq",value:function(){if(typeof this._interval=="number")return this.musicalTimeMode=!1,1/this._interval;if(typeof this._interval=="string")return this.musicalTimeMode=!0,this._bpm/60/this._convertNotation(this._interval)*(this._timeSignature/4)}},{key:"_convertNotation",value:function(t){var o=t.slice(-1);switch(t=Number(t.slice(0,-1)),o){case"m":return this._measure(t);case"n":return this._note(t);default:console.warn("Specified interval is not formatted correctly. See Tone.js timing reference for more info: https://github.com/Tonejs/Tone.js/wiki/Time")}}},{key:"_measure",value:function(t){return t*this._timeSignature}},{key:"_note",value:function(t){return this._timeSignature/t}}]),s}(),yr=vr;function ct(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ct=function(t){return typeof t}:ct=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ct(s)}function gr(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function xr(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function _r(s,r,t){return r&&xr(s.prototype,r),s}function Tr(s,r){return r&&(ct(r)==="object"||typeof r=="function")?r:Sr(s)}function Sr(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function ft(s,r,t){return typeof Reflect<"u"&&Reflect.get?ft=Reflect.get:ft=function(f,g,k){var I=wr(f,g);if(I){var N=Object.getOwnPropertyDescriptor(I,g);return N.get?N.get.call(k):N.value}},ft(s,r,t||s)}function wr(s,r){for(;!Object.prototype.hasOwnProperty.call(s,r)&&(s=Be(s),s!==null););return s}function Be(s){return Be=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Be(s)}function br(s,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),r&&Wt(s,r)}function Wt(s,r){return Wt=Object.setPrototypeOf||function(o,f){return o.__proto__=f,o},Wt(s,r)}var Pr=function(s){br(r,s);function r(){var t;return gr(this,r),t=Tr(this,Be(r).call(this)),t.compressor=t.ac.createDynamicsCompressor(),t.input.connect(t.compressor),t.compressor.connect(t.wet),t}return _r(r,[{key:"process",value:function(o,f,g,k,I,N){o.connect(this.input),this.set(f,g,k,I,N)}},{key:"set",value:function(o,f,g,k,I){typeof o<"u"&&this.attack(o),typeof f<"u"&&this.knee(f),typeof g<"u"&&this.ratio(g),typeof k<"u"&&this.threshold(k),typeof I<"u"&&this.release(I)}},{key:"attack",value:function(o,f){var g=f||0;return typeof o=="number"?(this.compressor.attack.value=o,this.compressor.attack.cancelScheduledValues(this.ac.currentTime+.01+g),this.compressor.attack.linearRampToValueAtTime(o,this.ac.currentTime+.02+g)):typeof o<"u"&&o.connect(this.compressor.attack),this.compressor.attack.value}},{key:"knee",value:function(o,f){var g=f||0;return typeof o=="number"?(this.compressor.knee.value=o,this.compressor.knee.cancelScheduledValues(this.ac.currentTime+.01+g),this.compressor.knee.linearRampToValueAtTime(o,this.ac.currentTime+.02+g)):typeof o<"u"&&o.connect(this.compressor.knee),this.compressor.knee.value}},{key:"ratio",value:function(o,f){var g=f||0;return typeof o=="number"?(this.compressor.ratio.value=o,this.compressor.ratio.cancelScheduledValues(this.ac.currentTime+.01+g),this.compressor.ratio.linearRampToValueAtTime(o,this.ac.currentTime+.02+g)):typeof o<"u"&&o.connect(this.compressor.ratio),this.compressor.ratio.value}},{key:"threshold",value:function(o,f){var g=f||0;return typeof o=="number"?(this.compressor.threshold.value=o,this.compressor.threshold.cancelScheduledValues(this.ac.currentTime+.01+g),this.compressor.threshold.linearRampToValueAtTime(o,this.ac.currentTime+.02+g)):typeof o<"u"&&o.connect(this.compressor.threshold),this.compressor.threshold.value}},{key:"release",value:function(o,f){var g=f||0;return typeof o=="number"?(this.compressor.release.value=o,this.compressor.release.cancelScheduledValues(this.ac.currentTime+.01+g),this.compressor.release.linearRampToValueAtTime(o,this.ac.currentTime+.02+g)):typeof number<"u"&&o.connect(this.compressor.release),this.compressor.release.value}},{key:"reduction",value:function(){return this.compressor.reduction.value}},{key:"dispose",value:function(){ft(Be(r.prototype),"dispose",this).call(this),this.compressor&&(this.compressor.disconnect(),delete this.compressor)}}]),r}(pe),Ar=Pr;function Cr(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function Er(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function kr(s,r,t){return r&&Er(s.prototype,r),s}var Or=function(){function s(r,t,o,f){Cr(this,s),this.framesPerPeak=f||20,this.framesSinceLastPeak=0,this.decayRate=.95,this.threshold=o||.35,this.cutoff=0,this.cutoffMult=1.5,this.energy=0,this.penergy=0,this.currentValue=0,this.isDetected=!1,this.f1=r||40,this.f2=t||2e4,this._onPeak=function(){}}return kr(s,[{key:"update",value:function(t){var o=this.energy=t.getEnergy(this.f1,this.f2)/255;o>this.cutoff&&o>this.threshold&&o-this.penergy>0?(this._onPeak(),this.isDetected=!0,this.cutoff=o*this.cutoffMult,this.framesSinceLastPeak=0):(this.isDetected=!1,this.framesSinceLastPeak<=this.framesPerPeak?this.framesSinceLastPeak++:(this.cutoff*=this.decayRate,this.cutoff=Math.max(this.cutoff,this.threshold))),this.currentValue=o,this.penergy=o}},{key:"onPeak",value:function(t,o){var f=this;f._onPeak=function(){t(f.energy,o)}}}]),s}(),cn=Or;function Rr(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function Mr(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function Br(s,r,t){return r&&Mr(s.prototype,r),s}var ht=i.audiocontext,Dr=function(){function s(){Rr(this,s),this.input=ht.createGain(),this.output=ht.createGain(),this._inputChannels=2,this._outputChannels=2;var r=w(1024);this._workletNode=new AudioWorkletNode(ht,c.a.recorderProcessor,{outputChannelCount:[this._outputChannels],processorOptions:{numInputChannels:this._inputChannels,bufferSize:r}}),this._workletNode.port.onmessage=(function(t){if(t.data.name==="buffers"){var o=[new Float32Array(t.data.leftBuffer),new Float32Array(t.data.rightBuffer)];this._callback(o)}}).bind(this),this._callback=function(){},this._workletNode.connect(p5.soundOut._silentNode),this.setInput(),i.soundArray.push(this)}return Br(s,[{key:"setInput",value:function(t){this.input.disconnect(),this.input=null,this.input=ht.createGain(),this.input.connect(this._workletNode),this.input.connect(this.output),t?t.connect(this.input):p5.soundOut.output.connect(this.input)}},{key:"record",value:function(t,o,f){this._workletNode.port.postMessage({name:"start",duration:o}),t&&f?this._callback=function(g){t.setBuffer(g),f()}:t&&(this._callback=function(g){t.setBuffer(g)})}},{key:"stop",value:function(){this._workletNode.port.postMessage({name:"stop"})}},{key:"dispose",value:function(){var t=i.soundArray.indexOf(this);i.soundArray.splice(t,1),this._callback=function(){},this.input&&this.input.disconnect(),this.input=null,this._workletNode=null}}]),s}(),Fr=Dr;function pt(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?pt=function(t){return typeof t}:pt=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pt(s)}function Ir(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function Nr(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function Lr(s,r,t){return r&&Nr(s.prototype,r),s}function Vr(s,r){return r&&(pt(r)==="object"||typeof r=="function")?r:Ur(s)}function Ur(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function dt(s,r,t){return typeof Reflect<"u"&&Reflect.get?dt=Reflect.get:dt=function(f,g,k){var I=Wr(f,g);if(I){var N=Object.getOwnPropertyDescriptor(I,g);return N.get?N.get.call(k):N.value}},dt(s,r,t||s)}function Wr(s,r){for(;!Object.prototype.hasOwnProperty.call(s,r)&&(s=De(s),s!==null););return s}function De(s){return De=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},De(s)}function qr(s,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),r&&qt(s,r)}function qt(s,r){return qt=Object.setPrototypeOf||function(o,f){return o.__proto__=f,o},qt(s,r)}function fn(s){for(var r=typeof s=="number"?s:50,t=44100,o=new Float32Array(t),f=Math.PI/180,g=0,k;g<t;++g)k=g*2/t-1,o[g]=(3+r)*k*20*f/(Math.PI+r*Math.abs(k));return o}var Gr=function(s){qr(r,s);function r(t,o){var f;if(Ir(this,r),f=Vr(this,De(r).call(this)),typeof t>"u"&&(t=.25),typeof t!="number")throw new Error("amount must be a number");if(typeof o>"u"&&(o="2x"),typeof o!="string")throw new Error("oversample must be a String");var g=p5.prototype.map(t,0,1,0,2e3);return f.waveShaperNode=f.ac.createWaveShaper(),f.amount=g,f.waveShaperNode.curve=fn(g),f.waveShaperNode.oversample=o,f.input.connect(f.waveShaperNode),f.waveShaperNode.connect(f.wet),f}return Lr(r,[{key:"process",value:function(o,f,g){o.connect(this.input),this.set(f,g)}},{key:"set",value:function(o,f){if(o){var g=p5.prototype.map(o,0,1,0,2e3);this.amount=g,this.waveShaperNode.curve=fn(g)}f&&(this.waveShaperNode.oversample=f)}},{key:"getAmount",value:function(){return this.amount}},{key:"getOversample",value:function(){return this.waveShaperNode.oversample}},{key:"dispose",value:function(){dt(De(r.prototype),"dispose",this).call(this),this.waveShaperNode&&(this.waveShaperNode.disconnect(),this.waveShaperNode=null)}}]),r}(pe),jr=Gr;function zr(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function Hr(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function Yr(s,r,t){return r&&Hr(s.prototype,r),s}var Kr=function(){function s(){zr(this,s),this.ac=i.audiocontext,this.input=this.ac.createGain(),this.output=this.ac.createGain(),this.input.gain.value=.5,this.input.connect(this.output),i.soundArray.push(this)}return Yr(s,[{key:"setInput",value:function(t){t.connect(this.input)}},{key:"connect",value:function(t){var o=t||p5.soundOut.input;this.output.connect(o.input?o.input:o)}},{key:"disconnect",value:function(){this.output&&this.output.disconnect()}},{key:"amp",value:function(t){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,g=i.audiocontext.currentTime,k=this.output.gain.value;this.output.gain.cancelScheduledValues(g),this.output.gain.linearRampToValueAtTime(k,g+f),this.output.gain.linearRampToValueAtTime(t,g+f+o)}},{key:"dispose",value:function(){var t=i.soundArray.indexOf(this);i.soundArray.splice(t,1),this.output&&(this.output.disconnect(),delete this.output),this.input&&(this.input.disconnect(),delete this.input)}}]),s}(),Zr=Kr;function Xr(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function Qr(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function $r(s,r,t){return r&&Qr(s.prototype,r),s}var Jr=function(){function s(){Xr(this,s),this.ac=i.audiocontext,this.output=this.ac.createGain(),this.connect(),i.soundArray.push(this)}return $r(s,[{key:"play",value:function(t,o,f,g){}},{key:"triggerAttack",value:function(t,o,f){}},{key:"triggerRelease",value:function(t){}},{key:"amp",value:function(t,o){}},{key:"connect",value:function(t){var o=t||i.input;this.output.connect(o.input?o.input:o)}},{key:"disconnect",value:function(){this.output.disconnect()}},{key:"dispose",value:function(){this.output&&(this.output.disconnect(),delete this.output)}}]),s}(),hn=Jr;function mt(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?mt=function(t){return typeof t}:mt=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mt(s)}function eo(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function to(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function no(s,r,t){return r&&to(s.prototype,r),s}function io(s,r){return r&&(mt(r)==="object"||typeof r=="function")?r:Gt(s)}function Gt(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function vt(s,r,t){return typeof Reflect<"u"&&Reflect.get?vt=Reflect.get:vt=function(f,g,k){var I=ro(f,g);if(I){var N=Object.getOwnPropertyDescriptor(I,g);return N.get?N.get.call(k):N.value}},vt(s,r,t||s)}function ro(s,r){for(;!Object.prototype.hasOwnProperty.call(s,r)&&(s=Fe(s),s!==null););return s}function Fe(s){return Fe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Fe(s)}function oo(s,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),r&&jt(s,r)}function jt(s,r){return jt=Object.setPrototypeOf||function(o,f){return o.__proto__=f,o},jt(s,r)}var so=.15,ao=function(s){oo(r,s);function r(){var t;return eo(this,r),t=io(this,Fe(r).call(this)),t.oscillator=new He,t.env=new Rn,t.env.setRange(1,0),t.env.setExp(!0),t.setADSR(.02,.25,.05,.35),t.oscillator.disconnect(),t.oscillator.connect(t.output),t.env.disconnect(),t.env.setInput(t.output.gain),t.oscillator.output.gain.value=1,t.oscillator.start(),t.connect(),i.soundArray.push(Gt(t)),Object.defineProperties(Gt(t),{attack:{get:function(){return this.env.aTime},set:function(f){this.env.setADSR(f,this.env.dTime,this.env.sPercent,this.env.rTime)}},decay:{get:function(){return this.env.dTime},set:function(f){this.env.setADSR(this.env.aTime,f,this.env.sPercent,this.env.rTime)}},sustain:{get:function(){return this.env.sPercent},set:function(f){this.env.setADSR(this.env.aTime,this.env.dTime,f,this.env.rTime)}},release:{get:function(){return this.env.rTime},set:function(f){this.env.setADSR(this.env.aTime,this.env.dTime,this.env.sPercent,f)}}}),t}return no(r,[{key:"play",value:function(o,f,g,k){this.triggerAttack(o,f,~~g),this.triggerRelease(~~g+(k||so))}},{key:"triggerAttack",value:function(o,f){var g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,k=y(o),I=f||.1;this.oscillator.freq(k,0,g),this.env.ramp(this.output.gain,g,I)}},{key:"triggerRelease",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;this.env.ramp(this.output.gain,o,0)}},{key:"setADSR",value:function(o,f,g,k){this.env.setADSR(o,f,g,k)}},{key:"amp",value:function(o,f){var g=f||0;return typeof o<"u"&&this.oscillator.amp(o,g),this.oscillator.amp().value}},{key:"connect",value:function(o){var f=o||i.input;this.output.connect(f.input?f.input:f)}},{key:"disconnect",value:function(){this.output&&this.output.disconnect()}},{key:"dispose",value:function(){vt(Fe(r.prototype),"dispose",this).call(this),this.env&&this.env.dispose(),this.oscillator&&this.oscillator.dispose()}}]),r}(hn),uo=ao;function lo(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function co(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function fo(s,r,t){return r&&co(s.prototype,r),s}var ho=function(){function s(r,t,o,f){lo(this,s),this.isDetected=!1,this.freqLow=r,this.freqHigh=t,this.treshold=o,this.energy=0,this.penergy=0,this.sensitivity=500,this.callback=f}return fo(s,[{key:"update",value:function(t,o){if(this.energy=t.getEnergy(this.freqLow,this.freqHigh)/255,this.isDetected===!1&&this.energy-this.penergy>this.treshold){this.isDetected=!0,this.callback?this.callback(this.energy):o&&o(this.energy);var f=this;setTimeout(function(){f.isDetected=!1},this.sensitivity)}this.penergy=this.energy}}]),s}(),po=ho;function mo(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}function vo(s,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}function yo(s,r,t){return r&&vo(s.prototype,r),s}var go=function(){function s(r,t){mo(this,s),this.audiovoices=[],this.notes={},this._newest=0,this._oldest=0,this.maxVoices=t||8,this.AudioVoice=r===void 0?p5.MonoSynth:r,this._voicesInUse=new At.a(0),this.output=i.audiocontext.createGain(),this.connect(),this._allocateVoices(),i.soundArray.push(this)}return yo(s,[{key:"_allocateVoices",value:function(){for(var t=0;t<this.maxVoices;t++)this.audiovoices.push(new this.AudioVoice),this.audiovoices[t].disconnect(),this.audiovoices[t].connect(this.output)}},{key:"play",value:function(t,o,f){var g=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;this.noteAttack(t,o,f),this.noteRelease(t,f+g)}},{key:"noteADSR",value:function(t,o,f,g,k){var I=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0,N=i.audiocontext.currentTime,G=N+I;this.audiovoices[this.notes[t].getValueAtTime(G)].setADSR(o,f,g,k)}},{key:"setADSR",value:function(t,o,f,g){this.audiovoices.forEach(function(k){k.setADSR(t,o,f,g)})}},{key:"noteAttack",value:function(t,o){var f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,g=i.audiocontext.currentTime+f,k=y(t),I=o||.1,N;this.notes[k]&&this.notes[k].getValueAtTime(g)!==null&&this.noteRelease(k,0),this._voicesInUse.getValueAtTime(g)<this.maxVoices?N=Math.max(~~this._voicesInUse.getValueAtTime(g),0):(N=this._oldest,oldestNote=h(this.audiovoices[this._oldest].oscillator.freq().value),this.noteRelease(oldestNote),this._oldest=(this._oldest+1)%(this.maxVoices-1)),this.notes[k]=new At.a,this.notes[k].setValueAtTime(N,g);var G=this._voicesInUse._searchBefore(g)===null?0:this._voicesInUse._searchBefore(g).value;if(this._voicesInUse.setValueAtTime(G+1,g),this._updateAfter(g,1),this._newest=N,typeof I=="number"){var j=1/this._voicesInUse.getValueAtTime(g)*2;I=I>j?j:I}this.audiovoices[N].triggerAttack(k,I,f)}},{key:"_updateAfter",value:function(t,o){if(this._voicesInUse._searchAfter(t)!==null){this._voicesInUse._searchAfter(t).value+=o;var f=this._voicesInUse._searchAfter(t).time;this._updateAfter(f,o)}}},{key:"noteRelease",value:function(t,o){var f=i.audiocontext.currentTime,g=o||0,k=f+g;if(!t){this.audiovoices.forEach(function(j){j.triggerRelease(g)}),this._voicesInUse.setValueAtTime(0,k);for(var I in this.notes)this.notes[I].dispose(),delete this.notes[I];return}var N=y(t);if(!this.notes[N]||this.notes[N].getValueAtTime(k)===null)console.warn("Cannot release a note that is not already playing");else{var G=Math.max(~~this._voicesInUse.getValueAtTime(k).value,1);this._voicesInUse.setValueAtTime(G-1,k),G>0&&this._updateAfter(k,-1),this.audiovoices[this.notes[N].getValueAtTime(k)].triggerRelease(g),this.notes[N].dispose(),delete this.notes[N],this._newest=this._newest===0?0:(this._newest-1)%(this.maxVoices-1)}}},{key:"connect",value:function(t){var o=t||i.input;this.output.connect(o.input?o.input:o)}},{key:"disconnect",value:function(){this.output&&this.output.disconnect()}},{key:"dispose",value:function(){this.audiovoices.forEach(function(t){t.dispose()}),this.output&&(this.output.disconnect(),delete this.output)}}]),s}(),xo=go;function _o(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}var To=function s(){_o(this,s),console.warn("p5.Signal is deprecated , Use Tone.js Signal instead ")},So=To;p5.prototype.getAudioContext=D.b,p5.prototype.userStartAudio=D.c,p5.prototype.sampleRate=d,p5.prototype.freqToMidi=h,p5.prototype.midiToFreq=a,p5.prototype.noteToFreq=y,p5.prototype.soundFormats=m,p5.prototype.disposeSound=x,p5.prototype._checkFileFormats=T,p5.prototype._mathChain=P,p5.prototype.convertToWav=E,p5.prototype.interleave=B,p5.prototype.writeUTFBytes=_,p5.prototype.safeBufferSize=w,p5.prototype.saveSound=A,p5.prototype.registerMethod("remove",p5.prototype.disposeSound),p5.Panner=$,p5.SoundFile=ne,p5.prototype.loadSound=ae,p5.prototype.registerPreloadMethod("loadSound",p5.prototype),p5.Amplitude=be,p5.FFT=_e,p5.Oscillator=He,p5.SinOsc=An,p5.TriOsc=Cn,p5.SawOsc=Zt,p5.SqrOsc=En,p5.Noise=Vn,p5.Pulse=Zn,p5.AudioIn=ei,p5.Effect=pe,p5.Filter=tt,p5.LowPass=fi,p5.HighPass=hi,p5.BandPass=pi,p5.EQ=Oi,p5.listener3D=Fi,p5.Panner3D=ji,p5.Delay=Ji,p5.Reverb=rn,p5.Convolver=on,p5.prototype.createConvolver=ir,p5.prototype.registerPreloadMethod("createConvolver",p5.prototype),p5.Metro=an,p5.Phrase=Ut,p5.Part=cr,p5.Score=fr,p5.SoundLoop=yr,p5.Compressor=Ar,p5.peakDetect=cn,p5.SoundRecorder=Fr,p5.Distortion=jr,p5.Gain=Zr,p5.AudioVoice=hn,p5.MonoSynth=uo,p5.OnsetDetect=po,p5.PolySynth=xo,p5.PeakDetect=cn,p5.Signal=So}])})();let xe;const Eo=()=>{xe=p.loadSound("...wav")},ko=()=>{xe.isPlaying()?xe.pause():xe.play(0,1,.7,xn-7)},Oo=()=>{document.querySelector("canvas").addEventListener("click",()=>{ko()})},pn=()=>xe.currentTime(),Ro={linear:F=>F,easeInQuad:F=>F*F,easeOutQuad:F=>F*(2-F),easeInOutQuad:F=>F<.5?2*F*F:-1+(4-2*F)*F,easeInCubic:F=>F*F*F,easeOutCubic:F=>--F*F*F+1,easeInOutCubic:F=>F<.5?4*F*F*F:(F-1)*(2*F-2)*(2*F-2)+1,easeInQuart:F=>F*F*F*F,easeOutQuart:F=>1- --F*F*F*F,easeInOutQuart:F=>F<.5?8*F*F*F*F:1-8*--F*F*F*F,easeInQuint:F=>F*F*F*F*F,easeOutQuint:F=>1+--F*F*F*F*F,easeInOutQuint:F=>F<.5?16*F*F*F*F*F:1+16*--F*F*F*F*F};let xt,Kt,_n=[],me,dn,mn;const Mo=()=>{Co(),Eo()},Tn=()=>{const F=document.querySelector("canvas");F.style.position="absolute",F.style.top="50%",F.style.left="50%";const V=Math.min(window.innerWidth/yn,window.innerHeight/Yt);F.style.transform=`translate(-50%, -50%) scale(${V})`},Bo=()=>{p.createCanvas(yn,Yt,p.WEBGL),p.pixelDensity(1),p.frameRate(bo),Oo(),xt=ge.Engine.create(),me=Ht.Body.create({position:{x:0,y:0}}),dn=yt.textToPoints(gn,0,0,gt),mn=Ht.Vertices.create(dn,me),me=ge.Bodies.fromVertices(0,0,[Ht.Vertices.clockwiseSort(mn.flat())],{isStatic:!0}),ge.World.add(xt.world,[me]),Kt=Po.replace(/\r?\n/g,"").split("").reverse(),_n=Kt.map(F=>({body:ge.Bodies.fromVertices(p.random(-300,300),-(3*Yt/4),yt.textToPoints(F,0,0,gt)),isAdded:!1})),p.textFont(yt),Tn()},Do=()=>{p.background(0),xe.isPlaying()&&ge.Engine.update(xt),xe.isPlaying()&&pn()!==0&&_n.forEach(({body:F,isAdded:V},S,D)=>{if(!V)p.lerp(xn,Ao,Ro.easeInOutQuad(p.norm(S,0,D.length-1)))<pn()&&(ge.World.add(xt.world,[F]),D[S].isAdded=!0);else{p.push();{p.fill(128),p.beginShape();for(let v of F.vertices)p.vertex(v.x,v.y);p.endShape(p.CLOSE)}p.pop(),p.push(),p.fill(255),p.translate(F.position.x,F.position.y),p.rotate(F.angle),p.textSize(gt),p.textAlign(p.CENTER,p.CENTER),p.text(Kt[S],0,0),p.pop()}}),p.push();{p.strokeWeight(3),p.fill(128),p.beginShape();for(let F of me.vertices)p.vertex(F.x,F.y);p.endShape(p.CLOSE)}p.pop(),p.push(),p.fill(255),p.translate(me.position.x,me.position.y),p.rotate(me.angle),p.textSize(gt),p.textAlign(p.CENTER,p.CENTER),p.text(gn,0,0),p.pop()};window.onload=()=>{new p5(F=>{window.p=F,F.preload=Mo,F.setup=Bo,F.draw=Do,F.windowResized=Tn})};
